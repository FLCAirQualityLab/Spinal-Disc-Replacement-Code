%% This code finds c5-c6 foreman width/height narrowig/widening during lateral bending (5N
clear all
clf
I=21;
%% model15_Intact/TLC_5N
T15=[2,2.0575,2.10375,2.15062,2.20072,2.26757,2.30624,2.35024,2.40593,2.45239,2.51131,2.56239,2.61382,2.65198,2.70613,2.75565,2.80324,2.85205,2.90639,2.95374,3];
%40274U
AA1=-12.0976+[0.114338,-0.0267734,-0.123845,-0.239742,-0.401986,-0.644139,-0.76897,-0.888614,-1.02613,-1.12976,-1.24041,-1.32513,-1.40594,-1.46431,-1.53999,-1.60494,-1.6636,-1.71963,-1.77934,-1.8291,-1.87465];
AA2=446.629+[-0.444623,-0.311169,-0.139858,0.0976273,0.439803,0.9768,1.28113,1.58605,1.94336,2.19826,2.44838,2.64099,2.81606,2.92691,3.06864,3.19193,3.30768,3.42253,3.54631,3.65126,3.75097];
AA3=-721.193+[-0.413199,-0.604228,-0.761709,-0.944794,-1.16823,-1.49047,-1.67114,-1.86485,-2.09934,-2.27627,-2.45707,-2.59633,-2.72407,-2.80287,-2.9044,-2.99168,-3.07173,-3.15004,-3.23239,-3.30133,-3.36705];
%62517L
AB1=-13.5347+[0.039132,-0.0197486,-0.062728,-0.118432,-0.202568,-0.329153,-0.391427,-0.449851,-0.518924,-0.57019,-0.624684,-0.665302,-0.703142,-0.730007,-0.764889,-0.795039,-0.822973,-0.849874,-0.878906,-0.903682,-0.926846];
AB2=446.999+[-0.268147,-0.203289,-0.135101,-0.0452279,0.116239,0.394493,0.55279,0.703563,0.874241,0.990272,1.09881,1.18216,1.26068,1.31739,1.38851,1.45072,1.50953,1.56841,1.63382,1.69011,1.74321];
AB3=-731.069+[-0.184018,-0.273195,-0.343555,-0.429092,-0.551172,-0.744445,-0.851956,-0.960369,-1.08657,-1.17617,-1.26459,-1.32986,-1.39089,-1.43332,-1.48596,-1.53101,-1.57238,-1.61242,-1.65555,-1.69219,-1.72665];
%45870
AC1=-9.75965+[0.0977491,-0.0237291,-0.107966,-0.210636,-0.356422,-0.576561,-0.690714,-0.800182,-0.926323,-1.02131,-1.12301,-1.20122,-1.2761,-1.33042,-1.40092,-1.46154,-1.51641,-1.56892,-1.62505,-1.67201,-1.71516];
AC2=445.175+[-0.422749,-0.318282,-0.177388,0.0216289,0.316968,0.785829,1.05194,1.31738,1.62832,1.85007,2.06716,2.23409,2.38599,2.48284,2.60661,2.71439,2.81583,2.91658,3.02545,3.11789,3.20559];
AC3=-723.489+[-0.443259,-0.596379,-0.720939,-0.864191,-1.03667,-1.28269,-1.42025,-1.56869,-1.7483,-1.88369,-2.0212,-2.12626,-2.22222,-2.2808,-2.35587,-2.42006,-2.4787,-2.53582,-2.59556,-2.64551,-2.69312];
%65936R
AD1=-15.4024+[0.0922672,-0.00313632,-0.0711395,-0.157016,-0.283815,-0.475852,-0.573226,-0.666365,-0.775967,-0.856902,-0.942605,-1.00668,-1.06651,-1.10868,-1.16329,-1.21056,-1.2543,-1.29654,-1.34195,-1.3803,-1.41595];
AD2=450.021+[-0.356624,-0.288059,-0.207505,-0.0951789,0.116567,0.486303,0.696502,0.894808,1.11909,1.27176,1.41437,1.52419,1.62774,1.70301,1.79728,1.87991,1.9584,2.03727,2.1253,2.20137,2.27305];
AD3=-723.647+[-0.136441,-0.236356,-0.318198,-0.420763,-0.574778,-0.824452,-0.964356,-1.10385,-1.26632,-1.38183,-1.49593,-1.58121,-1.66131,-1.71763,-1.78799,-1.84872,-1.90509,-1.96024,-2.02026,-2.07154,-2.11977];
YA1=[AA1-AB1];
YA2=[AA2-AB2];
YA3=[AA3-AB3];
XA1=[AD1-AC1];
XA2=[AD2-AC2];
XA3=[AD3-AC3];
%OH - Original Height Vector
OH=[YA1(1,1),YA2(1,1),YA3(1,1)];
%OHM - Original Height Magnitude
OHM=sqrt(YA1(1,1)^2+YA2(1,1)^2+YA3(1,1)^2);
%OW - Original Width Vector
OW=[XA1(1,1),XA2(1,1),XA3(1,1)];
%OWM - Original Width Magnitude
OWM=sqrt(XA1(1,1)^2+XA2(1,1)^2+XA3(1,1)^2);
Y15=[YA1',YA2',YA3'];
X15=[XA1',XA2',XA3'];
for N=1:I
    mag15y(N)=sqrt(Y15(N,1)^2+Y15(N,2)^2+Y15(N,3)^2);
end
for N=1:I
    intact_height_disp(N)=mag15y(1,1)-mag15y(1,N);
end
for N=1:I
    mag15x(N)=sqrt(X15(N,1)^2+X15(N,2)^2+X15(N,3)^2);
end
for N=1:I
    intact_width_disp(N)=mag15x(1,1)-mag15x(1,N);
end
figure(1)
plot(T15,-1*intact_height_disp,'b')
hold on
plot(T15,-1*intact_width_disp,'k')
xlabel('time (s)')
ylabel({'Narrowing/Widening (mm)';'Positive is Widening - Negative is narrowing'})
title('C5-C6 Narrowing/Widening under lateral bending (5N)')
%Percent change
PCW=100-mag15x(21)/mag15x(1)*100;
PCH=100-mag15y(21)/mag15y(1)*100;
PC=[PCW,PCH];
figure(2)
bar(PC,'b')
xticklabels({'Width','Height'})
%% model_1_SlideSlide_Tether
T1=[2,2.05126,2.11533,2.16533,2.2247,2.25107,2.30644,2.35622,2.40972,2.46023,2.50711,2.55164,2.60232,2.65142,2.72191,2.77012,2.80437,2.86374,2.90593,2.9903,3];
%40274U
AE1=-12.0976+[-0.25429,-0.179045,-0.0671642,-0.0325724,-0.0484103,-0.0749166,-0.158212,-0.256218,-0.380373,-0.507808,-0.631858,-0.755596,-0.89575,-1.02456,-1.20151,-1.31252,-1.38274,-1.49111,-1.55681,-1.6739,-1.68652];
AE2=446.629+[0.587276,0.35337,0.280874,0.302942,0.358368,0.395352,0.502528,0.623943,0.784835,0.971668,1.16561,1.36366,1.60971,1.86304,2.20493,2.41893,2.56203,2.79603,2.94874,3.22998,3.26112];
AE3=-721.193+[-0.763545,-0.942835,-1.01004,-1.11306,-1.25878,-1.33084,-1.49363,-1.64659,-1.81656,-1.98261,-2.13929,-2.28684,-2.45395,-2.614,-2.81921,-2.93808,-3.0148,-3.13763,-3.21579,-3.35516,-3.37042];
%62517L
AF1=-13.5347+[-0.146524,-0.12141,-0.0645272,-0.0393416,-0.0341268,-0.0423363,-0.0774891,-0.12419,-0.187812,-0.256234,-0.321332,-0.383771,-0.451723,-0.512127,-0.593777,-0.642592,-0.673022,-0.719385,-0.747757,-0.800349,-0.806102];
AF2=446.999+[0.3466,0.162781,0.06833,0.0410128,0.0315504,0.0369391,0.0701168,0.11621,0.186682,0.275212,0.370063,0.475044,0.608509,0.745663,0.920191,1.03031,1.10344,1.22165,1.2984,1.4433,1.45943];
AF3=-731.069+[-0.38589,-0.456415,-0.43942,-0.458718,-0.512353,-0.544655,-0.626468,-0.710031,-0.809766,-0.911035,-1.00821,-1.10385,-1.21223,-1.31271,-1.43103,-1.49844,-1.54033,-1.60455,-1.64438,-1.71673,-1.72463];
%65936R
AG1=-15.4024+[-0.16872,-0.127651,-0.0666353,-0.0505175,-0.0679214,-0.0869135,-0.14913,-0.224248,-0.322025,-0.425613,-0.525253,-0.621507,-0.727073,-0.821944,-0.946885,-1.0215,-1.06824,-1.13994,-1.1843,-1.26609,-1.27504];
AG2=450.021+[0.476683,0.2022,0.0688057,0.0216311,-0.00886022,-0.00859879,0.0225106,0.0730316,0.157115,0.267956,0.388722,0.524424,0.69856,0.879537,1.11323,1.26232,1.36189,1.52335,1.62852,1.82824,1.85054];
AG3=-723.647+[-0.447071,-0.476123,-0.442288,-0.45598,-0.507119,-0.54027,-0.628596,-0.721765,-0.836574,-0.956984,-1.07491,-1.19337,-1.33035,-1.46035,-1.61842,-1.71165,-1.77091,-1.86346,-1.92194,-2.03026,-2.04222];
%45870
AH1=-9.75965+[-0.240195,-0.16847,-0.0514884,-0.00915227,-0.0150424,-0.0371687,-0.110388,-0.198853,-0.312474,-0.429642,-0.543872,-0.65837,-0.788869,-0.909237,-1.07497,-1.17927,-1.24532,-1.34745,-1.40943,-1.52016,-1.53212];
AH2=445.175+[0.513202,0.306489,0.233411,0.242036,0.27566,0.301661,0.384148,0.481755,0.615015,0.773556,0.940086,1.11175,1.32594,1.54694,1.84539,2.03287,2.15838,2.36351,2.49745,2.74483,2.77225];
AH3=-723.489+[-0.700086,-0.901506,-0.962945,-1.04872,-1.16878,-1.22841,-1.36252,-1.48736,-1.62444,-1.75644,-1.87931,-1.99366,-2.12129,-2.24156,-2.39132,-2.47518,-2.52848,-2.61264,-2.6654,-2.75796,-2.76802];
XB1=[AG1-AH1];
XB2=[AG2-AH2];
XB3=[AG3-AH3];
YB1=[AE1-AF1];
YB2=[AE2-AF2];
YB3=[AE3-AF3];
X1=[XB1',XB2',XB3'];
Y1=[YB1',YB2',YB3'];
for N=1:I
    mag1x(N)=sqrt(X1(N,1)^2+X1(N,2)^2+X1(N,3)^2);
end
for N=1:I
    mag1y(N)=sqrt(Y1(N,1)^2+Y1(N,2)^2+Y1(N,3)^2);
end
for N=1:I
    model1_widthdisp(N)=mag1x(1,1)-mag1x(1,N)
end
for N=1:I
    model1_heightdisp(N)=mag1y(1,1)-mag1y(1,N)
end
figure(1)
hold on
plot(T1,(-1)*model1_widthdisp,'-.k')
hold on
plot(T1,-1*model1_heightdisp,'-.b')
legend('intact height','intact width','model 1 width','model 1 height','location','southwest')

    