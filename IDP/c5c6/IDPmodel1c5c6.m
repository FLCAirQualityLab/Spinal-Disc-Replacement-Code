%% this script plots average IDP for the c5-c6 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
% model 1
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.193793 0.222976 0.21558 0.202395 0.195122 0.184757 0.176194 0.168554 0.160409 0.154125 0.148388 0.144691 0.141954 0.140687 0.140605 0.141711 0.145144 0.148562 0.154188 0.159759 0.166785];
x4n=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

%4p
p4p=[0.193793 0.245918 0.264247 0.282938 0.304848 0.318205 0.338503 0.357406 0.385777 0.398511 0.423702 0.445368 0.471421 0.494647 0.517783 0.543173 0.569476 0.596287 0.623445 0.647127 0.665433];
x4p=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.32627 2.36846 2.42783 2.4542 2.50615 2.55076 2.60453 2.65273 2.70062 2.75176 2.80444 2.85837 2.91342 2.96196 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f2=plot(x4,p4,'r');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2],'intact','model 1')
hold on
%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.193793 0.237033 0.241268 0.244521 0.249666 0.252068 0.257562 0.262002 0.266015 0.26934 0.271453 0.272443 0.272477 0.27161 0.267388 0.262824 0.259558 0.253834 0.249858 0.242319 0.241495];
x5n=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30644 2.35622 2.40972 2.46023 2.50711 2.55164 2.60232 2.65142 2.72191 2.77012 2.80437 2.86374 2.90593 2.9903 3];

%5p
p5p=[0.193793 0.236746 0.238346 0.23882 0.240738 0.243281 0.24503 0.246369 0.247832 0.249131 0.249927 0.249873 0.248193 0.244228 0.24038 0.233893 0.225612 0.218754 0.211522 0.205611 0.200044 ];
x5p=[2 2.05126 2.10091 2.15165 2.20195 2.26309 2.30825 2.35242 2.40115 2.45206 2.50453 2.55201 2.60315 2.66299 2.70555 2.75188 2.8058 2.85226 2.9048 2.95124 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d2=plot(x5,p5,'r');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2],'intact','model 1')
hold on
%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.193793 0.253627 0.261586 0.268061 0.276036 0.283283 0.291338 0.299791 0.310914 0.316204 0.323751 0.330234 0.337943 0.343298 0.348614 0.359059 0.364164 0.369243 0.37367 0.380776 0.384394 ];
x6n=[2 2.0523 2.11876 2.16162 2.21039 2.25339 2.30021 2.35024 2.42245 2.45953 2.51292 2.56096 2.62034 2.66253 2.70471 2.78909 2.83128 2.87346 2.91038 2.9697 3];

%6p
p6p=[0.193793 0.236332 0.238513 0.240798 0.245369 0.251974 0.261057 0.27188 0.278745 0.289584 0.298167 0.30343 0.310441 0.317597 0.32459 0.332135 0.336767 0.34559 0.351597 0.355731 0.360814 ];
x6p=[2 2.05126 2.10091 2.15535 2.20061 2.25209 2.30561 2.36555 2.40191 2.4653 2.51879 2.5529 2.60117 2.65273 2.7052 2.76398 2.80076 2.87223 2.92223 2.95699 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s2=plot(x6,p6,'r');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2],'intact','model 1')
hold on

