%% this script plots average IDP for the c5-c6 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 6
%% flexion/extension (4n4p) c5-c6 Average IDP
%4n
p4n=[0.0389556 0.225608 0.213422 0.201409 0.190702 0.183049 0.176027 0.170928 0.168281 0.166874 0.168409 0.170112 0.173223 0.177323 0.181045 0.185829 0.192584 0.199722 0.208555 0.217513 0.225627];
x4n=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];

%4p
p4p=[0.0389556 0.25732 0.270611 0.296341 0.314731 0.338575 0.362129 0.388543 0.425175 0.439292 0.463951 0.485681 0.504513 0.528712 0.555173 0.576429 0.601395 0.625436 0.655427 0.673407 0.692344];
x4p=[2 2.06926 2.1039 2.16327 2.20546 2.25429 2.30079 2.35429 2.4315 2.46157 2.514 2.56038 2.60079 2.65194 2.70721 2.75135 2.80366 2.85454 2.91895 2.95814 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f7=plot(x4,p4,'y');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6,f7],'intact','model 1','model 2','model 3','model 4','model 5','model 6')
hold on

%% lateral bending (5n5p) c5-c6 Average IDP
%5n
p5n=[0.0389556 0.241496 0.245434 0.249412 0.2583 0.261418 0.264749 0.267408 0.269455 0.27016 0.269693 0.267328 0.263921 0.259965 0.255457 0.248404 0.24543 0.242532 0.239858 0.235173 0.234612  ];
x5n=[2 2.06926 2.11544 2.15658 2.22964 2.26089 2.30352 2.35172 2.40991 2.47326 2.50451 2.56164 2.6091 2.65161 2.70076 2.78645 2.82704 2.86763 2.90822 2.98941 3];

%5p
p5p=[0.0389556 0.240253 0.242113 0.246106 0.248276 0.250487 0.25107 0.25071 0.249699 0.247447 0.243304 0.237987 0.232349 0.22358 0.21786 0.210953 0.206869 0.201668 0.197483 0.193445 0.189868];
x5p=[2 2.06926 2.11039 2.16205 2.20253 2.25469 2.30237 2.35235 2.40447 2.45402 2.50951 2.55995 2.60457 2.66104 2.70282 2.76219 2.80057 2.85371 2.90136 2.95138 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d7=plot(x5,p5,'y');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6,d7],'intact','model 1','model 2','model 3','model 4','model 5','model 6')
hold on

%% axial rotation (6n6p) c5-c6 Average IDP
%6n
p6n=[0.0389556 0.247836 0.257148 0.264876 0.274858 0.283925 0.291058 0.299869 0.310363 0.316042 0.324081 0.33083 0.336555 0.345506 0.350807 0.356045 0.362144 0.368165 0.375287 0.380344 0.384039];
x6n=[2 2.05457 2.10596 2.15281 2.2099 2.26199 2.30323 2.3549 2.42252 2.46212 2.51913 2.56913 2.61288 2.68319 2.72538 2.76757 2.81757 2.86757 2.92694 2.96913 3];

%6p % 
p6p=[0.0389556 0.234703 0.239572 0.242255 0.248498 0.253872 0.263007 0.274849 0.281975 0.291129 0.298095 0.305833 0.31207 0.318855 0.32486 0.332495 0.339285 0.343336 0.350429 0.356215 0.361197];
x6p=[2 2.05486 2.10789 2.15953 2.21347 2.25039 2.30255 2.36524 2.40407 2.45974 2.50483 2.55731 2.60253 2.65367 2.70049 2.76158 2.81718 2.85019 2.90883 2.95766 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s7=plot(x6,p6,'y');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6,s7],'intact','model 1','model 2','model 3','model 4','model 5','model 6')
hold on



