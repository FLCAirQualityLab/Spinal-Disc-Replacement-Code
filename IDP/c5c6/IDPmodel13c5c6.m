%% this script plots average IDP for the c5-c6 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 13
%% flexion/extension (4n4p) c5-c6 Average IDP
%4n
p4n=[0.753686 0.750839 0.741455 0.734189 0.725554 0.721971 0.713174 0.708538 0.702321 0.695792 0.69022 0.686009 0.680939 0.676064 0.673307 0.671655 0.67083 0.671549 0.674167 0.679206 0.686034];
x4n=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];

%4p
p4p=[0.753686 0.759554 0.77043 0.780494 0.791637 0.806974 0.824351 0.844213 0.864313 0.881033 0.897016 0.912641 0.931463 0.945209 0.957965 0.975177 0.99116 1.0106 1.03075 1.05396 1.06902];
x4p=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

% plot
figure(1)
f8=plot(x4,p4,'color',[0.6350, 0.0780, 0.1840]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6,f7,f8],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13')
hold on

%% lateral bending (5n5p) c5-c6 Average IDP
%5n
p5n=[0.753686 0.75654 0.758795 0.760276 0.761252 0.762755 0.765318 0.767662 0.770525 0.77188 0.776561 0.780723 0.785943 0.792078 0.797291 0.802673 0.808061 0.810912 0.814533 0.818986 0.820964];
x5n=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.32471 2.36689 2.42627 2.45263 2.51864 2.55993 2.60692 2.66037 2.70735 2.75754 2.81624 2.85281 2.9034 2.9694 3];

%5p
p5p=[0.753686 0.755342 0.754564 0.752886 0.751785 0.751679 0.75237 0.753887 0.757071 0.76127 0.764978 0.76884 0.77217 0.77597 0.778034 0.782346 0.785426 0.788353 0.79055 0.793782 0.794784];
x5p=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35451 2.40116 2.45302 2.50151 2.55488 2.60159 2.66574 2.70148 2.76497 2.80618 2.85814 2.90512 2.97561 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d8=plot(x5,p5,'color',[0.6350, 0.0780, 0.1840]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6,d7,d8],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13')
hold on

%% axial rotation (6n6p) c5-c6 Average IDP
%6n
p6n=[0.753686 0.769838 0.782752 0.788818 0.79281 0.80102 0.807707 0.809814 0.821566 0.832073 0.839759 0.851976 0.873175 0.8762 0.88767 0.910419 0.913543 0.926096 0.936001 0.951747 0.959678];
x6n=[2 2.06253 2.12507 2.17135 2.21519 2.29738 2.34738 2.35988 2.41926 2.46936 2.50412 2.55762 2.64563 2.65813 2.705 2.79719 2.80969 2.86028 2.90125 2.96727 3 ];

%6p % 
p6p=[0.753686 0.755485 0.754259 0.753262 0.751167 0.749156 0.749163 0.751519 0.755642 0.761599 0.769933 0.778 0.787861 0.79549 0.812773 0.820174 0.834569 0.843716 0.860042 0.872942 0.886349];
x6p=[2 2.05126 2.11533 2.16533 2.21533 2.25361 2.30816 2.35516 2.41122 2.46102 2.51245 2.55582 2.60999 2.65082 2.73015 2.7614 2.81853 2.85329 2.91154 2.95522 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s8=plot(x6,p6,'color',[0.6350, 0.0780, 0.1840]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6,s7,s8],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13')
hold on