%% this script plots average IDP for the c5-c6 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 4
%% flexion/extension (4n4p)c5-c6 Average IDP
%4n
p4n=[0.0388881 0.225439 0.207581 0.197127 0.190777 0.188057 0.187407 0.190425 0.194584 0.19892 0.203333 0.207983 0.213868 0.22062 0.227704 0.234605 0.242478 0.250428 0.255754 0.262873 0.267055];
x4n=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3 ];

%4p
p4p=[0.0388881 0.262273 0.287714 0.31703 0.336092 0.364048 0.385082 0.406433 0.430563 0.45373 0.476069 0.504399 0.524058 0.543526 0.569474 0.589612 0.615049 0.639838 0.663594 0.681371 0.703371];
x4p=[2 2.05816 2.10161 2.16188 2.20417 2.26497 2.3108 2.35767 2.41039 2.46048 2.50857 2.57039 2.61266 2.65395 2.70851 2.75122 2.8056 2.85917 2.91124 2.95071 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f5=plot(x4,p4,'c');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5],'intact','model 1','model 2','model 3','model 4')
hold on

%% lateral bending (5n5p) c5-c6 Average IDP
%5n
p5n=[0.0388881 0.244507 0.252088 0.257492 0.261475 0.263619 0.264399 0.264811 0.264861 0.263604 0.261565 0.258462 0.255559 0.25205 0.248013 0.245955 0.242727 0.238993 0.237194 0.233216 0.232602];
x5n=[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3];

%5p
p5p=[0.0388881 0.244867 0.249961 0.251443 0.250863 0.249041 0.24644 0.243423 0.240129 0.235199 0.229398 0.225751 0.220247 0.215021 0.210712 0.205024 0.202251 0.19779 0.193725 0.190505 0.187328];
x5p=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d5=plot(x5,p5,'c');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5],'intact','model 1','model 2','model 3','model 4')
hold on

%% axial rotation (6n6p) c5-c6 Average IDP
%6n
p6n=[0.0388881 0.245295 0.254311 0.263855 0.27408 0.282616 0.29169 0.301375 0.307366 0.314443 0.321317 0.32995 0.33696 0.341811 0.348165 0.354417 0.36057 0.366646 0.375312 0.380394 0.3841];
x6n=[2 2.05499 2.10192 2.15388 2.20807 2.25585 2.30786 2.36346 2.40295 2.45178 2.50023 2.56364 2.61714 2.65515 2.70515 2.75515 2.80515 2.85515 2.92702 2.96921 3];

%6p % 
p6p=[0.0388881 0.244629 0.253536 0.261845 0.269081 0.275892 0.282923 0.290056 0.295067 0.300853 0.307785 0.315044 0.318977 0.327091 0.331679 0.338791 0.344687 0.348874 0.354741 0.360703 0.36654];
x6p=[2 2.05499 2.11058 2.16207 2.20435 2.25007 2.30324 2.36036 2.40263 2.45125 2.50837 2.56869 2.60135 2.66917 2.7073 2.76599 2.81551 2.85069 2.90069 2.95128 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s5=plot(x6,p6,'c');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5],'intact','model 1','model 2','model 3','model 4')
hold on



