%% this script plots average IDP for the c5-c6 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 5
%% flexion/extension (4n4p) c5-c6 Average IDP
%4n
p4n=[0.232914 0.231326 0.220418 0.207689 0.20095 0.188487 0.178972 0.170723 0.162415 0.154371 0.146671 0.139358 0.1322 0.128037 0.123609 0.120077 0.11809 0.117069 0.117704 0.120189 0.124012];
x4n=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];

%4p
p4p=[0.232914 0.241149 0.254533 0.265534 0.278734 0.292383 0.315647 0.329632 0.338401 0.359829 0.369509 0.39158 0.401373 0.412881 0.42964 0.447035 0.471866 0.483509 0.507272 0.523392 0.544158];
x4p=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f6=plot(x4,p4,'m');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6],'intact','model 1','model 2','model 3','model 4','model 5')
hold on

%% lateral bending (5n5p) c5-c6 Average IDP
%5n
p5n=[0.232914 0.235336 0.236745 0.23763 0.239577 0.241151 0.242329 0.244161 0.248739 0.250716 0.254128 0.255645 0.257593 0.260696 0.262283 0.263923 0.265233 0.266043 0.266987 0.267495 0.267456];
x5n=[2 2.05126 2.10091 2.15137 2.23246 2.28246 2.31371 2.35238 2.42753 2.45878 2.51533 2.551 2.6001 2.67059 2.71118 2.76118 2.82055 2.86274 2.92212 2.9643 3];

%5p
p5p=[0.232914 0.235254 0.236063 0.236093 0.235953 0.235401 0.235256 0.235654 0.236045 0.236298 0.236594 0.236286 0.235951 0.235789 0.23572 0.235527 0.234891 0.234361 0.233609 0.233181 0.232771];
x5p=[2 2.05126 2.11533 2.17471 2.20107 2.25991 2.30337 2.35035 2.40415 2.45064 2.51269 2.558 2.61911 2.66482 2.70279 2.77248 2.82013 2.86034 2.91837 2.95368 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d6=plot(x5,p5,'m');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6],'intact','model 1','model 2','model 3','model 4','model 5')
hold on

%% axial rotation (6n6p) c5-c6 Average IDP
%6n
p6n=[0.232914 0.246922 0.257559 0.266935 0.274255 0.284197 0.292578 0.299464 0.30789 0.31465 0.321335 0.328895 0.335719 0.343258 0.349521 0.355706 0.36178 0.36777 0.374869 0.37991 0.383506 ];
x6n=[2 2.05109 2.10925 2.16553 2.20718 2.26451 2.31289 2.3537 2.40703 2.45415 2.50161 2.55682 2.60896 2.66829 2.71829 2.76829 2.81829 2.86829 2.92766 2.96985 3];

%6p 
p6p=[0.232914 0.235183 0.235793 0.236279 0.236929 0.237939 0.239935 0.241798 0.246019 0.250544 0.255722 0.261508 0.265732 0.27021 0.275054 0.277598 0.282057 0.287182 0.298117 0.299627 0.304473];
x6p=[2 2.05126 2.11533 2.16533 2.20361 2.25315 2.31416 2.35262 2.40417 2.45195 2.50082 2.55529 2.60294 2.66047 2.7231 2.75435 2.80406 2.85412 2.94917 2.96167 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s6=plot(x6,p6,'m');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6],'intact','model 1','model 2','model 3','model 4','model 5')
hold on
