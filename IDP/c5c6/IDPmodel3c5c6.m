%% this script plots average IDP for the c5-c6 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 3
%% flexion/extension (4n4p) c5-c6 Average IDP
%4n
p4n=[0.232917 0.231381 0.220747 0.210281 0.201592 0.189696 0.178863 0.170445 0.162208 0.153547 0.14639 0.138642 0.13297 0.128296 0.124087 0.120597 0.118642 0.117903 0.11913 0.122228 0.125802];
x4n=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];

%4p
p4p=[0.232917 0.241172 0.254348 0.265342 0.282035 0.295401 0.312344 0.326501 0.343325 0.351351 0.369869 0.388438 0.40428 0.415764 0.430916 0.451186 0.464823 0.484146 0.506104 0.529136 0.545568];
x4p=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3 ];
% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f4=plot(x4,p4,'b');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4],'intact','model 1','model 2','model 3')
hold on
%% lateral bending (5n5p) c5-c6 Average IDP
%5n
p5n=[0.232917 0.235343 0.23684 0.237664 0.238864 0.240433 0.242828 0.244144 0.247249 0.250532 0.253488 0.256274 0.257938 0.260177 0.262527 0.264173 0.265126 0.266011 0.267365 0.267482 0.267388 ];
x5n=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.32471 2.35107 2.40206 2.45356 2.50055 2.56107 2.60246 2.65199 2.71178 2.76467 2.80998 2.85632 2.94802 2.96052 3 ];

%5p
p5p=[0.232917 0.23537 0.236342 0.236424 0.236293 0.235699 0.235491 0.235829 0.236249 0.236508 0.236809 0.236495 0.236219 0.23605 0.235932 0.235794 0.235213 0.234566 0.233768 0.233494 0.233056];
x5p=[2 2.05126 2.11533 2.17471 2.20107 2.25991 2.30337 2.35035 2.40609 2.45257 2.51312 2.55394 2.60039 2.6528 2.7013 2.75933 2.80608 2.85863 2.92741 2.95108 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d4=plot(x5,p5,'b');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4],'intact','model 1','model 2','model 3')
hold on
%% axial rotation (6n6p) c5-c6 Average IDP
%6n
p6n=[0.232917 0.233122 0.233305 0.233458 0.233633 0.233852 0.234151 0.234525 0.235018 0.235593 0.23627 0.237024 0.237868 0.238849 0.239914 0.241087 0.242517 0.24431 0.245659 0.247383 0.248637];
x6n=[2 2.05026 2.11433 2.16433 2.21433 2.26433 2.31433 2.36433 2.41433 2.46433 2.51433 2.56433 2.61433 2.66433 2.71433 2.76433 2.81433 2.87371 2.91589 2.96589 3];

%6p % over constrained
p6p=[0.232917 0.235332 0.236142 0.236778 0.237409 0.238281 0.240126 0.241965 0.24689 0.251987 0.256121 0.262657 0.267762 0.270649 0.275278 0.278879 0.283586 0.289933 0.293484 0.300124 0.305675];
x6p=[2 2.05126 2.11533 2.16533 2.20361 2.25315 2.31416 2.35262 2.41143 2.46244 2.50012 2.56211 2.62242 2.66 2.71937 2.76156 2.81214 2.87147 2.90272 2.95721 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s4=plot(x6,p6,'b');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4],'intact','model 1','model 2','model 3')
hold on



