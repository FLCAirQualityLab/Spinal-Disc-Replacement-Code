%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 14
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.710601 0.74711 0.739451 0.731796 0.728203 0.720766 0.714937 0.70832 0.700557 0.695814 0.691622 0.689137 0.686014 0.68367 0.68396 0.68628 0.690475 0.697102 0.70419 0.713928 0.724676];
x4n=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ];

%4p
p4p=[0.710601 0.766832 0.788916 0.805829 0.833638 0.852193 0.890647 0.909232 0.95749 0.96493 1.00298 1.03005 1.05757 1.09323 1.12382 1.15879 1.19161 1.23182 1.26972 1.31919 1.33607 ];
x4p=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f9=plot(x4,p4,'color',[0.9290,0.6940, 0.1250]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6,f7,f8,f9],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13','model 14')
hold on

%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.710601 0.759329 0.76351 0.771091 0.775407 0.784252 0.791269 0.796107 0.802823 0.808567 0.811916 0.817715 0.820844 0.821704 0.823457 0.821953 0.821351 0.82128 0.821763 0.822337 0.822981];
x5n=[2 2.05026 2.11433 2.17371 2.20007 2.2594 2.31877 2.36096 2.42034 2.47043 2.5127 2.58779 2.63779 2.65263 2.70273 2.76565 2.80142 2.8609 2.90157 2.95756 3];

%5p
p5p=[0.710601 0.754663 0.757084 0.760419 0.766072 0.771605 0.775452 0.779106 0.782238 0.784094 0.785659 0.787864 0.788354 0.787738 0.78689 0.782691 0.77969 0.776632 0.774586 0.773312 0.772746 ];
x5p=[2 2.05026 2.12154 2.15397 2.21175 2.26507 2.30594 2.35377 2.40753 2.45988 2.50332 2.56615 2.60113 2.66023 2.70008 2.7573 2.80337 2.85729 2.91233 2.96086 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d9=plot(x5,p5,'color',[0.9290,0.6940, 0.1250]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6,d7,d8,d9],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13','model 14')
hold on

%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.710601 0.760685 0.767252 0.771643 0.778921 0.783519 0.794699 0.80433 0.815328 0.822855 0.832075 0.84304 0.855944 0.868554 0.880293 0.892961 0.90528 0.919877 0.931934 0.947287 0.954538 ];
x6n=[2 2.05026 2.10532 2.15068 2.23407 2.26532 2.33563 2.38563 2.43563 2.46688 2.50555 2.55206 2.60555 2.65607 2.70294 2.75304 2.80113 2.85856 2.90701 2.97041 3];

%6p 
p6p=[0.710601 0.738602 0.748808 0.751202 0.750674 0.749028 0.746653 0.747364 0.750494 0.755089 0.764852 0.768801 0.781713 0.786066 0.797483 0.804491 0.818384 0.826583 0.840549 0.853029 0.866008];
x6p=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30206 2.35204 2.40323 2.45375 2.52804 2.55155 2.62764 2.65371 2.71895 2.75421 2.81684 2.85161 2.90752 2.95451 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s9=plot(x6,p6,'color',[0.9290,0.6940, 0.1250]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6,s7,s8,s9],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13','model 14')
hold on
