%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
% intact
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.843549 0.822281 0.799287 0.776942 0.761994 0.751949 0.746399 0.744644 0.744646 0.747809 0.755504 0.767828 0.780817 0.791848 0.800884 0.812568 0.823898 0.834474 0.844945 0.854151 0.862728];
x4n=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

%4p
p4p=[0.843549 0.869418 0.889436 0.918199 0.936568 0.958138 0.981579 1.00123 1.02609 1.07662 1.09856 1.13859 1.17661 1.2199 1.25621 1.30327 1.34578 1.39261 1.43985 1.49145 1.53255];
x4p=[2 2.0575 2.1025 2.16719 2.21465 2.2716 2.32233 2.35879 2.40155 2.47973 2.51017 2.56326 2.61022 2.66193 2.70424 2.75779 2.80445 2.8546 2.90442 2.95797 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f1=plot(x4,p4,'k');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C3-C4 under flexion/extension')
legend(f1,'intact')
hold on

%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.843549 0.850497 0.853925 0.858082 0.861812 0.863884 0.865452 0.867118 0.8691 0.871606 0.875822 0.878572 0.882739 0.886088 0.889963 0.894346 0.898527 0.903943 0.908466 0.915049 0.919156];
x5n=[2 2.0675 2.10125 2.16062 2.21688 2.26697 2.30924 2.35429 2.40779 2.45293 2.51808 2.55698 2.61406 2.65527 2.70375 2.75725 2.8064 2.86587 2.90654 2.96524 3];

%5p
p5p=[0.843549 0.83969 0.833465 0.82865 0.825311 0.824282 0.825434 0.828473 0.830984 0.834752 0.838969 0.844078 0.847642 0.851309 0.854814 0.858558 0.863294 0.865924 0.86909 0.872198 0.873853 ];
x5p=[2 2.05 2.10719 2.15841 2.20749 2.25204 2.30359 2.36468 2.40251 2.45207 2.50137 2.56422 2.60772 2.65475 2.70141 2.75163 2.81747 2.85415 2.90465 2.96581 3 ];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d1=plot(x5,p5,'k');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C3-C4 IDP under lateral bending')
legend([d1],'intact')
hold on

%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.843549 0.848054 0.850862 0.852634 0.854567 0.855216 0.856777 0.859791 0.861712 0.864924 0.868603 0.872553 0.878354 0.885495 0.893868 0.904079 0.913958 0.92046 0.929885 0.939716 0.949018 ];
x6n=[2 2.0575 2.1047 2.15542 2.22863 2.25714 2.30144 2.3674 2.40898 2.46323 2.51338 2.55396 2.60266 2.65487 2.708 2.76753 2.82255 2.85683 2.90566 2.95411 3];

%6p
p6p=[0.843549 0.83978 0.835594 0.832185 0.830895 0.831685 0.835703 0.840546 0.847837 0.853759 0.861628 0.869806 0.877196 0.885447 0.894456 0.900974 0.906967 0.914896 0.921659 0.928959 0.935878];
x6p=[2 2.0575 2.10171 2.15243 2.21614 2.25202 2.3077 2.35301 2.40975 2.45206 2.50317 2.55517 2.6029 2.65687 2.71794 2.76183 2.80173 2.85494 2.90035 2.95138 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s1=plot(x6,p6,'k');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C3-C4 under axial rotation')
legend([s1],'intact')
hold on




