%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 14
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.822574 0.822557 0.793581 0.769164 0.761794 0.749672 0.743376 0.739593 0.737898 0.738409 0.742377 0.747808 0.75855 0.771371 0.781205 0.789995 0.799694 0.812102 0.821527 0.831108 0.83958];
x4n=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

%4p
p4p=[0.822574 0.867074 0.899219 0.91653 0.941098 0.95538 0.984987 1.00297 1.05287 1.06073 1.10319 1.13468 1.16759 1.21126 1.24974 1.29432 1.33689 1.39012 1.44029 1.50499 1.5274];
x4p=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f9=plot(x4,p4,'color',[0.9290,0.6940, 0.1250]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6,f7,f8,f9],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13','model 14')
hold on

%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.822574 0.848962 0.854613 0.858794 0.8605 0.863831 0.866346 0.868306 0.87106 0.874174 0.877142 0.882886 0.887003 0.888067 0.891802 0.896645 0.899333 0.904352 0.908661 0.914773 0.919694];
x5n=[2 2.05026 2.11433 2.17371 2.20007 2.2594 2.31877 2.36096 2.42034 2.47043 2.5127 2.58779 2.63779 2.65263 2.70273 2.76565 2.80142 2.8609 2.90157 2.95756 3];

%5p
p5p=[0.822574 0.841276 0.833991 0.830785 0.825766 0.824184 0.825079 0.826944 0.830122 0.833483 0.836901 0.841945 0.844694 0.849548 0.852872 0.857524 0.860982 0.864971 0.868399 0.870861 0.872797];
x5p=[2 2.05026 2.12154 2.15397 2.21175 2.26507 2.30594 2.35377 2.40753 2.45988 2.50332 2.56615 2.60113 2.66023 2.70008 2.7573 2.80337 2.85729 2.91233 2.96086 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d9=plot(x5,p5,'color',[0.9290,0.6940, 0.1250]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6,d7,d8,d9],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13','model 14')
hold on

%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.822574 0.847693 0.850905 0.852287 0.854789 0.855344 0.858077 0.860388 0.862822 0.864731 0.867406 0.871562 0.877842 0.884625 0.891804 0.900175 0.908676 0.919338 0.928739 0.94157 0.947695];
x6n=[2 2.05026 2.10532 2.15068 2.23407 2.26532 2.33563 2.38563 2.43563 2.46688 2.50555 2.55206 2.60555 2.65607 2.70294 2.75304 2.80113 2.85856 2.90701 2.97041 3];

%6p % 
p6p=[0.822574 0.836314 0.837367 0.835274 0.832217 0.830923 0.830547 0.832683 0.836387 0.841525 0.851044 0.854245 0.865009 0.868717 0.877977 0.882887 0.89189 0.89693 0.905235 0.912385 0.919362];
x6p=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30206 2.35204 2.40323 2.45375 2.52804 2.55155 2.62764 2.65371 2.71895 2.75421 2.81684 2.85161 2.90752 2.95451 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s9=plot(x6,p6,'color',[0.9290,0.6940, 0.1250]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6,s7,s8,s9],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13','model 14')
hold on
