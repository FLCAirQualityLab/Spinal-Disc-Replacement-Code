%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 5
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.287586 0.270773 0.247692 0.226984 0.21727 0.200798 0.188086 0.181027 0.175158 0.170584 0.168206 0.167699 0.168416 0.169771 0.173021 0.178905 0.184967 0.192784 0.201747 0.210559 0.219278];
x4n=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];

%4p
p4p=[0.287586 0.307249 0.332727 0.353488 0.375814 0.395863 0.42886 0.452632 0.467743 0.502749 0.518432 0.554459 0.570955 0.590402 0.618429 0.646568 0.68339 0.699806 0.732067 0.753325 0.780294];
x4p=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f6=plot(x4,p4,'m');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6],'intact','model 1','model 2','model 3','model 4','model 5')
hold on

%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.287586 0.290811 0.294256 0.298106 0.303639 0.306886 0.308709 0.310463 0.312956 0.31378 0.315019 0.315518 0.315836 0.315857 0.315705 0.315584 0.315625 0.316125 0.31758 0.318707 0.319589];
x5n=[2 2.05126 2.10091 2.15137 2.23246 2.28246 2.31371 2.35238 2.42753 2.45878 2.51533 2.551 2.6001 2.67059 2.71118 2.76118 2.82055 2.86274 2.92212 2.9643 3];

%5p
p5p=[0.287586 0.286382 0.283471 0.281091 0.280186 0.27862 0.277456 0.276261 0.274893 0.273595 0.271966 0.270537 0.268184 0.266237 0.264541 0.26182 0.26019 0.258906 0.257294 0.256433 0.255411];
x5p=[2 2.05126 2.11533 2.17471 2.20107 2.25991 2.30337 2.35035 2.40415 2.45064 2.51269 2.558 2.61911 2.66482 2.70279 2.77248 2.82013 2.86034 2.91837 2.95368 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d6=plot(x5,p5,'m');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6],'intact','model 1','model 2','model 3','model 4','model 5')
hold on

%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.287586 0.2906 0.29314 0.295865 0.298388 0.302416 0.305955 0.309131 0.313184 0.316762 0.320288 0.324418 0.328454 0.332973 0.336783 0.3407 0.344796 0.349148 0.354536 0.358576 0.361539];
x6n=[2 2.05109 2.10925 2.16553 2.20718 2.26451 2.31289 2.3537 2.40703 2.45415 2.50161 2.55682 2.60896 2.66829 2.71829 2.76829 2.81829 2.86829 2.92766 2.96985 3];

%6p 
p6p=[0.287586 0.288057 0.287713 0.287521 0.287842 0.288685 0.290035 0.290916 0.292215 0.293222 0.294232 0.295595 0.296619 0.297635 0.298625 0.299069 0.299812 0.300665 0.302832 0.303138 0.304183 ];
x6p=[2 2.05126 2.11533 2.16533 2.20361 2.25315 2.31416 2.35262 2.40417 2.45195 2.50082 2.55529 2.60294 2.66047 2.7231 2.75435 2.80406 2.85412 2.94917 2.96167 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s6=plot(x6,p6,'m');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6],'intact','model 1','model 2','model 3','model 4','model 5')
hold on
