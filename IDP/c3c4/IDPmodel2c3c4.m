%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model_2
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.27856 0.268682 0.246816 0.226708 0.217194 0.202816 0.191363 0.18332 0.177898 0.175472 0.174754 0.175008 0.175855 0.17845 0.183223 0.189985 0.197494 0.206428 0.217343 0.22731 0.238407];
x4n=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

%4p
p4p=[0.27856 0.305852 0.332539 0.353565 0.380265 0.399968 0.423442 0.447271 0.47624 0.497435 0.527343 0.5491 0.56551 0.591929 0.62224 0.649361 0.682267 0.701643 0.73234 0.763696 0.783847];
x4p=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.46846 2.52783 2.57002 2.60127 2.65098 2.70667 2.75577 2.81523 2.85038 2.90628 2.96349 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f3=plot(x4,p4,'g');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3],'intact','model 1','model 2')
hold on
%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.27856 0.289708 0.295754 0.299383 0.30297 0.306782 0.308141 0.310355 0.311832 0.312901 0.313941 0.31433 0.314535 0.31448 0.314423 0.314446 0.315007 0.315562 0.316993 0.318515 0.319204];
x5n=[2 2.05026 2.11433 2.16433 2.21433 2.27371 2.30007 2.35578 2.40928 2.45979 2.52161 2.5572 2.60603 2.68118 2.71243 2.7511 2.82625 2.8575 2.91199 2.97132 3 ];

%5p
p5p=[0.27856 0.284616 0.282697 0.280699 0.279845 0.278632 0.276846 0.276192 0.274907 0.273121 0.271879 0.270344 0.268132 0.266012 0.264093 0.262328 0.261007 0.259725 0.258632 0.25758 0.256662];
x5p=[2 2.05126 2.11533 2.17471 2.20404 2.25438 2.33159 2.3549 2.4016 2.46738 2.50746 2.55002 2.60679 2.65835 2.71084 2.76368 2.81124 2.86007 2.90407 2.95108 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d3=plot(x5,p5,'g');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3],'intact','model 1','model 2')
hold on
%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.27856 0.290416 0.292679 0.295921 0.297696 0.302502 0.30538 0.309981 0.313037 0.316223 0.320075 0.325184 0.329589 0.332674 0.336488 0.340407 0.344509 0.348862 0.354253 0.358292 0.361361];
x6n=[2 2.05478 2.10546 2.17115 2.2004 2.26892 2.30837 2.36775 2.40818 2.45012 2.50186 2.56957 2.6267 2.66729 2.71729 2.76729 2.81729 2.86729 2.92666 2.96885 3];

%6p
p6p=[0.27856 0.286434 0.287061 0.28722 0.288126 0.288887 0.289989 0.290889 0.292011 0.292948 0.294286 0.295551 0.296579 0.297872 0.298706 0.300511 0.301412 0.303236 0.304601 0.306312 0.307961 ];
x6p=[2 2.05026 2.11433 2.15261 2.2098 2.25679 2.30943 2.35333 2.40624 2.4511 2.50404 2.55744 2.60598 2.66477 2.70156 2.77304 2.80429 2.86109 2.90333 2.95384 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s3=plot(x6,p6,'g');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3],'intact','model 1','model 2')
hold on