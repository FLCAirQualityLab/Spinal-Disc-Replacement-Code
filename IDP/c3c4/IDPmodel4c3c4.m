%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 4
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.175957 0.266335 0.24764 0.233116 0.218593 0.206028 0.197337 0.192866 0.191539 0.191727 0.192859 0.195412 0.20158 0.208474 0.217325 0.227007 0.238125 0.251121 0.260942 0.273437 0.283578];
x4n=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];

%4p
p4p=[0.175957 0.310925 0.327236 0.353118 0.372955 0.402028 0.424366 0.447627 0.474202 0.499826 0.524782 0.558234 0.581424 0.604317 0.63459 0.658384 0.688506 0.718341 0.747709 0.769907 0.797911];
x4p=[2 2.05816 2.10161 2.16188 2.20417 2.26497 2.3108 2.35767 2.41039 2.46048 2.50857 2.57039 2.61266 2.65395 2.70851 2.75122 2.8056 2.85917 2.91124 2.95071 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f5=plot(x4,p4,'c');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
% legend([f1,f2,f3,f4,f5],'intact','model 1','model 2','model 3','model 4')
hold on

%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.175957 0.292745 0.297014 0.299729 0.303861 0.307285 0.309605 0.311066 0.312406 0.312973 0.313165 0.312866 0.31241 0.31169 0.310916 0.310781 0.310752 0.311656 0.312392 0.314454 0.314816 ];
x5n=[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3];

%5p
p5p=[0.175957 0.285747 0.28351 0.281708 0.280827 0.279532 0.278486 0.276885 0.275505 0.273583 0.271312 0.269702 0.267333 0.265056 0.26321 0.260919 0.259755 0.257893 0.256246 0.255075 0.254083];
x5p=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d5=plot(x5,p5,'c');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
% legend([d1,d2,d3,d4,d5],'intact','model 1','model 2','model 3','model 4')
hold on

%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.175957 0.290728 0.292712 0.295159 0.298339 0.301697 0.30546 0.309774 0.312762 0.316473 0.320083 0.324846 0.328983 0.331878 0.335685 0.33957 0.343602 0.347901 0.354398 0.358435 0.361467 ];
x6n=[2 2.05499 2.10192 2.15388 2.20807 2.25585 2.30786 2.36346 2.40295 2.45178 2.50023 2.56364 2.61714 2.65515 2.70515 2.75515 2.80515 2.85515 2.92702 2.96921 3];

%6p % 
p6p=[0.175957 0.287989 0.287378 0.287656 0.288382 0.28945 0.29063 0.292091 0.293355 0.294894 0.296652 0.298309 0.299196 0.300924 0.301928 0.303522 0.304896 0.30586 0.307354 0.309002 0.310587 ];
x6p=[2 2.05499 2.11058 2.16207 2.20435 2.25007 2.30324 2.36036 2.40263 2.45125 2.50837 2.56869 2.60135 2.66917 2.7073 2.76599 2.81551 2.85069 2.90069 2.95128 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s5=plot(x6,p6,'c');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
% legend([s1,s2,s3,s4,s5],'intact','model 1','model 2','model 3','model 4')
hold on



