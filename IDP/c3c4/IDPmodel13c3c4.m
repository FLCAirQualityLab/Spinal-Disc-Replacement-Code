%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 13
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.843546 0.823733 0.795269 0.773365 0.755614 0.749674 0.73874 0.735359 0.732928 0.731884 0.733411 0.737149 0.744567 0.756898 0.767353 0.775094 0.782701 0.791035 0.799888 0.808694 0.816301];
x4n=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3 ];

%4p
p4p=[0.843546 0.864589 0.894311 0.918112 0.942385 0.966812 0.99056 1.01299 1.03754 1.06457 1.09445 1.12644 1.16664 1.19728 1.22595 1.26483 1.30361 1.34937 1.39476 1.44432 1.4748];
x4p=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

% plot
figure(1)
f8=plot(x4,p4,'color',[0.6350, 0.0780, 0.1840]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6,f7,f8],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13')
hold on

%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.843546 0.847004 0.851873 0.855809 0.859091 0.861931 0.865348 0.867674 0.87077 0.872261 0.876252 0.879101 0.883074 0.888208 0.89208 0.896384 0.901292 0.90435 0.90883 0.915362 0.918544];
x5n=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.32471 2.36689 2.42627 2.45263 2.51864 2.55993 2.60692 2.66037 2.70735 2.75754 2.81624 2.85281 2.9034 2.9694 3];

%5p
p5p=[0.843546 0.84181 0.837241 0.833128 0.828122 0.826069 0.822308 0.821694 0.822792 0.825164 0.828125 0.831669 0.834919 0.839399 0.841866 0.846386 0.849473 0.853315 0.856803 0.861484 0.862608 ];
x5p=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35451 2.40116 2.45302 2.50151 2.55488 2.60159 2.66574 2.70148 2.76497 2.80618 2.85814 2.90512 2.97561 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d8=plot(x5,p5,'color',[0.6350, 0.0780, 0.1840]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6,d7,d8],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13')
hold on

%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.843546 0.849246 0.852303 0.853763 0.854773 0.857059 0.859304 0.859811 0.862497 0.865572 0.868082 0.873156 0.884265 0.886067 0.893401 0.909344 0.911563 0.921043 0.928967 0.942276 0.948951];
x6n=[2 2.06253 2.12507 2.17135 2.21519 2.29738 2.34738 2.35988 2.41926 2.46936 2.50412 2.55762 2.64563 2.65813 2.705 2.79719 2.80969 2.86028 2.90125 2.96727 3];

%6p % 
p6p=[0.843546 0.842654 0.83845 0.835092 0.832063 0.830766 0.831264 0.834048 0.838824 0.844472 0.851135 0.85711 0.86486 0.870711 0.88237 0.886946 0.895289 0.900375 0.909209 0.916021 0.923066];
x6p=[2 2.05126 2.11533 2.16533 2.21533 2.25361 2.30816 2.35516 2.41122 2.46102 2.51245 2.55582 2.60999 2.65082 2.73015 2.7614 2.81853 2.85329 2.91154 2.95522 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s8=plot(x6,p6,'color',[0.6350, 0.0780, 0.1840]);
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6,s7,s8],'intact','model 1','model 2','model 3','model 4','model 5','model 6','model 13')
hold on