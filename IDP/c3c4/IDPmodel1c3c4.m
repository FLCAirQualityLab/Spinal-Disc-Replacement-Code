%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
% model 1
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.270735 0.266937 0.246272 0.226473 0.217129 0.20295 0.190548 0.183424 0.177194 0.17426 0.173332 0.173438 0.174432 0.177712 0.182971 0.189952 0.198075 0.205344 0.215784 0.225001 0.236117];
x4n=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

%4p
p4p=[0.270735 0.307713 0.333237 0.35409 0.381196 0.401064 0.429332 0.449829 0.479462 0.49286 0.519565 0.54319 0.572541 0.599176 0.625827 0.654318 0.683605 0.713487 0.744274 0.771611 0.793106 ];
x4p=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.32627 2.36846 2.42783 2.4542 2.50615 2.55076 2.60453 2.65273 2.70062 2.75176 2.80444 2.85837 2.91342 2.96196 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f2=plot(x4,p4,'r');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2],'intact','model 1')
hold on
%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.270735 0.291444 0.296756 0.30016 0.304327 0.306037 0.308915 0.310829 0.31239 0.313504 0.314255 0.314644 0.314599 0.314304 0.313676 0.313274 0.313258 0.313546 0.314362 0.316168 0.316366];
x5n=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30644 2.35622 2.40972 2.46023 2.50711 2.55164 2.60232 2.65142 2.72191 2.77012 2.80437 2.86374 2.90593 2.9903 3];

%5p
p5p=[0.270735 0.285635 0.283587 0.281587 0.280129 0.278781 0.277787 0.276685 0.275392 0.274041 0.272309 0.270623 0.26868 0.266274 0.264738 0.263074 0.261145 0.259453 0.257665 0.256271 0.254991];
x5p=[2 2.05126 2.10091 2.15165 2.20195 2.26309 2.30825 2.35242 2.40115 2.45206 2.50453 2.55201 2.60315 2.66299 2.70555 2.75188 2.8058 2.85226 2.9048 2.95124 3 ];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d2=plot(x5,p5,'r');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2],'intact','model 1')
hold on
%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.270735 0.290314 0.293307 0.295421 0.298406 0.301443 0.304821 0.30868 0.314164 0.316973 0.320945 0.324554 0.329143 0.332351 0.335565 0.342199 0.345747 0.349456 0.352775 0.358416 0.361399];
x6n=[2 2.0523 2.11876 2.16162 2.21039 2.25339 2.30021 2.35024 2.42245 2.45953 2.51292 2.56096 2.62034 2.66253 2.70471 2.78909 2.83128 2.87346 2.91038 2.9697 3];

%6p
p6p=[0.270735 0.28757 0.287406 0.287561 0.288048 0.288806 0.289915 0.291203 0.292285 0.294357 0.295995 0.296954 0.29829 0.299668 0.301023 0.30262 0.303676 0.305688 0.307265 0.308414 0.309815];
x6p=[2 2.05126 2.10091 2.15535 2.20061 2.25209 2.30561 2.36555 2.40191 2.4653 2.51879 2.5529 2.60117 2.65273 2.7052 2.76398 2.80076 2.87223 2.92223 2.95699 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s2=plot(x6,p6,'r');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2],'intact','model 1')
hold on

