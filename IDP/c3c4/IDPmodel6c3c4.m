%% this script plots average IDP for the c3-c4 nucleus pulposus under flexion/extension, lateral bending, and axial rotation
%model 6
%% flexion/extension (4n4p) c3-c4 Average IDP
%4n
p4n=[0.176024 0.268216 0.250056 0.234756 0.218427 0.204482 0.19357 0.187345 0.184038 0.182998 0.183347 0.184781 0.188149 0.195328 0.202417 0.211709 0.223573 0.233963 0.245466 0.257008 0.268922];
x4n=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];

%4p
p4p=[0.176024 0.315459 0.328757 0.353509 0.372938 0.396029 0.418509 0.444961 0.483966 0.499384 0.526563 0.551626 0.573698 0.602005 0.632667 0.657289 0.686306 0.714493 0.750783 0.772826 0.796603];
x4p=[2 2.06926 2.1039 2.16327 2.20546 2.25429 2.30079 2.35429 2.4315 2.46157 2.514 2.56038 2.60079 2.65194 2.70721 2.75135 2.80366 2.85454 2.91895 2.95814 3];

% delta loop
for n=1:20
    p4n1(n)=[p4n(n+1)-p4n(1)];
    p4p1(n)=[p4p(n+1)-p4p(1)];
end

% zero data and join
x4n1=-2*(x4n-2);
x4p1=[(x4p-2)*2];
p4p2=[0,p4p1];
x4=[flip(x4n1(2:21)),x4p1];
p4=[flip(p4n1),p4p2];

%plot
figure(1)
f7=plot(x4,p4,'y');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under flexion/extension')
legend([f1,f2,f3,f4,f5,f6,f7],'intact','model 1','model 2','model 3','model 4','model 5','model 6')
hold on

%% lateral bending (5n5p) c3-c4 Average IDP
%5n
p5n=[0.176024 0.293726 0.297298 0.299979 0.30519 0.307374 0.309411 0.311238 0.312802 0.313922 0.314171 0.314088 0.313562 0.31288 0.31211 0.311445 0.311494 0.312047 0.312928 0.314937 0.3152];
x5n=[2 2.06926 2.11544 2.15658 2.22964 2.26089 2.30352 2.35172 2.40991 2.47326 2.50451 2.56164 2.6091 2.65161 2.70076 2.78645 2.82704 2.86763 2.90822 2.98941 3];

%5p
p5p=[0.176024 0.285294 0.283315 0.281509 0.28059 0.279504 0.278543 0.277165 0.275678 0.274194 0.272111 0.270034 0.267998 0.265479 0.263705 0.261508 0.260128 0.258278 0.256734 0.255381 0.254318];
x5p=[2 2.06926 2.11039 2.16205 2.20253 2.25469 2.30237 2.35235 2.40447 2.45402 2.50951 2.55995 2.60457 2.66104 2.70282 2.76219 2.80057 2.85371 2.90136 2.95138 3];

% delta loop
for n=1:20
    p5n1(n)=[p5n(n+1)-p5n(1)];
    p5p1(n)=[p5p(n+1)-p5p(1)];
end

% zero data and join
x5n1=-2*(x5n-2);
x5p1=[(x5p-2)*2];
p5p2=[0,p5p1];
x5=[flip(x5n1(2:21)),x5p1];
p5=[flip(p5n1),p5p2];

%plot
figure(2)
d7=plot(x5,p5,'y');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 IDP under lateral bending')
legend([d1,d2,d3,d4,d5,d6,d7],'intact','model 1','model 2','model 3','model 4','model 5','model 6')
hold on

%% axial rotation (6n6p) c3-c4 Average IDP
%6n
p6n=[0.176024 0.290674 0.29291 0.295135 0.298501 0.302166 0.305156 0.309151 0.314283 0.317283 0.321525 0.325302 0.328684 0.334036 0.337269 0.340577 0.344676 0.349027 0.354415 0.358454 0.361492 ];
x6n=[2 2.05457 2.10596 2.15281 2.2099 2.26199 2.30323 2.3549 2.42252 2.46212 2.51913 2.56913 2.61288 2.68319 2.72538 2.76757 2.81757 2.86757 2.92694 2.96913 3];

%6p % 
p6p=[0.176024 0.286751 0.287448 0.287743 0.288367 0.288962 0.290089 0.291478 0.292643 0.294488 0.295895 0.297384 0.298624 0.299961 0.301156 0.302791 0.304339 0.305236 0.307014 0.308613 0.309987];
x6p=[2 2.05486 2.10789 2.15953 2.21347 2.25039 2.30255 2.36524 2.40407 2.45974 2.50483 2.55731 2.60253 2.65367 2.70049 2.76158 2.81718 2.85019 2.90883 2.95766 3];

% delta loop
for n=1:20
    p6n1(n)=[p6n(n+1)-p6n(1)];
    p6p1(n)=[p6p(n+1)-p6p(1)];
end

% zero data and join
x6n1=-2*(x6n-2);
x6p1=[(x6p-2)*2];
p6p2=[0,p6p1];
x6=[flip(x6n1(2:21)),x6p1];
p6=[flip(p6n1),p6p2];

%plot
figure(3)
s7=plot(x6,p6,'y');
ylabel('Change in Pressure (MPa)')
xlabel('Moment (Nm)')
title('IDP for C4-C5 under axial rotation')
legend([s1,s2,s3,s4,s5,s6,s7],'intact','model 1','model 2','model 3','model 4','model 5','model 6')
hold on



