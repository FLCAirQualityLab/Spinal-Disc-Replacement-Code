%% Facet contact force magnitude (N)
% model4_APSlide_NoTether/5N & 5P

clear all;
%% 5P
figure (14)

c4ulxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c4ulyp=[14.6465 21.2321 23.0774 25.4888 27.331 30.5145 33.1138 36.162 39.0292 42.6708 46.4731 48.9183 52.2266 55.7126 58.6401 62.6488 64.695 68.05 71.2046 73.8365 76.6206];

c4urxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c4uryp=[14.7053 19.4048 19.2304 19.0036 18.8347 18.5699 18.3202 18.0486 17.7085 17.2504 16.8102 16.4661 15.9049 15.2567 14.6832 13.8424 13.398 12.6171 11.8287 11.158 10.4719];

c5ulxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c5ulyp=[6.26926 19.0037 21.4506 25.5598 28.6273 33.4573 37.1593 41.1757 44.8695 49.2783 53.5536 56.1862 59.7832 63.5056 66.5977 70.911 73.261 77.2909 81.1597 84.3462 87.5678 ];

c5urxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c5uryp=[3.50286 7.0115 6.28896 6.22272 6.29732 6.24533 6.08128 5.79942 5.45299 4.9251 4.29105 3.81492 3.09182 2.25924 1.5517 0.761693 0.500472 0.34162 0.231366 0.136837 0.0240852];

c6ulxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c6ulyp=[0.00452416 8.06678 9.68084 12.0817 13.9027 16.8694 19.2991 22.1008 24.8403 28.6644 32.732 35.3314 39.0938 42.9239 46.0773 50.323 52.5275 56.2039 59.6918 62.6239 65.7225];

c6urxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c6uryp=[0.00369928 2.59531 2.76487 2.87527 2.94634 3.1312 3.27274 3.37644 3.41861 3.2874 3.0705 2.95901 2.53657 2.09014 1.74111 1.34199 1.17441 0.907101 0.678857 0.504709 0.345253];

c7ulxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c7ulyp=[0.00384772 3.88863 5.37102 7.71327 9.59206 12.9358 15.5839 18.4122 21.2297 25.2573 29.4627 32.1463 35.7009 39.2905 42.297 46.3461 48.4142 51.834 55.0797 57.786 60.6072 ];

c7urxp=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3]-2;
c7uryp=[3.9787 9.64791 9.88901 10.0101 10.0691 10.1287 10.0111 9.80293 9.62152 9.18437 8.66959 8.27675 7.77114 7.23879 6.81644 6.29267 6.03625 5.63226 5.27924 5.01904 4.79771  ];

%% 5N

c4ulxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c4ulyn=[14.6465 18.3103 17.3714 16.6751 15.6589 14.7999 14.0953 13.4804 12.533 11.7708 10.9778 9.99327 9.25707 8.34848 7.24214 6.65458 5.7634 4.71923 4.19219 3.05062 2.90294 ];

c4urxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c4uryn=[14.7053 20.5363 21.8569 23.1329 25.084 27.0639 29.6756 32.078 35.4529 37.9464 40.5034 44.0331 46.6411 49.6661 53.2209 55.0676 58.0225 61.5485 63.291 67.6889 68.4347];

c5ulxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c5ulyn=[6.26926 12.3775 8.53707 6.31146 4.77583 3.95385 3.31107 2.91178 2.62575 2.42515 2.21108 1.87959 1.64354 1.3742 1.07577 0.932768 0.722288 0.511639 0.413691 0.18936 0.15581];

c5urxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c5uryn=[3.50286 9.8749 10.4892 11.5472 13.7517 15.8905 18.4277 20.8176 24.1441 26.7336 29.3712 32.8218 35.3029 38.2387 41.7062 43.5234 46.4501 49.9809 51.7771 56.2488 56.9908 15581];

c6ulxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c6ulyn=[0.00452416 5.03679 4.36573 4.49633 4.71355 4.82402 4.94869 5.06763 5.21007 5.23318 5.27421 5.14494 4.83419 4.46784 4.05108 3.84483 3.51351 3.12125 2.94367 2.58975 2.54086  ];

c6urxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c6uryn=[0.00369928 3.81883 5.07779 6.61125 9.05851 11.0963 13.4197 15.5594 18.9157 21.8602 24.9779 29.3229 32.6809 36.5727 41.0801 43.4193 47.1017 51.455 53.6214 58.9843 59.8802 ];

c7ulxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c7ulyn=[0.00384772 2.5727 1.84474 1.75297 1.5246 1.30222 1.02215 0.879927 0.823553 0.759621 0.570605 0.429564 0.349904 0.248394 0.118041 0.0536554 0.00367059 0.00324007 0.00314279 0.00292028 0.00288871];

c7urxn=-1*[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3]+2;
c7uryn=[3.9787 10.5723 11.3405 12.4191 14.1584 16.0635 18.588 21.0262 24.679 27.7449 31.2646 35.6081 38.5548 41.9596 45.9522 48.0319 51.317 55.1825 57.105 61.9134 62.7149];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'color',[0.75, 0, 0.75]);
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'color',[0 0.5 1]);
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'color',[0.2 0 0]);
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'color',[1 .5 0]);

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Force Magntiude (CFNM) for model 4 under lateral bending (5N/5P)')
xlabel('Moment (N-m)')
ylabel('Force (N)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','north')