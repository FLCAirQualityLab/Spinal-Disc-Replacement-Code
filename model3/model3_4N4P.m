%% Facet contact force magnitude (N)
% model3_APSlide_Tether/4P & 4N 

clear all;
%% 4P
figure (10)

c4ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c4ulyp=[19.2318 17.8989 16.3806 15.2861 14.2209 13.4877 12.7052 12.0263 11.2541 10.8949 10.0944 9.28438 8.58836 8.09839 7.51776 6.80672 6.3887 5.86013 5.32169 4.79075 4.44256 ];

c4urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c4uryp=[19.6178 18.5233 17.2959 16.4487 15.6531 15.1785 14.57 14.048 13.3953 13.0985 12.4153 11.7058 11.0907 10.6378 10.0422 9.23201 8.71208 8.01411 7.27728 6.48275 5.99516];

c5ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c5ulyp=[16.248 14.7303 10.6563 6.82851 4.42881 3.40489 2.44973 1.68848 1.08066 0.832314 0.449633 0.231746 0.0655804 0.00409392 0.00379118 0.00355886 0.0034218 0.00324236 0.00306405 0.00289092 0.0027751];

c5urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c5uryp=[9.71199 8.37625 4.95586 2.56923 1.31442 1.03886 0.741129 0.55576 0.39841 0.347782 0.223933 0.0863849 0.00545876 0.00502934 0.00463688 0.00432764 0.00426549 0.00417677 0.00407487 0.00396548 0.00388778];

c6ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c6ulyp=[6.42718 6.09414 4.97513 3.7573 1.57718 0.475317 0.00529598 0.00490407 0.00454023 0.00443292 0.00424651 0.00407924 0.00393824 0.00383551 0.00368196 0.00351042 0.00343926 0.00335813 0.00327544 0.0031941 0.00314142];

c6urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c6uryp=[3.63375 3.25831 2.23246 1.3991 0.199356 0.00448549 0.00387561 0.00362356 0.00338808 0.00329058 0.0030715 0.00285112 0.00267384 0.0025611 0.00244056 0.00232033 0.00226849 0.00219933 0.00211771 0.00203743 0.00198128];

c7ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c7ulyp=[3.59905 3.62235 3.54961 3.4518 3.14242 2.67967 2.09249 1.04418 0.167085 0.00603123 0.00485134 0.00431661 0.00383327 0.0034907 0.00321763 0.003082 0.00306204 0.00304671 0.00303987 0.00304776 0.00306058];

c7urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c7uryp=[10.1982 10.1085 9.56466 9.03708 7.90605 7.19666 6.15044 4.58588 3.0368 2.43593 1.28916 0.513237 0.00488296 0.00396341 0.00374989 0.00353064 0.00343686 0.00331416 0.00318325 0.00305206 0.00296435];

%% 4N
c4ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c4ulyn=[19.2318 20.7429 22.9182 25.6812 28.4434 32.0879 35.8828 39.1816 42.6432 46.4645 49.7116 53.425 56.6268 60.1106 63.9187 67.9254 71.5604 75.1755 79.65 83.6513 86.5982];

c4urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c4uryn=[19.6178 20.8816 22.5437 24.5499 26.6773 29.7641 33.4756 36.8253 40.346 44.229 47.5549 51.6272 55.0353 58.6295 62.3691 66.4145 70.058 73.7474 77.9879 81.6252 84.3517];

c5ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c5ulyn=[16.248 18.0815 22.0208 25.1661 28.0352 32.4238 37.3895 41.1782 44.7551 48.5444 51.6865 55.3098 58.2655 61.7228 65.6431 69.8894 73.7632 77.7714 82.6514 87.0807 90.4473];

c5urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c5uryn=[9.71199 11.1324 14.4465 17.1942 19.4714 22.8893 26.5811 29.432 31.9201 34.5793 36.859 39.4788 41.643 44.2394 47.114 50.2121 53.0293 55.9768 59.5068 62.6196 64.9432];

c6ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c6ulyn=[6.42718 7.09399 8.49184 9.87316 11.002 12.7047 14.7192 16.428 18.1928 20.219 21.9942 24.0692 25.8293 27.7982 30.0223 32.5245 34.8684 37.4058 40.7044 43.9591 46.4913];

c6urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c6uryn=[3.63375 4.16588 5.37745 6.53029 7.47538 8.79045 10.2559 11.5983 13.024 14.6129 16.0009 17.6813 19.1743 20.7555 22.442 24.3024 26.0096 27.8311 30.2245 32.3111 33.9047];

c7ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c7ulyn=[3.59905 3.73601 3.91229 4.22548 4.51468 5.08618 6.10241 6.99332 7.88943 8.8864 9.73978 10.7331 11.5457 12.459 13.4463 14.4646 15.3538 16.254 17.305 18.3054 19.0728];

c7urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ]+2;
c7uryn=[10.1982 10.478 11.1231 11.7613 12.286 13.2446 14.5551 15.7176 16.8842 18.101 19.0743 20.112 20.9377 21.7571 22.5826 23.4327 24.1495 24.8461 25.6664 26.2592 26.659 ];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'color',[0.75, 0, 0.75]);
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'color',[0 0.5 1]);
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'color',[0.2 0 0]);
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'color',[1 .5 0]);

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Force Magntiude (CFNM) for model 3 under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Force (N)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','north')