%% Facet contact force magnitude (N)
% Intact 5P/5N
clear all;
%% 5P
figure (2)

c4ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c4ulyp=[21.3341 22.7741 24.9768 26.0084 28.7212 30.6767 33.468 37.1643 39.5759 42.8623 46.0691 49.6041 52.8913 56.5176 59.5782 62.8339 65.7159 69.3475 72.5383 75.2176 78.2594 ];

c4urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c4uryp=[21.2462 20.8366 20.4762 20.343 20.0015 19.6921 19.3578 18.9719 18.6923 18.2917 17.7845 17.2735 16.7705 16.0998 15.4756 14.7923 14.1476 13.3435 12.6717 12.1137 11.4476 ];

c5ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c5ulyp=[11.6099 14.0112 18.1092 19.9314 24.1963 27.0571 30.8654 35.3563 38.145 41.9851 45.6398 49.4964 53.1583 57.1714 60.4282 63.8446 66.8899 70.6751 73.9658 76.7382 79.9157 ];

c5urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c5uryp=[3.99436 2.68834 1.77173 1.53885 1.02707 0.755422 0.416045 0.0524626 0.00453191 0.0041082 0.00388681 0.00366456 0.00346697 0.00326418 0.00310827 0.00295376 0.00282241 0.00266986 0.00253702 0.00242919 0.00231272 ];

c6ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c6ulyp=[4.46774 6.79619 9.56689 10.7778 13.7226 15.7433 18.4713 21.9656 24.2163 27.3412 30.7671 34.2718 37.5443 41.3868 44.5415 47.8943 50.8277 54.5461 57.8363 60.5944 63.];

c6urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c6uryp=[1.49563 1.4466 1.67864 1.70432 1.80759 1.94537 2.10139 2.16082 2.15545 2.10614 1.91442 1.70007 1.56421 1.18965 0.950644 0.700416 0.483135 0.30031 0.157005 0.0455174 0.00266004 ];

c7ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c7ulyp=[2.08179 2.85032 5.44781 6.76738 9.89475 12.1294 14.8571 18.0678 20.482 23.9217 27.2485 30.8797 34.2003 37.7393 40.6641 43.7762 46.5708 50.0827 53.1385 55.6615 58.5379];

c7urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c7uryp=[9.88572 9.75995 9.78221 9.78467 9.8032 9.67473 9.40243 9.04614 8.78627 8.34801 7.9228 7.38361 6.9322 6.44145 6.03786 5.63084 5.27797 4.85151 4.52137 4.33637 4.13881 ];

%% 5N
c4ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c4ulyn=[21.3341 20.0758 19.079 18.1611 17.1438 15.9895 15.4306 14.8652 14.1419 13.439 12.5181 11.6526 10.7329 10.0747 9.09928 8.19921 7.40649 6.61952 5.75519 4.97063 4.26877  ];

c4urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c4uryn=[21.2462 21.9932 22.7666 23.7744 25.2281 27.7697 29.6189 31.9219 35.0452 37.7101 41.1787 44.2163 47.2603 49.4952 52.7052 55.5658 58.2866 61.0597 64.1055 66.7779 69.3401 ];

c5ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c5ulyn=[11.6099 9.94878 8.90544 7.96795 7.04031 5.9351 5.30971 4.61433 3.77428 3.14021 2.49888 2.06626 1.64453 1.34133 0.936137 0.626429 0.366652 0.126092 0.00287255 0.00263452 0.00248684 ];

c5urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c5uryn=[3.99436 6.28356 8.49115 10.95 13.7679 17.7788 20.1564 22.8722 26.2783 29.1115 32.6996 35.8062 38.9024 41.1636 44.3095 47.1506 49.8606 52.6668 55.7285 58.3731 60.9339 ];

c6ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c6ulyn=[4.46774 3.67965 3.52398 3.86052 4.10027 4.40846 4.55652 4.69721 4.88499 5.05218 5.0616 5.0361 4.94345 4.68895 4.31729 3.98539 3.67447 3.38602 3.06378 2.81802 2.59217 ];

c6urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c6uryn=[1.49563 2.46506 3.70287 5.95661 8.35349 11.6188 13.5339 15.7491 18.648 21.3413 25.1607 28.436 31.8703 34.6381 38.5377 42.0425 45.3736 48.7234 52.3851 55.5288 58.5851 ];

c7ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c7ulyn=[2.08179 1.35632 1.24688 1.08398 0.853242 0.60663 0.542625 0.525369 0.483407 0.422231 0.307628 0.210335 0.111496 0.0431669 0.00372558 0.00336549 0.00320781 0.00306281 0.00291333 0.00280202 0.00270481 ];

c7urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3 ]+2;
c7uryn=[9.88572 10.1576 10.6202 11.689 13.5741 16.7225 18.7234 20.9902 24.0324 26.9256 30.8925 34.2204 37.5104 39.9226 43.2935 46.3493 49.2614 52.208 55.4658 58.2923 61.0289 ];
%% Left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'color',[0.75, 0, 0.75]);
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'color',[0 0.5 1]);
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'color',[0.2 0 0]);
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'color',[1 .5 0]);

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Force Magntiude (CFNM) for intact under lateral bending (5N/5P)')
xlabel('Moment (N-m)')
ylabel('Force (N)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','north')