%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under axial rotation (6N)
% 20212,40296,25651,42160
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 20212,40296,25651,42160
%% model15_intact_TLC_6N
t15=[2 2.0575 2.1047 2.15542 2.22863 2.25714 2.30144 2.3674 2.40898 2.46323 2.51338 2.55396 2.60266 2.65487 2.708 2.76753 2.82255 2.85683 2.90566 2.95411 3 ];

% 20212
aa1=-10.8616+[0.237303 0.208614 0.0385113 -0.115023 -0.349025 -0.445952 -0.593267 -0.792082 -0.906642 -1.047 -1.17378 -1.27356 -1.38582 -1.49515 -1.59894 -1.70694 -1.79875 -1.85341 -1.92727 -1.99484 -2.05496];
aa2=446.379+[0.413703 -0.0217555 -0.0681224 0.0126065 0.226263 0.315149 0.450064 0.641617 0.753977 0.890049 1.00496 1.08845 1.17922 1.26573 1.34561 1.43473 1.51476 1.55965 1.61866 1.67324 1.72201];
aa3=-704.985+[-0.501412 -0.601434 -0.714754 -0.834464 -1.00277 -1.06577 -1.16019 -1.28909 -1.36375 -1.45226 -1.53225 -1.59494 -1.66496 -1.73387 -1.79885 -1.86894 -1.93002 -1.96576 -2.01364 -2.05759 -2.09638];

% 40296
ab1=-12.2381+[0.123435 0.140296 0.0451812 -0.0489877 -0.200759 -0.265694 -0.36527 -0.501062 -0.580779 -0.679187 -0.76849 -0.83858 -0.918084 -0.996115 -1.07013 -1.1472 -1.21284 -1.25271 -1.30674 -1.35628 -1.40045];
ab2=446.122+[0.252332 -0.0420959 -0.019183 0.078133 0.270417 0.347736 0.464317 0.629846 0.727259 0.844602 0.942902 1.01459 1.09223 1.16641 1.23451 1.30827 1.37391 1.41108 1.46019 1.50608 1.5473];
ab3=-714.556+[-0.468917 -0.520072 -0.592226 -0.672563 -0.79575 -0.844929 -0.919048 -1.02097 -1.08108 -1.15415 -1.21849 -1.26847 -1.32514 -1.38076 -1.43378 -1.49184 -1.54259 -1.57246 -1.61269 -1.64957 -1.68201];

% 25651
ac1=-9.36067+[0.270513 0.19404 -0.0234966 -0.216633 -0.496714 -0.609874 -0.781077 -1.01359 -1.14861 -1.31453 -1.46397 -1.58157 -1.71468 -1.84576 -1.97101 -2.1022 -2.21485 -2.28234 -2.3741 -2.45916 -2.5355];
ac2=443.597+[0.404337 -0.0416697 -0.108456 -0.0479226 0.13838 0.217521 0.338364 0.511104 0.612796 0.736386 0.840628 0.916175 0.998141 1.07613 1.14821 1.22909 1.30202 1.34283 1.39654 1.44632 1.49092];
ac3=-706.266+[-0.440591 -0.574459 -0.696854 -0.815399 -0.971537 -1.02942 -1.11636 -1.23604 -1.30628 -1.39069 -1.46742 -1.52825 -1.59688 -1.66546 -1.7312 -1.80205 -1.86414 -1.90101 -1.95121 -1.99803 -2.03999];

% 42160
ad1=-14.6392+[0.138744 0.170401 0.0836075 -0.00430448 -0.153222 -0.217976 -0.317292 -0.451627 -0.529952 -0.626351 -0.713928 -0.782699 -0.860337 -0.935866 -1.00713 -1.08112 -1.14367 -1.18146 -1.23233 -1.27833 -1.319];
ad2=448.856+[0.338222 0.0078576 0.0312971 0.141704 0.362652 0.451397 0.584656 0.773216 0.883874 1.01707 1.12875 1.21018 1.29831 1.38213 1.45883 1.54232 1.61658 1.65851 1.71362 1.76483 1.81052];
ad3=-710.316+[-0.51616 -0.534148 -0.601622 -0.686642 -0.826641 -0.88312 -0.967942 -1.08411 -1.15214 -1.23451 -1.30671 -1.36236 -1.42489 -1.48539 -1.54244 -1.60511 -1.65977 -1.69156 -1.73387 -1.77215 -1.80542];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_6N
t1=[2 2.0523 2.11876 2.16162 2.21039 2.25339 2.30021 2.35024 2.42245 2.45953 2.51292 2.56096 2.62034 2.66253 2.70471 2.78909 2.83128 2.87346 2.91038 2.9697 3];
% 20212
ae1=-10.8616+[-0.322039 0.156303 -0.175639 -0.320187 -0.503336 -0.665279 -0.835426 -1.00003 -1.21228 -1.31407 -1.45168 -1.57301 -1.71135 -1.80301 -1.88847 -2.04614 -2.11707 -2.18546 -2.24204 -2.32699 -2.36758];
ae2=446.379+[1.21324 -0.57528 -0.285538 -0.109906 0.0786509 0.223155 0.355534 0.483307 0.64861 0.725418 0.81857 0.893863 0.980278 1.03515 1.08637 1.17448 1.21413 1.24794 1.27436 1.31408 1.33284];
ae3=-704.985+[-0.790441 -0.882836 -1.10463 -1.19128 -1.30237 -1.39804 -1.49762 -1.5966 -1.72481 -1.78522 -1.86543 -1.93524 -2.01726 -2.07182 -2.12313 -2.21684 -2.25901 -2.29904 -2.33194 -2.38147 -2.40555];

% 40296
af1=-12.2381+[-0.296706 0.0929079 -0.0413208 -0.112876 -0.216135 -0.312176 -0.415011 -0.515686 -0.649408 -0.715441 -0.80591 -0.885343 -0.975107 -1.03407 -1.0891 -1.19144 -1.23805 -1.28329 -1.32089 -1.37676 -1.4029];
af2=446.122+[0.803328 -0.558481 -0.257206 -0.0621726 0.118688 0.250252 0.369459 0.480407 0.620676 0.684976 0.763625 0.826922 0.898334 0.94357 0.985816 1.05864 1.09107 1.11875 1.14046 1.17327 1.18879];
af3=-714.556+[-0.751604 -0.788606 -0.923782 -0.989775 -1.08205 -1.15866 -1.23542 -1.30855 -1.40478 -1.45056 -1.51117 -1.56368 -1.62496 -1.66519 -1.70303 -1.77184 -1.80292 -1.83212 -1.85603 -1.89119 -1.9079];

% 25651
ag1=-9.36067+[-0.292646 0.145976 -0.253307 -0.434919 -0.650302 -0.837526 -1.03318 -1.22326 -1.46963 -1.588 -1.74864 -1.88976 -2.05189 -2.15998 -2.2615 -2.4505 -2.53666 -2.62 -2.68947 -2.79497 -2.84598];
ag2=443.677+[1.15065 -0.578092 -0.329769 -0.171723 -0.0021296 0.127064 0.24463 0.358134 0.505408 0.573988 0.656775 0.723581 0.8003 0.84898 0.894548 0.972865 1.00828 1.03832 1.0618 1.09727 1.11408];
ag3=-706.563+[-0.648179 -0.887268 -1.09797 -1.18623 -1.29152 -1.38126 -1.47544 -1.56936 -1.69194 -1.75025 -1.82914 -1.89827 -1.98003 -2.03511 -2.08748 -2.18506 -2.22984 -2.27302 -2.30908 -2.36421 -2.39138];

% 42160
ah1=-14.6392+[-0.323489 0.12223 -0.00479046 -0.0697214 -0.172822 -0.269144 -0.371887 -0.471641 -0.603276 -0.668076 -0.756436 -0.834041 -0.921196 -0.978038 -1.03079 -1.12812 -1.17192 -1.21421 -1.24909 -1.30019 -1.32375];
ah2=448.856+[0.94052 -0.626065 -0.281625 -0.05972 0.148871 0.299966 0.436221 0.562251 0.721969 0.795097 0.884064 0.955903 1.03702 1.08821 1.13572 1.21677 1.2525 1.28271 1.30612 1.3411 1.35746];
ah3=-710.316+[-0.858051 -0.727729 -0.885014 -0.963925 -1.07333 -1.16222 -1.24949 -1.33139 -1.43848 -1.48901 -1.55471 -1.61139 -1.67707 -1.71967 -1.75933 -1.82998 -1.86127 -1.89007 -1.91321 -1.94653 -1.96203];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_6N
t2=[2 2.05478 2.10546 2.17115 2.2004 2.26892 2.30837 2.36775 2.40818 2.45012 2.50186 2.56957 2.6267 2.66729 2.71729 2.76729 2.81729 2.86729 2.92666 2.96885 3];

% 20212
ai1=-10.8616+[-0.237609 0.163138 -0.089674 -0.340237 -0.449934 -0.707081 -0.849208 -1.03957 -1.16221 -1.28132 -1.41727 -1.59009 -1.72423 -1.81315 -1.9155 -2.01141 -2.09975 -2.18292 -2.2752 -2.33642 -2.3792];
ai2=446.379+[1.42477 -0.432397 -0.316958 -0.0671235 0.0383394 0.263921 0.371488 0.516828 0.608646 0.699569 0.794179 0.899698 0.980979 1.03265 1.09128 1.14371 1.1922 1.23401 1.27644 1.30404 1.32309];
ai3=-704.985+[-0.908536 -0.895367 -1.06285 -1.20751 -1.27355 -1.42464 -1.50805 -1.62352 -1.69619 -1.76674 -1.84639 -1.94559 -2.02466 -2.07722 -2.13783 -2.19434 -2.24636 -2.2949 -2.34814 -2.3835 -2.40858 ];

% 40296
aj1=-12.2381+[-0.2408 0.101164 0.00386945 -0.121471 -0.18324 -0.335694 -0.421413 -0.537344 -0.615072 -0.6917 -0.780208 -0.89275 -0.978731 -1.03532 -1.10045 -1.16181 -1.21905 -1.27322 -1.33365 -1.37309 -1.4002];
aj2=446.122+[0.873877 -0.472887 -0.314353 -0.0242113 0.0790907 0.286993 0.384004 0.511034 0.589065 0.665519 0.745573 0.834937 0.902655 0.945792 0.99467 1.03822 1.07807 1.11243 1.14732 1.17023 1.18611];
aj3=-714.556+[-0.83035 -0.791359 -0.892133 -1.00275 -1.05737 -1.17874 -1.242 -1.32683 -1.38156 -1.43493 -1.49488 -1.56929 -1.62799 -1.6666 -1.71119 -1.75246 -1.79071 -1.82607 -1.86444 -1.88928 -1.9066];

% 25651
ak1=-9.36067+[-0.206337 0.153075 -0.15253 -0.461013 -0.59005 -0.88759 -1.05087 -1.27119 -1.41274 -1.55084 -1.70933 -1.9101 -2.06707 -2.17177 -2.29311 -2.40767 -2.51423 -2.61522 -2.72824 -2.80411 -2.85761];
ak2=443.677+[1.3488 -0.443289 -0.355366 -0.132585 -0.0381691 0.163323 0.258668 0.38749 0.469178 0.55036 0.634495 0.727949 0.799943 0.845695 0.897708 0.944217 0.987414 1.02456 1.06221 1.08679 1.10382];
ak3=-706.563+[-0.738806 -0.885738 -1.0532 -1.20125 -1.26441 -1.40669 -1.48563 -1.59551 -1.66481 -1.73246 -1.81029 -1.90843 -1.98724 -2.04033 -2.1023 -2.16096 -2.21578 -2.26779 -2.32603 -2.36539 -2.39362 ];

% 42160
al1=-14.6392+[-0.261043 0.13035 0.039512 -0.0774717 -0.139091 -0.291881 -0.377421 -0.491886 -0.568767 -0.644154 -0.730682 -0.840693 -0.924177 -0.978738 -1.0412 -1.09965 -1.15372 -1.20448 -1.26052 -1.29658 -1.32105];
al2=448.856+[1.02138 -0.525713 -0.346668 -0.0158841 0.103101 0.341803 0.452474 0.596681 0.685664 0.772753 0.863393 0.964791 1.04168 1.09045 1.14534 1.19384 1.2379 1.27549 1.31309 1.33746 1.3542];
al3=-710.316+[-0.940231 -0.739701 -0.849036 -0.980069 -1.04431 -1.18499 -1.25659 -1.35117 -1.4122 -1.47147 -1.53678 -1.61708 -1.67992 -1.72075 -1.76735 -1.80979 -1.84857 -1.88366 -1.92078 -1.94424 -1.96033 ];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_6N
t3=[2 2.05109 2.10771 2.16551 2.23127 2.25099 2.30879 2.3556 2.40827 2.4509 2.50089 2.55838 2.61053 2.66985 2.71985 2.76985 2.81985 2.86985 2.9136 2.98392 3];
% 20212
am1=-10.8616+[0.090966 0.212302 -0.0646688 -0.301561 -0.541179 -0.614727 -0.825947 -0.980841 -1.13937 -1.26085 -1.39207 -1.53881 -1.66215 -1.79204 -1.89255 -1.98668 -2.07352 -2.15491 -2.22269 -2.32231 -2.34383];
am2=446.379+[0.899489 -0.148193 -0.222471 -0.0661432 0.146777 0.206745 0.369584 0.488411 0.609625 0.702623 0.796866 0.889114 0.966887 1.04521 1.10422 1.1569 1.20507 1.24694 1.27872 1.32452 1.33414];
am3=-704.985+[-0.86313 -0.8869 -1.0634 -1.18939 -1.33073 -1.37393 -1.49761 -1.5906 -1.68634 -1.75857 -1.8362 -1.9209 -1.99451 -2.0724 -2.13318 -2.18982 -2.24207 -2.29082 -2.33071 -2.38983 -2.4028];
% 40296
an1=-12.2381+[-0.0539516 0.124846 0.0248648 -0.0952625 -0.233368 -0.277409 -0.406523 -0.5024 -0.602969 -0.682121 -0.76884 -0.866283 -0.947468 -1.03231 -1.09791 -1.15978 -1.2174 -1.27184 -1.31736 -1.38336 -1.39736];
an2=446.122+[0.432532 -0.301527 -0.259733 -0.0362077 0.178166 0.233643 0.380169 0.483292 0.586661 0.664648 0.743887 0.82178 0.886454 0.951379 1.00056 1.04454 1.08452 1.11919 1.14568 1.1843 1.19246];
an3=-714.556+[-0.79231 -0.779743 -0.887907 -0.985667 -1.10484 -1.13891 -1.23398 -1.3027 -1.37458 -1.42937 -1.48804 -1.55195 -1.6071 -1.66473 -1.7095 -1.75102 -1.78943 -1.82492 -1.85387 -1.89551 -1.90448];
% 25651
ao1=-9.36067+[0.130737 0.210663 -0.126314 -0.416996 -0.699565 -0.78457 -1.02733 -1.20596 -1.38957 -1.53034 -1.68335 -1.85399 -1.9983 -2.15131 -2.27076 -2.38346 -2.48844 -2.58756 -2.6706 -2.79451 -2.82153 ];
ao2=443.677+[0.851766 -0.170052 -0.265627 -0.13035 0.0596921 0.112954 0.257417 0.362907 0.470718 0.55377 0.637753 0.719557 0.788573 0.858014 0.910387 0.95711 0.999976 1.03715 1.06532 1.10607 1.11465];
ao3=-706.563+[-0.739154 -0.850423 -1.04438 -1.18072 -1.31835 -1.35924 -1.47611 -1.56428 -1.65568 -1.72487 -1.80051 -1.8841 -1.95713 -2.03546 -2.09751 -2.15618 -2.21114 -2.26326 -2.30667 -2.37235 -2.38693];
% 42160
ap1=-14.6392+[-0.0493544 0.153387 0.0613403 -0.0508473 -0.188255 -0.23231 -0.36138 -0.456483 -0.555713 -0.63368 -0.718565 -0.813915 -0.892959 -0.974934 -1.03789 -1.09688 -1.15134 -1.20237 -1.24474 -1.30508 -1.31773];
ap2=448.856+[0.511745 -0.326265 -0.282676 -0.0294231 0.21692 0.280423 0.447849 0.565042 0.682766 0.771636 0.861436 0.949796 1.02332 1.09685 1.1521 1.20111 1.24532 1.28328 1.31193 1.35306 1.36165];
ap3=-710.316+[-0.841263 -0.746227 -0.850241 -0.961846 -1.10039 -1.13943 -1.24741 -1.32436 -1.40436 -1.46524 -1.52936 -1.59846 -1.65779 -1.71898 -1.76583 -1.8086 -1.84758 -1.88285 -1.91104 -1.95046 -1.95879 ];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_6N
t4=[2 2.05499 2.10192 2.15388 2.20807 2.25585 2.30786 2.36346 2.40295 2.45178 2.50023 2.56364 2.61714 2.65515 2.70515 2.75515 2.80515 2.85515 2.92702 2.96921 3];
% 20212
aq1=-10.8616+[-0.401806 0.11107 -0.0258341 -0.246182 -0.437871 -0.610923 -0.800688 -0.984042 -1.10649 -1.2493 -1.37913 -1.54268 -1.67081 -1.75626 -1.86122 -1.95999 -2.05127 -2.13569 -2.24958 -2.31088 -2.3537];
aq2=446.379+[1.11968 0.0939234 -0.0861207 -0.0289979 0.0947395 0.225921 0.36376 0.499974 0.589626 0.695967 0.788599 0.890465 0.968778 1.0188 1.07964 1.13403 1.18357 1.22779 1.28069 1.308 1.32651 ];
aq3=704.985+[0.123842 -0.946106 -1.05695 -1.1706 -1.27546 -1.37585 -1.48611 -1.59678 -1.66917 -1.75345 -1.82986 -1.92409 -1.99998 -2.05078 -2.11361 -2.17225 -2.22646 -2.27681 -2.34334 -2.37934 -2.40469];
% 40296
ar1=-12.2381+[-0.211763 0.0615639 0.0433706 -0.0611303 -0.169967 -0.273099 -0.388843 -0.501455 -0.5795 -0.67223 -0.75742 -0.865383 -0.948803 -1.00408 -1.07161 -1.13552 -1.19513 -1.25065 -1.32606 -1.36605 -1.39345];
ar2=446.122+[0.668103 -0.135832 -0.195215 -0.0427497 0.118504 0.247738 0.374321 0.494326 0.571062 0.660854 0.739063 0.82548 0.89115 0.933122 0.98427 1.02989 1.07121 1.10794 1.15208 1.17521 1.19097];
ar3=-714.556+[0.114342 -0.822062 -0.881507 -0.965821 -1.05827 -1.13983 -1.22423 -1.30544 -1.35989 -1.42374 -1.48136 -1.55218 -1.60877 -1.64621 -1.69239 -1.73537 -1.77512 -1.81178 -1.85978 -1.88499 -1.90246];
% 25651
as1=-9.36067+[-0.36511 0.106588 -0.0781507 -0.34976 -0.581217 -0.782905 -1.00105 -1.21272 -1.35381 -1.51882 -1.66982 -1.85969 -2.0093 -2.1096 -2.23366 -2.35116 -2.46076 -2.56304 -2.7021 -2.77801 -2.83141 ];
as2=443.677+[1.04913 0.0568826 -0.133962 -0.0930651 0.0149022 0.130764 0.252438 0.372925 0.452515 0.547313 0.629822 0.720071 0.789406 0.833633 0.887526 0.935691 0.979676 1.01894 1.06576 1.08999 1.10644];
as3=-706.563+[0.290135 -0.885318 -1.02122 -1.1518 -1.26315 -1.3605 -1.46531 -1.57055 -1.63954 -1.72018 -1.79438 -1.88718 -1.96245 -2.01339 -2.07712 -2.13748 -2.19414 -2.2475 -2.31964 -2.35951 -2.38787];
% 42160
at1=-14.6392+[-0.24874 0.0834491 0.0773393 -0.0186077 -0.124317 -0.22708 -0.342638 -0.454073 -0.53141 -0.622932 -0.706448 -0.812168 -0.893426 -0.946932 -1.01193 -1.07312 -1.12973 -1.18196 -1.25226 -1.2889 -1.31374];
at2=448.856+[0.825379 -0.133062 -0.205123 -0.034798 0.148795 0.296511 0.440955 0.577163 0.664639 0.766993 0.855668 0.953746 1.02838 1.07595 1.13356 1.18454 1.23036 1.27072 1.31852 1.34316 1.35978];
at3=-710.316+[-0.0104733 -0.809775 -0.853578 -0.94393 -1.04835 -1.14108 -1.23639 -1.32689 -1.38759 -1.45855 -1.52166 -1.59834 -1.65916 -1.69897 -1.74757 -1.7921 -1.83268 -1.86943 -1.91627 -1.94017 -1.95647];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_6N
t5=[2 2.05109 2.10925 2.16553 2.20718 2.26451 2.31289 2.3537 2.40703 2.45415 2.50161 2.55682 2.60896 2.66829 2.71829 2.76829 2.81829 2.86829 2.92766 2.96985 3];
% 20212
au1=-10.8616+[0.0660434 0.187805 -0.0581511 -0.278503 -0.42987 -0.650367 -0.840289 -0.983427 -1.14959 -1.28753 -1.4152 -1.55939 -1.68606 -1.81901 -1.92142 -2.01718 -2.10534 -2.18783 -2.27945 -2.33901 -2.37948];
au2=446.379+[0.900609 -0.127776 -0.182486 -0.0230328 0.10473 0.279945 0.415723 0.520288 0.643283 0.746362 0.836063 0.923861 1.00214 1.08142 1.14169 1.19574 1.24523 1.28912 1.33365 1.36212 1.38109 ];
au3=-704.985+[-0.858817 -0.881346 -1.05528 -1.16916 -1.25239 -1.37871 -1.48107 -1.56301 -1.66048 -1.74071 -1.81438 -1.89558 -1.96939 -2.04761 -2.10853 -2.16541 -2.21787 -2.26634 -2.32003 -2.35553 -2.38006];
% 40296
av1=-12.2381+[-0.0560071 0.108702 0.00943714 -0.101391 -0.18736 -0.313415 -0.420808 -0.505373 -0.607347 -0.69462 -0.776896 -0.870251 -0.951417 -1.03622 -1.10187 -1.16373 -1.22129 -1.27577 -1.33664 -1.37622 -1.40261 ];
av2=446.122+[0.402313 -0.327546 -0.266004 -0.0308412 0.111165 0.275677 0.398867 0.48974 0.594958 0.681257 0.756469 0.830631 0.895492 0.960804 1.01046 1.05484 1.09505 1.13046 1.16638 1.18975 1.20535 ];
av3=-714.556+[-0.792025 -0.785816 -0.895063 -0.988443 -1.06469 -1.16477 -1.24408 -1.30456 -1.37757 -1.43824 -1.49396 -1.55492 -1.61011 -1.66784 -1.71274 -1.75433 -1.79276 -1.82831 -1.86701 -1.89192 -1.90881];
% 25651
aw1=-9.36067+[0.107468 0.188964 -0.118579 -0.39325 -0.574177 -0.828561 -1.04488 -1.20889 -1.40078 -1.56018 -1.70862 -1.87589 -2.02365 -2.1799 -2.30134 -2.41577 -2.5222 -2.62259 -2.73499 -2.80916 -2.86];
aw2=443.677+[0.85269 -0.151191 -0.228552 -0.0893514 0.0247662 0.180281 0.30116 0.394131 0.503587 0.595691 0.67573 0.753648 0.823232 0.893668 0.947334 0.995476 1.0397 1.07895 1.1187 1.14414 1.16113];
aw3=-706.563+[-0.73196 -0.838672 -1.0294 -1.15576 -1.24037 -1.36016 -1.45754 -1.53544 -1.6288 -1.70575 -1.77769 -1.85816 -1.93157 -2.01039 -2.07268 -2.1317 -2.187 -2.239 -2.29764 -2.33708 -2.36462];
% 42160
ax1=-14.6392+[-0.0511071 0.136516 0.0455302 -0.0572259 -0.142496 -0.268607 -0.376033 -0.460046 -0.560706 -0.646706 -0.72728 -0.818614 -0.897663 -0.979622 -1.04264 -1.10163 -1.15604 -1.2071 -1.26362 -1.29979 -1.32364];
ax2=448.856+[0.478028 -0.354901 -0.288873 -0.0222571 0.14086 0.329384 0.470083 0.573346 0.69311 0.791465 0.876722 0.960712 1.03443 1.10842 1.16424 1.21375 1.25825 1.2971 1.33594 1.36086 1.37735];
ax3=-710.316+[-0.838366 -0.750969 -0.857563 -0.965845 -1.05475 -1.16972 -1.25989 -1.32769 -1.40896 -1.47639 -1.53731 -1.60311 -1.66249 -1.72383 -1.77089 -1.81379 -1.85283 -1.88825 -1.92584 -1.94944 -1.96518];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_6N
t6=[2 2.05457 2.10596 2.15281 2.2099 2.26199 2.30323 2.3549 2.42252 2.46212 2.51913 2.56913 2.61288 2.68319 2.72538 2.76757 2.81757 2.86757 2.92694 2.96913 3 ];
% 20212
ay1=-10.8616+[-0.401788 0.136436 -0.0453498 -0.235334 -0.440026 -0.640545 -0.805268 -0.989283 -1.19923 -1.3141 -1.46777 -1.59763 -1.70442 -1.86188 -1.94843 -2.03061 -2.12 -2.20362 -2.29696 -2.35836 -2.40116];
ay2=446.379+[1.12007 -0.135766 -0.187928 -0.0631037 0.109401 0.265205 0.380489 0.511157 0.663529 0.746013 0.84617 0.923372 0.987182 1.07829 1.12778 1.17252 1.22167 1.26502 1.30946 1.33816 1.35771 ];
ay3=-704.985+[0.122619 -0.910627 -1.04787 -1.14822 -1.2589 -1.37409 -1.46262 -1.56724 -1.68977 -1.75602 -1.84344 -1.91688 -1.97886 -2.07102 -2.12193 -2.16999 -2.22262 -2.27152 -2.32543 -2.3611 -2.38631];
% 40296
az1=-12.2381+[-0.211769 0.0745171 0.0140586 -0.0778096 -0.192449 -0.306331 -0.398389 -0.50586 -0.634359 -0.70685 -0.804882 -0.887735 -0.95518 -1.05426 -1.10901 -1.16097 -1.21875 -1.27332 -1.33432 -1.37395 -1.40101];
az2=446.122+[0.66834 -0.328757 -0.277562 -0.0839926 0.118148 0.266044 0.371964 0.487905 0.619412 0.689355 0.774921 0.840398 0.893684 0.969325 1.01011 1.04711 1.08728 1.1225 1.15829 1.18161 1.19757 ];
az3=-714.556+[0.113813 -0.80783 -0.89014 -0.968314 -1.06924 -1.1596 -1.22792 -1.30508 -1.39675 -1.44676 -1.5123 -1.56708 -1.61309 -1.68067 -1.71804 -1.75298 -1.79156 -1.8272 -1.86599 -1.89096 -1.90827];
% 25651
ba1=-9.36067+[-0.365092 0.132996 -0.102319 -0.338834 -0.586036 -0.817253 -1.00466 -1.21524 -1.45742 -1.59013 -1.76844 -1.91893 -2.04337 -2.22829 -2.33088 -2.42883 -2.5365 -2.63801 -2.75218 -2.82827 -2.88171];
ba2=443.677+[1.04957 -0.162033 -0.232629 -0.125391 0.0284627 0.166335 0.268669 0.384563 0.519918 0.593445 0.682416 0.750799 0.807363 0.888156 0.932186 0.971948 1.0158 1.05449 1.09413 1.11982 1.13736 ];
ba3=-706.563+[0.28882 -0.867245 -1.02125 -1.13209 -1.24664 -1.35578 -1.43985 -1.53938 -1.65658 -1.72036 -1.80615 -1.87887 -1.94055 -2.03357 -2.08578 -2.13568 -2.19111 -2.24349 -2.30237 -2.34205 -2.37038];
% 42160
bb1=-14.6392+[-0.248732 0.0998926 0.0495489 -0.0353016 -0.147532 -0.261411 -0.353575 -0.460388 -0.587216 -0.658578 -0.754544 -0.83556 -0.901223 -0.996907 -1.04943 -1.09897 -1.15362 -1.2048 -1.26148 -1.29773 -1.3222];
bb2=448.856+[0.825649 -0.355291 -0.301756 -0.0825296 0.148803 0.318181 0.439252 0.570968 0.7207 0.800294 0.89713 0.971431 1.03197 1.11754 1.1633 1.20453 1.24898 1.2876 1.32629 1.35115 1.36801];
bb3=-710.316+[-0.0110182 -0.774788 -0.852176 -0.942221 -1.05987 -1.16351 -1.24127 -1.32779 -1.42978 -1.48514 -1.55639 -1.6155 -1.66491 -1.73651 -1.77552 -1.81151 -1.8507 -1.8862 -1.92388 -1.94754 -1.96367];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_6N
t13=[2 2.06253 2.12507 2.17135 2.21519 2.29738 2.34738 2.35988 2.41926 2.46936 2.50412 2.55762 2.64563 2.65813 2.705 2.79719 2.80969 2.86028 2.90125 2.96727 3];
% 20212
bc1=-10.8616+[0.14562 0.100267 -0.129469 -0.289599 -0.451731 -0.745907 -0.904973 -0.941922 -1.10587 -1.24025 -1.332 -1.47008 -1.67516 -1.70224 -1.80168 -1.97834 -2.00037 -2.08833 -2.1546 -2.25401 -2.30029];
bc2=446.379+[1.07675 -0.167912 0.0517149 0.217402 0.36138 0.597206 0.724936 0.754529 0.888187 0.997272 1.06735 1.16482 1.30299 1.32256 1.39161 1.51498 1.53056 1.5884 1.63101 1.69203 1.7197 ];
bc3=-704.985+[-0.585003 -0.635048 -0.791956 -0.885988 -0.982552 -1.16083 -1.26025 -1.28325 -1.3865 -1.47016 -1.52591 -1.6093 -1.735 -1.75236 -1.81572 -1.93044 -1.94486 -2.00174 -2.04469 -2.10937 -2.13965];
% 40296
bd1=-12.2381+[0.00596392 0.0705528 -0.0193174 -0.105608 -0.198813 -0.372762 -0.467795 -0.490068 -0.590692 -0.675699 -0.734809 -0.823219 -0.954273 -0.971386 -1.03485 -1.14767 -1.16198 -1.2195 -1.26294 -1.32788 -1.35789 ];
bd2=446.122+[0.498484 -0.323291 -0.081274 0.0971473 0.232585 0.444006 0.55639 0.582619 0.699836 0.793432 0.853093 0.936042 1.05278 1.06886 1.12569 1.22564 1.23813 1.28448 1.31852 1.36747 1.39008];
bd3=-714.556+[-0.522187 -0.538423 -0.629442 -0.709037 -0.785092 -0.919189 -0.991851 -1.00872 -1.08541 -1.14901 -1.19175 -1.25512 -1.34908 -1.36205 -1.40962 -1.49592 -1.50683 -1.54962 -1.58174 -1.62919 -1.65093];
% 25651
be1=-9.36067+[0.185688 0.0795065 -0.208737 -0.405758 -0.595934 -0.936318 -1.12148 -1.16476 -1.35759 -1.51507 -1.62234 -1.78323 -2.02433 -2.05636 -2.17409 -2.3855 -2.41216 -2.51856 -2.59948 -2.72214 -2.77981];
be2=443.677+[1.01382 -0.202862 -0.0141538 0.133385 0.260848 0.4689 0.58196 0.608196 0.727076 0.824612 0.887257 0.974277 1.09752 1.11507 1.17693 1.28781 1.30186 1.35392 1.39233 1.44739 1.4724];
be3=-706.563+[-0.430726 -0.592274 -0.747719 -0.842129 -0.933341 -1.10019 -1.19418 -1.21615 -1.31531 -1.39569 -1.44961 -1.5309 -1.65543 -1.6726 -1.73567 -1.85144 -1.86619 -1.92485 -1.96982 -2.03874 -2.07148];
% 42160
bf1=-14.6392+[0.0086072 0.101408 0.0223771 -0.0609131 -0.153275 -0.326047 -0.419458 -0.441184 -0.538869 -0.621721 -0.679417 -0.765786 -0.892582 -0.90906 -0.970203 -1.07801 -1.09156 -1.14594 -1.18658 -1.2466 -1.27398];
bf2=448.856+[0.623689 -0.315122 -0.0389329 0.167314 0.32343 0.565446 0.692973 0.722605 0.854924 0.960946 1.02863 1.12268 1.25452 1.27279 1.33722 1.45013 1.46416 1.51608 1.55392 1.60775 1.63235];
bf3=-710.316+[-0.603201 -0.524172 -0.630519 -0.72614 -0.814923 -0.967896 -1.04928 -1.068 -1.15261 -1.22295 -1.27002 -1.33932 -1.4404 -1.45441 -1.50548 -1.59705 -1.6085 -1.65289 -1.68568 -1.7331 -1.75441];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_6N
t14=[2 2.05026 2.10532 2.15068 2.23407 2.26532 2.33563 2.38563 2.43563 2.46688 2.50555 2.55206 2.60555 2.65607 2.70294 2.75304 2.80113 2.85856 2.90701 2.97041 3];
% 20212
bg1=-10.8616+[-0.290584 -0.0804419 -0.036828 -0.106381 -0.335959 -0.436147 -0.665155 -0.819553 -0.96843 -1.05838 -1.16431 -1.28886 -1.42814 -1.55392 -1.66497 -1.77864 -1.88026 -1.99341 -2.08403 -2.1935 -2.24191 ];
bg2=446.379+[1.36888 1.06817 0.987303 0.979976 1.01541 1.01208 1.01362 1.03695 1.07236 1.09799 1.13782 1.19107 1.25789 1.32271 1.3842 1.44993 1.51278 1.58496 1.64169 1.7093 1.73879 ];
bg3=-704.985+[-0.492421 -0.750742 -0.82793 -0.896968 -1.01699 -1.06448 -1.18328 -1.26824 -1.35014 -1.3998 -1.45935 -1.52951 -1.60907 -1.68201 -1.74849 -1.81723 -1.8806 -1.95172 -2.00814 -2.0773 -2.10789];
% 40296
bh1=-12.2381+[-0.262043 -0.0981064 0.00822395 0.00922838 -0.103595 -0.163385 -0.300728 -0.395081 -0.488867 -0.546327 -0.614489 -0.694702 -0.783989 -0.863955 -0.934346 -1.00605 -1.07076 -1.14348 -1.2021 -1.27242 -1.30331];
bh2=446.122+[0.846901 0.483355 0.426928 0.472344 0.641071 0.674389 0.728203 0.772075 0.819214 0.850016 0.892425 0.944606 1.00638 1.06445 1.11748 1.17272 1.22466 1.28325 1.32856 1.38268 1.40639];
bh3=-714.556+[-0.447652 -0.624613 -0.636844 -0.667332 -0.781459 -0.827496 -0.921706 -0.983718 -1.04461 -1.08194 -1.12723 -1.18076 -1.24058 -1.29505 -1.34514 -1.3972 -1.44537 -1.49942 -1.54204 -1.59332 -1.61561];
% 25651
bi1=-9.36067+[-0.2566 -0.0711371 -0.0672956 -0.176086 -0.476406 -0.597905 -0.867431 -1.04832 -1.22187 -1.32672 -1.45039 -1.5953 -1.75707 -1.90355 -2.03322 -2.16627 -2.28611 -2.42049 -2.52867 -2.66076 -2.71958];
bi2=443.677+[1.29559 0.984068 0.887561 0.865894 0.883146 0.874378 0.863083 0.877081 0.903436 0.923617 0.956761 1.00211 1.06009 1.11689 1.17123 1.22971 1.28599 1.35094 1.40212 1.46326 1.49001];
bi3=-706.563+[-0.323524 -0.586981 -0.673588 -0.753056 -0.904593 -0.960956 -1.09076 -1.18042 -1.2655 -1.31689 -1.37791 -1.44902 -1.52902 -1.60226 -1.66887 -1.73781 -1.80161 -1.87374 -1.93157 -2.00358 -2.03582];
% 42160
bk1=-14.6392+[-0.294117 -0.0968428 0.0293471 0.044329 -0.0567771 -0.114436 -0.247572 -0.338633 -0.429624 -0.485316 -0.551397 -0.62947 -0.716486 -0.794184 -0.862558 -0.932158 -0.994699 -1.06453 -1.12048 -1.18681 -1.21567];
bk2=448.856+[1.02023 0.616043 0.556353 0.606565 0.800021 0.8374 0.895249 0.942226 0.993231 1.02677 1.07356 1.13189 1.20116 1.26637 1.32638 1.38896 1.44768 1.51363 1.56442 1.62455 1.6507];
bk3=-710.316+[-0.582165 -0.710774 -0.708248 -0.733425 -0.856855 -0.904067 -0.99773 -1.05933 -1.12064 -1.15847 -1.20514 -1.26117 -1.3243 -1.38189 -1.43522 -1.49068 -1.54189 -1.59888 -1.64335 -1.69595 -1.71851];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of axial rotation 6N')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of axial rotation 6N')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
