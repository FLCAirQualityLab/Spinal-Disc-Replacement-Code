%% This code finds foreman height and width narrowing/widening for the C5-C6 Right Hand side foreman under axial rotation (6N)
clear all
clf

%% Model15_Intact/TLC_6N
t15=[2,2.0575,2.1047,2.15542,2.22863,2.25714,2.30685,2.35082,2.40011,2.45711,2.51234,2.55752,2.6058,2.65799,2.70027,2.75081,2.80824,2.88338,2.91463,2.95331,3];
%40182U
aa1=-13.5191+[0.114695,0.0864121,0.0592365,0.0236488,-0.0552329,-0.0903735,-0.148635,-0.196898,-0.246643,-0.303453,-0.358993,-0.4025,-0.446039,-0.488561,-0.520909,-0.557245,-0.593958,-0.639462,-0.657036,-0.678026,-0.700893,];
aa2=448.04+[-0.461887,-0.240648,-0.0461835,0.14248,0.390372,0.48011,0.627546,0.750344,0.878605,1.01564,1.13619,1.22513,1.31259,1.39887,1.46471,1.54135,1.62517,1.72364,1.76208,1.80851,1.86302];
aa3=-720.839+[-0.393063,-0.526366,-0.610744,-0.702199,-0.84211,-0.895895,-0.983271,-1.05485,-1.12827,-1.20846,-1.28184,-1.33836,-1.39447,-1.44938,-1.49177,-1.54213,-1.59629,-1.66036,-1.68471,-1.71329,-1.74519,];
%62515
ab1=-13.5397+[0.0355486,0.0327808,0.0170071,-0.00102686,-0.0400744,-0.0580047,-0.0880718,-0.113173,-0.139204,-0.166954,-0.194593,-0.216011,-0.237505,-0.258801,-0.274752,-0.292944,-0.311828,-0.335199,-0.344312,-0.356035,-0.369268,];
ab2=448.593+[-0.272229,-0.17516,-0.0953527,-0.0196382,0.0847353,0.12498,0.193979,0.253059,0.316376,0.384195,0.445568,0.491269,0.536841,0.582386,0.616592,0.654909,0.696026,0.745403,0.765072,0.788582,0.816079];
ab3=-730.72+[-0.167408,-0.228493,-0.28103,-0.331615,-0.406591,-0.43617,-0.485195,-0.525716,-0.568452,-0.612891,-0.651727,-0.680775,-0.709383,-0.7374,-0.758173,-0.781649,-0.806167,-0.83534,-0.846601,-0.85997,-0.87482,];
%45869
ac1=-9.75965+[0.0870308,0.0609779,0.0310229,-0.00696326,-0.0859592,-0.120932,-0.179579,-0.228913,-0.2807,-0.339996,-0.398015,-0.443611,-0.489749,-0.535569,-0.570669,-0.610243,-0.650912,-0.702074,-0.722183,-0.746446,-0.773441];
ac2=445.175+[-0.42166,-0.266771,-0.120877,0.0211242,0.208011,0.275862,0.388236,0.482232,0.580826,0.685999,0.778027,0.845544,0.91171,0.97702,1.02673,1.08431,1.14731,1.22096,1.24979,1.28471,1.32598,];
ac3=-723.489+[-0.447382,-0.540003,-0.598851,-0.664522,-0.765789,-0.805047,-0.869481,-0.922707,-0.977964,-1.03856,-1.09432,-1.13763,-1.18106,-1.22416,-1.25762,-1.29728,-1.34008,-1.39154,-1.41137,-1.43476,-1.46109,];
%65936R
ad1=-15.4024+[0.0922672,0.0621253,0.0238418,-0.0137129,-0.0817869,-0.111008,-0.159136,-0.198835,-0.239807,-0.282729,-0.323686,-0.355038,-0.386223,-0.416886,-0.439791,-0.465932,-0.49318,-0.526893,-0.539997,-0.556481,-0.575007,];
ad2=450.021+[-0.356624,-0.251457,-0.163031,-0.0787196,0.0369974,0.0817326,0.15868,0.22442,0.295027,0.36996,0.436605,0.485494,0.533667,0.581052,0.615964,0.654398,0.695027,0.742235,0.760799,0.7828,0.808384,];
ad3=-723.647+[-0.136441,-0.205852,-0.265727,-0.322922,-0.407592,-0.440998,-0.496325,-0.542014,-0.590157,-0.640056,-0.683519,-0.715878,-0.747616,-0.778517,-0.801294,-0.826923,-0.853577,-0.885076,-0.897177,-0.91151,-0.927376];
xa1=[ad1-ac1];
xa2=[ad2-ac2];
xa3=[ad3-ac3];
ya1=[aa1-ab1];
ya2=[aa2-ab2];
ya3=[aa3-ab3];
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];
k=21;
for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end
figure(1)
plot(t15,-1*width15,'b')
hold on
plot(t15,-1*height15,'k')
xlabel('time (s)')
ylabel({'Narrowing/Widening (mm)';'Widening is +, Narrowing is -'})










