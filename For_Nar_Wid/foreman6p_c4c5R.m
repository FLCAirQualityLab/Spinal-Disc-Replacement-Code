%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under lateral bending (5n)
% 20212,40296,25651,42160
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 20212,40296,25651,42160
%% model15_intact_TLC_4N
t15=[2 2.0575 2.10171 2.15243 2.21614 2.25202 2.3077 2.35301 2.40975 2.45206 2.50317 2.55517 2.6029 2.65687 2.71794 2.76183 2.80173 2.85494 2.90035 2.95138 3];

% 20212
aa1=-10.8616+[0.237303 0.57513 0.777102 1.00894 1.33204 1.51029 1.79501 2.02391 2.28636 2.46128 2.65079 2.82483 2.97381 3.12913 3.28866 3.39574 3.49077 3.61198 3.7117 3.8181 3.91396];
aa2=446.379+[0.413703 -0.481884 -0.856706 -1.13268 -1.35871 -1.44878 -1.56868 -1.64958 -1.75479 -1.84007 -1.94476 -2.05073 -2.15424 -2.28335 -2.43871 -2.55042 -2.65276 -2.79103 -2.90965 -3.04248 -3.16991];
aa3=-704.985+[-0.501412 -0.24927 -0.0985422 0.0464566 0.196454 0.268895 0.36359 0.427103 0.493246 0.534267 0.576749 0.614234 0.644842 0.675862 0.705655 0.724769 0.741607 0.762207 0.778615 0.795427 0.809969];

% 40296
ab1=-12.2381+[0.123435 0.311125 0.428435 0.571501 0.776953 0.893395 1.08367 1.23595 1.41157 1.52875 1.65589 1.7726 1.87274 1.9769 2.08443 2.15655 2.22021 2.3008 2.36624 2.43568 2.49749];
ab2=446.122+[0.252332 -0.400346 -0.673261 -0.880127 -1.06089 -1.1343 -1.23537 -1.30748 -1.39877 -1.46873 -1.55354 -1.63956 -1.72178 -1.81975 -1.93531 -2.01789 -2.09347 -2.19473 -2.28146 -2.37785 -2.46877];
ab3=-714.556+[-0.468917 -0.298328 -0.198369 -0.0914503 0.0266537 0.0832999 0.160704 0.21503 0.27318 0.309247 0.346649 0.379577 0.405905 0.431003 0.454567 0.469442 0.482731 0.498746 0.511119 0.523458 0.533594];

% 25651
ac1=-9.36067+[0.270513 0.658927 0.902659 1.17817 1.5487 1.75003 2.0642 2.31204 2.59544 2.78447 2.98976 3.1788 3.34036 3.50911 3.68299 3.79989 3.90357 4.03585 4.1448 4.26123 4.36632];
ac2=443.597+[0.404337 -0.422205 -0.75281 -0.984811 -1.16248 -1.22836 -1.31513 -1.37302 -1.45122 -1.51722 -1.59961 -1.68382 -1.76799 -1.87518 -2.00592 -2.10032 -2.18697 -2.30454 -2.4056 -2.51889 -2.62786];
ac3=-706.266+[-0.440591 -0.276886 -0.165826 -0.0539664 0.0628482 0.11945 0.191363 0.238193 0.284196 0.310445 0.335833 0.356844 0.372407 0.385992 0.396074 0.401443 0.405864 0.410079 0.412778 0.414487 0.414821 ];

% 42160
ad1=-14.6392+[0.138744 0.336053 0.44654 0.580777 0.779487 0.893217 1.08414 1.24071 1.42101 1.5408 1.67053 1.78954 1.89191 1.99779 2.10654 2.17932 2.24355 2.32466 2.39033 2.45977 2.52135];
ad2=448.856+[0.338222 -0.42442 -0.756523 -1.02153 -1.26134 -1.36237 -1.5001 -1.59565 -1.71567 -1.80682 -1.9166 -2.0271 -2.13146 -2.2552 -2.4004 -2.5041 -2.59874 -2.72531 -2.83359 -2.95402 -3.06774];
ad3=-710.316+[-0.51616 -0.268837 -0.136204 0.000509734 0.149146 0.219951 0.318111 0.387628 0.463836 0.51259 0.564477 0.611257 0.650033 0.688986 0.727846 0.753328 0.776069 0.804358 0.826925 0.850346 0.8707];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4N
t1=[2 2.05126 2.10091 2.15535 2.20061 2.25209 2.30561 2.36555 2.40191 2.4653 2.51879 2.5529 2.60117 2.65273 2.7052 2.76398 2.80076 2.87223 2.92223 2.95699 3];
% 20212
ae1=-10.8616+[-0.322039 -0.191056 -0.00526665 0.268268 0.55664 0.94802 1.37576 1.83859 2.10092 2.50803 2.81254 2.99044 3.2202 3.43992 3.64412 3.85245 3.97294 4.18785 4.32573 4.41982 4.53217];
ae2=446.379+[1.21324 0.790851 0.374215 -0.11348 -0.526329 -0.98764 -1.42831 -1.8523 -2.07602 -2.40171 -2.63522 -2.76947 -2.94198 -3.11046 -3.27237 -3.44697 -3.55351 -3.75518 -3.89488 -3.99215 -4.11406];
ae3=-704.985+[-0.790441 -0.887962 -0.673831 -0.393485 -0.171318 0.0391343 0.203987 0.339834 0.405342 0.497913 0.561805 0.597325 0.64171 0.681991 0.717688 0.751995 0.770503 0.801253 0.819937 0.832581 0.847559];

% 40296
af1=-12.2381+[-0.296706 -0.267677 -0.229329 -0.145033 -0.0133361 0.210019 0.475684 0.770173 0.937119 1.19356 1.38276 1.4925 1.63218 1.76532 1.8883 2.01374 2.08579 2.21298 2.29293 2.34672 2.41016 ];
af2=446.122+[0.803328 0.41029 0.132986 -0.137111 -0.364925 -0.653608 -0.953531 -1.25725 -1.41712 -1.65121 -1.81819 -1.91318 -2.03305 -2.15032 -2.26319 -2.38655 -2.46227 -2.6053 -2.70433 -2.77305 -2.85888];
af3=-714.556+[-0.751604 -0.872714 -0.759905 -0.610877 -0.481782 -0.338722 -0.214165 -0.105472 -0.0529845 0.0207916 0.071084 0.0985553 0.131486 0.160956 0.186641 0.211628 0.224899 0.246111 0.258195 0.266204 0.275443 ];

% 25651
ag1=-9.36067+[-0.292646 -0.138823 0.081503 0.400302 0.72684 1.15593 1.61495 2.10227 2.37686 2.80248 3.12098 3.3071 3.54744 3.77776 3.99213 4.2114 4.33847 4.56564 4.71174 4.81136 4.93042 ];
ag2=443.677+[1.15065 0.753654 0.381723 -0.0423848 -0.397843 -0.797895 -1.18207 -1.55397 -1.74924 -2.03125 -2.23152 -2.34593 -2.49226 -2.6347 -2.7714 -2.91901 -3.00925 -3.18022 -3.29895 -3.38165 -3.4855 ];
ag3=-706.563+[-0.648179 -0.771076 -0.602907 -0.385538 -0.217528 -0.062909 0.0511809 0.139197 0.178815 0.233012 0.268945 0.288188 0.311412 0.331313 0.347796 0.362146 0.368866 0.377908 0.382047 0.384627 0.387235 ];

% 42160
ah1=-14.6392+[-0.323489 -0.286332 -0.24526 -0.166253 -0.0423041 0.177215 0.44503 0.749447 0.922822 1.18973 1.38656 1.5007 1.64598 1.78414 1.91146 2.04097 2.11519 2.24573 2.32737 2.38224 2.44678 ];
ah2=448.856+[0.94052 0.480004 0.150723 -0.183013 -0.470779 -0.831356 -1.2028 -1.5726 -1.76812 -2.05508 -2.26118 -2.37901 -2.52811 -2.67451 -2.81568 -2.97009 -3.0649 -3.24416 -3.36829 -3.45436 -3.5617];
ah3=-710.316+[-0.858051 -0.929563 -0.781992 -0.596172 -0.434939 -0.251589 -0.0851453 0.0652008 0.140143 0.246838 0.320772 0.361732 0.411625 0.45734 0.498211 0.539179 0.56192 0.600395 0.623882 0.63964 0.658263];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4N
t2=[2 2.05026 2.11433 2.15261 2.2098 2.25679 2.30943 2.35333 2.40624 2.4511 2.50404 2.55744 2.60598 2.66477 2.70156 2.77304 2.80429 2.86109 2.90333 2.95384 3];

% 20212
ai1=-10.8616+[-0.237609 -0.201915 -0.135071 -0.0770572 0.0442079 0.185776 0.398173 0.616567 0.919628 1.1979 1.54108 1.89463 2.21091 2.57906 2.79807 3.19228 3.35282 3.62559 3.80943 4.01137 4.1845];
ai2=446.379+[1.42477 1.237 0.92547 0.716903 0.372071 0.0702042 -0.265906 -0.543926 -0.873205 -1.14728 -1.46536 -1.77947 -2.05113 -2.35937 -2.54048 -2.86665 -3.00005 -3.22954 -3.38894 -3.56938 -3.7279 ];
ai3=-704.985+[-0.908536 -0.956899 -0.818403 -0.704277 -0.49818 -0.313126 -0.122788 0.0192753 0.168628 0.276855 0.389602 0.48948 0.566367 0.644729 0.686583 0.752416 0.775618 0.810485 0.831865 0.853761 0.871449];

% 40296
aj1=-12.2381+[-0.2408 -0.239747 -0.265707 -0.279957 -0.285823 -0.259031 -0.172891 -0.0558557 0.123973 0.29697 0.516211 0.743366 0.946184 1.18167 1.32072 1.56879 1.66971 1.84085 1.9553 2.07941 2.18354 ];
aj2=446.122+[0.873877 0.720842 0.504722 0.376459 0.190557 0.0419616 -0.126727 -0.287369 -0.508675 -0.705312 -0.945209 -1.18384 -1.38498 -1.60929 -1.73921 -1.97014 -2.06456 -2.22867 -2.34363 -2.47394 -2.5874];
aj3=-714.556+[-0.83035 -0.899713 -0.843814 -0.792568 -0.696782 -0.604124 -0.500356 -0.406536 -0.292779 -0.207372 -0.114092 -0.0304574 0.0334264 0.0983542 0.132677 0.185687 0.204536 0.233504 0.251297 0.269035 0.282494 ];

% 25651
ak1=-9.36067+[-0.206337 -0.158019 -0.0598402 0.0211183 0.182367 0.359206 0.608381 0.853981 1.18374 1.48127 1.84416 2.21447 2.54397 2.92631 3.15332 3.56149 3.7276 4.00994 4.20048 4.41006 4.58978];
ak2=443.677+[1.3488 1.17476 0.89675 0.714182 0.417737 0.162206 -0.121867 -0.358713 -0.643557 -0.882612 -1.16174 -1.43831 -1.67677 -1.94615 -2.10386 -2.38693 -2.50243 -2.70088 -2.83857 -2.9942 -3.13068];
ak3=-706.563+[-0.738806 -0.801044 -0.693571 -0.603257 -0.440963 -0.297416 -0.152891 -0.0464308 0.0640993 0.141618 0.220125 0.286398 0.333275 0.376769 0.397873 0.426162 0.434066 0.443009 0.446781 0.44901 0.44951];

% 42160
al1=-14.6392+[-0.261043 -0.260133 -0.290284 -0.309928 -0.32904 -0.315316 -0.241339 -0.129817 0.0509083 0.227237 0.452892 0.688893 0.90059 1.14687 1.29242 1.55236 1.65825 1.83784 1.95778 2.08763 2.19639 ];
al2=448.856+[1.02138 0.838723 0.580348 0.422973 0.187828 -0.00650333 -0.228762 -0.435473 -0.709618 -0.949429 -1.23922 -1.52546 -1.76813 -2.04055 -2.19901 -2.48173 -2.59769 -2.7996 -2.94127 -3.1023 -3.24275];
al3=-710.316+[-0.940231 -0.989918 -0.909082 -0.84234 -0.723054 -0.609482 -0.480247 -0.362275 -0.217423 -0.105737 0.0186334 0.132731 0.22324 0.31854 0.370549 0.454917 0.486522 0.53733 0.569983 0.604191 0.631688];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25315 2.31416 2.35262 2.41143 2.46244 2.50012 2.56211 2.62242 2.66 2.71937 2.76156 2.81214 2.87147 2.90272 2.95721 3 ];
% 20212
am1=-10.8616+[0.090966 0.100856 0.112426 0.127445 0.14314 0.172496 0.231732 0.285744 0.399707 0.527864 0.638758 0.852032 1.08879 1.24862 1.51337 1.71059 1.9522 2.24123 2.39462 2.66206 2.87014];
am2=446.379+[0.899489 0.831634 0.684042 0.533631 0.406698 0.22107 -0.0365292 -0.207633 -0.475758 -0.70404 -0.868796 -1.13636 -1.39301 -1.55242 -1.80432 -1.9822 -2.193 -2.43521 -2.5611 -2.77645 -2.94112];
am3=-704.985+[-0.86313 -0.856195 -0.794848 -0.71492 -0.644738 -0.536514 -0.37869 -0.274975 -0.120776 0.00228752 0.0863916 0.212823 0.322528 0.385638 0.479556 0.541639 0.611944 0.685424 0.721166 0.777032 0.815316];
% 40296
an1=-12.2381+[-0.0539516 -0.0523511 -0.0768487 -0.109051 -0.13532 -0.170356 -0.205294 -0.214531 -0.198866 -0.154675 -0.105978 0.0051174 0.142485 0.239993 0.405196 0.530213 0.683742 0.869432 0.968549 1.14277 1.2789];
an2=446.122+[0.432532 0.387993 0.299909 0.215385 0.147074 0.0523348 -0.0679226 -0.148944 -0.269585 -0.382125 -0.473836 -0.639965 -0.819097 -0.935783 -1.1256 -1.25986 -1.41779 -1.59782 -1.69165 -1.8538 -1.97927];
an3=-714.556+[-0.79231 -0.799366 -0.788556 -0.765412 -0.74325 -0.705195 -0.642018 -0.593454 -0.520558 -0.451433 -0.398287 -0.31091 -0.229098 -0.180187 -0.10508 -0.0547085 0.00248968 0.0630578 0.0931149 0.141536 0.17548];
% 25651
ao1=-9.36067+[0.130737 0.14697 0.177287 0.212779 0.245972 0.301444 0.397047 0.474734 0.624228 0.780511 0.91022 1.15093 1.41067 1.58332 1.86687 2.07614 2.33115 2.63443 2.79488 3.07388 3.29036];
ao2=443.677+[0.851766 0.790064 0.659994 0.530006 0.421235 0.2638 0.048358 -0.0939172 -0.316081 -0.505787 -0.643409 -0.869132 -1.08859 -1.22595 -1.44371 -1.59769 -1.77991 -1.98889 -2.09737 -2.28281 -2.4245];
ao3=-706.563+[-0.739154 -0.737438 -0.689674 -0.625999 -0.570256 -0.484343 -0.36026 -0.27935 -0.16135 -0.0682991 -0.00521837 0.0888758 0.17002 0.216082 0.283594 0.326827 0.374338 0.421035 0.442772 0.474694 0.494685];
% 42160
ap1=-14.6392+[-0.0493544 -0.0505953 -0.0831243 -0.124054 -0.158494 -0.20692 -0.260765 -0.281469 -0.282592 -0.248586 -0.20517 -0.0991384 0.0368166 0.134954 0.30253 0.430509 0.588452 0.780555 0.883403 1.06468 1.20664];
ap2=448.856+[0.511745 0.458523 0.351615 0.245811 0.158732 0.0356067 -0.12509 -0.234852 -0.400777 -0.551684 -0.672141 -0.88516 -1.10826 -1.25149 -1.48318 -1.64672 -1.83925 -2.05909 -2.1738 -2.37222 -2.52597];
ap3=-710.316+[-0.841263 -0.844506 -0.826729 -0.79546 -0.766391 -0.718508 -0.641487 -0.582283 -0.492405 -0.407014 -0.340592 -0.230026 -0.125109 -0.0616545 0.0367785 0.103896 0.181067 0.264917 0.307182 0.376787 0.427122];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4N
t4=[2 2.05499 2.11058 2.16207 2.20435 2.25007 2.30324 2.36036 2.40263 2.45125 2.50837 2.56869 2.60135 2.66917 2.7073 2.76599 2.81551 2.85069 2.90069 2.95128 3];
% 20212
aq1=-10.8616+[-0.401806 0.545363 1.05673 1.40339 1.66386 1.93872 2.24361 2.56116 2.77653 3.00017 3.23164 3.45283 3.56423 3.77967 3.8942 4.0574 4.1869 4.27455 4.39554 4.51695 4.62822 ];
aq2=446.379+[1.11968 -0.435283 -1.22849 -1.6673 -1.90373 -2.07594 -2.23067 -2.3792 -2.49018 -2.62349 -2.78696 -2.96051 -3.05615 -3.2596 -3.37514 -3.55303 -3.69977 -3.80285 -3.95085 -4.10364 -4.25287];
aq3=704.985+[0.123842 -0.476809 -0.149673 0.0384251 0.151154 0.249676 0.346465 0.432264 0.487307 0.542505 0.59745 0.64786 0.671326 0.713852 0.734753 0.761929 0.781651 0.794135 0.810704 0.826995 0.840745];
% 40296
ar1=-12.2381+[-0.211763 0.127161 0.371165 0.55505 0.705573 0.872053 1.06063 1.25675 1.38962 1.52632 1.66546 1.79618 1.86185 1.98851 2.05586 2.15171 2.22741 2.27828 2.34783 2.41692 2.47932];
ar2=446.122+[0.668103 -0.429505 -0.883535 -1.14414 -1.299 -1.42108 -1.53484 -1.64789 -1.73049 -1.82592 -1.94051 -2.05956 -2.12508 -2.26462 -2.34451 -2.4679 -2.5699 -2.64173 -2.74528 -2.8518 -2.95475];
ar3=-714.556+[0.114342 -0.591535 -0.415445 -0.29842 -0.219071 -0.145717 -0.070964 -0.00306323 0.0395253 0.0806051 0.11987 0.154345 0.169915 0.197455 0.210873 0.227837 0.239686 0.246931 0.256227 0.26515 0.272022];
% 25651
as1=-9.36067+[-0.36511 0.62556 1.18466 1.57066 1.85946 2.15957 2.48881 2.8254 3.05316 3.28996 3.53582 3.77099 3.88939 4.11866 4.24058 4.41473 4.55307 4.64681 4.77618 4.90568 5.02455];
as2=443.677+[1.04913 -0.382358 -1.08565 -1.46199 -1.65783 -1.79502 -1.91477 -2.03175 -2.12069 -2.22934 -2.36458 -2.50917 -2.58961 -2.76199 -2.86037 -3.01243 -3.13797 -3.22623 -3.35326 -3.48469 -3.61325 ];
as3=-706.563+[0.290135 -0.490117 -0.258948 -0.125186 -0.0426698 0.0320297 0.105427 0.168374 0.207208 0.244169 0.27836 0.307505 0.319781 0.339652 0.348155 0.356979 0.361911 0.364195 0.366386 0.368012 0.367702];
% 42160
at1=-14.6392+[-0.24874 0.152988 0.402041 0.578128 0.722213 0.885546 1.07399 1.27645 1.41368 1.55437 1.69679 1.83037 1.8975 2.02659 2.09514 2.19234 2.26898 2.32038 2.39052 2.46018 2.52289 ];
at2=448.856+[0.825379 -0.490439 -1.03718 -1.36891 -1.57269 -1.73554 -1.88798 -2.03347 -2.13885 -2.26026 -2.40552 -2.55599 -2.63833 -2.81303 -2.91291 -3.06715 -3.19463 -3.28443 -3.41369 -3.54634 -3.67462];
at3=-710.316+[-0.0104733 -0.539125 -0.304658 -0.151222 -0.0483184 0.0451825 0.139996 0.227739 0.284003 0.339954 0.395751 0.446567 0.470703 0.515544 0.53853 0.569755 0.593052 0.608196 0.628555 0.648564 0.665889 ];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4N
t5=[2 2.05126 2.11533 2.16533 2.20361 2.25315 2.31416 2.35262 2.40417 2.45195 2.50082 2.55529 2.60294 2.66047 2.7231 2.75435 2.80406 2.85412 2.94917 2.96167 3];
% 20212
au1=-10.8616+[0.0660434 0.0753582 0.0854409 0.09926 0.114013 0.141879 0.198326 0.249682 0.34309 0.454476 0.591566 0.771184 0.948837 1.18301 1.45832 1.60085 1.8335 2.07349 2.53477 2.59557 2.78083];
au2=446.379+[0.900609 0.834193 0.689968 0.543433 0.419937 0.238708 -0.0135092 -0.181851 -0.41308 -0.62573 -0.838251 -1.07195 -1.27334 -1.51455 -1.77754 -1.90837 -2.11386 -2.31719 -2.69422 -2.743 -2.89012];
au3=-704.985+[-0.858817 -0.852667 -0.794101 -0.717308 -0.649646 -0.544838 -0.390436 -0.287661 -0.152354 -0.0338198 0.077401 0.191034 0.280897 0.379943 0.479053 0.526113 0.596723 0.6609 0.766302 0.778814 0.814051];
% 40296
av1=-12.2381+[-0.0560071 -0.0542085 -0.0759559 -0.105415 -0.129673 -0.162129 -0.195289 -0.204499 -0.193963 -0.158591 -0.099855 -0.0084064 0.0924487 0.232967 0.404377 0.493967 0.6411 0.794494 1.09208 1.13151 1.25186];
av2=446.122+[0.402313 0.35942 0.275871 0.19668 0.131942 0.0402441 -0.0796518 -0.160635 -0.267212 -0.368549 -0.483953 -0.623926 -0.758366 -0.929937 -1.12556 -1.22315 -1.37559 -1.52619 -1.80635 -1.8429 -1.954];
av3=-714.556+[-0.792025 -0.798779 -0.786871 -0.762818 -0.740291 -0.702393 -0.640267 -0.592676 -0.529843 -0.467331 -0.399226 -0.323183 -0.258102 -0.183398 -0.105154 -0.0676851 -0.0111338 0.0410593 0.129451 0.14026 0.171008];
% 25651
aw1=-9.36067+[0.107468 0.122985 0.151252 0.184899 0.216661 0.270147 0.362465 0.437331 0.561851 0.700166 0.862109 1.06637 1.26305 1.51761 1.81274 1.96445 2.21059 2.46298 2.94545 3.00886 3.20179];
aw2=443.677+[0.85269 0.792221 0.664957 0.538223 0.432395 0.278751 0.0679269 -0.0719101 -0.26319 -0.439289 -0.616334 -0.812679 -0.983885 -1.19085 -1.41798 -1.53105 -1.70847 -1.88386 -2.20854 -2.25049 -2.37702];
aw3=-706.563+[-0.73196 -0.730826 -0.685564 -0.624778 -0.571332 -0.488415 -0.367107 -0.286831 -0.18298 -0.09299 -0.00924981 0.0754769 0.142145 0.214844 0.286223 0.319391 0.367728 0.409491 0.472926 0.48002 0.498922];
% 42160
ax1=-14.6392+[-0.0511071 -0.0521138 -0.0817074 -0.119588 -0.151716 -0.19711 -0.24895 -0.269585 -0.27398 -0.249049 -0.197629 -0.111252 -0.0123652 0.12802 0.301571 0.392938 0.543925 0.702228 1.011 1.05202 1.1774];
ax2=448.856+[0.478028 0.426811 0.325257 0.225795 0.142935 0.0233775 -0.136915 -0.246424 -0.392691 -0.529476 -0.681613 -0.862262 -1.03133 -1.24335 -1.48253 -1.60162 -1.78772 -1.97172 -2.31458 -2.35934 -2.49552];
ax3=-710.316+[-0.838366 -0.841532 -0.823116 -0.791445 -0.762273 -0.714643 -0.638557 -0.580404 -0.502742 -0.425715 -0.340899 -0.245067 -0.162199 -0.0658659 0.0365085 0.0860813 0.161912 0.233505 0.358466 0.374041 0.419279];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4N
t6=[2 2.05486 2.10789 2.15953 2.21347 2.25039 2.30255 2.36524 2.40407 2.45974 2.50483 2.55731 2.60253 2.65367 2.70049 2.76158 2.81718 2.85019 2.90883 2.95766 3];
% 20212
ay1=-10.8616+[-0.401788 -0.212385 0.0243641 0.320819 0.70541 0.999762 1.42017 1.89705 2.16751 2.51607 2.76655 3.03144 3.23721 3.44871 3.62864 3.84594 4.03545 4.13965 4.30864 4.44176 4.55215];
ay2=446.379+[1.12007 0.675489 0.210136 -0.269191 -0.769581 -1.09811 -1.5191 -1.93856 -2.15731 -2.42291 -2.60675 -2.79792 -2.94672 -3.1037 -3.2422 -3.41876 -3.57526 -3.66724 -3.82968 -3.96551 -4.08521 ];
ay3=-704.985+[0.122619 -0.847931 -0.62184 -0.349419 -0.0928994 0.0514519 0.211008 0.349502 0.416649 0.497028 0.551685 0.60672 0.6479 0.688321 0.720839 0.757013 0.782922 0.797161 0.819879 0.837566 0.852217];
% 40296
az1=-12.2381+[-0.211769 -0.28958 -0.227285 -0.117402 0.0817189 0.255187 0.519142 0.824688 0.998068 1.21877 1.37514 1.53879 1.6639 1.79096 1.89799 2.02559 2.12776 2.18738 2.28488 2.36088 2.42299 ];
az2=446.122+[0.66834 0.323302 0.0144994 -0.261802 -0.55978 -0.768995 -1.05225 -1.34644 -1.50244 -1.69391 -1.82554 -1.96021 -2.06326 -2.17158 -2.26714 -2.39089 -2.50176 -2.56702 -2.68173 -2.77773 -2.86159];
az3=-714.556+[0.113813 -0.854604 -0.732948 -0.57952 -0.421096 -0.322902 -0.204563 -0.0959922 -0.0428625 0.0204153 0.0627934 0.104755 0.134936 0.163898 0.187015 0.213159 0.232084 0.242232 0.257595 0.269085 0.278163];
% 25651
ba1=-9.36067+[-0.365092 -0.15554 0.119329 0.459708 0.888778 1.20895 1.65943 2.16152 2.44484 2.80955 3.07196 3.34967 3.56544 3.78754 3.97671 4.20566 4.40545 4.51539 4.69425 4.83523 4.95226];
ba2=443.677+[1.04957 0.646507 0.231386 -0.18515 -0.617255 -0.902036 -1.26773 -1.63318 -1.82273 -2.05115 -2.20771 -2.36923 -2.4944 -2.62614 -2.74241 -2.89098 -3.02275 -3.10044 -3.238 -3.35335 -3.45522];
ba3=-706.563+[0.28882 -0.74087 -0.566319 -0.355379 -0.162254 -0.0578786 0.0519648 0.141196 0.182323 0.230648 0.262732 0.293966 0.316527 0.337574 0.353397 0.3691 0.377437 0.38157 0.386983 0.390558 0.393013];
% 42160
bb1=-14.6392+[-0.248732 -0.310894 -0.244566 -0.138783 0.0534021 0.225808 0.492662 0.808689 0.988761 1.21846 1.38105 1.55103 1.68097 1.81256 1.92317 2.05472 2.1596 2.22086 2.32066 2.39821 2.46134 ];
bb2=448.856+[0.825649 0.378594 0.0108799 -0.330445 -0.703394 -0.964187 -1.31543 -1.676 -1.86765 -2.10314 -2.26621 -2.43408 -2.5629 -2.69874 -2.81865 -2.97391 -3.11301 -3.19485 -3.33877 -3.45905 -3.56399];
bb3=-710.316+[-0.0110182 -0.903418 -0.742104 -0.550673 -0.351108 -0.223455 -0.0651489 0.0852281 0.160753 0.251425 0.312803 0.374295 0.419282 0.463437 0.499543 0.541801 0.574382 0.592488 0.621371 0.643726 0.661978];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4N
t13=[2 2.05126 2.11533 2.16533 2.21533 2.25361 2.30816 2.35516 2.41122 2.46102 2.51245 2.55582 2.60999 2.65082 2.73015 2.7614 2.81853 2.85329 2.91154 2.95522 3 ];
% 20212
bc1=-10.8616+[0.14562 0.158941 0.178538 0.205389 0.246666 0.286966 0.369896 0.470011 0.625505 0.792985 0.99151 1.17195 1.41508 1.60672 1.98991 2.14314 2.42466 2.59503 2.87517 3.07904 3.28212 ];
bc2=446.379+[1.07675 0.990135 0.805868 0.62153 0.412371 0.244251 -0.00776014 -0.231846 -0.499561 -0.733015 -0.968479 -1.16506 -1.40859 -1.58898 -1.92643 -2.05574 -2.28644 -2.42311 -2.64383 -2.80247 -2.95961 ];
bc3=-704.985+[-0.585003 -0.571527 -0.491917 -0.393243 -0.270171 -0.16839 -0.0155871 0.113427 0.257392 0.370336 0.472811 0.551967 0.64252 0.704947 0.811852 0.850051 0.913745 0.948801 0.999588 1.03176 1.06093];
% 40296
bd1=-12.2381+[0.00596392 0.00753366 -0.0197933 -0.0505705 -0.0814973 -0.102563 -0.114153 -0.09681 -0.0388664 0.0421841 0.151347 0.255916 0.402967 0.521217 0.760905 0.857437 1.03624 1.14483 1.32422 1.45496 1.58518];
bd2=446.122+[0.498484 0.441289 0.332988 0.23299 0.125631 0.0425223 -0.0773757 -0.187233 -0.327573 -0.46553 -0.618456 -0.75427 -0.92883 -1.06084 -1.30588 -1.39911 -1.56512 -1.6634 -1.82374 -1.93992 -2.05642];
bd3=-714.556+[-0.522187 -0.526466 -0.507394 -0.475272 -0.429573 -0.389259 -0.323367 -0.261942 -0.181698 -0.109994 -0.0398737 0.017622 0.0857764 0.133723 0.215625 0.245016 0.29485 0.322571 0.363815 0.390402 0.415037];
% 25651
be1=-9.36067+[0.185688 0.206845 0.249476 0.301104 0.370927 0.433915 0.550607 0.679763 0.867577 1.06049 1.28206 1.48018 1.74277 1.94755 2.35329 2.51462 2.80991 2.98809 3.2803 3.49246 3.70343];
be2=443.677+[1.01382 0.93478 0.772391 0.61313 0.434838 0.29268 0.0818046 -0.105161 -0.329154 -0.526 -0.726214 -0.894307 -1.10394 -1.25973 -1.55057 -1.6617 -1.85961 -1.97664 -2.16543 -2.30097 -2.43517];
be3=-706.563+[-0.430726 -0.423859 -0.361973 -0.283885 -0.186453 -0.106325 0.0121403 0.110913 0.219627 0.303234 0.377448 0.433851 0.496905 0.539182 0.607406 0.630455 0.666818 0.685579 0.710081 0.72339 0.73399];
% 42160
bf1=-14.6392+[0.0086072 0.00670494 -0.0313294 -0.0735576 -0.118063 -0.149759 -0.176849 -0.172317 -0.125463 -0.0506737 0.0549225 0.158009 0.305951 0.426349 0.672368 0.771904 0.956958 1.06966 1.25641 1.39283 1.52896];
bf2=448.856+[0.623689 0.556391 0.425235 0.29993 0.161987 0.0540605 -0.105615 -0.252733 -0.437369 -0.615033 -0.808589 -0.978999 -1.19475 -1.35676 -1.65823 -1.77321 -1.97827 -2.0998 -2.29843 -2.44264 -2.58721];
bf3=-710.316+[-0.603201 -0.602959 -0.575493 -0.53389 -0.476667 -0.426891 -0.3453 -0.26859 -0.168247 -0.0768065 0.0146887 0.0909479 0.182498 0.248017 0.363536 0.405947 0.479229 0.520886 0.584996 0.628161 0.66924];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4N
t14=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30206 2.35204 2.40323 2.45375 2.52804 2.55155 2.62764 2.65371 2.71895 2.75421 2.81684 2.85161 2.90752 2.95451 3];
% 20212
bg1=-10.8616+[-0.290584 -0.27283 -0.247243 -0.218905 -0.173206 -0.146635 -0.0798834 0.00669409 0.123671 0.266943 0.528945 0.621095 0.948665 1.06827 1.38199 1.55775 1.87557 2.05356 2.34011 2.57905 2.80643];
bg2=446.379+[1.36888 1.26749 1.07723 0.897226 0.665854 0.557156 0.336055 0.11075 -0.123906 -0.354531 -0.691088 -0.797045 -1.13791 -1.25352 -1.541 -1.69442 -1.96012 -2.10455 -2.33098 -2.51562 -2.68876 ];
bg3=-704.985+[-0.492421 -0.614687 -0.607139 -0.538574 -0.425545 -0.364407 -0.229326 -0.089186 0.0520482 0.181315 0.350525 0.400346 0.545416 0.591513 0.698496 0.75184 0.837353 0.880979 0.944454 0.990855 1.02988];
% 40296
bh1=-12.2381+[-0.262043 -0.266732 -0.288836 -0.315125 -0.346633 -0.359231 -0.377153 -0.379113 -0.354486 -0.300982 -0.169245 -0.118676 0.0739305 0.146682 0.341795 0.45257 0.654664 0.768452 0.952842 1.10775 1.25539];
bh2=446.122+[0.846901 0.764924 0.617594 0.496138 0.353729 0.292702 0.180064 0.0673946 -0.0444908 -0.165426 -0.37558 -0.446589 -0.689118 -0.773937 -0.990108 -1.10508 -1.30129 -1.40738 -1.57409 -1.71175 -1.84165];
bh3=-714.556+[-0.447652 -0.58544 -0.621776 -0.607468 -0.570029 -0.546421 -0.490894 -0.425202 -0.356799 -0.283329 -0.168747 -0.132701 -0.0232577 0.0123834 0.0973022 0.139895 0.207963 0.243098 0.295301 0.334832 0.368581];
% 25651
bi1=-9.36067+[-0.2566 -0.232927 -0.185912 -0.134463 -0.0579042 -0.0164735 0.0805625 0.19747 0.344591 0.515595 0.813938 0.916595 1.27456 1.4035 1.73849 1.9247 2.25945 2.44616 2.74573 2.99474 3.23107];
bi2=443.677+[1.29559 1.19965 1.02667 0.867396 0.666171 0.573105 0.386281 0.197632 0.00186115 -0.191122 -0.475674 -0.565783 -0.858048 -0.957681 -1.20628 -1.3389 -1.56797 -1.69218 -1.8866 -2.04498 -2.19334];
bi3=-706.563+[-0.323524 -0.450542 -0.454391 -0.401093 -0.311437 -0.262902 -0.156279 -0.0465381 0.062519 0.161103 0.288728 0.325941 0.432234 0.465485 0.540962 0.577208 0.632217 0.658996 0.695829 0.720527 0.739146];
% 42160
bk1=-14.6392+[-0.294117 -0.298914 -0.329396 -0.365459 -0.410104 -0.429094 -0.460039 -0.474488 -0.460753 -0.415022 -0.290193 -0.240929 -0.0492798 0.024226 0.223065 0.336756 0.545149 0.662953 0.854484 1.01589 1.17006];
bk2=448.856+[1.02023 0.923791 0.748899 0.600917 0.42329 0.34532 0.198133 0.0481079 -0.10028 -0.258507 -0.527154 -0.61689 -0.918477 -1.02269 -1.28687 -1.42736 -1.66798 -1.79832 -2.00343 -2.17303 -2.33339];
bk3=-710.316+[-0.582165 -0.71038 -0.733469 -0.707633 -0.65526 -0.624565 -0.554757 -0.473021 -0.388637 -0.297199 -0.152039 -0.105875 0.0366754 0.0835628 0.19695 0.254934 0.350031 0.399974 0.475665 0.534672 0.586851];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
