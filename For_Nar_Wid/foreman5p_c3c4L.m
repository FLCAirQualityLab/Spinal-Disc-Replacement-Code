%% foreman height and width narrowing/widening 

% 5P!!

% for all models for the c3-c4 left hand side foreman under lateral bending (_n)
% 1297,16439,17116,14886

% Values for displacements have not been replaced. base coordinates have,
% but need checking. 
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 1297,16439,17116,14886
%% model15_intact_TLC_5P
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 1297
aa1=12.7746+[4.8745400e-01   1.1863800e+00   1.9156900e+00   2.5561000e+00   3.1641400e+00   3.7114100e+00   4.3140200e+00   4.9591400e+00   5.3380600e+00   5.7888900e+00   6.1645900e+00   6.5071100e+00   6.7002000e+00   6.8935000e+00   7.0758600e+00   7.2539300e+00   7.4653800e+00   7.5780800e+00   7.7261800e+00   7.8959100e+00   7.9886500e+00];
aa2=447.736+[1.5391800e+00   1.0799900e+00   1.3890300e+00   2.0732700e+00   2.9525900e+00   3.8744100e+00   5.0068800e+00   6.2811300e+00   7.0394900e+00   7.9514300e+00   8.7409200e+00   9.4973100e+00   9.9262100e+00   1.0312900e+01   1.0652600e+01   1.0994400e+01   1.1424600e+01   1.1661100e+01   1.1982100e+01   1.2359500e+01   1.2564000e+01];
aa3=-690.116+[-1.1235400e+00  -1.4636900e+00  -1.9049300e+00  -2.3407300e+00  -2.7906000e+00  -3.2281800e+00  -3.7575200e+00  -4.3794100e+00  -4.7612100e+00  -5.2410600e+00  -5.6698800e+00  -6.1043600e+00  -6.3676600e+00  -6.6124700e+00  -6.8371700e+00  -7.0646400e+00  -7.3494600e+00  -7.5059900e+00  -7.7183800e+00  -7.9693100e+00  -8.1070800e+00];

% 16439
ab1=13.5613+[3.1910900e-01   8.1669200e-01   1.3445700e+00   1.8175700e+00   2.2714000e+00   2.6844800e+00   3.1438200e+00   3.6420300e+00   3.9382000e+00   4.2939700e+00   4.5912000e+00   4.8624200e+00   5.0198100e+00   5.1778700e+00   5.3269900e+00   5.4733100e+00   5.6488100e+00   5.7432200e+00   5.8678700e+00   6.0091500e+00   6.0858800e+00];
ab2=447.206+[1.0864800e+00   7.3136500e-01   9.9553000e-01   1.5614400e+00   2.2876500e+00   3.0486400e+00   3.9806100e+00   5.0251900e+00   5.6494700e+00   6.3918700e+00   7.0308500e+00   7.6304600e+00   7.9641200e+00   8.2646300e+00   8.5294000e+00   8.7960500e+00   9.1333300e+00   9.3197700e+00   9.5736900e+00   9.8742300e+00   1.0038000e+01];
ab3=-699.132+[-9.9227400e-01  -1.2989800e+00  -1.6761200e+00  -2.0411500e+00  -2.4149900e+00  -2.7759500e+00  -3.2081000e+00  -3.7107100e+00  -4.0185200e+00  -4.4014200e+00  -4.7379200e+00  -5.0671500e+00  -5.2621600e+00  -5.4407400e+00  -5.6047400e+00  -5.7697400e+00  -5.9762500e+00  -6.0903700e+00  -6.2454100e+00  -6.4291600e+00  -6.5304900e+00];

% 17116
ac1=16.2684+[3.1756800e-01   8.2701900e-01   1.3597400e+00   1.8322400e+00   2.2834500e+00   2.6925000e+00   3.1444000e+00   3.6329400e+00   3.9229300e+00   4.2728800e+00   4.5645100e+00   4.8301500e+00   4.9839300e+00   5.1399900e+00   5.2876800e+00   5.4322300e+00   5.6048900e+00   5.6975500e+00   5.8195500e+00   5.9572500e+00   6.0320200e+00];
ac2=443.597+[1.2257500e+00   8.7528900e-01   1.1900500e+00   1.8220000e+00   2.6206900e+00   3.4512200e+00   4.4644400e+00   5.5963800e+00   6.2701700e+00   7.0694400e+00   7.7561500e+00   8.4012900e+00   8.7606300e+00   9.0831200e+00   9.3667700e+00   9.6522200e+00   1.0012900e+01   1.0212000e+01   1.0483100e+01   1.0803700e+01   1.0978200e+01];
ac3=-706.266+[-1.1326600e+00  -1.4563100e+00  -1.8942100e+00  -2.3350800e+00  -2.7946100e+00  -3.2410400e+00  -3.7765200e+00  -4.3970800e+00  -4.7754400e+00  -5.2457400e+00  -5.6590300e+00  -6.0652900e+00  -6.3050100e+00  -6.5247100e+00  -6.7255500e+00  -6.9276600e+00  -7.1807500e+00  -7.3205900e+00  -7.5106800e+00  -7.7358000e+00  -7.8596900e+00];

% 14886
ad1=9.91704+[5.2208400e-01   1.2371100e+00   1.9927700e+00   2.6616700e+00   3.2992300e+00   3.8750700e+00   4.5135000e+00   5.2003400e+00   5.6044700e+00   6.0847100e+00   6.4870900e+00   6.8580800e+00   7.0696600e+00   7.2792000e+00   7.4762700e+00   7.6695900e+00   7.9008000e+00   8.0245700e+00   8.1880400e+00   8.3762000e+00   8.4789400e+00];
ad2=444.847+[1.4321600e+00   9.4002600e-01   1.1819400e+00   1.7940400e+00   2.6009100e+00   3.4567200e+00   4.5146800e+00   5.7109400e+00   6.4262100e+00   7.2895100e+00   8.0385300e+00   8.7554700e+00   9.1611400e+00   9.5277700e+00   9.8501100e+00   1.0174900e+01   1.0584200e+01   1.0809700e+01   1.1115900e+01   1.1476400e+01   1.1672100e+01];
ad3=-691.954+[-1.0061900e+00  -1.3159100e+00  -1.6786500e+00  -2.0218300e+00  -2.3701400e+00  -2.7077900e+00  -3.1171100e+00  -3.6025600e+00  -3.9033400e+00  -4.2824200e+00  -4.6219800e+00  -4.9648000e+00  -5.1731600e+00  -5.3670700e+00  -5.5460900e+00  -5.7274400e+00  -5.9546600e+00  -6.0796900e+00  -6.2493100e+00  -6.4500700e+00  -6.5606900e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3']
y15=[ya1',ya2',ya3']

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5P
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 1297
ae1=12.7746+[-3.0399900e-01   5.2145800e-02   5.3880700e-01   1.1173000e+00   1.7313800e+00   2.4946800e+00   3.0514400e+00   3.5766300e+00   4.1254600e+00   4.6661200e+00   5.1888700e+00   5.6341500e+00   6.0820500e+00   6.5730000e+00   6.8878700e+00   7.1861900e+00   7.4760800e+00   7.6813900e+00   7.8839200e+00   8.0443100e+00   8.1945900e+00];
ae2=447.736+[2.4876100e+00   2.4364500e+00   2.4860200e+00   2.5949200e+00   2.7596700e+00   3.0531200e+00   3.3358200e+00   3.6688300e+00   4.1102900e+00   4.6569300e+00   5.3033700e+00   5.9503200e+00   6.7011800e+00   7.6248200e+00   8.2931900e+00   8.9902400e+00   9.7448400e+00   1.0343500e+01   1.0966200e+01   1.1477000e+01   1.1979000e+01];
ae3=-690.116+[-1.1890200e+00  -1.7358800e+00  -2.0616400e+00  -2.4120500e+00  -2.7741800e+00  -3.2320700e+00  -3.5719400e+00  -3.9005800e+00  -4.2663500e+00  -4.6542400e+00  -5.0627100e+00  -5.4447700e+00  -5.8586000e+00  -6.3501100e+00  -6.6932300e+00  -7.0370400e+00  -7.4021200e+00  -7.6913700e+00  -7.9974300e+00  -8.2542800e+00  -8.5122600e+00];

% 16439
af1=13.5613+[-3.2124000e-01  -9.4794800e-02   2.2332400e-01   6.1691400e-01   1.0549600e+00   1.6240900e+00   2.0502400e+00   2.4593300e+00   2.8915900e+00   3.3211800e+00   3.7400900e+00   4.0980700e+00   4.4645600e+00   4.8663700e+00   5.1238900e+00   5.3712000e+00   5.6154800e+00   5.7902400e+00   5.9622000e+00   6.0991400e+00   6.2293700e+00];
af2=447.206+[1.8134300e+00   1.7112300e+00   1.7536400e+00   1.8590300e+00   2.0065900e+00   2.2538800e+00   2.4881100e+00   2.7651100e+00   3.1311900e+00   3.5855200e+00   4.1227400e+00   4.6602200e+00   5.2823600e+00   6.0437300e+00   6.5930000e+00   7.1595000e+00   7.7675200e+00   8.2486600e+00   8.7485500e+00   9.1587600e+00   9.5628100e+00];
af3=-699.132+[-9.0469200e-01  -1.3772600e+00  -1.6554300e+00  -1.9527800e+00  -2.2559200e+00  -2.6361500e+00  -2.9171400e+00  -3.1887700e+00  -3.4909200e+00  -3.8104400e+00  -4.1471500e+00  -4.4631100e+00  -4.8034600e+00  -5.2055400e+00  -5.4832900e+00  -5.7549200e+00  -6.0379600e+00  -6.2590800e+00  -6.4912800e+00  -6.6853800e+00  -6.8802000e+00];

% 17116
ag1=16.2684+[-3.4470400e-01  -1.0821100e-01   2.1523400e-01   6.1095500e-01   1.0473300e+00   1.6126400e+00   2.0348500e+00   2.4389000e+00   2.8649900e+00   3.2865200e+00   3.6964100e+00   4.0458300e+00   4.4021200e+00   4.7920300e+00   5.0404700e+00   5.2792700e+00   5.5148100e+00   5.6829900e+00   5.8485500e+00   5.9795900e+00   6.1031100e+00];
ag2=449.981+[1.9898500e+00   1.9143800e+00   1.9892700e+00   2.1313100e+00   2.3179000e+00   2.6153600e+00   2.8878600e+00   3.2031100e+00   3.6127000e+00   4.1150100e+00   4.7038500e+00   5.2896700e+00   5.9641100e+00   6.7863600e+00   7.3778800e+00   7.9860800e+00   8.6373200e+00   9.1511900e+00   9.6838700e+00   1.0120500e+01   1.0550200e+01];
ag3=-696.273+[-1.0629800e+00  -1.5754800e+00  -1.8959900e+00  -2.2383300e+00  -2.5867200e+00  -3.0253900e+00  -3.3514800e+00  -3.6684500e+00  -4.0235100e+00  -4.4023200e+00  -4.8052800e+00  -5.1861000e+00  -5.5990700e+00  -6.0908500e+00  -6.4334200e+00  -6.7729200e+00  -7.1302500e+00  -7.4105400e+00  -7.7051700e+00  -7.9506700e+00  -8.1961800e+00];

% 14886
ah1=9.91704+[-2.6361700e-01   1.0085600e-01   6.0690400e-01   1.2119400e+00   1.8564900e+00   2.6584400e+00   3.2441300e+00   3.7979200e+00   4.3783700e+00   4.9528900e+00   5.5109800e+00   5.9881400e+00   6.4704600e+00   7.0004400e+00   7.3425200e+00   7.6672800e+00   7.9847200e+00   8.2113800e+00   8.4355400e+00   8.6144500e+00   8.7841500e+00];
ah2=448.847+[2.3816500e+00   2.2909800e+00   2.2902300e+00   2.3431300e+00   2.4511700e+00   2.6766500e+00   2.9107600e+00   3.1977800e+00   3.5897600e+00   4.0852800e+00   4.6800600e+00   5.2815900e+00   5.9854700e+00   6.8576200e+00   7.4919900e+00   8.1567200e+00   8.8790500e+00   9.4540000e+00   1.0053800e+01   1.0546500e+01   1.1031000e+01];
ah3=-691.954+[-1.0819800e+00  -1.5741400e+00  -1.8406400e+00  -2.1289500e+00  -2.4294900e+00  -2.8102100e+00  -3.0920800e+00  -3.3636700e+00  -3.6641900e+00  -3.9804400e+00  -4.3107400e+00  -4.6179700e+00  -4.9483600e+00  -5.3380300e+00  -5.6081100e+00  -5.8748400e+00  -6.1550400e+00  -6.3763300e+00  -6.6107700e+00  -6.8084800e+00  -7.0081000e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5P
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 1297
ai1=12.7746+[-1.7128900e-01  -4.0596400e-02   2.5208200e-01   5.9891700e-01   7.9039700e-01   1.1535300e+00   1.7724100e+00   1.9683100e+00   2.3717900e+00   2.9605700e+00   3.3220100e+00   3.7059900e+00   4.2135400e+00   4.6666300e+00   5.1172600e+00   5.5573000e+00   5.9392300e+00   6.3213900e+00   6.6543900e+00   6.9943200e+00   7.3252300e+00];
ai2=447.736+[2.9455100e+00   2.9097700e+00   2.9802500e+00   3.0959100e+00   3.1669100e+00   3.3093700e+00   3.5768700e+00   3.6648000e+00   3.8557300e+00   4.1635100e+00   4.3737600e+00   4.6222700e+00   4.9955400e+00   5.3727200e+00   5.7915200e+00   6.2539200e+00   6.7064800e+00   7.1877700e+00   7.6390100e+00   8.1350900e+00   8.6627500e+00];
ai3=-690.116+[-1.4399000e+00  -1.6986800e+00  -1.9887800e+00  -2.2814700e+00  -2.4334700e+00  -2.7047000e+00  -3.1401900e+00  -3.2728900e+00  -3.5426400e+00  -3.9286500e+00  -4.1678100e+00  -4.4269000e+00  -4.7804700e+00  -5.1078500e+00  -5.4434100e+00  -5.7869800e+00  -6.1011900e+00  -6.4254700e+00  -6.7144000e+00  -7.0173700e+00  -7.3253500e+00];

% 16439
aj1=13.5613+[-2.2044400e-01  -1.4360800e-01   2.2229800e-02   2.2841000e-01   3.4685800e-01   5.8105400e-01   1.0179500e+00   1.1620800e+00   1.4674000e+00   1.9247300e+00   2.2119200e+00   2.5192400e+00   2.9268300e+00   3.2926000e+00   3.6599400e+00   4.0206100e+00   4.3356700e+00   4.6532500e+00   4.9334300e+00   5.2187100e+00   5.4955600e+00];
aj2=447.206+[2.1526800e+00   2.0941900e+00   2.1323900e+00   2.2190800e+00   2.2752000e+00   2.3910200e+00   2.6008500e+00   2.6697000e+00   2.8171800e+00   3.0605800e+00   3.2298000e+00   3.4329600e+00   3.7424500e+00   4.0583100e+00   4.4093600e+00   4.7970400e+00   5.1765600e+00   5.5803400e+00   5.9575300e+00   6.3707000e+00   6.8089800e+00];
aj3=-699.132+[-1.1264800e+00  -1.3334500e+00  -1.5601100e+00  -1.7902700e+00  -1.9098200e+00  -2.1239300e+00  -2.4673800e+00  -2.5729500e+00  -2.7887400e+00  -3.1009900e+00  -3.2966400e+00  -3.5106100e+00  -3.8049600e+00  -4.0793700e+00  -4.3605200e+00  -4.6484700e+00  -4.9115900e+00  -5.1827300e+00  -5.4223300e+00  -5.6715100e+00  -5.9223300e+00];

% 17116
ak1=16.2684+[-2.4201000e-01  -1.5834100e-01   1.4163300e-02   2.2391900e-01   3.4305200e-01   5.7658400e-01   1.0098500e+00   1.1522800e+00   1.4536800e+00   1.9040900e+00   2.1865000e+00   2.4883600e+00   2.8877900e+00   3.2451700e+00   3.6038900e+00   3.9565700e+00   4.2645500e+00   4.5746700e+00   4.8490100e+00   5.1285200e+00   5.3993000e+00];
ak2=449.981+[2.3669000e+00   2.3147800e+00   2.3770700e+00   2.4922400e+00   2.5640800e+00   2.7088900e+00   2.9667500e+00   3.0504100e+00   3.2277900e+00   3.5147600e+00   3.7109300e+00   3.9433800e+00   4.2929800e+00   4.6462500e+00   5.0352600e+00   5.4611100e+00   5.8752900e+00   6.3142400e+00   6.7220900e+00   7.1672900e+00   7.6381700e+00];
ak3=-696.273+[-1.3288600e+00  -1.5500300e+00  -1.8111900e+00  -2.0785500e+00  -2.2176000e+00  -2.4663100e+00  -2.8660500e+00  -2.9888100e+00  -3.2393800e+00  -3.6026100e+00  -3.8301400e+00  -4.0792600e+00  -4.4224600e+00  -4.7431600e+00  -5.0728800e+00  -5.4124100e+00  -5.7243800e+00  -6.0465500e+00  -6.3331800e+00  -6.6338500e+00  -6.9389000e+00];

% 14886
al1=9.91704+[-1.2909300e-01   3.3129300e-03   3.0857500e-01   6.7418100e-01   8.7714300e-01   1.2627500e+00   1.9202000e+00   2.1283100e+00   2.5570100e+00   3.1825300e+00   3.5671700e+00   3.9765000e+00   4.5186300e+00   5.0038200e+00   5.4866800e+00   5.9578100e+00   6.3671600e+00   6.7774000e+00   7.1343400e+00   7.4985100e+00   7.8536200e+00];
al2=444.847+[2.8113300e+00   2.7596000e+00   2.7890500e+00   2.8583800e+00   2.9046500e+00   3.0030800e+00   3.2016000e+00   3.2690900e+00   3.4194400e+00   3.6713400e+00   3.8482000e+00   4.0616700e+00   4.3891000e+00   4.7255700e+00   5.1046700e+00   5.5291700e+00   5.9489200e+00   6.3978900e+00   6.8218400e+00   7.2906500e+00   7.7918300e+00];
al3=-691.954+[-1.2862800e+00  -1.5202400e+00  -1.7566900e+00  -1.9930400e+00  -2.1160200e+00  -2.3367300e+00  -2.6922500e+00  -2.8010100e+00  -3.0226500e+00  -3.3406400e+00  -3.5383100e+00  -3.7528500e+00  -4.0461500e+00  -4.3178300e+00  -4.5957900e+00  -4.8793200e+00  -5.1375500e+00  -5.4038200e+00  -5.6393800e+00  -5.8843800e+00  -6.1316000e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 1297
am1=12.7746+[3.3679900e-01   3.7451000e-01   4.8744500e-01   6.3559100e-01   7.1292900e-01   9.0995300e-01   1.0754600e+00   1.2676100e+00   1.5121900e+00   1.7307100e+00   2.0338200e+00   2.2508000e+00   2.5042600e+00   2.7992900e+00   3.0818300e+00   3.4292000e+00   3.7135000e+00   4.0379400e+00   4.4686200e+00   4.6179400e+00   4.9286200e+00];
am2=447.736+[2.5609300e+00   2.5531300e+00   2.6039300e+00   2.6865200e+00   2.7332100e+00   2.8577200e+00   2.9660100e+00   3.0983000e+00   3.2687300e+00   3.4207400e+00   3.6300700e+00   3.7795700e+00   3.9565400e+00   4.1659600e+00   4.3708900e+00   4.6311900e+00   4.8513400e+00   5.1115700e+00   5.4736400e+00   5.6027700e+00   5.8811200e+00];
am3=-690.116+[-1.7303000e+00  -1.8051200e+00  -1.9613700e+00  -2.1391400e+00  -2.2266400e+00  -2.4383900e+00  -2.6069500e+00  -2.7990500e+00  -3.0332300e+00  -3.2319100e+00  -3.4948200e+00  -3.6733100e+00  -3.8780600e+00  -4.1125900e+00  -4.3323700e+00  -4.5991200e+00  -4.8161100e+00  -5.0621300e+00  -5.3895500e+00  -5.5035900e+00  -5.7424000e+00];
% 16439
an1=13.5613+[1.6922800e-01   1.9348500e-01   2.4898300e-01   3.2086300e-01   3.5931400e-01   4.6016000e-01   5.4926300e-01   6.6213200e-01   8.1633700e-01   9.6490600e-01   1.1830000e+00   1.3444800e+00   1.5376600e+00   1.7675600e+00   1.9908400e+00   2.2689300e+00   2.5003200e+00   2.7680400e+00   3.1261300e+00   3.2502700e+00   3.5083400e+00];
an2=447.206+[1.8377900e+00   1.8119300e+00   1.8265600e+00   1.8736700e+00   1.9035600e+00   1.9904100e+00   2.0695600e+00   2.1670600e+00   2.2922500e+00   2.4011600e+00   2.5531300e+00   2.6632500e+00   2.7943500e+00   2.9526400e+00   3.1109700e+00   3.3164900e+00   3.4920100e+00   3.7023600e+00   3.9998000e+00   4.1071200e+00   4.3403400e+00];
an3=-699.132+[-1.4183800e+00  -1.4591200e+00  -1.5568100e+00  -1.6766500e+00  -1.7373600e+00  -1.8874200e+00  -2.0092200e+00  -2.1488900e+00  -2.3210500e+00  -2.4686400e+00  -2.6675300e+00  -2.8049700e+00  -2.9647200e+00  -3.1505600e+00  -3.3274600e+00  -3.5446900e+00  -3.7221400e+00  -3.9248200e+00  -4.1968600e+00  -4.2921100e+00  -4.4922800e+00];
% 17116
ao1=16.2684+[1.5435300e-01   1.8291700e-01   2.4532200e-01   3.2264800e-01   3.6309200e-01   4.6676300e-01   5.5653700e-01   6.6871000e-01   8.2062200e-01   9.6650800e-01   1.1799700e+00   1.3378400e+00   1.5265200e+00   1.7508000e+00   1.9683500e+00   2.2387900e+00   2.4636300e+00   2.7240000e+00   3.0725100e+00   3.1933400e+00   3.4446400e+00];
ao2=449.981+[2.0571100e+00   2.0308000e+00   2.0528700e+00   2.1125900e+00   2.1495700e+00   2.2558500e+00   2.3519000e+00   2.4697200e+00   2.6208900e+00   2.7523600e+00   2.9352700e+00   3.0670000e+00   3.2229900e+00   3.4098600e+00   3.5950300e+00   3.8331500e+00   4.0349000e+00   4.2744400e+00   4.6098200e+00   4.7301000e+00   4.9900300e+00];
ao3=-696.273+[-1.6334300e+00  -1.6780700e+00  -1.7913900e+00  -1.9314800e+00  -2.0025400e+00  -2.1785000e+00  -2.3212200e+00  -2.4847700e+00  -2.6864800e+00  -2.8594800e+00  -3.0929600e+00  -3.2546500e+00  -3.4424600e+00  -3.6607100e+00  -3.8682700e+00  -4.1229400e+00  -4.3308900e+00  -4.5683000e+00  -4.8868500e+00  -4.9983400e+00  -5.2326800e+00];
% 14886
ap1=9.91704+[3.8729600e-01   4.2378900e-01   5.3982000e-01   6.9523700e-01   7.7722700e-01   9.8787800e-01   1.1661600e+00   1.3747100e+00   1.6407600e+00   1.8783900e+00   2.2074400e+00   2.4426700e+00   2.7175600e+00   3.0374200e+00   3.3435800e+00   3.7200100e+00   4.0281000e+00   4.3791900e+00   4.8446400e+00   5.0059200e+00   5.3411600e+00];
ap2=444.847+[2.4108500e+00   2.3967600e+00   2.4270000e+00   2.4832000e+00   2.5162400e+00   2.6065600e+00   2.6869000e+00   2.7869000e+00   2.9180700e+00   3.0370200e+00   3.2036100e+00   3.3245200e+00   3.4693000e+00   3.6429400e+00   3.8153300e+00   4.0374200e+00   4.2275200e+00   4.4551500e+00   4.7762200e+00   4.8916500e+00   5.1424100e+00];
ap3=-691.954+[-1.5620500e+00  -1.6244100e+00  -1.7492100e+00  -1.8905900e+00  -1.9602300e+00  -2.1291600e+00  -2.2640800e+00  -2.4184700e+00  -2.6070300e+00  -2.7670000e+00  -2.9791000e+00  -3.1232200e+00  -3.2888500e+00  -3.4791200e+00  -3.6580500e+00  -3.8762100e+00  -4.0541500e+00  -4.2565600e+00  -4.5270900e+00  -4.6216300e+00  -4.8200900e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5P
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 1297
aq1=12.7746+[-4.3484900e-01   1.3797900e+00   2.2210700e+00   3.0211000e+00   3.5333300e+00   4.2925800e+00   4.8360700e+00   5.3838300e+00   5.8402000e+00   6.2999500e+00   6.6392200e+00   6.8091200e+00   7.0153400e+00   7.2192200e+00   7.3809700e+00   7.5861400e+00   7.6873700e+00   7.8542700e+00   8.0093800e+00   8.1334100e+00   8.2592900e+00];
aq2=447.736+[2.5760800e+00   1.5606800e+00   1.7165300e+00   2.4000500e+00   3.1057200e+00   4.4156400e+00   5.4569000e+00   6.5622800e+00   7.5290200e+00   8.5855800e+00   9.4451700e+00   9.8843700e+00   1.0395000e+01   1.0881300e+01   1.1268400e+01   1.1777900e+01   1.2036100e+01   1.2453800e+01   1.2843200e+01   1.3167200e+01   1.3501500e+01];
aq3=-690.116+[-9.0088400e-02  -2.1658400e+00  -2.6070300e+00  -3.1149400e+00  -3.4892600e+00  -4.0985600e+00  -4.5732900e+00  -5.0984200e+00  -5.5778700e+00  -6.1190400e+00  -6.5719400e+00  -6.8161900e+00  -7.1089200e+00  -7.3996000e+00  -7.6338800e+00  -7.9430800e+00  -8.1014400e+00  -8.3600100e+00  -8.6031700e+00  -8.8060700e+00  -9.0182900e+00];
% 16439
ar1=13.5613+[-4.2097600e-01   9.0625400e-01   1.5171300e+00   2.1103900e+00   2.4981200e+00   3.0827900e+00   3.5077200e+00   3.9373100e+00   4.2990700e+00   4.6666900e+00   4.9375700e+00   5.0738500e+00   5.2461500e+00   5.4154200e+00   5.5493300e+00   5.7196700e+00   5.8060700e+00   5.9475600e+00   6.0791000e+00   6.1851700e+00   6.2941600e+00];
ar2=447.206+[1.7838300e+00   1.0764100e+00   1.2501300e+00   1.8276400e+00   2.4089100e+00   3.4897300e+00   4.3494300e+00   5.2598500e+00   6.0526700e+00   6.9098400e+00   7.6005000e+00   7.9492200e+00   8.3483300e+00   8.7293800e+00   9.0339400e+00   9.4362100e+00   9.6398500e+00   9.9709800e+00   1.0281300e+01   1.0540400e+01   1.0808400e+01];
ar3=-699.132+[7.7023900e-02  -1.8292300e+00  -2.2181500e+00  -2.6453200e+00  -2.9536800e+00  -3.4507100e+00  -3.8380100e+00  -4.2663200e+00  -4.6551600e+00  -5.0862600e+00  -5.4390700e+00  -5.6255400e+00  -5.8432600e+00  -6.0592200e+00  -6.2332200e+00  -6.4627300e+00  -6.5806400e+00  -6.7735200e+00  -6.9553800e+00  -7.1074200e+00  -7.2668300e+00];
% 17116
as1=16.2684+[-4.5758100e-01   9.0385500e-01   1.5145700e+00   2.1036500e+00   2.4863400e+00   3.0593900e+00   3.4742900e+00   3.8919100e+00   4.2419500e+00   4.5969800e+00   4.8554900e+00   4.9847700e+00   5.1499000e+00   5.3118200e+00   5.4397300e+00   5.6020800e+00   5.6846200e+00   5.8201200e+00   5.9457500e+00   6.0465100e+00   6.1498200e+00];
as2=449.981+[1.9827400e+00   1.2873900e+00   1.5060100e+00   2.1553700e+00   2.7960600e+00   3.9751500e+00   4.9078900e+00   5.8933300e+00   6.7499000e+00   7.6737700e+00   8.4183400e+00   8.7948100e+00   9.2248500e+00   9.6353100e+00   9.9629800e+00   1.0394900e+01   1.0613100e+01   1.0966900e+01   1.1298100e+01   1.1574200e+01   1.1859900e+01];
as3=-696.273+[-9.3101500e-02  -2.0474500e+00  -2.4877900e+00  -2.9971500e+00  -3.3754300e+00  -3.9922900e+00  -4.4740500e+00  -5.0043300e+00  -5.4840700e+00  -6.0167000e+00  -6.4543100e+00  -6.6857300e+00  -6.9563600e+00  -7.2239400e+00  -7.4395700e+00  -7.7241500e+00  -7.8701000e+00  -8.1084000e+00  -8.3327100e+00  -8.5201300e+00  -8.7164500e+00];
% 14886
at1=9.91704+[-3.8613900e-01   1.4604300e+00   2.3363300e+00   3.1745800e+00   3.7148900e+00   4.5205000e+00   5.0992200e+00   5.6858200e+00   6.1775600e+00   6.6764600e+00   7.0511200e+00   7.2410900e+00   7.4711800e+00   7.6991800e+00   7.8805400e+00   8.1115300e+00   8.2257100e+00   8.4133000e+00   8.5879700e+00   8.7285000e+00   8.8716000e+00];
at2=444.847+[2.4369800e+00   1.3711100e+00   1.4611900e+00   2.0630400e+00   2.7081900e+00   3.9245600e+00   4.8999700e+00   5.9394600e+00   6.8515600e+00   7.8519400e+00   8.6663600e+00   9.0819600e+00   9.5655700e+00   1.0026400e+01   1.0393900e+01   1.0878800e+01   1.1125200e+01   1.1524800e+01   1.1898100e+01   1.2209000e+01   1.2530500e+01];
at3=-691.954+[6.2514600e-02  -1.9770000e+00  -2.3519300e+00  -2.7595500e+00  -3.0506400e+00  -3.5197200e+00  -3.8858600e+00  -4.2945600e+00  -4.6703600e+00  -5.0947400e+00  -5.4491600e+00  -5.6402700e+00  -5.8683100e+00  -6.0960500e+00  -6.2799600e+00  -6.5229300e+00  -6.6474800e+00  -6.8515000e+00  -7.0440100e+00  -7.2050500e+00  -7.3740200e+00];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5P
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 1297
au1=12.7746+[3.1852000e-01   3.5404200e-01   4.6225100e-01   6.0486900e-01   6.7954000e-01   8.7054600e-01   1.0313800e+00   1.2186100e+00   1.4492700e+00   1.6626500e+00   1.9659600e+00   2.2020600e+00   2.5313400e+00   2.7858200e+00   3.0038900e+00   3.4148200e+00   3.7018000e+00   3.9464700e+00   4.3042100e+00   4.5242900e+00   4.8154100e+00];
au2=447.736+[2.6057600e+00   2.5981200e+00   2.6465600e+00   2.7251500e+00   2.7696400e+00   2.8886100e+00   2.9930100e+00   3.1213800e+00   3.2823000e+00   3.4317500e+00   3.6424600e+00   3.8060900e+00   4.0377900e+00   4.2200200e+00   4.3789300e+00   4.6878700e+00   4.9114600e+00   5.1074900e+00   5.4041000e+00   5.5917200e+00   5.8491600e+00];
au3=-690.116+[-1.7472500e+00  -1.8215700e+00  -1.9761900e+00  -2.1508800e+00  -2.2366200e+00  -2.4438600e+00  -2.6088800e+00  -2.7973900e+00  -3.0196400e+00  -3.2155300e+00  -3.4810500e+00  -3.6765900e+00  -3.9429600e+00  -4.1451400e+00  -4.3151500e+00  -4.6318500e+00  -4.8506700e+00  -5.0366000e+00  -5.3083900e+00  -5.4760000e+00  -5.6991100e+00];
% 16439
av1=13.5613+[1.4615900e-01   1.6817100e-01   2.2012000e-01   2.8843100e-01   3.2526400e-01   4.2232500e-01   5.0836800e-01   6.1756000e-01   7.6183700e-01   9.0581100e-01   1.1225400e+00   1.2975400e+00   1.5489200e+00   1.7478600e+00   1.9199700e+00   2.2491600e+00   2.4831700e+00   2.6850700e+00   2.9821700e+00   3.1649600e+00   3.4066100e+00];
av2=447.206+[1.8708400e+00   1.8450800e+00   1.8565900e+00   1.8992500e+00   1.9268800e+00   2.0088000e+00   2.0847600e+00   2.1792900e+00   2.2978000e+00   2.4049400e+00   2.5581100e+00   2.6789700e+00   2.8513600e+00   2.9900800e+00   3.1131400e+00   3.3572000e+00   3.5358800e+00   3.6942900e+00   3.9371700e+00   4.0928100e+00   4.3083400e+00];
av3=-699.132+[-1.4334300e+00  -1.4740000e+00  -1.5696700e+00  -1.6859700e+00  -1.7448000e+00  -1.8904600e+00  -2.0090300e+00  -2.1455500e+00  -2.3084200e+00  -2.4533300e+00  -2.6534200e+00  -2.8036800e+00  -3.0114500e+00  -3.1720300e+00  -3.3088400e+00  -3.5664900e+00  -3.7454000e+00  -3.8984600e+00  -4.1237600e+00  -4.2635200e+00  -4.4504200e+00];
% 17116
aw1=16.2684+[1.3041600e-01   1.5685100e-01   2.1587500e-01   2.8977000e-01   3.2867700e-01   4.2886900e-01   5.1579400e-01   6.2463500e-01   7.6696400e-01   9.0840100e-01   1.1206100e+00   1.2917000e+00   1.5371800e+00   1.7311600e+00   1.8988300e+00   2.2190200e+00   2.4464900e+00   2.6428300e+00   2.9319100e+00   3.1098700e+00   3.3452400e+00];
aw2=449.981+[2.0970500e+00   2.0707600e+00   2.0889900e+00   2.1432400e+00   2.1774100e+00   2.2774700e+00   2.3695100e+00   2.4835400e+00   2.6264000e+00   2.7555700e+00   2.9396900e+00   3.0841200e+00   3.2887200e+00   3.4520500e+00   3.5958300e+00   3.8784700e+00   4.0834800e+00   4.2639500e+00   4.5384400e+00   4.7131700e+00   4.9536400e+00];
aw3=-696.273+[-1.6551300e+00  -1.6996500e+00  -1.8104000e+00  -1.9460500e+00  -2.0147400e+00  -2.1852100e+00  -2.3240400e+00  -2.4838400e+00  -2.6746400e+00  -2.8444700e+00  -3.0792700e+00  -3.2560200e+00  -3.5001700e+00  -3.6887000e+00  -3.8492100e+00  -4.1513500e+00  -4.3610600e+00  -4.5403800e+00  -4.8042300e+00  -4.9678500e+00  -5.1866200e+00];
% 14886
ax1=9.91704+[3.7090600e-01   4.0506200e-01   5.1597600e-01   6.6537500e-01   7.4442600e-01   9.4833500e-01   1.1214100e+00   1.3244300e+00   1.5752900e+00   1.8074300e+00   2.1369200e+00   2.3930400e+00   2.7503600e+00   3.0264400e+00   3.2628400e+00   3.7082900e+00   4.0192400e+00   4.2841300e+00   4.6710000e+00   4.9087000e+00   5.2228300e+00];
ax2=444.847+[2.4504300e+00   2.4366700e+00   2.4652000e+00   2.5183400e+00   2.5496900e+00   2.6357200e+00   2.7130500e+00   2.8100000e+00   2.9337700e+00   3.0506000e+00   3.2180800e+00   3.3503500e+00   3.5402900e+00   3.6917800e+00   3.8255000e+00   4.0891200e+00   4.2826000e+00   4.4539300e+00   4.7160500e+00   4.8833700e+00   5.1148800e+00];
ax3=-691.954+[-1.5725900e+00  -1.6344400e+00  -1.7579800e+00  -1.8970400e+00  -1.9653400e+00  -2.1308300e+00  -2.2629500e+00  -2.4144400e+00  -2.5933500e+00  -2.7509900e+00  -2.9651200e+00  -3.1229800e+00  -3.3384900e+00  -3.5025700e+00  -3.6409500e+00  -3.8998300e+00  -4.0792800e+00  -4.2321800e+00  -4.4565000e+00  -4.5953400e+00  -4.7806800e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5P
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 1297
ay1=12.7746+[-4.3481100e-01   6.8641300e-01   1.3843700e+00   2.2070600e+00   2.7986600e+00   3.4836700e+00   4.0507600e+00   4.6108600e+00   5.1633900e+00   5.6555000e+00   6.1652400e+00   6.5704500e+00   6.8583700e+00   7.1393600e+00   7.3168800e+00   7.5346600e+00   7.6600000e+00   7.8238000e+00   7.9668100e+00   8.1108300e+00   8.2447100e+00];
ay2=447.736+[2.5760400e+00   2.1744400e+00   2.1975500e+00   2.3824200e+00   2.6580000e+00   3.1871000e+00   3.8059000e+00   4.5835400e+00   5.4995100e+00   6.4381800e+00   7.5201300e+00   8.4662100e+00   9.2430800e+00   1.0048700e+01   1.0549900e+01   1.1163100e+01   1.1527600e+01   1.1993500e+01   1.2382200e+01   1.2772800e+01   1.3141300e+01];
ay3=-690.116+[-9.1370300e-02  -2.0257800e+00  -2.3811400e+00  -2.8262900e+00  -3.1713800e+00  -3.6144700e+00  -4.0132300e+00  -4.4416500e+00  -4.9101000e+00  -5.3773000e+00  -5.9140800e+00  -6.3809700e+00  -6.7610300e+00  -7.1546800e+00  -7.4110600e+00  -7.7391900e+00  -7.9395200e+00  -8.2048700e+00  -8.4337100e+00  -8.6676700e+00  -8.8916100e+00];
% 16439
az1=13.5613+[-4.2095300e-01   3.5764500e-01   8.5540000e-01   1.4597700e+00   1.9032500e+00   2.4252300e+00   2.8635100e+00   3.3015200e+00   3.7379600e+00   4.1318400e+00   4.5417700e+00   4.8704600e+00   5.1078400e+00   5.3439100e+00   5.4927900e+00   5.6753200e+00   5.7826600e+00   5.9229200e+00   6.0449900e+00   6.1684300e+00   6.2845100e+00];
az2=447.206+[1.7840500e+00   1.5160100e+00   1.5667600e+00   1.7487000e+00   1.9854900e+00   2.4251100e+00   2.9381600e+00   3.5831900e+00   4.3421100e+00   5.1148200e+00   6.0051300e+00   6.7799100e+00   7.4078200e+00   8.0495500e+00   8.4483500e+00   8.9363600e+00   9.2256900e+00   9.5956500e+00   9.9052700e+00   1.0217500e+01   1.0513000e+01];
az3=-699.132+[7.5821900e-02  -1.6567900e+00  -1.9734600e+00  -2.3577200e+00  -2.6483200e+00  -3.0142200e+00  -3.3404600e+00  -3.6909500e+00  -4.0739200e+00  -4.4541600e+00  -4.8909700e+00  -5.2674200e+00  -5.5672400e+00  -5.8673000e+00  -6.0609200e+00  -6.3070400e+00  -6.4567800e+00  -6.6551400e+00  -6.8265500e+00  -7.0020100e+00  -7.1702200e+00];
% 17116
ba1=16.2684+[-4.5755800e-01   3.4926200e-01   8.5030700e-01   1.4534400e+00   1.8943900e+00   2.4114500e+00   2.8433700e+00   3.2726600e+00   3.6989700e+00   4.0817500e+00   4.4782500e+00   4.7953500e+00   5.0215800e+00   5.2472700e+00   5.3894900e+00   5.5632900e+00   5.6651500e+00   5.7981700e+00   5.9141400e+00   6.0312000e+00   6.1413400e+00];
ba2=449.981+[1.9828700e+00   1.7413600e+00   1.8260600e+00   2.0538200e+00   2.3299500e+00   2.8251200e+00   3.3921300e+00   4.0979800e+00   4.9228600e+00   5.7596600e+00   6.7206300e+00   7.5541900e+00   8.2294300e+00   8.9176800e+00   9.3449500e+00   9.8675500e+00   1.0177200e+01   1.0572800e+01   1.0903500e+01   1.1236600e+01   1.1551400e+01];
ba3=-696.273+[-9.4209400e-02  -1.8850400e+00  -2.2443200e+00  -2.6819500e+00  -3.0185000e+00  -3.4503000e+00  -3.8418000e+00  -4.2678300e+00  -4.7368000e+00  -5.2043700e+00  -5.7426800e+00  -6.2091500e+00  -6.5835000e+00  -6.9620600e+00  -7.2057000e+00  -7.5142400e+00  -7.7015600e+00  -7.9487000e+00  -8.1614100e+00  -8.3786500e+00  -8.5869100e+00];
% 14886
bb1=9.91704+[-3.8609900e-01   7.5530700e-01   1.4794500e+00   2.3381100e+00   2.9572500e+00   3.6775500e+00   4.2768100e+00   4.8718700e+00   5.4614300e+00   5.9899500e+00   6.5409500e+00   6.9808100e+00   7.2986500e+00   7.6096000e+00   7.8069000e+00   8.0508300e+00   8.1925000e+00   8.3779800e+00   8.5395800e+00   8.7027000e+00   8.8545300e+00];
bb2=444.847+[2.4370000e+00   1.9890100e+00   1.9588500e+00   2.0776400e+00   2.3025600e+00   2.7668600e+00   3.3280600e+00   4.0454400e+00   4.8999100e+00   5.7816100e+00   6.8036400e+00   7.7022800e+00   8.4416500e+00   9.2112200e+00   9.6903400e+00   1.0276600e+01   1.0625400e+01   1.1071500e+01   1.1444100e+01   1.1819200e+01   1.2173700e+01];
bb3=-691.954+[6.1123100e-02  -1.8250000e+00  -2.1239500e+00  -2.4992700e+00  -2.7858900e+00  -3.1470800e+00  -3.4668700e+00  -3.8060100e+00  -4.1745800e+00  -4.5410700e+00  -4.9625400e+00  -5.3278300e+00  -5.6225400e+00  -5.9245100e+00  -6.1222200e+00  -6.3767600e+00  -6.5324800e+00  -6.7398100e+00  -6.9196900e+00  -7.1043400e+00  -7.2815400e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 1297
bc1=12.7746+[3.8812000e-01   4.3908100e-01   5.8159100e-01   7.4277600e-01   9.6541900e-01   1.0751400e+00   1.3788900e+00   1.5656900e+00   1.8106100e+00   2.0996500e+00   2.3820000e+00   2.7056400e+00   2.9988400e+00   3.4124200e+00   3.6456800e+00   4.0670900e+00   4.3412800e+00   4.6885600e+00   5.0043500e+00   5.4796600e+00   5.6436600e+00];
bc2=447.736+[2.8364000e+00   2.8210600e+00   2.8662100e+00   2.9359200e+00   3.0413300e+00   3.0978400e+00   3.2641800e+00   3.3696000e+00   3.5150500e+00   3.6906900e+00   3.8695400e+00   4.0794500e+00   4.2754000e+00   4.5664400e+00   4.7393600e+00   5.0709700e+00   5.2974700e+00   5.5982700e+00   5.8846000e+00   6.3429900e+00   6.5091600e+00];
bc3=-690.116+[-1.3218300e+00  -1.4033400e+00  -1.5754000e+00  -1.7423200e+00  -1.9601400e+00  -2.0642200e+00  -2.3436200e+00  -2.5096100e+00  -2.7249700e+00  -2.9725700e+00  -3.2106300e+00  -3.4755200e+00  -3.7088300e+00  -4.0316700e+00  -4.2139000e+00  -4.5429600e+00  -4.7598300e+00  -5.0364400e+00  -5.2877500e+00  -5.6698700e+00  -5.8037500e+00];
% 16439
bd1=13.5613+[2.2240800e-01   2.5325800e-01   3.3036300e-01   4.1974000e-01   5.4508100e-01   6.0881500e-01   7.9485000e-01   9.1296300e-01   1.0790300e+00   1.2825300e+00   1.4898100e+00   1.7336600e+00   1.9589400e+00   2.2854500e+00   2.4729000e+00   2.8132300e+00   3.0361600e+00   3.3204700e+00   3.5808000e+00   3.9736800e+00   4.1091500e+00];
bd2=447.206+[2.0702900e+00   2.0370300e+00   2.0469400e+00   2.0900500e+00   2.1647400e+00   2.2067600e+00   2.3318200e+00   2.4110000e+00   2.5175000e+00   2.6474900e+00   2.7773900e+00   2.9317700e+00   3.0798800e+00   3.3024300e+00   3.4371800e+00   3.7026400e+00   3.8863200e+00   4.1320900e+00   4.3685100e+00   4.7526300e+00   4.8926900e+00];
bd3=-699.132+[-1.1512300e+00  -1.1979500e+00  -1.3099800e+00  -1.4282200e+00  -1.5867000e+00  -1.6634500e+00  -1.8707200e+00  -1.9942600e+00  -2.1547500e+00  -2.3416500e+00  -2.5217900e+00  -2.7249200e+00  -2.9068200e+00  -3.1609600e+00  -3.3060300e+00  -3.5725100e+00  -3.7499600e+00  -3.9766900e+00  -4.1835100e+00  -4.5000700e+00  -4.6113400e+00];
% 17116
be1=16.2684+[2.0733300e-01   2.4290400e-01   3.2725700e-01   4.2119600e-01   5.5030300e-01   6.1481600e-01   8.0087800e-01   9.1781100e-01   1.0819400e+00   1.2825300e+00   1.4864000e+00   1.7258300e+00   1.9465900e+00   2.2665100e+00   2.4499100e+00   2.7826700e+00   3.0004700e+00   3.2783700e+00   3.5332500e+00   3.9183000e+00   4.0510200e+00];
be2=449.981+[2.3181800e+00   2.2847500e+00   2.3028600e+00   2.3578200e+00   2.4503300e+00   2.5017600e+00   2.6537400e+00   2.7497500e+00   2.8784500e+00   3.0347600e+00   3.1902000e+00   3.3734100e+00   3.5474500e+00   3.8056200e+00   3.9604000e+00   4.2621100e+00   4.4693800e+00   4.7447100e+00   5.0072900e+00   5.4301900e+00   5.5837000e+00];
be3=-696.273+[-1.3985200e+00  -1.4499300e+00  -1.5791100e+00  -1.7161400e+00  -1.8999500e+00  -1.9889200e+00  -2.2293000e+00  -2.3726700e+00  -2.5592000e+00  -2.7769200e+00  -2.9869700e+00  -3.2240300e+00  -3.4365100e+00  -3.7332900e+00  -3.9025200e+00  -4.2135800e+00  -4.4206100e+00  -4.6854300e+00  -4.9271500e+00  -5.2975600e+00  -5.4279500e+00];
% 14886
bf1=9.91704+[4.3791600e-01   4.8814400e-01   6.3500300e-01   8.0412400e-01   1.0399300e+00   1.1570700e+00   1.4828000e+00   1.6835100e+00   1.9472400e+00   2.2583300e+00   2.5624100e+00   2.9108500e+00   3.2264000e+00   3.6717400e+00   3.9231300e+00   4.3768900e+00   4.6722800e+00   5.0460900e+00   5.3853100e+00   5.8951600e+00   6.0711900e+00];
bf2=444.847+[2.6550600e+00   2.6328000e+00   2.6560800e+00   2.7019100e+00   2.7748800e+00   2.8154400e+00   2.9386200e+00   3.0185500e+00   3.1312500e+00   3.2701900e+00   3.4144200e+00   3.5866600e+00   3.7502400e+00   3.9976400e+00   4.1467000e+00   4.4371200e+00   4.6376300e+00   4.9067000e+00   5.1656500e+00   5.5848800e+00   5.7377900e+00];
bf3=-691.954+[-1.0947100e+00  -1.1628100e+00  -1.3013600e+00  -1.4359600e+00  -1.6123500e+00  -1.6970400e+00  -1.9251600e+00  -2.0610300e+00  -2.2375000e+00  -2.4407800e+00  -2.6361600e+00  -2.8538800e+00  -3.0460900e+00  -3.3126200e+00  -3.4634300e+00  -3.7366400e+00  -3.9172500e+00  -4.1478500e+00  -4.3576900e+00  -4.6772700e+00  -4.7891600e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5P
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 1297
bg1=12.7746+[-2.9740500e-01   2.9987600e-01   1.3067500e+00   1.7643100e+00   2.5422000e+00   3.2153200e+00   3.6970800e+00   4.2246200e+00   4.7796600e+00   5.2931000e+00   5.7020500e+00   6.2635200e+00   6.5601400e+00   7.0063400e+00   7.2458500e+00   7.5110600e+00   7.6847300e+00   7.8570600e+00   8.0138600e+00   8.1465800e+00   8.2517300e+00];
bg2=447.736+[2.7438700e+00   2.5951700e+00   2.5969700e+00   2.6856700e+00   2.9483000e+00   3.3243200e+00   3.7034500e+00   4.2446500e+00   4.9776800e+00   5.7749300e+00   6.4873800e+00   7.5791800e+00   8.2015600e+00   9.2317900e+00   9.8809500e+00   1.0672700e+01   1.1216800e+01   1.1774600e+01   1.2278900e+01   1.2684600e+01   1.2992000e+01];
bg3=-690.116+[-7.2232400e-01  -1.3874400e+00  -1.9243800e+00  -2.1815500e+00  -2.6405700e+00  -3.0685300e+00  -3.3977800e+00  -3.7883000e+00  -4.2367600e+00  -4.6886700e+00  -5.0806200e+00  -5.6674800e+00  -6.0008800e+00  -6.5487800e+00  -6.8868200e+00  -7.2934200e+00  -7.5814800e+00  -7.8876400e+00  -8.1773300e+00  -8.4195200e+00  -8.6086500e+00];
% 16439
bh1=13.5613+[-2.9872300e-01   1.1133300e-01   8.2686800e-01   1.1586000e+00   1.7333000e+00   2.2413100e+00   2.6080500e+00   3.0154000e+00   3.4494400e+00   3.8549500e+00   4.1806300e+00   4.6317900e+00   4.8734800e+00   5.2398900e+00   5.4358100e+00   5.6565100e+00   5.8029500e+00   5.9497300e+00   6.0844900e+00   6.1981000e+00   6.2874700e+00];
bh2=447.206+[2.0430200e+00   1.8502000e+00   1.8906700e+00   1.9791700e+00   2.2112900e+00   2.5251400e+00   2.8378200e+00   3.2822200e+00   3.8867000e+00   4.5444400e+00   5.1303000e+00   6.0311500e+00   6.5424500e+00   7.3827400e+00   7.9081500e+00   8.5412000e+00   8.9754400e+00   9.4197300e+00   9.8217300e+00   1.0146400e+01   1.0393100e+01];
bh3=-699.132+[-5.8657500e-01  -1.1751500e+00  -1.6502100e+00  -1.8724900e+00  -2.2622400e+00  -2.6181200e+00  -2.8880900e+00  -3.2056200e+00  -3.5681400e+00  -3.9339400e+00  -4.2511300e+00  -4.7278700e+00  -4.9976900e+00  -5.4361500e+00  -5.7017300e+00  -6.0109500e+00  -6.2272500e+00  -6.4553900e+00  -6.6707200e+00  -6.8506800e+00  -6.9916200e+00];
% 17116
bi1=16.2684+[-3.2813800e-01   9.8938600e-02   8.2280600e-01   1.1552100e+00   1.7283100e+00   2.2331200e+00   2.5964300e+00   2.9987400e+00   3.4248200e+00   3.8209600e+00   4.1384200e+00   4.5751900e+00   4.8094100e+00   5.1629300e+00   5.3491300e+00   5.5596000e+00   5.6988500e+00   5.8375600e+00   5.9644900e+00   6.0716000e+00   6.1559400e+00];
bi2=449.981+[2.2464200e+00   2.0857300e+00   2.1722300e+00   2.2857900e+00   2.5656700e+00   2.9266500e+00   3.2774600e+00   3.7693000e+00   4.4309000e+00   5.1465600e+00   5.7812300e+00   6.7537700e+00   7.3037400e+00   8.2056400e+00   8.7693500e+00   9.4460800e+00   9.9094500e+00   1.0383500e+01   1.0812200e+01   1.1158100e+01   1.1420800e+01];
bi3=-696.273+[-7.6833000e-01  -1.4109000e+00  -1.9484300e+00  -2.2016200e+00  -2.6490300e+00  -3.0623400e+00  -3.3796100e+00  -3.7572400e+00  -4.1933600e+00  -4.6363000e+00  -5.0215700e+00  -5.6016400e+00  -5.9310100e+00  -6.4687400e+00  -6.7975300e+00  -7.1842400e+00  -7.4544100e+00  -7.7388200e+00  -8.0059900e+00  -8.2283300e+00  -8.4020000e+00];
% 14886
bk1=9.91704+[-2.5342700e-01   3.5233800e-01   1.3952400e+00   1.8725000e+00   2.6864200e+00   3.3928400e+00   3.8999100e+00   4.4576100e+00   5.0478700e+00   5.5969300e+00   6.0356700e+00   6.6423000e+00   6.9633000e+00   7.4491700e+00   7.7144200e+00   8.0090600e+00   8.2037200e+00   8.3992900e+00   8.5787600e+00   8.7305500e+00   8.8504500e+00];
bk2=444.847+[2.6061700e+00   2.4110200e+00   2.3365500e+00   2.3882600e+00   2.5861300e+00   2.9037100e+00   3.2390000e+00   3.7291600e+00   4.4051400e+00   5.1478000e+00   5.8163900e+00   6.8469200e+00   7.4376600e+00   8.4194500e+00   9.0397200e+00   9.7995000e+00   1.0322500e+01   1.0858600e+01   1.1343400e+01   1.1733700e+01   1.2029700e+01];
bk3=-691.954+[-5.6563500e-01  -1.1607600e+00  -1.6123100e+00  -1.8287000e+00  -2.2135500e+00  -2.5691300e+00  -2.8397900e+00  -3.1573400e+00  -3.5183000e+00  -3.8802300e+00  -4.1935900e+00  -4.6632600e+00  -4.9296500e+00  -5.3657400e+00  -5.6326000e+00  -5.9503300e+00  -6.1760700e+00  -6.4168700e+00  -6.6460100e+00  -6.8386500e+00  -6.9898100e+00];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (5P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (5P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')