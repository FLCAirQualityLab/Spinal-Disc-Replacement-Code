%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under lateral bending (4P)
% 20212,40296,25651,42160
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 20212,40296,25651,42160
%% model15_intact_TLC_4P
t15=[2 2.0575 2.1025 2.16719 2.21465 2.2716 2.32233 2.35879 2.40155 2.47973 2.51017 2.56326 2.61022 2.66193 2.70424 2.75779 2.80445 2.8546 2.90442 2.95797 3];

% 20212
aa1=-10.8616+[0.237303 0.373022 0.399638 0.399863 0.407714 0.434759 0.462671 0.482245 0.50245 0.535055 0.547319 0.567884 0.58495 0.602787 0.617239 0.636195 0.653003 0.670132 0.6864 0.702957 0.715249];
aa2=446.379+[0.413703 -0.524301 -1.35042 -2.29845 -2.81362 -3.36507 -3.82917 -4.15326 -4.5292 -5.20109 -5.45858 -5.89974 -6.27943 -6.68663 -7.01262 -7.41548 -7.75847 -8.11815 -8.46786 -8.83491 -9.11695];
aa3=-704.985+[-0.501412 -0.40666 -0.38423 -0.413129 -0.450436 -0.498693 -0.544735 -0.580954 -0.627635 -0.720908 -0.760289 -0.83154 -0.896065 -0.969269 -1.03076 -1.11039 -1.1815 -1.2596 -1.33874 -1.42493 -1.49327];

% 40296
ab1=-12.2381+[0.123435 0.209877 0.231537 0.231921 0.235739 0.253765 0.271759 0.284035 0.296279 0.315191 0.322181 0.333705 0.343128 0.352521 0.359945 0.370472 0.380544 0.391058 0.401007 0.411237 0.418933];
ab2=446.122+[0.252332 -0.318714 -0.831501 -1.41101 -1.72416 -2.05881 -2.34303 -2.54226 -2.77349 -3.18799 -3.34632 -3.61709 -3.84985 -4.10037 -4.30094 -4.54903 -4.76087 -4.98327 -5.19987 -5.4276 -5.60278];
ab3=-714.556+[-0.468917 -0.415245 -0.406705 -0.439929 -0.473086 -0.51023 -0.544564 -0.571506 -0.605511 -0.670207 -0.695854 -0.740994 -0.781211 -0.826063 -0.863031 -0.909983 -0.951068 -0.995478 -1.0401 -1.0883 -1.12616 ];

% 25651
ac1=-9.36067+[0.270513 0.404759 0.426468 0.420666 0.424779 0.447638 0.47152 0.487985 0.50465 0.531675 0.542026 0.559358 0.573658 0.588331 0.600324 0.616586 0.631174 0.645901 0.659773 0.673837 0.684205];
ac2=443.597+[0.404337 -0.484374 -1.26999 -2.16849 -2.65459 -3.17256 -3.60705 -3.90977 -4.26017 -4.88403 -5.12234 -5.52985 -5.87966 -6.25406 -6.5532 -6.92191 -7.23515 -7.56303 -7.8812 -8.21443 -8.47];
ac3=-706.266+[-0.440591 -0.454121 -0.517294 -0.642809 -0.733488 -0.840283 -0.936148 -1.00731 -1.0943 -1.25914 -1.32571 -1.44315 -1.54718 -1.66241 -1.75715 -1.87748 -1.98285 -2.09653 -2.20992 -2.33168 -2.42707];

% 42160
ad1=-14.6392+[0.138744 0.237531 0.262067 0.26663 0.274391 0.298056 0.320883 0.33639 0.3522 0.37659 0.385534 0.400652 0.413211 0.426053 0.436236 0.450256 0.463357 0.47698 0.489905 0.503164 0.513132 ];
ad2=448.856+[0.338222 -0.336946 -0.948024 -1.63376 -2.00167 -2.39703 -2.73398 -2.97065 -3.24585 -3.74089 -3.93045 -4.25507 -4.53465 -4.83592 -5.07744 -5.37669 -5.63252 -5.90144 -6.16371 -6.43984 -6.65247];
ad3=-710.316+[-0.51616 -0.386854 -0.315276 -0.283485 -0.283557 -0.284429 -0.288169 -0.293984 -0.303819 -0.326228 -0.336052 -0.354422 -0.371993 -0.392939 -0.411118 -0.435195 -0.457129 -0.481869 -0.507743 -0.536695 -0.560084];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4P
t1=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.32627 2.36846 2.42783 2.4542 2.50615 2.55076 2.60453 2.65273 2.70062 2.75176 2.80444 2.85837 2.91342 2.96196 3];
% 20212
ae1=-10.8616+[-0.322039 -0.200573 -0.0640623 0.0352207 0.148162 0.225047 0.318805 0.370112 0.433864 0.45833 0.50106 0.534422 0.571028 0.600351 0.6267 0.651609 0.674524 0.696114 0.716586 0.733915 0.746814 ];
ae2=446.379+[1.21324 0.881872 0.39794 -0.0989858 -0.759104 -1.29742 -2.11119 -2.68325 -3.45149 -3.779 -4.40147 -4.91077 -5.50471 -6.01843 -6.51327 -7.0248 -7.53438 -8.038 -8.5324 -8.9539 -9.27473];
ae3=-704.985+[-0.790441 -0.938589 -0.762129 -0.659391 -0.561778 -0.525673 -0.501901 -0.511869 -0.552526 -0.577365 -0.635606 -0.692708 -0.768361 -0.841274 -0.917884 -1.00495 -1.09933 -1.19931 -1.30319 -1.39599 -1.46917];

% 40296
af1=-12.2381+[-0.296706 -0.245215 -0.190559 -0.137334 -0.0711264 -0.018774 0.0463892 0.081002 0.125084 0.14275 0.17414 0.198935 0.227377 0.249738 0.26946 0.287859 0.304437 0.319805 0.3342 0.346359 0.355431];
af2=446.122+[0.803328 0.574477 0.495649 0.262997 -0.0853533 -0.411961 -0.925648 -1.27721 -1.74122 -1.9374 -2.30944 -2.61313 -2.96704 -3.27424 -3.57039 -3.87641 -4.18114 -4.48168 -4.77543 -5.02542 -5.21504];
af3=-714.556+[-0.751604 -0.924632 -0.904038 -0.851117 -0.791715 -0.773648 -0.762322 -0.775089 -0.809802 -0.828818 -0.871008 -0.910067 -0.95928 -1.00566 -1.05309 -1.10603 -1.16236 -1.22087 -1.2804 -1.33254 -1.37297];

% 25651
ag1=-9.36067+[-0.292646 -0.16759 -0.0273141 0.0731991 0.184611 0.259857 0.352774 0.402856 0.463042 0.485607 0.524045 0.553197 0.585031 0.610077 0.63211 0.652507 0.670936 0.688127 0.704306 0.718127 0.728453];
ag2=443.677+[1.15065 0.840313 0.410663 -0.0449739 -0.656001 -1.16059 -1.92339 -2.45783 -3.17405 -3.47882 -4.05738 -4.53001 -5.08003 -5.5548 -6.01132 -6.48232 -6.95054 -7.41221 -7.86429 -8.24881 -8.54087];
ag3=-706.563+[-0.648179 -0.832681 -0.748448 -0.713023 -0.693523 -0.7088 -0.757476 -0.818682 -0.928238 -0.98228 -1.09549 -1.19712 -1.32389 -1.44043 -1.55853 -1.68791 -1.82386 -1.9644 -2.10765 -2.23357 -2.33172];

% 42160
ah1=-14.6392+[-0.323489 -0.259326 -0.197926 -0.138844 -0.0628706 -0.00447014 0.0662301 0.104886 0.156501 0.177577 0.215785 0.246671 0.281998 0.309878 0.334875 0.358571 0.380358 0.40076 0.419948 0.435981 0.447845];
ah2=448.856+[0.94052 0.663926 0.550801 0.253837 -0.178977 -0.562944 -1.16521 -1.57885 -2.12565 -2.35733 -2.79721 -3.157 -3.57709 -3.94246 -4.29533 -4.66086 -5.02552 -5.38601 -5.73914 -6.04019 -6.26893 ];
ah3=-710.316+[-0.858051 -0.99133 -0.943883 -0.845287 -0.72722 -0.671119 -0.605226 -0.581127 -0.56736 -0.56613 -0.570519 -0.579101 -0.593658 -0.610859 -0.630774 -0.655903 -0.685223 -0.717733 -0.752497 -0.784174 -0.809455 ];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4P
t2=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.46846 2.52783 2.57002 2.60127 2.65098 2.70667 2.75577 2.81523 2.85038 2.90628 2.96349 3];

% 20212
ai1=-10.8616+[-0.237609 -0.199674 -0.151258 -0.11562 -0.0705728 -0.036736 0.00579547 0.0499267 0.103868 0.143721 0.198915 0.235732 0.26295 0.306761 0.355593 0.397651 0.446551 0.474049 0.515344 0.554228 0.577396 ];
ai2=446.379+[1.42477 1.30394 1.11863 0.937305 0.673391 0.445053 0.132561 -0.218603 -0.67195 -1.03052 -1.56757 -1.98126 -2.29438 -2.8003 -3.3647 -3.86205 -4.46485 -4.82037 -5.38396 -5.95654 -6.31989];
ai3=-704.985+[-0.908536 -0.979464 -0.915427 -0.827808 -0.741994 -0.679855 -0.622473 -0.583996 -0.548903 -0.529056 -0.507153 -0.498834 -0.496679 -0.505805 -0.535633 -0.573182 -0.629575 -0.667783 -0.735924 -0.814742 -0.869379];

% 40296
aj1=-12.2381+[-0.2408 -0.229407 -0.221399 -0.219331 -0.204368 -0.190481 -0.167579 -0.139908 -0.105068 -0.0779238 -0.0396306 -0.0143811 0.00446934 0.0352937 0.0699038 0.0999377 0.135122 0.155 0.184706 0.212436 0.228661];
aj2=446.122+[0.873877 0.817401 0.851186 0.903801 0.864054 0.796896 0.673781 0.501108 0.254616 0.0465711 -0.271566 -0.522739 -0.713285 -1.01875 -1.3532 -1.64877 -2.00921 -2.22306 -2.56335 -2.91055 -3.13175  ];
aj3=-714.556+[-0.83035 -0.921804 -0.953083 -0.965112 -0.939694 -0.905471 -0.879589 -0.867355 -0.852315 -0.840128 -0.82331 -0.814956 -0.810721 -0.813484 -0.831739 -0.854823 -0.888202 -0.910093 -0.948545 -0.992237 -1.02232];

% 25651
ak1=-9.36067+[-0.206337 -0.166805 -0.115958 -0.0792029 -0.0322565 0.00139201 0.0450022 0.0903691 0.145159 0.185468 0.241364 0.278706 0.305992 0.348627 0.394413 0.433006 0.477232 0.50182 0.538341 0.572106 0.59195];
ak2=443.677+[1.3488 1.23874 1.08074 0.928175 0.696436 0.492043 0.208673 -0.11442 -0.533854 -0.866756 -1.36535 -1.74975 -2.04071 -2.51079 -3.03429 -3.49515 -4.05316 -4.38196 -4.90267 -5.43102 -5.76595];
ak3=-706.563+[-0.738806 -0.829135 -0.813635 -0.776492 -0.744211 -0.722006 -0.710168 -0.713817 -0.728298 -0.74483 -0.775405 -0.805552 -0.831973 -0.886889 -0.968181 -1.05043 -1.15983 -1.22867 -1.34446 -1.47062 -1.55472];

% 42160
al1=-14.6392+[-0.261043 -0.244742 -0.234148 -0.231221 -0.215373 -0.197707 -0.173274 -0.144136 -0.106533 -0.0772546 -0.0361817 -0.00933049 0.011297 0.0466111 0.0875696 0.123405 0.165569 0.189508 0.225585 0.259913 0.280272];
al2=448.856+[1.02138 0.947421 0.971663 1.01599 0.935576 0.829232 0.661282 0.448289 0.149609 -0.100432 -0.481637 -0.781075 -1.00745 -1.36906 -1.76605 -2.11723 -2.54582 -2.80021 -3.20508 -3.6183 -3.88156];
al3=-710.316+[-0.940231 -1.01688 -1.0402 -1.04604 -0.992242 -0.929801 -0.873843 -0.835158 -0.786203 -0.747431 -0.691991 -0.655218 -0.630041 -0.599858 -0.58183 -0.573548 -0.569788 -0.570262 -0.575616 -0.586614 -0.596522];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 20212
am1=-10.8616+[0.090966 0.108485 0.127803 0.141855 0.160875 0.177848 0.200073 0.223969 0.253738 0.267714 0.300519 0.333199 0.360199 0.378975 0.403302 0.436041 0.457165 0.485683 0.516419 0.547134 0.568231];
am2=446.379+[0.899489 0.848416 0.754179 0.654435 0.504762 0.363496 0.163786 -0.0671966 -0.373755 -0.522806 -0.893321 -1.29998 -1.67156 -1.95194 -2.33488 -2.83991 -3.16175 -3.596 -4.07427 -4.56813 -4.91913 ];
am3=-704.985+[-0.86313 -0.858544 -0.808053 -0.741606 -0.674674 -0.628691 -0.577981 -0.544885 -0.51552 -0.505078 -0.485308 -0.469655 -0.459941 -0.455024 -0.454691 -0.46726 -0.483884 -0.514355 -0.556295 -0.607273 -0.647614];
% 40296
an1=-12.2381+[-0.0539516 -0.0479491 -0.0504362 -0.0591741 -0.0603181 -0.0550708 -0.0453939 -0.031537 -0.0123052 -0.00290567 0.0196329 0.042323 0.0604806 0.0726447 0.0889795 0.11163 0.126532 0.146763 0.168764 0.190718 0.205799];
an2=446.122+[0.432532 0.435781 0.524018 0.628946 0.685052 0.682007 0.649662 0.576746 0.448484 0.377435 0.185618 -0.0352678 -0.244851 -0.405944 -0.627343 -0.921426 -1.10809 -1.35981 -1.63905 -1.92952 -2.13723];
an3=-714.556+[-0.79231 -0.810158 -0.841037 -0.866383 -0.866454 -0.848621 -0.826771 -0.822864 -0.818899 -0.816174 -0.808358 -0.799789 -0.792605 -0.78754 -0.784002 -0.78845 -0.79797 -0.815795 -0.839694 -0.868001 -0.889856];
% 25651
ao1=-9.36067+[0.130737 0.148601 0.168396 0.182211 0.201319 0.218019 0.240301 0.264863 0.295578 0.309827 0.343162 0.376518 0.404106 0.42313 0.447331 0.478593 0.498122 0.52396 0.551236 0.577996 0.596108];
ao2=443.677+[0.851766 0.807848 0.734338 0.657861 0.534753 0.413011 0.237967 0.0303594 -0.248551 -0.385121 -0.726013 -1.10076 -1.44363 -1.7025 -2.05642 -2.52384 -2.82157 -3.22292 -3.66466 -4.12049 -4.44425];
ao3=-706.563+[-0.739154 -0.747582 -0.734101 -0.708678 -0.686703 -0.673173 -0.661875 -0.664338 -0.675626 -0.683244 -0.705389 -0.733226 -0.76132 -0.784151 -0.820597 -0.880188 -0.926486 -0.996676 -1.08157 -1.17595 -1.24654];
% 42160
ap1=-14.6392+[-0.0493544 -0.0418456 -0.0441474 -0.0533437 -0.0549357 -0.0484281 -0.0381382 -0.0243478 -0.00492482 0.0050706 0.0290096 0.0528445 0.0716802 0.0844145 0.102613 0.129289 0.147169 0.17169 0.198573 0.225695 0.244516 ];
ap2=448.856+[0.511745 0.511128 0.599819 0.706866 0.741597 0.71012 0.639625 0.537468 0.371968 0.282949 0.0459701 -0.224414 -0.479293 -0.674585 -0.94109 -1.2926 -1.51537 -1.81625 -2.15034 -2.49779 -2.74608];
ap3=-710.316+[-0.841263 -0.855689 -0.886834 -0.913896 -0.899693 -0.86232 -0.815283 -0.792759 -0.765374 -0.751226 -0.715222 -0.676727 -0.643042 -0.618356 -0.588893 -0.560349 -0.549391 -0.539837 -0.53396 -0.532205 -0.53318];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4P
t4=[2 2.05816 2.10161 2.16188 2.20417 2.26497 2.3108 2.35767 2.41039 2.46048 2.50857 2.57039 2.61266 2.65395 2.70851 2.75122 2.8056 2.85917 2.91124 2.95071 3];
% 20212
aq1=-10.8616+[-0.401806 0.353096 0.481994 0.511291 0.52215 0.539243 0.554142 0.571632 0.600994 0.629223 0.653057 0.677046 0.692228 0.70698 0.72697 0.742009 0.759801 0.776783 0.794153 0.806885 0.822315];
aq2=446.379+[1.11968 -0.777732 -1.93667 -2.89544 -3.39431 -4.04082 -4.50238 -4.96479 -5.47279 -5.94678 -6.39077 -6.94211 -7.31059 -7.66441 -8.11598 -8.45892 -8.88438 -9.29242 -9.67817 -9.96459 -10.3168];
aq3=704.985+[0.123842 -0.573478 -0.489976 -0.520267 -0.555084 -0.612691 -0.660796 -0.714524 -0.778461 -0.843846 -0.911283 -1.0028 -1.06925 -1.13683 -1.22699 -1.29869 -1.39139 -1.48396 -1.5745 -1.64359 -1.73003];
% 40296
ar1=-12.2381+[-0.211763 0.0804726 0.160995 0.181074 0.187724 0.198631 0.209112 0.22255 0.244887 0.26607 0.283902 0.302472 0.314131 0.325112 0.338974 0.349252 0.361209 0.372416 0.384038 0.392447 0.402498];
ar2=446.122+[0.668103 -0.437567 -1.13174 -1.69544 -1.97881 -2.34285 -2.60278 -2.86363 -3.15186 -3.42262 -3.67696 -3.99205 -4.20336 -4.40743 -4.66762 -4.865 -5.10947 -5.34372 -5.56469 -5.72818 -5.92737];
ar3=-714.556+[0.114342 -0.714317 -0.675293 -0.726733 -0.768324 -0.825646 -0.867384 -0.909711 -0.955928 -1.00071 -1.04556 -1.10406 -1.14545 -1.18692 -1.24112 -1.28333 -1.33684 -1.38915 -1.43907 -1.47644 -1.52236];
% 25651
as1=-9.36067+[-0.36511 0.392077 0.515824 0.538171 0.545093 0.557041 0.568253 0.582121 0.607382 0.63172 0.652282 0.67337 0.686653 0.699459 0.716501 0.729322 0.744277 0.758543 0.773332 0.784165 0.797243];
as2=443.677+[1.04913 -0.71219 -1.79865 -2.69845 -3.16452 -3.76629 -4.19466 -4.62279 -5.09193 -5.52895 -5.93741 -6.44288 -6.78009 -7.10349 -7.51537 -7.82757 -8.21423 -8.58432 -8.93344 -9.19218 -9.50956];
as3=-706.563+[0.290135 -0.645017 -0.675805 -0.794023 -0.875267 -0.993402 -1.08452 -1.18101 -1.29169 -1.39996 -1.50687 -1.64662 -1.74478 -1.84244 -1.97093 -2.07139 -2.19935 -2.32527 -2.44699 -2.53899 -2.65347];
% 42160
at1=-14.6392+[-0.24874 0.103464 0.195049 0.220454 0.230342 0.246748 0.261548 0.279535 0.307655 0.334313 0.356573 0.379506 0.393965 0.407558 0.424959 0.437838 0.453031 0.467269 0.481803 0.492329 0.504951 ];
at2=448.856+[0.825379 -0.511776 -1.33453 -1.9978 -2.33289 -2.76556 -3.07548 -3.38705 -3.73222 -4.05687 -4.36254 -4.74267 -4.99808 -5.24507 -5.56077 -5.80062 -6.09797 -6.3832 -6.65268 -6.85222 -7.09557];
at3=-710.316+[-0.0104733 -0.65397 -0.531624 -0.524068 -0.535999 -0.554541 -0.568731 -0.583771 -0.599883 -0.617009 -0.636671 -0.664888 -0.686449 -0.709163 -0.739734 -0.764432 -0.796784 -0.829386 -0.861144 -0.885404 -0.915703];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4P
t5=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3];
% 20212
au1=-10.8616+[0.0660434 0.0824315 0.0998158 0.112241 0.12738 0.142694 0.172302 0.195818 0.210967 0.247696 0.264535 0.301476 0.317614 0.335931 0.361506 0.388378 0.424918 0.441293 0.473139 0.493857 0.5195];
au2=446.379+[0.900609 0.850934 0.759291 0.663367 0.539102 0.411884 0.146959 -0.0843377 -0.238907 -0.63942 -0.83187 -1.31135 -1.53814 -1.81317 -2.22894 -2.66046 -3.23942 -3.49894 -4.01484 -4.35947 -4.80177];
au3=-704.985+[-0.858817 -0.854468 -0.805004 -0.739085 -0.678088 -0.63027 -0.559215 -0.52828 -0.512202 -0.485046 -0.474411 -0.455145 -0.448306 -0.442035 -0.439238 -0.446897 -0.475361 -0.493257 -0.536585 -0.57041 -0.618921];
% 40296
av1=-12.2381+[-0.0560071 -0.0500892 -0.0523883 -0.0604418 -0.0624075 -0.0587277 -0.044978 -0.029558 -0.0192814 0.00713636 0.0190147 0.044334 0.0554122 0.0678831 0.0853582 0.104191 0.13023 0.141969 0.164999 0.179953 0.198455];
av2=446.122+[0.402313 0.405145 0.485551 0.585448 0.642089 0.655686 0.619602 0.541611 0.47922 0.284287 0.184513 -0.0774631 -0.204457 -0.360471 -0.599126 -0.849073 -1.18353 -1.33339 -1.6333 -1.83494 -2.09533];
av3=-714.556+[-0.792025 -0.809936 -0.840451 -0.865152 -0.869584 -0.856327 -0.826024 -0.822702 -0.820565 -0.813445 -0.8093 -0.800323 -0.795973 -0.790787 -0.786486 -0.789096 -0.806474 -0.817412 -0.843054 -0.86248 -0.889619];
% 25651
aw1=-9.36067+[0.107468 0.124209 0.142119 0.154233 0.168939 0.184072 0.21295 0.236873 0.252301 0.289345 0.306216 0.34331 0.359596 0.378057 0.403379 0.428938 0.462358 0.477006 0.504978 0.522871 0.544685];
aw2=443.677+[0.85269 0.810051 0.73862 0.665484 0.564355 0.457045 0.225813 0.0175086 -0.12275 -0.489977 -0.666922 -1.10883 -1.31799 -1.57172 -1.95576 -2.35499 -2.89038 -3.13012 -3.60645 -3.92446 -4.33238 ];
aw3=-706.563+[-0.73196 -0.740404 -0.727013 -0.701521 -0.680434 -0.665842 -0.649453 -0.653581 -0.658809 -0.680143 -0.691549 -0.723999 -0.740634 -0.762124 -0.7999 -0.848271 -0.930534 -0.972313 -1.06234 -1.12674 -1.21376];
% 42160
ax1=-14.6392+[-0.0511071 -0.043673 -0.0457401 -0.0541441 -0.0564951 -0.052744 -0.0374204 -0.0220847 -0.0118636 0.0158761 0.0283878 0.0546709 0.0661623 0.0792386 0.0984996 0.120631 0.151966 0.16625 0.194471 0.212976 0.236109];
ax2=448.856+[0.478028 0.476992 0.556527 0.657929 0.700687 0.688323 0.601495 0.494481 0.412958 0.169023 0.0455137 -0.275238 -0.429913 -0.619527 -0.907526 -1.20677 -1.60631 -1.78559 -2.14463 -2.38599 -2.69744];
ax3=-710.316+[-0.838366 -0.85285 -0.882708 -0.908667 -0.903901 -0.873311 -0.809112 -0.787406 -0.773306 -0.735282 -0.716453 -0.672225 -0.651672 -0.627085 -0.594443 -0.568675 -0.549195 -0.543809 -0.537351 -0.535746 -0.536476];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4P
t6=[2 2.06926 2.1039 2.16327 2.20546 2.25429 2.30079 2.35429 2.4315 2.46157 2.514 2.56038 2.60079 2.65194 2.70721 2.75135 2.80366 2.85454 2.91895 2.95814 3];
% 20212
ay1=-10.8616+[-0.401788 0.00213025 0.132846 0.317385 0.393373 0.454751 0.48935 0.51517 0.5436 0.557734 0.584277 0.606308 0.623321 0.642988 0.663399 0.679344 0.697398 0.713769 0.734426 0.747197 0.7604];
ay2=446.379+[1.12007 0.152953 -0.404727 -1.47454 -2.20675 -2.9696 -3.5954 -4.22971 -5.05664 -5.36245 -5.88038 -6.32343 -6.69841 -7.1599 -7.64609 -8.02322 -8.45669 -8.86445 -9.36524 -9.66224 -9.97268 ];
ay3=-704.985+[0.122619 -0.75059 -0.618352 -0.499771 -0.487026 -0.511058 -0.555117 -0.614807 -0.709237 -0.748091 -0.818471 -0.884236 -0.94406 -1.02377 -1.11458 -1.18892 -1.27849 -1.36664 -1.47957 -1.54892 -1.62278];
% 40296
az1=-12.2381+[-0.211769 -0.130501 -0.0579094 0.0603844 0.113016 0.15765 0.183148 0.203036 0.225925 0.236851 0.257598 0.27452 0.287379 0.302036 0.31686 0.328041 0.34062 0.351817 0.365932 0.374642 0.3835];
az2=446.122+[0.66834 0.138974 -0.100499 -0.740836 -1.19347 -1.65747 -2.03084 -2.40327 -2.88297 -3.06057 -3.36119 -3.61824 -3.83556 -4.10347 -4.38653 -4.60553 -4.85675 -5.09233 -5.38093 -5.55153 -5.72815 ];
az3=-714.556+[0.113813 -0.843529 -0.795191 -0.718651 -0.723879 -0.757163 -0.800548 -0.851833 -0.925357 -0.953438 -1.00201 -1.04584 -1.08477 -1.13547 -1.19179 -1.2367 -1.28969 -1.34071 -1.40436 -1.44256 -1.48256];
% 25651
ba1=-9.36067+[-0.365092 0.0414701 0.172375 0.35173 0.423328 0.480247 0.510347 0.531126 0.552562 0.564017 0.586609 0.605478 0.619896 0.636425 0.653516 0.666761 0.68174 0.695199 0.712251 0.722893 0.733837];
ba2=443.677+[1.04957 0.163182 -0.347748 -1.34849 -2.03675 -2.75174 -3.33661 -3.92744 -4.69434 -4.97708 -5.45467 -5.86223 -6.20654 -6.62953 -7.07434 -7.41866 -7.81362 -8.18436 -8.63868 -8.90752 -9.18787 ];
ba3=-706.563+[0.28882 -0.729643 -0.67474 -0.667041 -0.72082 -0.813182 -0.913366 -1.03023 -1.19957 -1.26604 -1.38275 -1.48762 -1.58015 -1.69957 -1.83154 -1.93752 -2.06303 -2.18461 -2.33805 -2.43114 -2.52977];
% 42160
bb1=-14.6392+[-0.248732 -0.130218 -0.0490336 0.0852404 0.145136 0.196628 0.22802 0.254192 0.285002 0.298993 0.324681 0.345515 0.361448 0.37971 0.398318 0.412564 0.428541 0.442861 0.460836 0.47183 0.483058];
bb2=448.856+[0.825649 0.154254 -0.138404 -0.904563 -1.4343 -1.97773 -2.41717 -2.85754 -3.42794 -3.64005 -4.00005 -4.30859 -4.56994 -4.89281 -5.23452 -5.49945 -5.80383 -6.08977 -6.44051 -6.64808 -6.86328];
bb3=-710.316+[-0.0110182 -0.852712 -0.765317 -0.602746 -0.559368 -0.544913 -0.54995 -0.563038 -0.587912 -0.598068 -0.616744 -0.635612 -0.653918 -0.679687 -0.710303 -0.735647 -0.766733 -0.797697 -0.837471 -0.861921 -0.88793];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4P
t13=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3];
% 20212
bc1=-10.8616+[0.14562 0.155867 0.166726 0.173788 0.180905 0.189206 0.199007 0.210266 0.223522 0.238346 0.254361 0.271461 0.292537 0.307997 0.322115 0.340662 0.358726 0.381052 0.403556 0.429026 0.445079];
bc2=446.379+[1.07675 1.05044 1.00555 0.956179 0.895259 0.813018 0.70852 0.579859 0.430773 0.263085 0.0749866 -0.133428 -0.400265 -0.6092 -0.806226 -1.08057 -1.36225 -1.69964 -2.03476 -2.40745 -2.63937];
bc3=-704.985+[-0.585003 -0.583914 -0.554113 -0.509223 -0.453867 -0.40552 -0.35579 -0.310934 -0.270319 -0.239077 -0.213669 -0.191227 -0.166535 -0.150482 -0.136868 -0.121182 -0.1081 -0.0974546 -0.0929215 -0.0940718 -0.0977934];
% 40296
bd1=-12.2381+[0.00596392 0.0103618 0.00857115 0.000418968 -0.0086886 -0.0144083 -0.0175893 -0.0166305 -0.0121795 -0.00493479 0.00394765 0.0136634 0.0260444 0.0353808 0.0438874 0.0550457 0.0658846 0.0799788 0.0944365 0.111026 0.12165];
bd2=446.122+[0.498484 0.502257 0.569442 0.655748 0.754927 0.807306 0.834879 0.84038 0.825097 0.788047 0.725738 0.641565 0.52341 0.422922 0.32538 0.183627 0.033178 -0.14919 -0.333782 -0.54226 -0.673437];
bd3=-714.556+[-0.522187 -0.534604 -0.559849 -0.583964 -0.604259 -0.602861 -0.586946 -0.574908 -0.562205 -0.556768 -0.552111 -0.54693 -0.539032 -0.532155 -0.52566 -0.5171 -0.508116 -0.499056 -0.49349 -0.490821 -0.490681];
% 25651
be1=-9.36067+[0.185688 0.196072 0.207013 0.213925 0.220746 0.228626 0.237635 0.249369 0.26351 0.279016 0.295572 0.313139 0.334838 0.350822 0.365435 0.384631 0.40323 0.425783 0.447987 0.472513 0.487693];
be2=443.677+[1.01382 0.991403 0.959132 0.924938 0.882481 0.817553 0.730923 0.621559 0.492591 0.34411 0.175024 -0.0139175 -0.256694 -0.447567 -0.627725 -0.879126 -1.13772 -1.44778 -1.75625 -2.0997 -2.31357];
be3=-706.563+[-0.430726 -0.437073 -0.430887 -0.414084 -0.392194 -0.374617 -0.356269 -0.343152 -0.334422 -0.332915 -0.336366 -0.342869 -0.352971 -0.362346 -0.371988 -0.387242 -0.404591 -0.429333 -0.458734 -0.496496 -0.522491];
% 42160
bf1=-14.6392+[0.0086072 0.0140055 0.0127558 0.00408054 -0.00547999 -0.0110167 -0.0123011 -0.0127079 -0.00997344 -0.00234142 0.00725545 0.0174744 0.0303494 0.0400302 0.0487109 0.0599707 0.071196 0.0867635 0.103171 0.122411 0.134947];
bf2=448.856+[0.623689 0.626074 0.695775 0.786234 0.888624 0.928074 0.933236 0.912233 0.868652 0.810164 0.725031 0.615539 0.464846 0.338853 0.217244 0.0419689 -0.142891 -0.365601 -0.589636 -0.841387 -0.999296];
bf3=-710.316+[-0.603201 -0.614123 -0.640874 -0.668226 -0.691019 -0.680387 -0.648019 -0.618695 -0.587972 -0.568204 -0.548311 -0.52661 -0.497892 -0.474972 -0.453616 -0.424747 -0.395143 -0.361836 -0.332781 -0.304619 -0.288867];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4P
t14=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3];
% 20212
bg1=-10.8616+[-0.290584 -0.0643288 0.181451 0.286632 0.38809 0.436726 0.511052 0.542275 0.60845 0.617447 0.65608 0.678427 0.698421 0.721769 0.740531 0.760271 0.77766 0.799061 0.818653 0.842947 0.850958];
bg2=446.379+[1.36888 0.848209 0.0187053 -0.528323 -1.40235 -1.99028 -2.98191 -3.39666 -4.32786 -4.46038 -5.09466 -5.51325 -5.91866 -6.41621 -6.82864 -7.27854 -7.68395 -8.16082 -8.58892 -9.11516 -9.29122 ];
bg3=-704.985+[-0.492421 -0.603052 -0.342618 -0.258175 -0.190303 -0.177284 -0.201391 -0.222209 -0.29258 -0.304762 -0.371718 -0.422059 -0.475191 -0.54629 -0.610214 -0.684842 -0.756297 -0.845949 -0.931276 -1.04221 -1.0805];
% 40296
bh1=-12.2381+[-0.262043 -0.151448 -0.0200146 0.0462618 0.112458 0.143165 0.192793 0.215517 0.263614 0.270057 0.298142 0.314218 0.328291 0.344204 0.356821 0.36987 0.381315 0.395385 0.408165 0.423942 0.429101];
bh2=446.122+[0.846901 0.482124 0.180861 -0.127479 -0.660518 -1.02201 -1.6168 -1.86149 -2.40722 -2.48489 -2.85571 -3.10041 -3.3375 -3.6285 -3.87011 -4.13358 -4.37063 -4.64892 -4.89831 -5.20354 -5.30473 ];
bh3=-714.556+[-0.447652 -0.614902 -0.528186 -0.478477 -0.442913 -0.444652 -0.47974 -0.499181 -0.557192 -0.566522 -0.615344 -0.650088 -0.68538 -0.730961 -0.77069 -0.815861 -0.857996 -0.909745 -0.958004 -1.0194 -1.04027];
% 25651
bi1=-9.36067+[-0.2566 -0.0282979 0.218572 0.322389 0.422432 0.46975 0.538638 0.566884 0.625828 0.633755 0.667469 0.686669 0.703606 0.723113 0.738679 0.754882 0.769099 0.786749 0.802933 0.823054 0.829658];
bi2=443.677+[1.29559 0.803192 0.0481935 -0.461626 -1.28087 -1.83237 -2.76058 -3.14763 -4.01359 -4.13655 -4.72397 -5.11075 -5.48472 -5.94286 -6.32196 -6.73479 -7.10606 -7.54183 -7.9322 -8.41079 -8.57052];
bi3=-706.563+[-0.323524 -0.486507 -0.356064 -0.333475 -0.350744 -0.391445 -0.506267 -0.565197 -0.721163 -0.745415 -0.869672 -0.957301 -1.04614 -1.16056 -1.25988 -1.37265 -1.47809 -1.60729 -1.72771 -1.8813 -1.93381];
% 42160
bk1=-14.6392+[-0.294117 -0.161244 -0.0136735 0.0600061 0.131721 0.166514 0.226223 0.253924 0.31251 0.320389 0.355273 0.375498 0.39351 0.414251 0.430769 0.448068 0.463261 0.4818 0.498601 0.519246 0.526008];
bk2=448.856+[1.02023 0.597361 0.222225 -0.152503 -0.786723 -1.20994 -1.9067 -2.19454 -2.83961 -2.93169 -3.37245 -3.66415 -3.94724 -4.29536 -4.5849 -4.90109 -5.18611 -5.5213 -5.82223 -6.19138 -6.31396];
bk3=-710.316+[-0.582165 -0.69641 -0.550582 -0.453501 -0.352005 -0.314841 -0.286573 -0.27981 -0.28018 -0.281438 -0.29205 -0.302118 -0.313925 -0.331186 -0.347917 -0.368517 -0.388994 -0.415816 -0.442231 -0.477528 -0.48991];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
