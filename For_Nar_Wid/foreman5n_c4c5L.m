%% foreman height and witdth narrowing/widening 
% for all models for the c4-c5 left hand side foreman under lateral bending (5n)
% 36572,16215,31500,37435
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 36572,16215,31500,37435
%% model15_intact_TLC_5N
t15=[2 2.0675 2.10125 2.16062 2.21688 2.26697 2.30924 2.35429 2.40779 2.45293 2.51808 2.55698 2.61406 2.65527 2.70375 2.75725 2.8064 2.86587 2.90654 2.96524 3];

% 36572
aa1=12.3763+[0.111599 0.015312 -0.12133 -0.352745 -0.608265 -0.870826 -1.10881 -1.36586 -1.64864 -1.8742 -2.16042 -2.30523 -2.49627 -2.62441 -2.76164 -2.90151 -3.02344 -3.16208 -3.25247 -3.37803 -3.44903 ];
aa2=446.738+[0.535552 -0.0715937 -0.248647 -0.347697 -0.283629 -0.125026 0.0717613 0.319734 0.61622 0.857165 1.15873 1.30519 1.48635 1.60506 1.7252 1.84187 1.94508 2.06703 2.15002 2.26789 2.3358];
aa3=-714.659+[-0.774879 -0.600358 -0.476223 -0.333585 -0.201835 -0.0838596 0.0127502 0.11419 0.223146 0.306952 0.410724 0.464934 0.537754 0.586012 0.63953 0.695596 0.744708 0.800674 0.836829 0.886003 0.91342];

% 16215
ab1=12.1679+[0.223784 0.0138387 -0.223542 -0.610843 -1.02095 -1.42643 -1.7883 -2.17918 -2.6149 -2.96293 -3.40388 -3.62867 -3.9265 -4.12399 -4.33646 -4.55485 -4.74595 -4.96353 -5.1062 -5.30516 -5.41811];
ab2=446.385+[0.866838 0.00189327 -0.250944 -0.398035 -0.305486 -0.0820246 0.197969 0.555917 0.99477 1.35379 1.80986 2.03318 2.31418 2.49719 2.6833 2.86695 3.03003 3.22233 3.35183 3.53431 3.63843];
ab3=-705.203+[-0.935817 -0.683409 -0.517597 -0.3108 -0.133309 0.0164359 0.133112 0.250472 0.372507 0.464859 0.579587 0.641887 0.725534 0.781856 0.84537 0.912422 0.970971 1.03777 1.08246 1.14347 1.17753];

% 31500
ac1=9.70641+[0.238644 0.0216209 -0.217895 -0.606143 -1.01223 -1.41135 -1.76653 -2.14994 -2.57761 -2.91841 -3.34855 -3.56727 -3.85656 -4.04783 -4.25318 -4.46397 -4.64834 -4.85823 -4.99563 -5.18722 -5.29608];
ac2=444.062+[0.758958 -0.0337006 -0.253131 -0.363234 -0.251115 -0.0184214 0.26397 0.621288 1.05778 1.41378 1.86404 2.08459 2.36246 2.54299 2.72681 2.90843 3.06969 3.25967 3.38754 3.56769 3.67058];
ac3=-707.068+[-0.814455 -0.649146 -0.522724 -0.359708 -0.210449 -0.0793884 0.0262018 0.135025 0.249829 0.336778 0.444966 0.503071 0.580027 0.631762 0.689442 0.74984 0.802552 0.863005 0.903425 0.958522 0.989244 ];

% 37435
ad1=16.2708+[0.132811 0.0105363 -0.149892 -0.417982 -0.7146 -1.01773 -1.29162 -1.58742 -1.91374 -2.17467 -2.50587 -2.67359 -2.89497 -3.04269 -3.20083 -3.36217 -3.50284 -3.66288 -3.76714 -3.91177 -3.99353 ];
ad2=449.059+[0.698641 -0.0202954 -0.239837 -0.370859 -0.311984 -0.143834 0.0701822 0.341978 0.668601 0.935293 1.27179 1.43593 1.63924 1.77257 1.90726 2.038 2.15348 2.29001 2.38295 2.51486 2.59091];
ad3=-710.186+[-0.884108 -0.624377 -0.456934 -0.266124 -0.0969818 0.0498737 0.167162 0.287797 0.415949 0.514163 0.634474 0.696889 0.780952 0.836155 0.897524 0.961938 1.01821 1.0819 1.12269 1.17792 1.20856];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5N
t1=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30644 2.35622 2.40972 2.46023 2.50711 2.55164 2.60232 2.65142 2.72191 2.77012 2.80437 2.86374 2.90593 2.9903 3];
% 36572
ae1=12.3763+[-0.296363 -0.203547 -0.127687 -0.151719 -0.250962 -0.316875 -0.489703 -0.674614 -0.896749 -1.12125 -1.3393 -1.55433 -1.80074 -2.03363 -2.34905 -2.54371 -2.6688 -2.86656 -2.99009 -3.21241 -3.23668 ];
ae2=446.738+[0.797079 0.536746 0.313958 0.138478 -0.0577762 -0.129014 -0.236499 -0.294886 -0.303551 -0.252602 -0.165803 -0.0555691 0.100741 0.280465 0.563701 0.762419 0.900807 1.13244 1.28798 1.58354 1.6167 ];
ae3=-714.659+[-0.615151 -0.85815 -0.789178 -0.682828 -0.549867 -0.496585 -0.385973 -0.286057 -0.182086 -0.0857585 0.00451909 0.0905816 0.187608 0.279373 0.402892 0.479533 0.529415 0.609675 0.660996 0.753706 0.763824];

% 16215
af1=12.1679+[-0.324978 -0.222527 -0.252706 -0.406595 -0.674687 -0.818661 -1.15601 -1.48831 -1.86771 -2.24051 -2.59671 -2.94169 -3.33401 -3.70498 -4.20468 -4.5124 -4.71184 -5.03072 -5.23305 -5.60145 -5.64198];
af2=446.385+[1.47688 1.22218 0.863578 0.576762 0.25581 0.12942 -0.0772745 -0.192646 -0.228304 -0.17617 -0.0693713 0.0745713 0.287582 0.539035 0.947397 1.23877 1.44362 1.78995 2.02468 2.47201 2.5223];
af3=-705.203+[-0.848839 -1.10334 -0.93361 -0.745198 -0.521947 -0.428212 -0.243804 -0.0918523 0.0571504 0.190415 0.309767 0.418453 0.536267 0.644174 0.785656 0.871575 0.926809 1.0146 1.07015 1.16997 1.18076];

% 31500
ag1=9.70641+[-0.300144 -0.198368 -0.233287 -0.39123 -0.662994 -0.807968 -1.14525 -1.47512 -1.84955 -2.21548 -2.56371 -2.90022 -3.28275 -3.64428 -4.13 -4.42838 -4.62163 -4.93049 -5.12631 -5.48246 -5.52161];
ag2=444.066+[1.35021 1.09689 0.776161 0.528207 0.254085 0.148156 -0.0194227 -0.105588 -0.116785 -0.0472593 0.07144 0.223453 0.442473 0.696612 1.10167 1.38739 1.58749 1.92515 2.15347 2.58802 2.63686];
ag3=-707.086+[-0.716544 -0.972789 -0.848139 -0.704946 -0.535224 -0.464806 -0.326087 -0.210037 -0.0938333 0.0126087 0.110081 0.200597 0.301054 0.395533 0.524667 0.605881 0.659026 0.744518 0.799408 0.898796 0.909576];

% 37435
ah1=16.2708+[-0.32538 -0.224891 -0.162115 -0.206781 -0.334362 -0.413435 -0.616878 -0.831661 -1.08765 -1.34607 -1.5972 -1.84427 -2.12669 -2.39375 -2.75507 -2.97758 -3.12068 -3.34714 -3.48892 -3.74413 -3.772];
ah2=449.059+[0.940437 0.639681 0.376961 0.163804 -0.0751485 -0.162886 -0.299738 -0.379162 -0.40171 -0.354783 -0.265257 -0.148242 0.0206377 0.21781 0.535394 0.760735 0.91825 1.18266 1.36063 1.69908 1.73705];
ah3=-710.186+[-0.667767 -0.895689 -0.793559 -0.649385 -0.470235 -0.397542 -0.246927 -0.112392 0.0254286 0.150393 0.26507 0.372459 0.490771 0.599743 0.740588 0.8246 0.878155 0.962822 1.01593 1.11012 1.1203 ];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5N
t2=[2 2.05026 2.11433 2.16433 2.21433 2.27371 2.30007 2.35578 2.40928 2.45979 2.52161 2.5572 2.60603 2.68118 2.71243 2.7511 2.82625 2.8575 2.91199 2.97132 3];

% 36572
ai1=12.3763+[-0.24139 -0.205417 -0.129447 -0.0852741 -0.06762 -0.0810026 -0.102298 -0.179616 -0.290526 -0.42203 -0.609259 -0.730735 -0.906845 -1.20472 -1.33482 -1.49964 -1.82571 -1.96171 -2.19623 -2.44008 -2.55314];
ai2=446.738+[0.905469 0.829119 0.721856 0.628586 0.528344 0.403686 0.347901 0.228835 0.12284 0.037888 -0.0428604 -0.0697419 -0.0898902 -0.0693797 -0.0477854 -0.00923426 0.096395 0.150314 0.260141 0.395563 0.465901];
ai3=-714.659+[-0.763679 -0.877644 -0.861126 -0.80831 -0.735016 -0.63857 -0.594901 -0.493598 -0.398653 -0.31113 -0.206032 -0.146148 -0.0650286 0.0622849 0.115681 0.18195 0.31007 0.363134 0.45448 0.551042 0.596414 ];

% 16215
aj1=12.1679+[-0.242242 -0.202115 -0.184823 -0.221508 -0.30239 -0.443016 -0.523236 -0.729974 -0.969361 -1.22448 -1.56371 -1.77324 -2.07032 -2.55411 -2.76171 -3.02255 -3.53609 -3.74959 -4.11758 -4.50199 -4.68103];
aj2=446.385+[1.74178 1.64238 1.45402 1.27968 1.09781 0.877108 0.779287 0.578955 0.403332 0.266225 0.136363 0.0893701 0.0465399 0.0537407 0.0766421 0.122484 0.262346 0.33652 0.491614 0.691537 0.796658 ];
aj3=-705.203+[-1.05161 -1.15461 -1.06607 -0.941768 -0.797904 -0.621455 -0.543084 -0.375946 -0.22328 -0.0883851 0.0667462 0.152668 0.267597 0.436569 0.504542 0.586933 0.742111 0.805199 0.912417 1.02376 1.07527];

% 31500
ak1=9.70641+[-0.21745 -0.175329 -0.158466 -0.197129 -0.280097 -0.42341 -0.504704 -0.712948 -0.953364 -1.20813 -1.54506 -1.75196 -2.04423 -2.5173 -2.7198 -2.97384 -3.47337 -3.68087 -4.03806 -4.41039 -4.58364 ];
ak2=444.066+[1.58819 1.49039 1.32103 1.16994 1.01479 0.827851 0.74531 0.577233 0.432271 0.32209 0.222207 0.190392 0.166671 0.197244 0.228443 0.283226 0.437165 0.516131 0.677381 0.880189 0.985772 ];
ak3=-707.086+[-0.881612 -0.990039 -0.927986 -0.833061 -0.722183 -0.585979 -0.525513 -0.396238 -0.278907 -0.175727 -0.057224 0.00878497 0.097303 0.229091 0.2826 0.348093 0.473341 0.52503 0.614354 0.709798 0.75463];

% 37435
al1=16.2708+[-0.262384 -0.224858 -0.156921 -0.124193 -0.121966 -0.155663 -0.1865 -0.286777 -0.420651 -0.575426 -0.792816 -0.932885 -1.13531 -1.47722 -1.62624 -1.81511 -2.18795 -2.34298 -2.61013 -2.88781 -3.01665];
al2=449.059+[1.06927 0.980528 0.854962 0.742573 0.620603 0.468891 0.401121 0.255795 0.124514 0.0170187 -0.0884138 -0.126577 -0.159457 -0.150918 -0.13228 -0.0953361 0.012401 0.0687536 0.18644 0.335565 0.413718];
al3=-710.186+[-0.835382 -0.943732 -0.909701 -0.836153 -0.737517 -0.608993 -0.550841 -0.416475 -0.289448 -0.171468 -0.029749 0.0504579 0.158446 0.325549 0.394797 0.480029 0.641999 0.707904 0.81928 0.933687 0.986588];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5N
t3=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.32471 2.35107 2.40206 2.45356 2.50055 2.56107 2.60246 2.65199 2.71178 2.76467 2.80998 2.85632 2.94802 2.96052 3];
% 36572
am1=12.3763+[-0.0625365 -0.0446844 0.00543106 0.0540755 0.102963 0.146468 0.187469 0.200462 0.211953 0.20332 0.177461 0.117828 0.0624844 -0.0184024 -0.135482 -0.253651 -0.366654 -0.491445 -0.763028 -0.801545 -0.92781];
am2=446.738+[0.664822 0.653508 0.635214 0.609347 0.575726 0.535149 0.478944 0.450861 0.395404 0.335824 0.27532 0.188223 0.125653 0.0513141 -0.0327857 -0.0983418 -0.144351 -0.182592 -0.227423 -0.231645 -0.239198];
am3=-714.659+[-1.00175 -1.01187 -1.00076 -0.972959 -0.932727 -0.884608 -0.816923 -0.782691 -0.716757 -0.64672 -0.577158 -0.483954 -0.42332 -0.352369 -0.267798 -0.192983 -0.129231 -0.0635067 0.0677281 0.0857096 0.142145 ];
% 16215
an1=12.1679+[0.0741139 0.084891 0.0938778 0.0900684 0.0732011 0.0413129 -0.0140373 -0.0464508 -0.124685 -0.224669 -0.335827 -0.507785 -0.641078 -0.816022 -1.04779 -1.26814 -1.46893 -1.68359 -2.13576 -2.19913 -2.40355];
an2=446.385+[1.46322 1.43648 1.36605 1.28499 1.18879 1.08201 0.946473 0.883434 0.758259 0.631025 0.516312 0.373562 0.279878 0.174012 0.0594779 -0.0286317 -0.0905771 -0.142118 -0.200635 -0.205752 -0.214211];
an3=-705.203+[-1.33312 -1.33082 -1.26877 -1.18689 -1.08647 -0.974505 -0.834145 -0.768885 -0.641193 -0.512281 -0.394909 -0.247433 -0.152845 -0.0451784 0.0808058 0.189043 0.278951 0.368881 0.542301 0.565663 0.638455];
% 31500
ao1=9.70641+[0.100468 0.113434 0.1247 0.12168 0.104923 0.0724518 0.0161731 -0.0166157 -0.0957275 -0.196437 -0.307828 -0.479738 -0.613249 -0.788267 -1.01939 -1.23838 -1.43735 -1.64943 -2.09385 -2.15597 -2.35603];
ao2=444.066+[1.29841 1.2724 1.21019 1.1409 1.05993 0.971133 0.858958 0.806843 0.703434 0.598179 0.503118 0.384941 0.30809 0.222069 0.130737 0.0622001 0.0161128 -0.0201133 -0.0517481 -0.0534205 -0.0517228 ];
ao3=-707.086+[-1.14938 -1.15139 -1.10463 -1.04075 -0.961868 -0.873803 -0.763475 -0.712084 -0.611314 -0.50919 -0.415812 -0.298099 -0.223142 -0.138398 -0.039561 0.0452978 0.115741 0.186225 0.322544 0.340923 0.398376];
% 37435
ap1=16.2708+[-0.0527419 -0.0363461 0.00798514 0.0492517 0.0885459 0.121332 0.14741 0.152793 0.149343 0.124117 0.0818099 0.00048845 -0.0689982 -0.166948 -0.305283 -0.443122 -0.573719 -0.717441 -1.02941 -1.07362 -1.21809];
ap2=449.059+[0.808319 0.796584 0.775571 0.743201 0.700614 0.649364 0.578659 0.543344 0.474693 0.402181 0.328374 0.221989 0.145293 0.0534963 -0.0515087 -0.134484 -0.194184 -0.245403 -0.311207 -0.318002 -0.332789];
ap3=-710.186+[-1.08969 -1.09804 -1.07987 -1.04166 -0.98773 -0.924096 -0.835265 -0.790469 -0.704472 -0.613349 -0.522853 -0.40144 -0.321787 -0.227902 -0.115593 -0.0163776 0.0680389 0.154934 0.327461 0.351016 0.424712];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5N
t4=[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3];
% 36572
aq1=12.3763+[-0.215014 -0.0245877 -0.179115 -0.352833 -0.605177 -0.852564 -1.14504 -1.39314 -1.71704 -1.93372 -2.12111 -2.33899 -2.47847 -2.63094 -2.79788 -2.88186 -3.00967 -3.15407 -3.22351 -3.3896 -3.41632];
aq2=446.738+[0.808702 -0.145684 -0.572977 -0.645093 -0.570089 -0.401448 -0.122753 0.160615 0.559882 0.823818 1.03806 1.27219 1.40611 1.54915 1.70384 1.78397 1.90975 2.05896 2.13424 2.32252 2.35355 ];
aq3=-714.659+[0.194024 -0.872846 -0.674845 -0.566442 -0.425425 -0.304464 -0.178069 -0.0744707 0.0557677 0.139201 0.21315 0.301045 0.358519 0.423084 0.495905 0.532717 0.589088 0.653156 0.683762 0.755733 0.767076 ];
% 16215
ar1=12.1679+[-0.403375 -0.013213 -0.392465 -0.730457 -1.19847 -1.6228 -2.10339 -2.51149 -3.0423 -3.39427 -3.70338 -4.06485 -4.29568 -4.54983 -4.83094 -4.97274 -5.18974 -5.43691 -5.55672 -5.84512 -5.89169];
ar2=446.385+[1.40349 0.261182 -0.416803 -0.581823 -0.528588 -0.323794 0.0441049 0.435758 0.996075 1.37061 1.67902 2.01479 2.20659 2.41345 2.64011 2.75851 2.94542 3.16873 3.28205 3.56705 3.61436 ];
ar3=-705.203+[0.136572 -1.07558 -0.747781 -0.557174 -0.332665 -0.1611 0.00571124 0.134904 0.291383 0.389432 0.477413 0.582799 0.652422 0.730203 0.817104 0.860366 0.92608 0.999833 1.03489 1.11647 1.12922];
% 31500
as1=9.70641+[-0.371109 0.00232645 -0.384782 -0.724299 -1.19003 -1.60903 -2.08177 -2.48256 -3.00325 -3.34737 -3.64856 -4.00013 -4.22433 -4.47104 -4.7436 -4.88105 -5.09113 -5.33011 -5.44583 -5.72428 -5.76927];
as2=444.066+[1.26279 0.18622 -0.412126 -0.538891 -0.454942 -0.235959 0.137331 0.528461 1.08491 1.45507 1.75949 2.09157 2.28183 2.48706 2.71173 2.82888 3.01344 3.23341 3.34486 3.62482 3.67127 ];
as3=-707.086+[0.278094 -1.00134 -0.763634 -0.616316 -0.429729 -0.280525 -0.129148 -0.00816588 0.140413 0.233888 0.316833 0.414565 0.478106 0.548973 0.628096 0.667692 0.727997 0.79601 0.828444 0.90425 0.916134];
% 37435
at1=16.2708+[-0.248265 -0.0271694 -0.218498 -0.421762 -0.717929 -1.00574 -1.34377 -1.63108 -2.00571 -2.25568 -2.47263 -2.72474 -2.88553 -3.06128 -3.25392 -3.35079 -3.49834 -3.66512 -3.74536 -3.93717 -3.96797];
at2=449.059+[1.0122 -0.144313 -0.66383 -0.760687 -0.688353 -0.50709 -0.200139 0.114819 0.560107 0.856002 1.09834 1.36356 1.51514 1.67714 1.85264 1.94357 2.08635 2.25571 2.34126 2.55513 2.59037 ];
at3=-710.186+[0.112597 -0.872621 -0.595973 -0.450378 -0.271626 -0.123726 0.0256155 0.144858 0.291842 0.384794 0.466911 0.564585 0.628805 0.700713 0.781458 0.821959 0.883604 0.953005 0.985797 1.06215 1.07408];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5N
t5=[2 2.05126 2.10091 2.15137 2.23246 2.28246 2.31371 2.35238 2.42753 2.45878 2.51533 2.551 2.6001 2.67059 2.71118 2.76118 2.82055 2.86274 2.92212 2.9643 3];
% 36572
au1=12.3763+[-0.0645383 -0.0495299 -0.0253944 0.0130683 0.0908138 0.132406 0.155325 0.176552 0.187792 0.180929 0.150044 0.118477 0.0597574 -0.0508417 -0.129155 -0.237993 -0.379611 -0.491443 -0.658261 -0.784693 -0.896459];
au2=446.738+[0.630243 0.618627 0.604054 0.580016 0.522047 0.479175 0.450881 0.412419 0.333849 0.298964 0.229717 0.182014 0.113537 0.0156857 -0.0369632 -0.0944085 -0.153809 -0.185954 -0.22155 -0.236392 -0.243161 ];
au3=-714.659+[-0.996715 -1.00578 -0.996334 -0.973691 -0.909248 -0.858958 -0.824482 -0.775799 -0.678499 -0.635508 -0.552576 -0.499772 -0.429517 -0.331139 -0.274436 -0.204321 -0.121562 -0.0623778 0.0212563 0.081224 0.131756];
% 16215
av1=12.1679+[0.0479822 0.0604929 0.0795263 0.0902003 0.0715204 0.0388292 0.0130053 -0.0298387 -0.147494 -0.208618 -0.339601 -0.436261 -0.585961 -0.829465 -0.985382 -1.19038 -1.44658 -1.63996 -1.92206 -2.13175 -2.31409];
av2=446.385+[1.48605 1.46032 1.41346 1.34366 1.19308 1.0858 1.01593 0.925821 0.744518 0.668165 0.531408 0.44749 0.336269 0.188442 0.113501 0.0328363 -0.0499495 -0.0945589 -0.14373 -0.162955 -0.171014];
av3=-705.203+[-1.34535 -1.34195 -1.29842 -1.22864 -1.0677 -0.951851 -0.876981 -0.779797 -0.588553 -0.509137 -0.365946 -0.277965 -0.162994 -0.00735126 0.0788393 0.182443 0.301721 0.383797 0.497262 0.576326 0.642154];
% 31500
aw1=9.70641+[0.0756118 0.0904737 0.112212 0.124298 0.106079 0.0728349 0.0466704 0.00346365 -0.115147 -0.176576 -0.307696 -0.404365 -0.55431 -0.797765 -0.95317 -1.15686 -1.41078 -1.60175 -1.87954 -2.08523 -2.26373];
aw2=444.066+[1.31678 1.29171 1.24976 1.18936 1.06258 0.973686 0.915935 0.841612 0.692027 0.628804 0.515441 0.446048 0.354883 0.235382 0.176127 0.113916 0.0520719 0.0212316 -0.00966683 -0.0171614 -0.0159892 ];
aw3=-707.086+[-1.15639 -1.1574 -1.12485 -1.07072 -0.944028 -0.852691 -0.79371 -0.717036 -0.565555 -0.502328 -0.387988 -0.317676 -0.226353 -0.103756 -0.0360662 0.0453028 0.138925 0.203371 0.292536 0.354806 0.406772];
% 37435
ax1=16.2708+[-0.0552054 -0.0418738 -0.0228829 0.00887523 0.071405 0.101888 0.117148 0.127428 0.116145 0.0990059 0.0483685 0.00443747 -0.070856 -0.205399 -0.298051 -0.425349 -0.589543 -0.718467 -0.910378 -1.05563 -1.1836];
ax2=449.059+[0.768975 0.756827 0.740255 0.710697 0.637669 0.583683 0.548116 0.49965 0.40262 0.360082 0.275412 0.217138 0.133141 0.0119016 -0.0542819 -0.127516 -0.204717 -0.248251 -0.298393 -0.321963 -0.335222];
ax3=-710.186+[-1.08139 -1.0884 -1.07284 -1.0409 -0.954367 -0.888081 -0.842894 -0.779254 -0.652621 -0.59681 -0.489119 -0.420467 -0.328449 -0.198535 -0.123432 -0.0306729 0.0787166 0.156836 0.266928 0.345486 0.411416 ];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5N
t6=[2 2.06926 2.11544 2.15658 2.22964 2.26089 2.30352 2.35172 2.40991 2.47326 2.50451 2.56164 2.6091 2.65161 2.70076 2.78645 2.82704 2.86763 2.90822 2.98941 3];
% 36572
ay1=12.3763+[-0.215017 -0.13266 -0.144007 -0.231426 -0.487311 -0.614176 -0.804307 -1.03546 -1.33032 -1.65932 -1.8215 -2.10049 -2.30157 -2.46473 -2.62871 -2.87143 -2.9746 -3.07241 -3.16584 -3.34237 -3.36467];
ay2=446.738+[0.808829 0.149248 -0.113232 -0.317166 -0.468938 -0.485442 -0.458318 -0.359951 -0.148675 0.160217 0.329565 0.646076 0.888793 1.09052 1.29342 1.58053 1.69968 1.81321 1.92208 2.13291 2.15996];
ay3=-714.659+[0.193483 -0.830348 -0.726426 -0.610891 -0.447893 -0.378978 -0.284774 -0.182247 -0.0577776 0.0758293 0.13959 0.24782 0.326423 0.389168 0.453736 0.554266 0.598677 0.64109 0.681468 0.757353 0.766796];
% 16215
az1=12.1679+[-0.403358 -0.17839 -0.300695 -0.523658 -1.02892 -1.26001 -1.59096 -1.97954 -2.46607 -3.00124 -3.26179 -3.70984 -4.03463 -4.29546 -4.56098 -4.96182 -5.13478 -5.29976 -5.45854 -5.76203 -5.80062 ];
az2=446.385+[1.40391 0.772806 0.363182 0.0353856 -0.282825 -0.349001 -0.352609 -0.248712 0.0206241 0.440624 0.674529 1.12315 1.47603 1.76922 2.0667 2.49248 2.6701 2.83958 3.00311 3.32145 3.36278 ];
az3=-705.203+[0.135333 -1.05217 -0.857077 -0.661536 -0.367567 -0.253836 -0.110025 0.0374274 0.205591 0.372821 0.449257 0.574267 0.662859 0.732969 0.805127 0.918159 0.968123 1.01581 1.06114 1.14607 1.15659 ];
% 31500
ba1=9.70641+[-0.371091 -0.157404 -0.285462 -0.51205 -1.01847 -1.2483 -1.57569 -1.9584 -2.43539 -2.959 -3.21368 -3.65076 -3.96672 -4.22016 -4.47799 -4.86665 -5.03413 -5.19376 -5.34724 -5.64016 -5.67738 ];
ba2=444.066+[1.26326 0.671985 0.307933 0.0231781 -0.233891 -0.279413 -0.261438 -0.141033 0.139154 0.562417 0.795743 1.23904 1.58488 1.87111 2.16156 2.57779 2.75171 2.91763 3.0778 3.38958 3.43006];
ba3=-707.086+[0.276778 -0.950151 -0.807419 -0.661272 -0.438618 -0.350051 -0.234729 -0.112443 0.0326541 0.182794 0.252995 0.3709 0.456727 0.525684 0.596466 0.7057 0.753375 0.7988 0.841739 0.921811 0.931712 ];
% 37435
bb1=16.2708+[-0.248256 -0.153231 -0.18207 -0.292858 -0.593607 -0.741611 -0.961939 -1.22864 -1.56934 -1.94906 -2.13557 -2.4566 -2.68832 -2.87547 -3.06366 -3.34297 -3.46193 -3.57468 -3.6824 -3.88614 -3.91184];
bb2=449.059+[1.01233 0.19273 -0.121892 -0.369636 -0.564691 -0.592024 -0.572199 -0.47108 -0.241695 0.0990838 0.286898 0.641793 0.917543 1.14732 1.37874 1.70662 1.84254 1.972 2.09605 2.33612 2.36691];
bb3=-710.186+[0.11204 -0.836312 -0.68987 -0.532077 -0.310057 -0.218528 -0.0963098 0.0333493 0.185224 0.342706 0.416073 0.537231 0.622304 0.688751 0.75666 0.862862 0.909932 0.954711 0.997296 1.07687 1.08671];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5N
t13=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.32471 2.36689 2.42627 2.45263 2.51864 2.55993 2.60692 2.66037 2.70735 2.75754 2.81624 2.85281 2.9034 2.9694 3];
% 36572
bc1=12.3763+[-0.00126366 0.0219317 0.0739165 0.113439 0.144322 0.161285 0.163808 0.145126 0.0982255 0.0696328 -0.0216009 -0.0929525 -0.184555 -0.304829 -0.421059 -0.556605 -0.730807 -0.847191 -1.0134 -1.24199 -1.35179];
bc2=446.738+[0.696855 0.678331 0.647739 0.612603 0.569624 0.520066 0.456283 0.40606 0.329725 0.293445 0.198673 0.139663 0.0750155 0.00903091 -0.0413454 -0.0848345 -0.120298 -0.133144 -0.14353 -0.136816 -0.126303];
bc3=-714.659+[-0.705812 -0.717113 -0.705595 -0.680387 -0.64276 -0.592896 -0.526466 -0.475836 -0.397029 -0.359688 -0.266551 -0.207385 -0.140277 -0.0624012 0.00658398 0.0808532 0.168435 0.223633 0.300267 0.400161 0.446376];
% 16215
bd1=12.1679+[0.129016 0.142933 0.146885 0.129589 0.0919495 0.0312154 -0.0642922 -0.15535 -0.305967 -0.382191 -0.598444 -0.750818 -0.936585 -1.16725 -1.38211 -1.62483 -1.92451 -2.11908 -2.3943 -2.76689 -2.94389];
bd2=446.385+[1.63099 1.59294 1.50283 1.40704 1.29754 1.17804 1.02832 0.916974 0.759017 0.689559 0.523284 0.427282 0.326046 0.226241 0.150837 0.0860791 0.0335924 0.0151283 0.000610323 0.0112589 0.0264063];
bd3=-705.203+[-1.0531 -1.04686 -0.972606 -0.883104 -0.777052 -0.659034 -0.512868 -0.407717 -0.259499 -0.193617 -0.0339929 0.0622074 0.169233 0.288032 0.389872 0.4957 0.615538 0.688523 0.788043 0.914736 0.972351];
% 31500
be1=9.70641+[0.155694 0.17185 0.177748 0.160756 0.122761 0.0613435 -0.0350685 -0.126954 -0.278464 -0.354916 -0.571257 -0.723185 -0.907992 -1.13669 -1.34897 -1.588 -1.88243 -2.07325 -2.34276 -2.70682 -2.87949];
be2=444.066+[1.44871 1.41197 1.33185 1.2492 1.15602 1.05548 0.930112 0.836805 0.704272 0.646044 0.507627 0.428696 0.346602 0.267676 0.209744 0.16265 0.129199 0.12169 0.121655 0.149525 0.172069];
be3=-707.086+[-0.843245 -0.842335 -0.785715 -0.715789 -0.632531 -0.54005 -0.425806 -0.343515 -0.227129 -0.175251 -0.0502688 0.0245927 0.107558 0.199552 0.278272 0.359866 0.452578 0.509354 0.586864 0.685859 0.730988 ];
% 37435
bf1=16.2708+[0.00528751 0.0271941 0.0737542 0.106744 0.129143 0.135092 0.122869 0.0924878 0.0268283 -0.0106738 -0.124789 -0.211469 -0.321052 -0.463007 -0.599385 -0.75749 -0.959136 -1.09314 -1.28424 -1.54623 -1.67185];
bf2=449.059+[0.880613 0.861293 0.82705 0.78512 0.732719 0.671245 0.591971 0.530332 0.436683 0.392075 0.275398 0.202379 0.121936 0.0386132 -0.0259839 -0.0837861 -0.13415 -0.155255 -0.175979 -0.180058 -0.173527];
bf3=-710.186+[-0.813393 -0.822853 -0.803979 -0.768869 -0.718175 -0.651741 -0.563634 -0.496453 -0.391972 -0.342503 -0.218203 -0.138749 -0.0484772 0.0561194 0.14869 0.248258 0.365002 0.438081 0.53906 0.66969 0.729768 ];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5N
t14=[2 2.05026 2.11433 2.17371 2.20007 2.2594 2.31877 2.36096 2.42034 2.47043 2.5127 2.58779 2.63779 2.65263 2.70273 2.76565 2.80142 2.8609 2.90157 2.95756 3];
% 36572
bg1=12.3763+[-0.262546 -0.124095 -0.094675 -0.192346 -0.259911 -0.457753 -0.691674 -0.875293 -1.15094 -1.39502 -1.60297 -1.96951 -2.20687 -2.27579 -2.48614 -2.71783 -2.83324 -3.0019 -3.10594 -3.23833 -3.33238];
bg2=446.738+[0.872491 0.46412 0.175647 -0.045327 -0.120787 -0.221501 -0.254526 -0.21841 -0.109948 0.0345404 0.185228 0.515063 0.758163 0.829848 1.06309 1.34054 1.48448 1.69562 1.82595 1.99198 2.10964];
bg3=-714.659+[-0.305877 -0.591861 -0.502643 -0.386162 -0.336974 -0.219371 -0.0992608 -0.0161876 0.101886 0.202009 0.285885 0.424517 0.508818 0.533368 0.607554 0.687483 0.7276 0.787518 0.825285 0.873512 0.90743];
% 16215
bh1=12.1679+[-0.293437 -0.130061 -0.227211 -0.488757 -0.634028 -1.01097 -1.4256 -1.73794 -2.19539 -2.59472 -2.93431 -3.52897 -3.90955 -4.02025 -4.36011 -4.73266 -4.92011 -5.19811 -5.37239 -5.59659 -5.75795 ];
bh2=446.385+[1.65142 1.27031 0.80819 0.418221 0.274196 0.0501222 -0.0562799 -0.0358755 0.080756 0.263801 0.467982 0.932633 1.28074 1.38485 1.73058 2.14142 2.35552 2.67245 2.86874 3.11942 3.29897];
bh3=-705.203+[-0.521951 -0.845275 -0.638781 -0.405961 -0.307687 -0.0973165 0.0946877 0.218733 0.3848 0.516417 0.621015 0.785084 0.879971 0.907157 0.987379 1.07314 1.11597 1.18007 1.2206 1.2729 1.31009 ];
% 31500
bi1=9.70641+[-0.263984 -0.105896 -0.209005 -0.474682 -0.620952 -0.99746 -1.40799 -1.71502 -2.16367 -2.55469 -2.88703 -3.46857 -3.84028 -3.9482 -4.27909 -4.64109 -4.82304 -5.09274 -5.26165 -5.47861 -5.63447 ];
bi2=444.066+[1.50764 1.12752 0.711984 0.372508 0.249846 0.067395 -0.00652198 0.0300923 0.164656 0.357898 0.567694 1.03532 1.38172 1.48479 1.82498 2.22684 2.43591 2.74555 2.93753 3.18285 3.3587];
bi3=-707.086+[-0.371135 -0.689198 -0.538926 -0.366672 -0.293992 -0.134889 0.013871 0.112833 0.248139 0.358632 0.448591 0.594143 0.680614 0.70572 0.781539 0.864818 0.906772 0.969238 1.00834 1.05823 1.09322];
% 37435
bk1=16.2708+[-0.296601 -0.141189 -0.124839 -0.246654 -0.326533 -0.557926 -0.829354 -1.04178 -1.3596 -1.6409 -1.88068 -2.3029 -2.57549 -2.65475 -2.89701 -3.16257 -3.29488 -3.48847 -3.60813 -3.76051 -3.86872];
bk2=449.059+[1.06322 0.60052 0.259359 -0.00831589 -0.101105 -0.23094 -0.28312 -0.251284 -0.141443 0.0119243 0.174564 0.536407 0.805635 0.885818 1.14864 1.46266 1.62584 1.86515 2.01265 2.20045 2.33337];
bk3=-710.186+[-0.380102 -0.65123 -0.521417 -0.358923 -0.290072 -0.129088 0.0317927 0.140471 0.291648 0.416706 0.51941 0.684652 0.782317 0.810288 0.893057 0.979025 1.02144 1.08459 1.12446 1.1753 1.21102];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C5-C6 Left Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
