%% foreman height and width narrowing/widening 

% 5N!!

% for all models for the c3-c4 left hand side foreman under lateral bending (_n)
% 1297,16439,17116,14886

% Values for displacements have not been replaced. base coordinates have,
% but need checking. 
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 1297,16439,17116,14886
%% model15_intact_TLC_5N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 1297
aa1=12.7746+[4.8745400e-01   1.3787300e-02  -4.2115800e-01  -1.1113700e+00  -1.8060600e+00  -2.4670500e+00  -3.0439100e+00  -3.6634400e+00  -4.3575400e+00  -4.9128700e+00  -5.6206400e+00  -5.9860700e+00  -6.4726200e+00  -6.7936000e+00  -7.1407300e+00  -7.4986700e+00  -7.8127500e+00  -8.1711900e+00  -8.4067400e+00  -8.7367100e+00  -8.9250500e+00];
aa2=447.736+[1.5391800e+00   3.4385900e-01   1.9810000e-02  -1.3139700e-01   5.5523100e-02   4.1758200e-01   8.5285400e-01   1.4019700e+00   2.0778700e+00   2.6312400e+00   3.3387600e+00   3.6883700e+00   4.1312900e+00   4.4179500e+00   4.7102700e+00   5.0006800e+00   5.2594000e+00   5.5668700e+00   5.7723700e+00   6.0599300e+00   6.2252900e+00];
aa3=-690.116+[-1.1235400e+00  -7.5194000e-01  -5.3779900e-01  -2.6771400e-01  -5.1096100e-02   1.2010200e-01   2.4522400e-01   3.6260300e-01   4.7360900e-01   5.4984500e-01   6.3861900e-01   6.8619200e-01   7.4792700e-01   7.8894100e-01   8.3695200e-01   8.8746900e-01   9.3075000e-01   9.7789800e-01   1.0076500e+00   1.0472000e+00   1.0683100e+00];

% 16439
ab1=13.5613+[3.1910900e-01   1.1318000e-02  -2.9876200e-01  -7.9677000e-01  -1.3119200e+00  -1.8114800e+00  -2.2522200e+00  -2.7265300e+00  -3.2560200e+00  -3.6790300e+00  -4.2149700e+00  -4.4890900e+00  -4.8526700e+00  -5.0928100e+00  -5.3513900e+00  -5.6175400e+00  -5.8505300e+00  -6.1163200e+00  -6.2907600e+00  -6.5338400e+00  -6.6719000e+00];
ab2=447.206+[1.0864800e+00   9.4693900e-02  -1.8878200e-01  -3.3910500e-01  -2.1177200e-01   6.2544300e-02   3.9881300e-01   8.2614300e-01   1.3511100e+00   1.7810900e+00   2.3287800e+00   2.5979400e+00   2.9374800e+00   3.1578000e+00   3.3819300e+00   3.6034400e+00   3.7999600e+00   4.0320400e+00   4.1875800e+00   4.4064100e+00   4.5314900e+00];
ab3=-699.132+[-9.9227400e-01  -6.9600800e-01  -5.0944000e-01  -2.7923000e-01  -8.6998500e-02   7.1154600e-02   1.9117600e-01   3.0865800e-01   4.2698200e-01   5.1403000e-01   6.1915400e-01   6.7573000e-01   7.5118700e-01   8.0167400e-01   8.5885800e-01   9.1911100e-01   9.7113200e-01   1.0294700e+00   1.0682800e+00   1.1205800e+00   1.1493700e+00];

% 17116
ac1=16.2684+[3.1756800e-01   6.1899100e-03  -3.0994500e-01  -8.1973000e-01  -1.3516000e+00  -1.8691300e+00  -2.3264300e+00  -2.8187200e+00  -3.3678700e+00  -3.8074100e+00  -4.3661200e+00  -4.6525300e+00  -5.0329200e+00  -5.2847200e+00  -5.5563400e+00  -5.8362300e+00  -6.0813200e+00  -6.3608800e+00  -6.5446100e+00  -6.8006700e+00  -6.9459900e+00];
ac2=443.597+[1.2257500e+00   1.4106000e-01  -1.8089000e-01  -3.6883900e-01  -2.5561500e-01   1.7435000e-02   3.6010100e-01   7.9889100e-01   1.3395800e+00   1.7835400e+00   2.3511100e+00   2.6300400e+00   2.9816500e+00   3.2101700e+00   3.4423900e+00   3.6717000e+00   3.8750600e+00   4.1154200e+00   4.2764700e+00   4.5030200e+00   4.6324300e+00];
ac3=-706.266+[-1.1326600e+00  -7.3655800e-01  -5.0620700e-01  -2.2888400e-01  -8.0788800e-03   1.6749500e-01   2.9639100e-01   4.1914400e-01   5.4009200e-01   6.2846800e-01   7.3456300e-01   7.9245200e-01   8.7082700e-01   9.2342000e-01   9.8389700e-01   1.0482300e+00   1.1037700e+00   1.1656100e+00   1.2067800e+00   1.2622900e+00   1.2928300e+00];

% 14886
ad1=9.91704+[5.2208400e-01   2.9868700e-02  -4.1381800e-01  -1.1137500e+00  -1.8104900e+00  -2.4692500e+00  -3.0420000e+00  -3.6562200e+00  -4.3444200e+00  -4.8936300e+00  -5.5907200e+00  -5.9496700e+00  -6.4267800e+00  -6.7406200e+00  -7.0793700e+00  -7.4281700e+00  -7.7338700e+00  -8.0824300e+00  -8.3110800e+00  -8.6310800e+00  -8.8136300e+00];
ad2=444.847+[1.4321600e+00   3.2888800e-01   4.9277900e-02  -4.7365000e-02   1.7336600e-01   5.5554200e-01   1.0009900e+00   1.5571100e+00   2.2389100e+00   2.7954400e+00   3.5043400e+00   3.8549000e+00   4.2996300e+00   4.5868800e+00   4.8802900e+00   5.1721100e+00   5.4318900e+00   5.7402100e+00   5.9460900e+00   6.2341900e+00   6.3999700e+00];
ad3=-691.954+[-1.0061900e+00  -7.5612100e-01  -5.9647400e-01  -3.9095500e-01  -2.1787800e-01  -7.6477000e-02   2.9918900e-02   1.3136400e-01   2.2731200e-01   2.9179600e-01   3.6534100e-01   4.0359700e-01   4.5129800e-01   4.8274200e-01   5.1909800e-01   5.5673600e-01   5.8859600e-01   6.2287900e-01   6.4397500e-01   6.7108700e-01   6.8489700e-01];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3']
y15=[ya1',ya2',ya3']

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 1297
ae1=12.7746+[-3.0399900e-01  -2.0217800e-01  -4.2360100e-01  -7.8337500e-01  -1.3141100e+00  -1.5793000e+00  -2.1718800e+00  -2.7299200e+00  -3.3468800e+00  -3.9437800e+00  -4.5076800e+00  -5.0471600e+00  -5.6571600e+00  -6.2340000e+00  -7.0085800e+00  -7.4861100e+00  -7.7973400e+00  -8.2989100e+00  -8.6211400e+00  -9.2136400e+00  -9.2793400e+00];
ae2=447.736+[2.4876100e+00   2.2111500e+00   1.7352900e+00   1.3582400e+00   9.4752300e-01   7.8899400e-01   5.3885900e-01   4.1554200e-01   4.0602000e-01   5.1156200e-01   6.8918200e-01   9.1919300e-01   1.2533600e+00   1.6431500e+00   2.2805000e+00   2.7343300e+00   3.0541000e+00   3.5997500e+00   3.9706100e+00   4.6750100e+00   4.7541900e+00];
ae3=-690.116+[-1.1890200e+00  -1.4244300e+00  -1.1670800e+00  -9.1325000e-01  -6.2030300e-01  -4.9855000e-01  -2.6347000e-01  -7.5967100e-02   1.0066200e-01   2.5057000e-01   3.7834600e-01   4.8906900e-01   6.0218300e-01   6.9808200e-01   8.1166400e-01   8.7418700e-01   9.1115800e-01   9.6470100e-01   9.9416300e-01   1.0420400e+00   1.0469600e+00];

% 16439
af1=13.5613+[-3.2124000e-01  -2.2133300e-01  -3.2420400e-01  -5.5617800e-01  -9.2177000e-01  -1.1098100e+00  -1.5390900e+00  -1.9526200e+00  -2.4175000e+00  -2.8708700e+00  -3.3018100e+00  -3.7166800e+00  -4.1865600e+00  -4.6304400e+00  -5.2272600e+00  -5.5942300e+00  -5.8324700e+00  -6.2141100e+00  -6.4570800e+00  -6.9002100e+00  -6.9490000e+00];
af2=447.206+[1.8134300e+00   1.5563000e+00   1.1561300e+00   8.3267900e-01   4.7356800e-01   3.3232100e-01   1.0276500e-01  -2.0314200e-02  -4.9775500e-02   2.0197700e-02   1.5255500e-01   3.2743800e-01   5.8360900e-01   8.8475500e-01   1.3758700e+00   1.7260200e+00   1.9723700e+00   2.3892800e+00   2.6723600e+00   3.2109400e+00   3.2714400e+00];
af3=-699.132+[-9.0469200e-01  -1.1581400e+00  -9.6422300e-01  -7.5264400e-01  -5.0359200e-01  -3.9921800e-01  -1.9513600e-01  -2.9077100e-02   1.3126000e-01   2.7212400e-01   3.9600900e-01   5.0679200e-01   6.2422900e-01   7.2889300e-01   8.6073900e-01   9.3771000e-01   9.8579900e-01   1.0601000e+00   1.1054700e+00   1.1842400e+00   1.1925300e+00];

% 17116
ag1=16.2684+[-3.4470400e-01  -2.4491500e-01  -3.5102200e-01  -5.8715300e-01  -9.5930300e-01  -1.1509300e+00  -1.5898900e+00  -2.0146200e+00  -2.4940200e+00  -2.9636100e+00  -3.4114200e+00  -3.8431700e+00  -4.3321300e+00  -4.7941800e+00  -5.4168100e+00  -5.8004800e+00  -6.0497500e+00  -6.4491000e+00  -6.7035400e+00  -7.1680600e+00  -7.2192300e+00];
ag2=449.981+[1.9898500e+00   1.7300200e+00   1.2857900e+00   9.1805200e-01   5.0647000e-01   3.4252500e-01   7.0218300e-02  -8.3521100e-02  -1.3683000e-01  -8.1878700e-02   4.2208800e-02   2.1352800e-01   4.7001400e-01   7.7579600e-01   1.2825400e+00   1.6471400e+00   1.9044600e+00   2.3405700e+00   2.6372600e+00   3.2021500e+00   3.2656100e+00];
ag3=-696.273+[-1.0629800e+00  -1.3137400e+00  -1.0693300e+00  -8.0764700e-01  -4.9971400e-01  -3.6983900e-01  -1.1614500e-01   8.8351900e-02   2.8307500e-01   4.5134800e-01   5.9690600e-01   7.2503500e-01   8.5811800e-01   9.7376600e-01   1.1131600e+00   1.1910800e+00   1.2384600e+00   1.3101000e+00   1.3525800e+00   1.4248500e+00   1.4323700e+00];

% 14886
ah1=9.91704+[-2.6361700e-01  -1.6321200e-01  -3.9700600e-01  -7.6760800e-01  -1.3092400e+00  -1.5781900e+00  -2.1756200e+00  -2.7344900e+00  -3.3488000e+00  -3.9401100e+00  -4.4964900e+00  -5.0274200e+00  -5.6271900e+00  -6.1938700e+00  -6.9529000e+00  -7.4197100e+00  -7.7235900e+00  -8.2128400e+00  -8.5267600e+00  -9.1026400e+00  -9.1663600e+00];
ah2=448.847+[2.3816500e+00   2.1154100e+00   1.6936800e+00   1.3690300e+00   1.0212900e+00   8.9009200e-01   6.9243200e-01   6.0935800e-01   6.3495100e-01   7.6697500e-01   9.6424600e-01   1.2088000e+00   1.5554600e+00   1.9535700e+00   2.5939300e+00   3.0453800e+00   3.3624100e+00   3.9021700e+00   4.2684000e+00   4.9631500e+00   5.0412000e+00];
ah3=-691.954+[-1.0819800e+00  -1.3318900e+00  -1.1435500e+00  -9.5453600e-01  -7.3781100e-01  -6.4897900e-01  -4.7785600e-01  -3.4100900e-01  -2.1133500e-01  -1.0033000e-01  -4.9566300e-03   7.8584500e-02   1.6527000e-01   2.3992200e-01   3.3216500e-01   3.8505900e-01   4.1672800e-01   4.6287500e-01   4.8814400e-01   5.2814600e-01   5.3211900e-01];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5N
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 1297
ai1=12.7746+[-1.7128900e-01  -1.3897800e-01  -2.4239100e-01  -4.1757900e-01  -6.5899700e-01  -1.0044300e+00  -1.1796700e+00  -1.5940300e+00  -2.0375300e+00  -2.4870900e+00  -3.0619600e+00  -3.4074000e+00  -3.8907700e+00  -4.6587800e+00  -4.9837100e+00  -5.3898900e+00  -6.1840000e+00  -6.5128200e+00  -7.0796300e+00  -7.6729900e+00  -7.9501700e+00];
ai2=447.736+[2.9455100e+00   2.8002800e+00   2.5389100e+00   2.3039900e+00   2.0621200e+00   1.7789100e+00   1.6584400e+00   1.4205900e+00   1.2199700e+00   1.0707400e+00   9.3960000e-01   9.0048900e-01   8.7630000e-01   9.3715600e-01   9.8906200e-01   1.0788600e+00   1.3266000e+00   1.4531700e+00   1.7116400e+00   2.0394700e+00   2.2106300e+00];
ai3=-690.116+[-1.4399000e+00  -1.5110100e+00  -1.3486000e+00  -1.1642800e+00  -9.6218300e-01  -7.2082400e-01  -6.1576500e-01  -3.9805300e-01  -2.0307800e-01  -3.4448500e-02   1.5496800e-01   2.5672800e-01   3.9049000e-01   5.7865900e-01   6.5131500e-01   7.3619000e-01   8.8611200e-01   9.4348200e-01   1.0355900e+00   1.1248900e+00   1.1643700e+00];

% 16439
aj1=13.5613+[-2.2044400e-01  -1.8554700e-01  -2.1548400e-01  -3.0544300e-01  -4.4698100e-01  -6.6296400e-01  -7.7755300e-01  -1.0591000e+00  -1.3710900e+00  -1.6949900e+00  -2.1176000e+00  -2.3752400e+00  -2.7380100e+00  -3.3225300e+00  -3.5717700e+00  -3.8842100e+00  -4.4970900e+00  -4.7510700e+00  -5.1882300e+00  -5.6446200e+00  -5.8572400e+00];
aj2=447.206+[2.1526800e+00   2.0451200e+00   1.8375400e+00   1.6427800e+00   1.4389100e+00   1.1928500e+00   1.0847100e+00   8.6501800e-01   6.7472900e-01   5.2880000e-01   3.9370100e-01   3.4721200e-01   3.0748200e-01   3.2894200e-01   3.6047800e-01   4.2008300e-01   5.9456500e-01   6.8545800e-01   8.7401100e-01   1.1169000e+00   1.2443600e+00];
aj3=-699.132+[-1.1264800e+00  -1.2265700e+00  -1.1232600e+00  -9.8310000e-01  -8.2212200e-01  -6.2580700e-01  -5.3897000e-01  -3.5473600e-01  -1.8719400e-01  -3.9960800e-02   1.2808700e-01   2.2031400e-01   3.4281000e-01   5.2031700e-01   5.9083200e-01   6.7540900e-01   8.3197500e-01   8.9461800e-01   9.9940100e-01   1.1055500e+00   1.1537700e+00];

% 17116
ak1=16.2684+[-2.4201000e-01  -2.1036500e-01  -2.4572600e-01  -3.3968700e-01  -4.8582100e-01  -7.0722600e-01  -8.2434500e-01  -1.1122100e+00  -1.4307200e+00  -1.7622300e+00  -2.1961300e+00  -2.4617800e+00  -2.8367600e+00  -3.4437800e+00  -3.7030800e+00  -4.0285100e+00  -4.6674200e+00  -4.9322800e+00  -5.3885800e+00  -5.8658600e+00  -6.0884000e+00];
ak2=449.981+[2.3669000e+00   2.2562700e+00   2.0268500e+00   1.8059100e+00   1.5721900e+00   1.2886900e+00   1.1637100e+00   9.0864700e-01   6.8520000e-01   5.1065000e-01   3.4429500e-01   2.8239500e-01   2.2356200e-01   2.2323600e-01   2.4757400e-01   3.0007000e-01   4.6527800e-01   5.5373900e-01   7.4091400e-01   9.8717100e-01   1.1174400e+00];
ak3=-696.273+[-1.3288600e+00  -1.4223400e+00  -1.2893600e+00  -1.1166700e+00  -9.1931500e-01  -6.7881000e-01  -5.7240300e-01  -3.4691300e-01  -1.4111400e-01   4.0206200e-02   2.4731000e-01   3.6058800e-01   5.1082800e-01   7.2673100e-01   8.1195700e-01   9.1347500e-01   1.0992900e+00   1.1727900e+00   1.2940800e+00   1.4139200e+00   1.4675700e+00];

% 14886
al1=9.91704+[-1.2909300e-01  -9.5070400e-02  -2.0347700e-01  -3.8525700e-01  -6.3347100e-01  -9.8666200e-01  -1.1650600e+00  -1.5850500e+00  -2.0329100e+00  -2.4846400e+00  -3.0593800e+00  -3.4029300e+00  -3.8819900e+00  -4.6389000e+00  -4.9583300e+00  -5.3570700e+00  -6.1354700e+00  -6.4573800e+00  -7.0113700e+00  -7.5900400e+00  -7.8599400e+00];
al2=444.847+[2.8113300e+00   2.6748400e+00   2.4455000e+00   2.2447600e+00   2.0408200e+00   1.8043700e+00   1.7047000e+00   1.5103700e+00   1.3510200e+00   1.2384400e+00   1.1485600e+00   1.1306700e+00   1.1332900e+00   1.2277500e+00   1.2919200e+00   1.3953200e+00   1.6654000e+00   1.7998600e+00   2.0693500e+00   2.4046800e+00   2.5783100e+00];
al3=-691.954+[-1.2862800e+00  -1.3748700e+00  -1.2586900e+00  -1.1200900e+00  -9.6756400e-01  -7.8547200e-01  -7.0625600e-01  -5.4224100e-01  -3.9735300e-01  -2.7376500e-01  -1.3656500e-01  -6.3206100e-02   3.3024000e-02   1.6849300e-01   2.2060700e-01   2.8139700e-01   3.8844200e-01   4.2935100e-01   4.9512400e-01   5.6009400e-01   5.8895500e-01];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 1297
am1=12.7746+[3.3679900e-01   3.4035000e-01   2.8109700e-01   1.8943900e-01   6.4932700e-02  -9.0995600e-02  -3.0641700e-01  -4.1455900e-01  -6.4619100e-01  -9.0530000e-01  -1.1642300e+00  -1.5275100e+00  -1.7902200e+00  -2.1185700e+00  -2.5357600e+00  -2.9205500e+00  -3.2626300e+00  -3.6218800e+00  -4.3633800e+00  -4.4663700e+00  -4.7953600e+00];
am2=447.736+[2.5609300e+00   2.4986200e+00   2.3688200e+00   2.2427100e+00   2.1020500e+00   1.9508800e+00   1.7676100e+00   1.6859300e+00   1.5293600e+00   1.3775900e+00   1.2476800e+00   1.0953300e+00   1.0002100e+00   8.9921000e-01   7.9819100e-01   7.2660300e-01   6.8224900e-01   6.5310000e-01   6.5689500e-01   6.6119700e-01   6.8455900e-01];
am3=-690.116+[-1.7303000e+00  -1.6935400e+00  -1.5653500e+00  -1.4289300e+00  -1.2747000e+00  -1.1094800e+00  -9.0763900e-01  -8.1645500e-01  -6.4112100e-01  -4.6816700e-01  -3.1474900e-01  -1.2570600e-01  -5.1401400e-03   1.3078700e-01   2.8642700e-01   4.1710200e-01   5.2311300e-01   6.2589700e-01   8.1428200e-01   8.3914200e-01   9.1541700e-01];
% 16439
an1=13.5613+[1.6922800e-01   1.7394200e-01   1.5368100e-01   1.1480800e-01   5.5532800e-02  -2.3375300e-02  -1.3761600e-01  -1.9763500e-01  -3.3070900e-01  -4.8720800e-01  -6.5078700e-01  -8.9029000e-01  -1.0686400e+00  -1.2967900e+00  -1.5928600e+00  -1.8698500e+00  -2.1189200e+00  -2.3829700e+00  -2.9337000e+00  -3.0105600e+00  -3.2574500e+00];
an2=447.206+[1.8377900e+00   1.8066400e+00   1.7269600e+00   1.6354200e+00   1.5270400e+00   1.4067000e+00   1.2540500e+00   1.1835500e+00   1.0452900e+00   9.0722300e-01   7.8490000e-01   6.3579000e-01   5.3881000e-01   4.3015300e-01   3.1423400e-01   2.2682400e-01   1.6705800e-01   1.1930800e-01   7.3708100e-02   7.0693200e-02   6.9878200e-02];
an3=-699.132+[-1.4183800e+00  -1.4137000e+00  -1.3426600e+00  -1.2503600e+00  -1.1377300e+00  -1.0126300e+00  -8.5639100e-01  -7.8401800e-01  -6.4293700e-01  -5.0128200e-01  -3.7303300e-01  -2.1285800e-01  -1.1039900e-01   5.9282000e-03   1.4139600e-01   2.5708200e-01   3.5264000e-01   4.4767700e-01   6.2913700e-01   6.5341400e-01   7.2870600e-01];
% 17116
ao1=16.2684+[1.5435300e-01   1.5554900e-01   1.2872000e-01   8.4549500e-02   2.0016300e-02  -6.3840100e-02  -1.8388800e-01  -2.4663600e-01  -3.8486200e-01  -5.4680100e-01  -7.1589300e-01  -9.6282900e-01  -1.1457700e+00  -1.3794400e+00  -1.6829400e+00  -1.9673100e+00  -2.2234200e+00  -2.4954700e+00  -3.0649900e+00  -3.1446300e+00  -3.4007700e+00];
ao2=449.981+[2.0571100e+00   2.0246800e+00   1.9355200e+00   1.8306800e+00   1.7053100e+00   1.5651100e+00   1.3866600e+00   1.3041100e+00   1.1421300e+00   9.8034600e-01   8.3703600e-01   6.6207600e-01   5.4751700e-01   4.1825600e-01   2.7839900e-01   1.7106400e-01   9.5409800e-02   3.2596900e-02  -3.8527500e-02  -4.4755900e-02  -5.4835500e-02];
ao3=-696.273+[-1.6334300e+00  -1.6237200e+00  -1.5354400e+00  -1.4230500e+00  -1.2865600e+00  -1.1350900e+00  -9.4581200e-01  -8.5821400e-01  -6.8774200e-01  -5.1697200e-01  -3.6275500e-01  -1.7056800e-01  -4.7092800e-02   9.3663300e-02   2.5795800e-01   3.9831500e-01   5.1428700e-01   6.2959200e-01   8.4928800e-01   8.7867400e-01   9.6961300e-01];
% 14886
ap1=9.91704+[3.8729600e-01   3.9283400e-01   3.3309300e-01   2.3941400e-01   1.1185300e-01  -4.7943100e-02  -2.6785000e-01  -3.7792600e-01  -6.1331200e-01  -8.7569200e-01  -1.1368700e+00  -1.5022800e+00  -1.7664700e+00  -2.0961600e+00  -2.5137400e+00  -2.8978000e+00  -3.2383400e+00  -3.5950600e+00  -4.3277600e+00  -4.4292600e+00  -4.7529800e+00];
ap2=444.847+[2.4108500e+00   2.3546600e+00   2.2440800e+00   2.1387800e+00   2.0225300e+00   1.8987200e+00   1.7493700e+00   1.6831800e+00   1.5571900e+00   1.4361900e+00   1.3337200e+00   1.2157400e+00   1.1439100e+00   1.0700600e+00   1.0004800e+00   9.5558000e-01   9.3303000e-01   9.2503500e-01   9.6611500e-01   9.7520800e-01   1.0128900e+00];
ap3=-691.954+[-1.5620500e+00  -1.5386500e+00  -1.4425200e+00  -1.3379000e+00  -1.2190700e+00  -1.0917400e+00  -9.3582100e-01  -8.6522600e-01  -7.2963300e-01  -5.9611400e-01  -4.7770400e-01  -3.3206500e-01  -2.4001500e-01  -1.3703500e-01  -1.9996500e-02   7.7422600e-02   1.5568400e-01   2.3076900e-01   3.6632500e-01   3.8409300e-01   4.3842500e-01];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 1297
aq1=12.7746+[-4.3484900e-01   4.5336700e-02  -6.8568000e-01  -1.2757100e+00  -2.0719100e+00  -2.7645900e+00  -3.5272700e+00  -4.1729600e+00  -5.0100000e+00  -5.5644700e+00  -6.0574900e+00  -6.6374800e+00  -7.0096100e+00  -7.4203800e+00  -7.8757900e+00  -8.1055600e+00  -8.4586000e+00  -8.8632000e+00  -9.0600000e+00  -9.5359600e+00  -9.6131600e+00];
aq2=447.736+[2.5760800e+00   8.5515600e-01  -6.6887000e-02  -2.7136900e-01  -1.4059300e-01   1.9285600e-01   7.6147000e-01   1.3609700e+00   2.2120400e+00   2.7803300e+00   3.2551200e+00   3.7786900e+00   4.0826700e+00   4.4145900e+00   4.7826900e+00   4.9749400e+00   5.2798900e+00   5.6430300e+00   5.8257900e+00   6.2848800e+00   6.3609800e+00];
aq3=-690.116+[-9.0088400e-02  -1.3319700e+00  -9.0338200e-01  -6.6407300e-01  -3.9703200e-01  -2.0440400e-01  -3.2048900e-02   8.9061800e-02   2.2192700e-01   2.9983000e-01   3.7019700e-01   4.5639900e-01   5.1539600e-01   5.8023600e-01   6.5072100e-01   6.8372100e-01   7.3171000e-01   7.8079200e-01   8.0164300e-01   8.4624600e-01   8.5286000e-01];
% 16439
ar1=13.5613+[-4.2097600e-01   4.1301300e-03  -5.0704900e-01  -9.3893100e-01  -1.5285700e+00  -2.0519000e+00  -2.6365400e+00  -3.1320400e+00  -3.7749400e+00  -4.1998500e+00  -4.5742400e+00  -5.0121200e+00  -5.2913500e+00  -5.5990400e+00  -5.9397700e+00  -6.1116200e+00  -6.3747400e+00  -6.6746500e+00  -6.8201200e+00  -7.1703300e+00  -7.2268600e+00];
ar2=447.206+[1.7838300e+00   4.3820700e-01  -3.4248400e-01  -5.2611600e-01  -4.4610400e-01  -1.9402000e-01   2.4795100e-01   7.1662400e-01   1.3852100e+00   1.8327300e+00   2.2043100e+00   2.6098600e+00   2.8428400e+00   3.0951300e+00   3.3725700e+00   3.5174700e+00   3.7457900e+00   4.0178900e+00   4.1555000e+00   4.5008800e+00   4.5581500e+00];
ar3=-699.132+[7.7023900e-02  -1.1060900e+00  -7.3301800e-01  -5.2074700e-01  -2.7779500e-01  -9.7017200e-02   7.3338100e-02   2.0081400e-01   3.4998500e-01   4.4061600e-01   5.2094400e-01   6.1661300e-01   6.7988800e-01   7.4989500e-01   8.2712200e-01   8.6488700e-01   9.2143900e-01   9.8352200e-01   1.0124300e+00   1.0777900e+00   1.0877300e+00];
% 17116
as1=16.2684+[-4.5758100e-01  -7.7121000e-03  -5.2468200e-01  -9.6495800e-01  -1.5703300e+00  -2.1103900e+00  -2.7149600e+00  -3.2279700e+00  -3.8941400e+00  -4.3356400e+00  -4.7259000e+00  -5.1829500e+00  -5.4747000e+00  -5.7963600e+00  -6.1529500e+00  -6.3328200e+00  -6.6084800e+00  -6.9229800e+00  -7.0756300e+00  -7.4432100e+00  -7.5025200e+00];
as2=449.981+[1.9827400e+00   5.3701900e-01  -3.3891800e-01  -5.6329300e-01  -5.0955200e-01  -2.6425000e-01   1.8369100e-01   6.6459900e-01   1.3533600e+00   1.8162200e+00   2.2012600e+00   2.6208200e+00   2.8613700e+00   3.1219200e+00   3.4087400e+00   3.5587500e+00   3.7954300e+00   4.0779400e+00   4.2209400e+00   4.5800700e+00   4.6396300e+00];
as3=-696.273+[-9.3101500e-02  -1.1935200e+00  -7.1923100e-01  -4.6009300e-01  -1.7824600e-01   2.3794500e-02   2.0644100e-01   3.3816700e-01   4.8910300e-01   5.7989500e-01   6.6133900e-01   7.6026000e-01   8.2701700e-01   9.0099100e-01   9.8259400e-01   1.0221800e+00   1.0811900e+00   1.1454000e+00   1.1750800e+00   1.2414900e+00   1.2515000e+00];
% 14886
at1=9.91704+[-3.8613900e-01   7.4133200e-02  -6.7762300e-01  -1.2764100e+00  -2.0775200e+00  -2.7690000e+00  -3.5273100e+00  -4.1679700e+00  -4.9969700e+00  -5.5441500e+00  -6.0290600e+00  -6.5981100e+00  -6.9625400e+00  -7.3644100e+00  -7.8093500e+00  -8.0337100e+00  -8.3778700e+00  -8.7714700e+00  -8.9627100e+00  -9.4243200e+00  -9.4991000e+00];
at2=444.847+[2.4369800e+00   8.1284200e-01  -8.4693800e-03  -1.6080300e-01   1.7115600e-02   3.7649500e-01   9.6086600e-01   1.5675900e+00   2.4241300e+00   2.9938900e+00   3.4699500e+00   3.9957200e+00   4.3019500e+00   4.6363000e+00   5.0067900e+00   5.2000000e+00   5.5056500e+00   5.8687200e+00   6.0511500e+00   6.5086000e+00   6.5843900e+00];
at3=-691.954+[6.2514600e-02  -1.3119600e+00  -1.0053800e+00  -8.2682900e-01  -6.1584500e-01  -4.5801800e-01  -3.1099900e-01  -2.0510100e-01  -8.8856600e-02  -2.1682600e-02   3.7199200e-02   1.0742700e-01   1.5444500e-01   2.0577000e-01   2.6108100e-01   2.8664700e-01   3.2349200e-01   3.5993000e-01   3.7477300e-01   4.0483400e-01   4.0904600e-01];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 1297
au1=12.7746+[3.1852000e-01   3.2237400e-01   2.9060600e-01   2.2551200e-01   3.4980300e-02  -1.2550600e-01  -2.3559400e-01  -3.8944700e-01  -7.3522600e-01  -8.9379000e-01  -1.2028500e+00  -1.4120200e+00  -1.7153800e+00  -2.1772600e+00  -2.4587000e+00  -2.8189400e+00  -3.2597600e+00  -3.5843400e+00  -4.0522100e+00  -4.3945700e+00  -4.6888300e+00];
au2=447.736+[2.6057600e+00   2.5453500e+00   2.4542300e+00   2.3397700e+00   2.1180200e+00   1.9674900e+00   1.8724000e+00   1.7539900e+00   1.5281100e+00   1.4379100e+00   1.2836700e+00   1.1930600e+00   1.0776900e+00   9.3473000e-01   8.6792000e-01   8.0119000e-01   7.3926300e-01   7.1497500e-01   7.0176100e-01   7.1316400e-01   7.3302700e-01];
au3=-690.116+[-1.7472500e+00  -1.7098200e+00  -1.6169900e+00  -1.4922600e+00  -1.2436500e+00  -1.0748700e+00  -9.6755700e-01  -8.3186200e-01  -5.7158200e-01  -4.6598200e-01  -2.8001800e-01  -1.6733600e-01  -2.0791600e-02   1.7502300e-01   2.8121500e-01   4.0646600e-01   5.4730300e-01   6.4077800e-01   7.6559600e-01   8.5002900e-01   9.1920400e-01];
% 16439
av1=13.5613+[1.4615900e-01   1.5214500e-01   1.4959800e-01   1.2960600e-01   4.3170700e-02  -3.7699500e-02  -9.4582100e-02  -1.7799000e-01  -3.7721200e-01  -4.7287700e-01  -6.6706700e-01  -8.0344500e-01  -1.0068100e+00  -1.3261200e+00  -1.5255800e+00  -1.7841200e+00  -2.1033700e+00  -2.3415200e+00  -2.6867300e+00  -2.9416100e+00  -3.1621100e+00];
av2=447.206+[1.8708400e+00   1.8409100e+00   1.7882500e+00   1.7096300e+00   1.5400600e+00   1.4189100e+00   1.3399100e+00   1.2385200e+00   1.0385600e+00   9.5609700e-01   8.1041500e-01   7.2230100e-01   6.0634900e-01   4.5351000e-01   3.7731200e-01   2.9681300e-01   2.1617800e-01   1.7495300e-01   1.3245100e-01   1.1983800e-01   1.1834500e-01];
av3=-699.132+[-1.4334300e+00  -1.4275700e+00  -1.3775700e+00  -1.2986400e+00  -1.1182300e+00  -9.8899800e-01  -9.0570000e-01  -7.9790500e-01  -5.8700100e-01  -4.9995200e-01  -3.4374700e-01  -2.4819800e-01  -1.2359700e-01   4.4522500e-02   1.3715500e-01   2.4794400e-01   3.7472900e-01   4.6140900e-01   5.8046100e-01   6.6279200e-01   7.3093600e-01];
% 17116
aw1=16.2684+[1.3041600e-01   1.3264600e-01   1.2418100e-01   9.8627300e-02   3.4079200e-03  -8.2562800e-02  -1.4268500e-01  -2.3034000e-01  -4.3761200e-01  -5.3676100e-01  -7.3777200e-01  -8.7848200e-01  -1.0873500e+00  -1.4146900e+00  -1.6192600e+00  -1.8848100e+00  -2.2131200e+00  -2.4586000e+00  -2.8150800e+00  -3.0790800e+00  -3.3078000e+00];
aw2=449.981+[2.0970500e+00   2.0659800e+00   2.0078600e+00   1.9186000e+00   1.7225600e+00   1.5810500e+00   1.4886000e+00   1.3696600e+00   1.1350700e+00   1.0384700e+00   8.6777100e-01   7.6428000e-01   6.2724400e-01   4.4477600e-01   3.5233600e-01   2.5296400e-01   1.5122500e-01   9.6445700e-02   3.6264900e-02   1.2624800e-02   2.6455900e-03];
aw3=-696.273+[-1.6551300e+00  -1.6441300e+00  -1.5819000e+00  -1.4854800e+00  -1.2670900e+00  -1.1108200e+00  -1.0100000e+00  -8.7962600e-01  -6.2528600e-01  -5.2065000e-01  -3.3320400e-01  -2.1861100e-01  -6.8624700e-02   1.3479500e-01   2.4709100e-01   3.8138600e-01   5.3512400e-01   6.4018400e-01   7.8439700e-01   8.8398100e-01   9.6629100e-01];
% 14886
ax1=9.91704+[3.7090600e-01   3.7692500e-01   3.4591900e-01   2.7978400e-01   8.4672100e-02  -7.9602800e-02  -1.9186900e-01  -3.4835200e-01  -6.9919200e-01  -8.5954000e-01  -1.1711300e+00  -1.3816100e+00  -1.6867600e+00  -2.1503300e+00  -2.4319400e+00  -2.7914700e+00  -3.2304300e+00  -3.5526200e+00  -4.0157000e+00  -4.3533200e+00  -4.6429400e+00];
ax2=444.847+[2.4504300e+00   2.3959500e+00   2.3178500e+00   2.2217000e+00   2.0385600e+00   1.9156300e+00   1.8381600e+00   1.7421900e+00   1.5609400e+00   1.4891700e+00   1.3676000e+00   1.2972700e+00   1.2096400e+00   1.1052800e+00   1.0597100e+00   1.0181600e+00   9.8502400e-01   9.7975200e-01   9.9174800e-01   1.0194500e+00   1.0523000e+00];
ax3=-691.954+[-1.5725900e+00  -1.5485400e+00  -1.4793000e+00  -1.3840300e+00  -1.1921400e+00  -1.0617100e+00  -9.7861600e-01  -8.7335600e-01  -6.7168600e-01  -5.8992000e-01  -4.4594400e-01  -3.5897000e-01  -2.4674900e-01  -9.8207900e-02  -1.8297300e-02   7.5318300e-02   1.7955000e-01   2.4792300e-01   3.3812500e-01   3.9862900e-01   4.4799700e-01];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 1297
ay1=12.7746+[-4.3481100e-01  -2.0260500e-01  -5.2720400e-01  -9.6505200e-01  -1.8578300e+00  -2.2505000e+00  -2.7964400e+00  -3.4219600e+00  -4.1953300e+00  -5.0376800e+00  -5.4443500e+00  -6.1436900e+00  -6.6551900e+00  -7.0657100e+00  -7.4858500e+00  -8.1281400e+00  -8.4080900e+00  -8.6760600e+00  -8.9352300e+00  -9.4341100e+00  -9.4979500e+00];
ay2=447.736+[2.5760400e+00   1.6158300e+00   1.0624600e+00   6.2747200e-01   2.2161300e-01   1.5130500e-01   1.7972600e-01   3.6418400e-01   7.8771700e-01   1.4288800e+00   1.7824100e+00   2.4656800e+00   3.0094000e+00   3.4616800e+00   3.9246800e+00   4.5985000e+00   4.8838800e+00   5.1561000e+00   5.4176000e+00   5.9250900e+00   5.9906000e+00];
ay3=-690.116+[-9.1370300e-02  -1.3283300e+00  -1.0586400e+00  -8.0469600e-01  -4.3098100e-01  -2.9113700e-01  -1.2057600e-01   4.5818700e-02   2.2071600e-01   3.7715400e-01   4.4310700e-01   5.4179000e-01   6.0586000e-01   6.5426100e-01   7.0297200e-01   7.7807100e-01   8.1024200e-01   8.3926400e-01   8.6487900e-01   9.0987600e-01   9.1528600e-01];
% 16439
az1=13.5613+[-4.2095300e-01  -1.9313800e-01  -3.9133300e-01  -6.9538800e-01  -1.3431300e+00  -1.6330300e+00  -2.0422500e+00  -2.5170700e+00  -3.1084000e+00  -3.7550600e+00  -4.0682600e+00  -4.6061800e+00  -4.9964400e+00  -5.3090800e+00  -5.6281000e+00  -6.1117100e+00  -6.3209200e+00  -6.5205300e+00  -6.7128300e+00  -7.0809000e+00  -7.1277200e+00];
az2=447.206+[1.7840500e+00   1.0517900e+00   5.8427700e-01   2.1086000e-01  -1.4672700e-01  -2.1730200e-01  -2.1247800e-01  -8.1120100e-02   2.4400500e-01   7.4622900e-01   1.0248600e+00   1.5605600e+00   1.9840300e+00   2.3361400e+00   2.6942800e+00   3.2099600e+00   3.4254800e+00   3.6310800e+00   3.8291300e+00   4.2134400e+00   4.2632000e+00];
az3=-699.132+[7.5821900e-02  -1.0930000e+00  -8.7082400e-01  -6.5077000e-01  -3.2363400e-01  -1.9913400e-01  -4.4114800e-02   1.1160400e-01   2.8424200e-01   4.4956200e-01   5.2289000e-01   6.3860400e-01   7.1725800e-01   7.7772400e-01   8.3889000e-01   9.3376100e-01   9.7536200e-01   1.0146500e+00   1.0515700e+00   1.1193200e+00   1.1275500e+00];
% 17116
ba1=16.2684+[-4.5755800e-01  -2.1470200e-01  -4.1503000e-01  -7.2389800e-01  -1.3856600e+00  -1.6832300e+00  -2.1046800e+00  -2.5951800e+00  -3.2083500e+00  -3.8798300e+00  -4.2051900e+00  -4.7648700e+00  -5.1719400e+00  -5.4983500e+00  -5.8316600e+00  -6.3376800e+00  -6.5567700e+00  -6.7659300e+00  -6.9676000e+00  -7.3540500e+00  -7.4032500e+00];
ba2=449.981+[1.9828700e+00   1.1935900e+00   6.7176100e-01   2.4838300e-01  -1.7621600e-01  -2.6819700e-01  -2.8391200e-01  -1.6514600e-01   1.5729500e-01   6.6851900e-01   9.5443000e-01   1.5084900e+00   1.9495600e+00   2.3174200e+00   2.6916300e+00   3.2301500e+00   3.4549200e+00   3.6693600e+00   3.8758100e+00   4.2762600e+00   4.3280900e+00];
ba3=-696.273+[-9.4209400e-02  -1.2157900e+00  -9.3468500e-01  -6.5965700e-01  -2.5476800e-01  -1.0332700e-01   8.1481600e-02   2.6240000e-01   4.5636800e-01   6.3489500e-01   7.1203900e-01   8.2964700e-01   9.0649900e-01   9.6412700e-01   1.0224400e+00   1.1146700e+00   1.1557700e+00   1.1946300e+00   1.2313100e+00   1.2987800e+00   1.3069600e+00];
% 14886
bb1=9.91704+[-3.8609900e-01  -1.6956700e-01  -5.0763900e-01  -9.5596400e-01  -1.8593200e+00  -2.2536400e+00  -2.7992700e+00  -3.4215400e+00  -4.1873900e+00  -5.0193500e+00  -5.4203700e+00  -6.1084600e+00  -6.6103600e+00  -7.0124700e+00  -7.4236000e+00  -8.0510800e+00  -8.3239900e+00  -8.5848800e+00  -8.8369300e+00  -9.3208000e+00  -9.3826000e+00];
bb2=444.847+[2.4370000e+00   1.5498000e+00   1.0560900e+00   6.7701100e-01   3.5395300e-01   3.1253300e-01   3.7245100e-01   5.8327900e-01   1.0279900e+00   1.6822400e+00   2.0394800e+00   2.7238000e+00   3.2646000e+00   3.7130100e+00   4.1721100e+00   4.8414300e+00   5.1251200e+00   5.3957100e+00   5.6557300e+00   6.1600000e+00   6.2250800e+00];
bb3=-691.954+[6.1123100e-02  -1.2759200e+00  -1.0801200e+00  -8.9433600e-01  -6.2114300e-01  -5.1716200e-01  -3.8732600e-01  -2.5788800e-01  -1.1813000e-01   1.0026400e-02   6.4774800e-02   1.4872300e-01   2.0480000e-01   2.4782500e-01   2.9059400e-01   3.5383300e-01   3.7986700e-01   4.0266300e-01   4.2186200e-01   4.5346400e-01   4.5705400e-01];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 1297
bc1=12.7746+[3.8812000e-01   3.8697800e-01   3.0364500e-01   1.8561100e-01   3.0275000e-02  -1.6090800e-01  -4.2202200e-01  -6.3840500e-01  -9.7199200e-01  -1.1317300e+00  -1.5609600e+00  -1.8492100e+00  -2.1914400e+00  -2.6009100e+00  -2.9735200e+00  -3.3836100e+00  -3.8772600e+00  -4.1927500e+00  -4.6355400e+00  -5.2265100e+00  -5.5047100e+00];
bc2=447.736+[2.8364000e+00   2.7612400e+00   2.6162200e+00   2.4773000e+00   2.3246500e+00   2.1642100e+00   1.9711600e+00   1.8355500e+00   1.6512700e+00   1.5729400e+00   1.3916100e+00   1.2924200e+00   1.1926800e+00   1.1021300e+00   1.0391500e+00   9.9353800e-01   9.7068600e-01   9.7566200e-01   9.9862100e-01   1.0677000e+00   1.1130500e+00];
bc3=-690.116+[-1.3218300e+00  -1.2789900e+00  -1.1392300e+00  -9.9579200e-01  -8.3586700e-01  -6.6576500e-01  -4.6053200e-01  -3.1590700e-01  -1.1605500e-01  -2.9431200e-02   1.7650900e-01   2.9719200e-01   4.2792300e-01   5.6741500e-01   6.8479200e-01   8.0402300e-01   9.3520700e-01   1.0126200e+00   1.1157800e+00   1.2412300e+00   1.2962000e+00];
% 16439
bd1=13.5613+[2.2240800e-01   2.2858800e-01   1.9898600e-01   1.4389200e-01   6.2348900e-02  -4.7086900e-02  -2.0322800e-01  -3.3921800e-01  -5.5463300e-01  -6.6022900e-01  -9.5088200e-01  -1.1503500e+00  -1.3899200e+00  -1.6823300e+00  -1.9518500e+00  -2.2531500e+00  -2.6210000e+00  -2.8579300e+00  -3.1917500e+00  -3.6409300e+00  -3.8535000e+00];
bd2=447.206+[2.0702900e+00   2.0269800e+00   1.9264100e+00   1.8193000e+00   1.6965000e+00   1.5616600e+00   1.3926200e+00   1.2690300e+00   1.0964700e+00   1.0215700e+00   8.4401200e-01   7.4268900e-01   6.3646700e-01   5.3344100e-01   4.5708400e-01   3.9302200e-01   3.4462600e-01   3.3067400e-01   3.2380800e-01   3.4783000e-01   3.7038700e-01];
bd3=-699.132+[-1.1512300e+00  -1.1419700e+00  -1.0573400e+00  -9.5650800e-01  -8.3761700e-01  -7.0567700e-01  -5.4277700e-01  -4.2608600e-01  -2.6247700e-01  -1.9009300e-01  -1.5150700e-02   8.9907400e-02   2.0638300e-01   3.3496200e-01   4.4457500e-01   5.5786600e-01   6.8506900e-01   7.6188000e-01   8.6593900e-01   9.9707300e-01   1.0561900e+00];
% 17116
be1=16.2684+[2.0733300e-01   2.0970300e-01   1.7348900e-01   1.1328000e-01   2.6723300e-02  -8.7737000e-02  -2.4983300e-01  -3.8995700e-01  -6.1163500e-01  -7.2023200e-01  -1.0189100e+00  -1.2239500e+00  -1.4702900e+00  -1.7713900e+00  -2.0495200e+00  -2.3610400e+00  -2.7418800e+00  -2.9874200e+00  -3.3336600e+00  -3.8002300e+00  -4.0212800e+00];
be2=449.981+[2.3181800e+00   2.2728500e+00   2.1609400e+00   2.0391300e+00   1.8981900e+00   1.7421700e+00   1.5458400e+00   1.4023000e+00   1.2019400e+00   1.1148800e+00   9.0736100e-01   7.8790600e-01   6.6141800e-01   5.3664200e-01   4.4233300e-01   3.6037800e-01   2.9321700e-01   2.6878000e-01   2.4826700e-01   2.5667500e-01   2.7276600e-01];
be3=-696.273+[-1.3985200e+00  -1.3830300e+00  -1.2786500e+00  -1.1560200e+00  -1.0118500e+00  -8.5165200e-01  -6.5350100e-01  -5.1171600e-01  -3.1331500e-01  -2.2569100e-01  -1.3208700e-02   1.1482900e-01   2.5713400e-01   4.1429100e-01   5.4841400e-01   6.8725100e-01   8.4280100e-01   9.3640100e-01   1.0631300e+00   1.2224900e+00   1.2942200e+00];
% 14886
bf1=9.91704+[4.3791600e-01   4.3863800e-01   3.5427300e-01   2.3310800e-01   7.3612200e-02  -1.2209100e-01  -3.8837500e-01  -6.0843800e-01  -9.4651900e-01  -1.1079800e+00  -1.5405700e+00  -1.8300100e+00  -2.1727900e+00  -2.5817800e+00  -2.9528600e+00  -3.3600600e+00  -3.8489700e+00  -4.1608400e+00  -4.5977000e+00  -5.1793900e+00  -5.4527500e+00];
bf2=444.847+[2.6550600e+00   2.5864600e+00   2.4613500e+00   2.3442200e+00   2.2169300e+00   2.0843100e+00   1.9256000e+00   1.8150600e+00   1.6660200e+00   1.6032300e+00   1.4603100e+00   1.3844900e+00   1.3107400e+00   1.2485300e+00   1.2094000e+00   1.1878800e+00   1.1913300e+00   1.2116200e+00   1.2547900e+00   1.3481000e+00   1.4039600e+00];
bf3=-691.954+[-1.0947100e+00  -1.0665100e+00  -9.6061500e-01  -8.5030800e-01  -7.2715700e-01  -5.9628200e-01  -4.3843500e-01  -3.2740100e-01  -1.7422800e-01  -1.0799900e-01   4.7683400e-02   1.3758100e-01   2.3381300e-01   3.3523800e-01   4.1994800e-01   5.0523500e-01   5.9825400e-01   6.5280100e-01   7.2487100e-01   8.1124600e-01   8.4858000e-01];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 1297
bg1=12.7746+[-2.9740500e-01  -9.4516700e-02  -4.0247800e-01  -9.2531200e-01  -1.1919500e+00  -1.8484100e+00  -2.5414800e+00  -3.0507500e+00  -3.7834300e+00  -4.4154500e+00  -4.9512000e+00  -5.8841800e+00  -6.4766100e+00  -6.6491200e+00  -7.1813800e+00  -7.7646700e+00  -8.0600700e+00  -8.5013800e+00  -8.7795200e+00  -9.1406700e+00  -9.4025700e+00];
bg2=447.736+[2.7438700e+00   2.3468400e+00   1.7202800e+00   1.1928100e+00   1.0018800e+00   7.2461800e-01   6.2209600e-01   6.8211800e-01   8.8576800e-01   1.1797900e+00   1.5037800e+00   2.2291500e+00   2.7664800e+00   2.9285900e+00   3.4695000e+00   4.1087400e+00   4.4428900e+00   4.9433600e+00   5.2548500e+00   5.6508500e+00   5.9329200e+00];
bg3=-690.116+[-7.2232400e-01  -1.0368600e+00  -7.3682700e-01  -4.2276400e-01  -2.9305500e-01  -2.5701600e-02   2.0961400e-01   3.5580500e-01   5.4102300e-01   6.7603100e-01   7.7468700e-01   9.0854200e-01   9.7211500e-01   9.8883400e-01   1.0320600e+00   1.0717400e+00   1.0897400e+00   1.1152000e+00   1.1291900e+00   1.1466400e+00   1.1582200e+00];
% 16439
bh1=13.5613+[-2.9872300e-01  -1.2092000e-01  -2.9572300e-01  -6.5326300e-01  -8.4300100e-01  -1.3221400e+00  -1.8378100e+00  -2.2213500e+00  -2.7782600e+00  -3.2617400e+00  -3.6719600e+00  -4.3877900e+00  -4.8439400e+00  -4.9766300e+00  -5.3845600e+00  -5.8308000e+00  -6.0557300e+00  -6.3903100e+00  -6.6006300e+00  -6.8716800e+00  -7.0671200e+00];
bh2=447.206+[2.0430200e+00   1.6598300e+00   1.1342500e+00   6.8736700e-01   5.2312000e-01   2.7233000e-01   1.5978200e-01   1.9081700e-01   3.3493800e-01   5.5579600e-01   8.0120200e-01   1.3569700e+00   1.7718100e+00   1.8964700e+00   2.3117600e+00   2.8044800e+00   3.0614400e+00   3.4427000e+00   3.6791300e+00   3.9805700e+00   4.1958000e+00];
bh3=-699.132+[-5.8657500e-01  -9.1283000e-01  -6.7633500e-01  -4.1274300e-01  -3.0203800e-01  -6.8017500e-02   1.4209500e-01   2.7532500e-01   4.5058600e-01   5.8599800e-01   6.9093700e-01   8.4894500e-01   9.3603700e-01   9.6039400e-01   1.0295500e+00   1.0999600e+00   1.1339100e+00   1.1836400e+00   1.2146100e+00   1.2541100e+00   1.2818500e+00];
% 17116
bi1=16.2684+[-3.2813800e-01  -1.4310000e-01  -3.2029900e-01  -6.8395600e-01  -8.7743000e-01  -1.3680700e+00  -1.8991500e+00  -2.2963500e+00  -2.8737800e+00  -3.3755400e+00  -3.8013400e+00  -4.5445600e+00  -5.0184900e+00  -5.1565800e+00  -5.5816500e+00  -6.0474200e+00  -6.2824100e+00  -6.6321000e+00  -6.8520700e+00  -7.1359800e+00  -7.3410100e+00];
bi2=449.981+[2.2464200e+00   1.8608500e+00   1.2791300e+00   7.7331200e-01   5.8468200e-01   2.8814800e-01   1.4181400e-01   1.5797700e-01   2.8793900e-01   5.0406100e-01   7.4989300e-01   1.3161800e+00   1.7426800e+00   1.8714500e+00   2.3026500e+00   2.8165800e+00   3.0849500e+00   3.4829800e+00   3.7296200e+00   4.0438500e+00   4.2679600e+00];
bi3=-696.273+[-7.6833000e-01  -1.0996000e+00  -7.9947100e-01  -4.6826800e-01  -3.2926000e-01  -3.9311400e-02   2.1714200e-01   3.7649700e-01   5.8288400e-01   7.3846000e-01   8.5636600e-01   1.0280800e+00   1.1195400e+00   1.1446700e+00   1.2135800e+00   1.2806400e+00   1.3123200e+00   1.3588300e+00   1.3881300e+00   1.4260700e+00   1.4531900e+00];
% 14886
bk1=9.91704+[-2.5342700e-01  -5.6199700e-02  -3.7877300e-01  -9.1468000e-01  -1.1859600e+00  -1.8489900e+00  -2.5430900e+00  -3.0494900e+00  -3.7760900e+00  -4.4014300e+00  -4.9308900e+00  -5.8516800e+00  -6.4354400e+00  -6.6051600e+00  -7.1281000e+00  -7.6997900e+00  -7.9888400e+00  -8.4201400e+00  -8.6916300e+00  -9.0434500e+00  -9.2979300e+00];
bk2=444.847+[2.6061700e+00   2.2176600e+00   1.6528100e+00   1.1915700e+00   1.0289800e+00   8.0799700e-01   7.5083500e-01   8.3528500e-01   1.0675900e+00   1.3800000e+00   1.7158600e+00   2.4539100e+00   2.9949900e+00   3.1575600e+00   3.6974000e+00   4.3322300e+00   4.6636000e+00   5.1600100e+00   5.4692900e+00   5.8627000e+00   6.1430600e+00];
bk3=-691.954+[-5.6563500e-01  -8.8533900e-01  -6.6679700e-01  -4.3795400e-01  -3.4422500e-01  -1.4888900e-01   2.5496000e-02   1.3543400e-01   2.7574700e-01   3.7909900e-01   4.5519700e-01   5.5862800e-01   6.0716100e-01   6.1996300e-01   6.5329700e-01   6.8445700e-01   6.9829000e-01   7.1686200e-01   7.2573800e-01   7.3542400e-01   7.4044200e-01];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (5N)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (5N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')