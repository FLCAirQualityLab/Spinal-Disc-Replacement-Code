%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under axial rotation
% (6p)
% 36572,16215,31500,37435
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 36572,16215,31500,37435
%% model15_intact_TLC_6P
t15=[2 2.0575 2.10171 2.15243 2.21614 2.25202 2.3077 2.35301 2.40975 2.45206 2.50317 2.55517 2.6029 2.65687 2.71794 2.76183 2.80173 2.85494 2.90035 2.95138 3];

% 36572
aa1=12.3763+[0.111599 0.267939 0.354002 0.455544 0.601201 0.683025 0.819847 0.929983 1.05463 1.13597 1.22168 1.29772 1.3621 1.42754 1.49316 1.5361 1.57325 1.61918 1.6553 1.69239 1.7242];
aa2=446.738+[0.535552 0.377718 0.487606 0.694395 0.99369 1.16128 1.38826 1.54381 1.71009 1.81307 1.92062 2.01629 2.08826 2.15433 2.21349 2.25031 2.2812 2.31726 2.34499 2.37349 2.39735];
aa3=-714.659+[-0.774879 -0.959394 -1.04719 -1.12925 -1.24732 -1.31117 -1.41888 -1.51432 -1.61983 -1.68686 -1.75867 -1.82479 -1.88065 -1.93515 -1.98785 -2.02165 -2.05053 -2.08561 -2.1131 -2.14102 -2.16447];

% 16215
ab1=12.1679+[0.223784 0.51704 0.670018 0.835896 1.06376 1.186 1.38395 1.54372 1.72282 1.83856 1.95873 2.06355 2.15054 2.2371 2.32134 2.37554 2.42255 2.48057 2.52632 2.57268 2.61223 ];
ab2=446.385+[0.866838 0.654571 0.79553 1.05626 1.43496 1.64736 1.93706 2.14133 2.35673 2.48864 2.62826 2.75615 2.85395 2.94295 3.02194 3.07137 3.1127 3.16019 3.19724 3.23487 3.26526];
ab3=-705.203+[-0.935817 -1.20386 -1.35545 -1.5031 -1.6941 -1.79492 -1.95389 -2.08729 -2.23508 -2.33019 -2.43442 -2.53215 -2.61552 -2.69965 -2.78234 -2.83594 -2.88139 -2.93742 -2.98224 -3.02874 -3.06876];

% 31500
ac1=9.70641+[0.238644 0.562607 0.747333 0.949581 1.21989 1.36409 1.59133 1.77087 1.97301 2.10494 2.24383 2.3671 2.47006 2.57418 2.67768 2.74536 2.80449 2.87831 2.93748 2.99871 3.05214];
ac2=444.062+[0.758958 0.509004 0.608233 0.821442 1.14361 1.32723 1.57797 1.75464 1.94035 2.05338 2.17248 2.28116 2.36318 2.43637 2.49975 2.53888 2.57134 2.60786 2.63594 2.66409 2.68616];
ac3=-707.068+[-0.814455 -1.07212 -1.20751 -1.33489 -1.49755 -1.58305 -1.71915 -1.83388 -1.96298 -2.04777 -2.14181 -2.2307 -2.30754 -2.3869 -2.46709 -2.51988 -2.56515 -2.62183 -2.66765 -2.71593 -2.75843];

% 37435
ad1=16.2708+[0.132811 0.306741 0.388875 0.48257 0.620068 0.697289 0.830645 0.941264 1.06535 1.14525 1.22845 1.30136 1.36295 1.4245 1.48502 1.52406 1.55757 1.59842 1.62997 1.66165 1.68809 ];
ad2=449.059+[0.698641 0.555857 0.705206 0.961012 1.32605 1.529 1.80528 1.99732 2.2027 2.33006 2.46339 2.58266 2.6733 2.75707 2.83284 2.8802 2.92029 2.9675 3.00411 3.04181 3.07346];
ad3=-710.186+[-0.884108 -1.09223 -1.19903 -1.30278 -1.4532 -1.53473 -1.67043 -1.78983 -1.92046 -2.00234 -2.08908 -2.16821 -2.23415 -2.29703 -2.35621 -2.39351 -2.42522 -2.46311 -2.49232 -2.52139 -2.54507];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_6P
t1=[2 2.05126 2.10091 2.15535 2.20061 2.25209 2.30561 2.36555 2.40191 2.4653 2.51879 2.5529 2.60117 2.65273 2.7052 2.76398 2.80076 2.87223 2.92223 2.95699 3];
% 36572
ae1=12.3763+[-0.296363 -0.273609 -0.250318 -0.195635 -0.0993911 0.0747359 0.284151 0.517044 0.647333 0.842433 0.981956 1.06123 1.16033 1.25236 1.33525 1.41743 1.46342 1.54204 1.58946 1.62073 1.65659];
ae2=446.738+[0.797079 0.611517 0.656084 0.832081 1.01233 1.17274 1.29205 1.37123 1.41676 1.49964 1.57146 1.61645 1.67643 1.73568 1.79039 1.84363 1.87264 1.92177 1.94996 1.96808 1.98778];
ae3=-714.659+[-0.615151 -0.917302 -1.02294 -1.11673 -1.18297 -1.26709 -1.37223 -1.50654 -1.5856 -1.71275 -1.80796 -1.86325 -1.93432 -2.00101 -2.06096 -2.11951 -2.1522 -2.20805 -2.24093 -2.26233 -2.28618];

% 16215
af1=12.1679+[-0.324978 -0.207262 -0.057042 0.145138 0.352587 0.63875 0.951808 1.28979 1.47766 1.7593 1.96061 2.07443 2.21681 2.3473 2.46362 2.57695 2.63974 2.74602 2.81 2.85248 2.90113];
af2=446.385+[1.47688 1.4179 1.53044 1.72959 1.9006 2.04853 2.15906 2.24033 2.28967 2.38956 2.48192 2.54119 2.62262 2.70498 2.78276 2.86091 2.9049 2.98136 3.02731 3.05737 3.09082];
af3=-705.203+[-0.848839 -1.27477 -1.48189 -1.67767 -1.8106 -1.95585 -2.11356 -2.2998 -2.40877 -2.5852 -2.72036 -2.79963 -2.90291 -3.00137 -3.09145 -3.18098 -3.23203 -3.32109 -3.37613 -3.4127 -3.45482];

% 31500
ag1=9.70641+[-0.300144 -0.168265 0.0075167 0.248701 0.493224 0.819684 1.16965 1.54021 1.74588 2.05632 2.2808 2.40882 2.57024 2.72027 2.85586 2.99022 3.06584 3.1964 3.27694 3.33082 3.39352];
ag2=444.066+[1.35021 1.25454 1.32264 1.47006 1.60043 1.70688 1.78052 1.82782 1.85893 1.92933 1.99862 2.04421 2.10777 2.17258 2.23387 2.29501 2.32909 2.38782 2.42244 2.44491 2.4694 ];
ag3=-707.086+[-0.716544 -1.11071 -1.28852 -1.46047 -1.58162 -1.71619 -1.86416 -2.03805 -2.14023 -2.30478 -2.4307 -2.50473 -2.60144 -2.69409 -2.77951 -2.86529 -2.9147 -3.00209 -3.05708 -3.09391 -3.13691];

% 37435
ah1=16.2708+[-0.32538 -0.288903 -0.257205 -0.203151 -0.112863 0.0569573 0.265757 0.504093 0.637467 0.836349 0.977377 1.05698 1.15598 1.24685 1.32771 1.40681 1.45049 1.52388 1.56706 1.59528 1.62711];
ah2=449.059+[0.940437 0.73943 0.816499 1.04557 1.27227 1.47762 1.63469 1.74815 1.81202 1.92583 2.02206 2.08163 2.16069 2.23848 2.31028 2.38045 2.41892 2.48435 2.5223 2.54687 2.57398];
ah3=-710.186+[-0.667767 -0.973466 -1.104 -1.22691 -1.31453 -1.42113 -1.54818 -1.70799 -1.80099 -1.95065 -2.06246 -2.1272 -2.21022 -2.28757 -2.35653 -2.42302 -2.45958 -2.52092 -2.55604 -2.57867 -2.60343 ];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_6P
t2=[2 2.05026 2.11433 2.15261 2.2098 2.25679 2.30943 2.35333 2.40624 2.4511 2.50404 2.55744 2.60598 2.66477 2.70156 2.77304 2.80429 2.86109 2.90333 2.95384 3];

% 36572
ai1=12.3763+[-0.24139 -0.243063 -0.278409 -0.301977 -0.329124 -0.327442 -0.274855 -0.190644 -0.0545634 0.0790371 0.249034 0.424801 0.580578 0.758998 0.862821 1.04486 1.11772 1.23917 1.31849 1.40244 1.47119 ];
ai2=446.738+[0.905469 0.846388 0.87477 0.935942 1.09689 1.27511 1.46613 1.60141 1.71479 1.78325 1.84024 1.88006 1.91365 1.95514 1.98093 2.02805 2.047 2.0782 2.09819 2.1196 2.1375];
ai3=-714.659+[-0.763679 -0.892386 -0.968467 -1.00516 -1.04845 -1.07905 -1.11529 -1.15626 -1.22937 -1.30073 -1.39063 -1.4876 -1.57777 -1.68421 -1.74786 -1.86411 -1.91225 -1.99424 -2.04823 -2.10574 -2.15359 ];

% 16215
aj1=12.1679+[-0.242242 -0.211968 -0.166732 -0.131589 -0.0635042 0.0164117 0.147492 0.291813 0.501413 0.696853 0.938419 1.18579 1.40383 1.65234 1.79698 2.05008 2.15049 2.317 2.42524 2.53989 2.63462];
aj2=446.385+[1.74178 1.72542 1.83883 1.94217 2.1427 2.33123 2.52488 2.65801 2.77403 2.84934 2.91802 2.96977 3.01221 3.063 3.09434 3.15314 3.17766 3.21989 3.24913 3.2822 3.31116];
aj3=-705.203+[-1.05161 -1.2297 -1.39816 -1.49557 -1.62949 -1.72498 -1.82252 -1.90058 -2.01046 -2.11426 -2.24349 -2.3802 -2.50537 -2.65223 -2.74007 -2.90049 -2.96638 -3.07891 -3.15431 -3.23656 -3.30675];

% 31500
ak1=9.70641+[-0.21745 -0.178381 -0.109712 -0.0560249 0.0470497 0.160502 0.329205 0.503301 0.744275 0.964132 1.23267 1.50527 1.74501 2.01874 2.17856 2.45985 2.57211 2.75953 2.88274 3.01473 3.12492];
ak2=444.066+[1.58819 1.5568 1.6319 1.70856 1.86555 2.01788 2.17435 2.27917 2.36393 2.41461 2.45595 2.48239 2.50407 2.53198 2.55014 2.58569 2.60087 2.62719 2.64549 2.66639 2.6849];
ak3=-707.086+[-0.881612 -1.05048 -1.19547 -1.27878 -1.39471 -1.47989 -1.56947 -1.64185 -1.74225 -1.83733 -1.95584 -2.0821 -2.1994 -2.33861 -2.42258 -2.57731 -2.64136 -2.75134 -2.82552 -2.90704 -2.9771 ];

% 37435
al1=16.2708+[-0.262384 -0.261869 -0.296824 -0.323227 -0.360227 -0.369846 -0.329067 -0.251088 -0.115997 0.0183351 0.190505 0.36979 0.529031 0.710977 0.816472 1.00061 1.07405 1.19589 1.27476 1.35746 1.42457];
al2=449.059+[1.06927 1.00477 1.05601 1.13817 1.34129 1.5596 1.79174 1.95888 2.10774 2.20296 2.28839 2.35416 2.4083 2.47213 2.51075 2.58021 2.60796 2.65375 2.68337 2.71505 2.74153];
al3=-710.186+[-0.835382 -0.962749 -1.05123 -1.09699 -1.15539 -1.19919 -1.24907 -1.3034 -1.39688 -1.48516 -1.59453 -1.71088 -1.81711 -1.94092 -2.01428 -2.14679 -2.20111 -2.29285 -2.35263 -2.41557 -2.4674];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_6P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25315 2.31416 2.35262 2.41143 2.46244 2.50012 2.56211 2.62242 2.66 2.71937 2.76156 2.81214 2.87147 2.90272 2.95721 3];
% 36572
am1=12.3763+[-0.0625365 -0.0621528 -0.0911171 -0.129768 -0.162565 -0.209291 -0.265 -0.290988 -0.304268 -0.288649 -0.263061 -0.192402 -0.0964416 -0.0256169 0.0952623 0.18766 0.300706 0.437401 0.509861 0.636464 0.734581];
am2=446.738+[0.664822 0.654953 0.678761 0.732128 0.788423 0.891517 1.06765 1.1918 1.38268 1.53572 1.63703 1.77445 1.87233 1.91993 1.98447 2.02448 2.07072 2.12238 2.14882 2.1927 2.2248];
am3=-714.659+[-1.00175 -1.01304 -1.02393 -1.03415 -1.04027 -1.04499 -1.05126 -1.05742 -1.0665 -1.08803 -1.11003 -1.1535 -1.20363 -1.23868 -1.29719 -1.34248 -1.39952 -1.47188 -1.51107 -1.58148 -1.63781];
% 16215
an1=12.1679+[0.0741139 0.0811602 0.0813036 0.0796584 0.0781306 0.0768065 0.0825275 0.0946382 0.134696 0.192698 0.249369 0.370513 0.51492 0.615612 0.783213 0.908984 1.06189 1.24418 1.33999 1.50583 1.63349];
an2=446.385+[1.46322 1.46635 1.5426 1.64623 1.73847 1.88249 2.09362 2.2338 2.44365 2.60889 2.71859 2.87228 2.99276 3.05634 3.14699 3.20448 3.27039 3.34245 3.37903 3.43981 3.48499];
an3=-705.203+[-1.33312 -1.35882 -1.41958 -1.48415 -1.53531 -1.60255 -1.68309 -1.73151 -1.80071 -1.86029 -1.90613 -1.98635 -2.07268 -2.13015 -2.22435 -2.29486 -2.38155 -2.48613 -2.54164 -2.63929 -2.7166 ];
% 31500
ao1=9.70641+[0.100468 0.112691 0.128028 0.143357 0.156842 0.178806 0.218732 0.254264 0.331218 0.420062 0.498294 0.65247 0.826355 0.944407 1.13881 1.28288 1.45732 1.66413 1.77272 1.9605 2.10501];
ao2=444.066+[1.29841 1.29592 1.35189 1.43296 1.50627 1.62269 1.79672 1.91307 2.088 2.22507 2.31522 2.4388 2.5317 2.57891 2.64452 2.6852 2.7318 2.78266 2.80848 2.85124 2.88291];
ao3=-707.086+[-1.14938 -1.17423 -1.22666 -1.28153 -1.32523 -1.38288 -1.45332 -1.49633 -1.55984 -1.61505 -1.65747 -1.73124 -1.80958 -1.86166 -1.94727 -2.01189 -2.092 -2.18985 -2.24214 -2.33465 -2.4083];
% 37435
ap1=16.2708+[-0.0527419 -0.0544987 -0.0897015 -0.135542 -0.17536 -0.233898 -0.306937 -0.343886 -0.374145 -0.36938 -0.350111 -0.287251 -0.196294 -0.127472 -0.00905826 0.0823693 0.194593 0.330898 0.403187 0.529564 0.627466];
ap2=449.059+[0.808319 0.799363 0.835223 0.904577 0.975423 1.10273 1.31683 1.46672 1.69526 1.88105 2.00531 2.17709 2.30521 2.3703 2.46113 2.51855 2.58492 2.65887 2.69668 2.75956 2.80571];
ap3=-710.186+[-1.08969 -1.09926 -1.11058 -1.12291 -1.13071 -1.13839 -1.15086 -1.16209 -1.17799 -1.20895 -1.23885 -1.29585 -1.35976 -1.40368 -1.47614 -1.53136 -1.60028 -1.6864 -1.7327 -1.81514 -1.88038];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_6P
t4=[2 2.05499 2.11058 2.16207 2.20435 2.25007 2.30324 2.36036 2.40263 2.45125 2.50837 2.56869 2.60135 2.66917 2.7073 2.76599 2.81551 2.85069 2.90069 2.95128 3];
% 36572
aq1=12.3763+[-0.215014 0.0905684 0.286714 0.422707 0.531627 0.653417 0.790251 0.93361 1.0293 1.12558 1.21994 1.30551 1.34788 1.42783 1.46954 1.52743 1.57203 1.60124 1.64032 1.67868 1.71209];
aq2=446.738+[0.808702 0.263743 0.362857 0.554854 0.7359 0.927273 1.13327 1.30296 1.40695 1.50659 1.60158 1.68607 1.72285 1.78468 1.81305 1.84822 1.87381 1.88984 1.90856 1.92343 1.93415];
aq3=-714.659+[0.194024 -1.18545 -1.3513 -1.43327 -1.49425 -1.56642 -1.65505 -1.76536 -1.83771 -1.90927 -1.97955 -2.04465 -2.07675 -2.13537 -2.16485 -2.20462 -2.2351 -2.25494 -2.28072 -2.30464 -2.32475];
% 16215
ar1=12.1679+[-0.403375 0.465 0.865437 1.11078 1.28803 1.47397 1.67677 1.88799 2.02702 2.16576 2.30138 2.424 2.48384 2.59492 2.65192 2.72939 2.78809 2.82614 2.87696 2.92678 2.96975];
ar2=446.385+[1.40349 0.909642 0.971585 1.15911 1.36338 1.60028 1.86155 2.09025 2.23298 2.37074 2.50274 2.62091 2.67365 2.76411 2.80673 2.8613 2.90243 2.92905 2.96166 2.98932 3.01037];
ar3=-705.203+[0.136572 -1.63139 -1.9087 -2.05874 -2.1691 -2.29173 -2.43075 -2.59029 -2.69664 -2.80491 -2.91484 -3.01803 -3.0692 -3.1645 -3.2134 -3.28064 -3.33286 -3.36759 -3.41406 -3.45859 -3.49747];
% 31500
as1=9.70641+[-0.371109 0.51959 0.96365 1.25026 1.4594 1.67568 1.90983 2.14831 2.30613 2.46555 2.62451 2.77076 2.84278 2.97848 3.04895 3.14664 3.22198 3.27166 3.33877 3.40488 3.46335];
as2=444.066+[1.26279 0.722112 0.732029 0.876351 1.04567 1.24658 1.47019 1.66427 1.78455 1.89956 2.00824 2.10456 2.14669 2.21718 2.24953 2.28963 2.31939 2.33834 2.36063 2.3784 2.39067];
as3=-707.086+[0.278094 -1.45405 -1.71443 -1.85525 -1.95458 -2.06098 -2.18091 -2.31924 -2.41261 -2.50923 -2.60937 -2.70504 -2.75327 -2.84478 -2.89253 -2.95952 -3.01221 -3.04765 -3.09571 -3.14242 -3.18432 ];
% 37435
at1=16.2708+[-0.248265 0.129375 0.334262 0.462164 0.56305 0.678722 0.810867 0.955187 1.05094 1.14616 1.23773 1.31959 1.35986 1.43471 1.47332 1.526 1.56599 1.59178 1.62584 1.65905 1.68726];
at2=449.059+[1.0122 0.383007 0.532597 0.771509 0.991505 1.2248 1.47713 1.6902 1.82159 1.94783 2.06874 2.17691 2.22465 2.30604 2.34388 2.39144 2.42646 2.44858 2.4751 2.49712 2.51364];
at3=-710.186+[0.112597 -1.28473 -1.48622 -1.58736 -1.66357 -1.75496 -1.86727 -2.0051 -2.09457 -2.18183 -2.26587 -2.34252 -2.3796 -2.44584 -2.4784 -2.52107 -2.55312 -2.57354 -2.59945 -2.62295 -2.6417];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_6P
t5=[2 2.05126 2.11533 2.16533 2.20361 2.25315 2.31416 2.35262 2.40417 2.45195 2.50082 2.55529 2.60294 2.66047 2.7231 2.75435 2.80406 2.85412 2.94917 2.96167 3];
% 36572
au1=12.3763+[-0.0645383 -0.063943 -0.0902245 -0.12621 -0.157029 -0.201125 -0.254863 -0.280623 -0.295093 -0.285626 -0.256317 -0.200039 -0.131463 -0.0312498 0.0939447 0.159615 0.267686 0.380489 0.597547 0.626009 0.712588];
au2=446.738+[0.630243 0.621885 0.652279 0.712523 0.772656 0.877353 1.05123 1.17333 1.33913 1.4852 1.61939 1.74647 1.83419 1.91648 1.98678 2.0183 2.06593 2.11124 2.19138 2.20147 2.23096];
au3=-714.659+[-0.996715 -1.00808 -1.02123 -1.03431 -1.04252 -1.04916 -1.05584 -1.06168 -1.06883 -1.08549 -1.11241 -1.14886 -1.18624 -1.23661 -1.29689 -1.3287 -1.3827 -1.44147 -1.55972 -1.5756 -1.62485];
% 16215
av1=12.1679+[0.0479822 0.0544954 0.0533879 0.0510486 0.0491501 0.0472686 0.0516918 0.0620307 0.0923666 0.139418 0.207077 0.306087 0.411649 0.556379 0.730302 0.820254 0.967074 1.11858 1.40633 1.44372 1.55723];
av2=446.385+[1.48605 1.48846 1.56058 1.65937 1.7482 1.88868 2.09636 2.23572 2.42038 2.5801 2.72625 2.86689 2.9698 3.07438 3.1706 3.21505 3.28187 3.3444 3.45435 3.46832 3.50952];
av3=-705.203+[-1.34535 -1.3701 -1.42893 -1.49121 -1.54067 -1.60579 -1.68406 -1.73126 -1.79038 -1.84375 -1.90115 -1.96866 -2.03261 -2.11625 -2.21336 -2.26354 -2.34585 -2.43147 -2.59744 -2.61938 -2.68718];
% 31500
aw1=9.70641+[0.0756118 0.0872114 0.100882 0.115004 0.127704 0.148673 0.18678 0.220316 0.282748 0.358968 0.454842 0.58329 0.712773 0.88461 1.08668 1.19037 1.35846 1.53075 1.85702 1.89945 2.02814];
aw2=444.066+[1.31678 1.31373 1.36631 1.44343 1.51403 1.62767 1.79901 1.91482 2.06909 2.20227 2.32293 2.43706 2.51799 2.59731 2.66735 2.69926 2.74703 2.79148 2.86934 2.87924 2.90831];
aw3=-707.086+[-1.15639 -1.1804 -1.23144 -1.28471 -1.3272 -1.3833 -1.45185 -1.49373 -1.54788 -1.59741 -1.65054 -1.71291 -1.77128 -1.84722 -1.93553 -1.98146 -2.05743 -2.13731 -2.29395 -2.31478 -2.37934];
% 37435
ax1=16.2708+[-0.0552054 -0.0566791 -0.0887886 -0.131449 -0.168894 -0.224365 -0.295262 -0.332015 -0.361653 -0.363271 -0.342558 -0.293697 -0.229807 -0.133575 -0.0112192 0.0534139 0.160402 0.27259 0.488972 0.517333 0.603584];
ax2=449.059+[0.768975 0.761861 0.805687 0.88337 0.958793 1.08785 1.29903 1.44651 1.64509 1.82196 1.98626 2.14417 2.2568 2.36672 2.46471 2.50936 2.57697 2.64138 2.75544 2.76984 2.81201];
ax3=-710.186+[-1.08139 -1.0913 -1.10606 -1.12256 -1.13325 -1.14333 -1.15597 -1.16662 -1.17931 -1.204 -1.24097 -1.28918 -1.33742 -1.40106 -1.47586 -1.51489 -1.58042 -1.65071 -1.79008 -1.80865 -1.86584];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_6P
t6=[2 2.05486 2.10789 2.15953 2.21347 2.25039 2.30255 2.36524 2.40407 2.45974 2.50483 2.55731 2.60253 2.65367 2.70049 2.76158 2.81718 2.85019 2.90883 2.95766 3 ];
% 36572
ay1=12.3763+[-0.215017 -0.296128 -0.252323 -0.174345 -0.0218669 0.114686 0.323124 0.564439 0.699117 0.866222 0.981123 1.09844 1.18617 1.27299 1.34453 1.42748 1.49129 1.52828 1.58694 1.63124 1.66624 ];
ay2=446.738+[0.808829 0.540967 0.609904 0.786274 0.985773 1.09517 1.21864 1.31844 1.3761 1.45909 1.5274 1.60549 1.66712 1.73103 1.78361 1.84225 1.8859 1.90979 1.9467 1.97292 1.99265];
ay3=-714.659+[0.193483 -0.888601 -1.02774 -1.12445 -1.21183 -1.28029 -1.38764 -1.5296 -1.61315 -1.72401 -1.8038 -1.88748 -1.95161 -2.01554 -2.06785 -2.12752 -2.17311 -2.1995 -2.24081 -2.27112 -2.29444];
% 16215
az1=12.1679+[-0.403358 -0.230933 -0.0373534 0.18451 0.466494 0.682676 0.990269 1.33719 1.52927 1.76852 1.93316 2.10081 2.22615 2.35006 2.45198 2.57076 2.67407 2.72753 2.80862 2.86927 2.917];
az2=446.385+[1.40391 1.35708 1.48565 1.68075 1.87352 1.9763 2.09198 2.19505 2.26088 2.36373 2.4524 2.55565 2.6399 2.72879 2.80339 2.89008 2.95994 2.99778 3.05725 3.10069 3.13393];
az3=-705.203+[0.135333 -1.25839 -1.50574 -1.69594 -1.85795 -1.96898 -2.1241 -2.3163 -2.43024 -2.58335 -2.69584 -2.81479 -2.90778 -3.00236 -3.08089 -3.17208 -3.24516 -3.28708 -3.3543 -3.40557 -3.44645];
% 31500
ba1=9.70641+[-0.371091 -0.188153 0.0340046 0.294494 0.620806 0.865208 1.20854 1.58921 1.80007 2.06449 2.24865 2.43819 2.58134 2.72466 2.84389 2.98476 3.10775 3.17256 3.27337 3.35013 3.41172];
ba2=444.066+[1.26326 1.19362 1.27226 1.4168 1.56122 1.63496 1.71502 1.78306 1.82931 1.90582 1.97461 2.05639 2.12376 2.19508 2.25479 2.32362 2.37883 2.40836 2.45409 2.48682 2.51128];
ba3=-707.086+[0.276778 -1.09896 -1.31324 -1.48048 -1.62814 -1.73138 -1.87714 -2.05675 -2.16292 -2.30464 -2.40859 -2.51887 -2.60536 -2.6939 -2.76809 -2.85536 -2.92676 -2.96783 -3.03463 -3.08628 -3.12814 ];
% 37435
bb1=16.2708+[-0.248256 -0.314497 -0.260031 -0.181915 -0.0350834 0.0995348 0.307859 0.55477 0.692414 0.862535 0.978541 1.09605 1.1833 1.26864 1.33818 1.41774 1.47763 1.51228 1.56623 1.60626 1.63727 ];
bb2=449.059+[1.01233 0.658424 0.767278 0.99685 1.25088 1.39159 1.55315 1.68998 1.76828 1.87995 1.9701 2.07198 2.15217 2.23515 2.30354 2.38029 2.43794 2.46961 2.51882 2.55426 2.58128];
bb3=-710.186+[0.11204 -0.935946 -1.10612 -1.23265 -1.34628 -1.4313 -1.56112 -1.73029 -1.82908 -1.96038 -2.05478 -2.15357 -2.22901 -2.30367 -2.36422 -2.4323 -2.4831 -2.51227 -2.55702 -2.58922 -2.61343 ];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_6P
t13=[2 2.05126 2.11533 2.16533 2.21533 2.25361 2.30816 2.35516 2.41122 2.46102 2.51245 2.55582 2.60999 2.65082 2.73015 2.7614 2.81853 2.85329 2.91154 2.95522 3];
% 36572
bc1=12.3763+[-0.00126366 -0.0012826 -0.0347822 -0.0742503 -0.117865 -0.151161 -0.185128 -0.191151 -0.165324 -0.116047 -0.0418843 0.0313398 0.137738 0.224375 0.400878 0.471611 0.602117 0.680753 0.80956 0.902407 0.993818];
bc2=446.738+[0.696855 0.685471 0.730453 0.809437 0.922228 1.02217 1.19041 1.33962 1.50628 1.63335 1.74109 1.81836 1.89588 1.945 2.03277 2.06646 2.12633 2.16162 2.2171 2.25578 2.29261];
bc3=-714.659+[-0.705812 -0.718853 -0.736011 -0.750863 -0.764261 -0.77605 -0.795749 -0.813376 -0.84772 -0.889884 -0.941579 -0.98807 -1.0536 -1.10685 -1.21667 -1.2613 -1.34458 -1.39565 -1.48153 -1.54523 -1.60901];
% 16215
bd1=12.1679+[0.129016 0.138704 0.14364 0.14896 0.157959 0.166497 0.192313 0.233948 0.311766 0.406014 0.526231 0.637861 0.792436 0.915233 1.16019 1.25709 1.4338 1.53935 1.71074 1.83344 1.95379];
bd2=446.385+[1.63099 1.63319 1.72358 1.84439 1.99587 2.12179 2.31647 2.48362 2.66668 2.80632 2.92827 3.01928 3.11494 3.17902 3.29452 3.33835 3.41546 3.46103 3.53368 3.58523 3.6353];
bd3=-705.203+[-1.0531 -1.08397 -1.15758 -1.23199 -1.31083 -1.37152 -1.455 -1.52192 -1.59982 -1.67393 -1.75734 -1.83132 -1.92992 -2.00857 -2.16704 -2.23001 -2.34484 -2.4144 -2.53039 -2.61614 -2.70201];
% 31500
be1=9.70641+[0.155694 0.171713 0.195396 0.22158 0.255696 0.285079 0.343537 0.414829 0.527469 0.650672 0.798562 0.932518 1.11315 1.25462 1.53414 1.64433 1.84485 1.96464 2.15923 2.29876 2.43589];
be2=444.066+[1.44871 1.44372 1.50963 1.60395 1.72538 1.82757 1.98797 2.12609 2.2765 2.38931 2.48552 2.55576 2.62705 2.67363 2.75762 2.78973 2.84644 2.88012 2.93384 2.97202 3.00899];
be3=-707.086+[-0.843245 -0.872563 -0.936345 -1.00014 -1.06796 -1.12062 -1.19484 -1.25553 -1.32715 -1.39559 -1.47253 -1.54069 -1.63155 -1.70407 -1.85164 -1.91076 -2.01929 -2.08537 -2.19603 -2.27822 -2.36074];
% 37435
bf1=16.2708+[0.00528751 0.00277992 -0.0388098 -0.087576 -0.142796 -0.185464 -0.233881 -0.252748 -0.238481 -0.196626 -0.128038 -0.0584907 0.0452574 0.130813 0.306333 0.376828 0.507098 0.585581 0.71419 0.806803 0.897861];
bf2=449.059+[0.880613 0.871599 0.935173 1.0367 1.17739 1.30112 1.50597 1.68667 1.89093 2.04896 2.18553 2.28493 2.38846 2.45589 2.5761 2.62194 2.70318 2.75097 2.82599 2.87823 2.92822];
bf3=-710.186+[-0.813393 -0.825226 -0.845129 -0.864269 -0.883198 -0.900349 -0.928592 -0.953443 -0.999868 -1.05409 -1.11841 -1.17525 -1.2546 -1.31842 -1.44798 -1.50021 -1.59714 -1.65625 -1.75483 -1.8273 -1.89954];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_6P
t14=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30206 2.35204 2.40323 2.45375 2.52804 2.55155 2.62764 2.65371 2.71895 2.75421 2.81684 2.85161 2.90752 2.95451 3];
% 36572
bg1=12.3763+[-0.262546 -0.267677 -0.293542 -0.325504 -0.367139 -0.385781 -0.418646 -0.439672 -0.437802 -0.410385 -0.323563 -0.288503 -0.148922 -0.0952321 0.0501092 0.132883 0.28382 0.368163 0.503914 0.616926 0.723661 ];
bg2=446.738+[0.872491 0.808673 0.793444 0.831527 0.916894 0.971642 1.10571 1.25633 1.41243 1.55665 1.73555 1.78483 1.91384 1.9503 2.02776 2.06594 2.13172 2.16767 2.22377 2.26812 2.30845];
bg3=-714.659+[-0.305877 -0.453721 -0.528113 -0.560494 -0.591974 -0.604807 -0.62859 -0.65231 -0.683001 -0.721901 -0.78981 -0.812869 -0.897156 -0.928495 -1.01168 -1.05927 -1.14825 -1.19903 -1.28261 -1.35387 -1.42307];
% 16215
bh1=12.1679+[-0.293437 -0.27778 -0.260506 -0.245824 -0.226265 -0.215648 -0.188783 -0.152085 -0.095573 -0.0184931 0.138189 0.195037 0.404088 0.481339 0.685366 0.799476 1.00476 1.11834 1.29948 1.4488 1.58912];
bh2=446.385+[1.65142 1.63589 1.70529 1.80848 1.96234 2.04265 2.21565 2.39445 2.57375 2.73612 2.93868 2.99574 3.15267 3.19967 3.30438 3.3565 3.44436 3.49177 3.56521 3.62358 3.67725];
bh3=-705.203+[-0.521951 -0.717173 -0.870194 -0.973032 -1.08909 -1.13838 -1.22952 -1.31245 -1.39364 -1.47107 -1.58657 -1.62432 -1.75566 -1.80312 -1.92729 -1.99667 -2.12245 -2.19266 -2.30592 -2.40124 -2.49339];
% 31500
bi1=9.70641+[-0.263984 -0.244559 -0.211124 -0.178222 -0.133116 -0.109691 -0.0556238 0.00992396 0.0967283 0.203245 0.401021 0.470369 0.71757 0.807248 1.04123 1.17103 1.40334 1.53171 1.73617 1.90463 2.06298];
bi2=444.066+[1.50764 1.48284 1.52496 1.60058 1.71908 1.78297 1.92357 2.07067 2.2188 2.35214 2.51483 2.55985 2.67995 2.71493 2.79085 2.82825 2.89165 2.92609 2.97962 3.0221 3.06115];
bi3=-707.086+[-0.371135 -0.558541 -0.695113 -0.783062 -0.881744 -0.92379 -1.00235 -1.07484 -1.14714 -1.21692 -1.32119 -1.35531 -1.47423 -1.51722 -1.63011 -1.6938 -1.81065 -1.87636 -1.98302 -2.07331 -2.16104];
% 37435
bk1=16.2708+[-0.296601 -0.30141 -0.332916 -0.372088 -0.423894 -0.44758 -0.49128 -0.523356 -0.531565 -0.511769 -0.43304 -0.400013 -0.264849 -0.212064 -0.0678869 0.0147077 0.165811 0.250326 0.386483 0.499847 0.606864];
bk2=449.059+[1.06322 0.989308 0.981576 1.0355 1.14615 1.21461 1.37942 1.56244 1.75359 1.9314 2.15555 2.21816 2.38713 2.43658 2.54445 2.598 2.68936 2.73901 2.8163 2.87741 2.93289 ];
bk3=-710.186+[-0.380102 -0.52266 -0.59605 -0.630869 -0.667538 -0.683693 -0.715535 -0.748315 -0.790565 -0.842575 -0.930482 -0.959832 -1.06473 -1.10335 -1.20457 -1.26176 -1.36723 -1.42704 -1.52481 -1.60742 -1.68691];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of axial rotation (6P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C5-C6 Left Hand Foreman Narrowing/Widening Under 2 N-m of axial rotation (6P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
