%% foreman height and width narrowing/widening 

% 6P!!

% for all models for the c3-c4 left hand side foreman under lateral bending (_n)
% 1297,16439,17116,14886

% Values for displacements have not been replaced. base coordinates have,
% but need checking. 
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 1297,16439,17116,14886
%% model15_intact_TLC_6P
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 1297
aa1=12.7746+[4.8745400e-01   1.0799600e+00   1.3978700e+00   1.7185400e+00   2.1265400e+00   2.3384800e+00   2.6680400e+00   2.9294100e+00   3.2158600e+00   3.3976900e+00   3.5858000e+00   3.7527200e+00   3.8906000e+00   4.0265400e+00   4.1550500e+00   4.2384600e+00   4.3109200e+00   4.3998900e+00   4.4701000e+00   4.5394800e+00   4.5991500e+00];
aa2=447.736+[1.5391800e+00   1.1374500e+00   1.2624600e+00   1.5539700e+00   2.0061700e+00   2.2684000e+00   2.6369200e+00   2.9076500e+00   3.1937200e+00   3.3686800e+00   3.5558600e+00   3.7256400e+00   3.8573500e+00   3.9753300e+00   4.0777000e+00   4.1394700e+00   4.1890300e+00   4.2435900e+00   4.2850700e+00   4.3265500e+00   4.3570100e+00];
aa3=-690.116+[-1.1235400e+00  -1.4358300e+00  -1.6371000e+00  -1.8458900e+00  -2.1179200e+00  -2.2658200e+00  -2.4975900e+00  -2.6895500e+00  -2.9058400e+00  -3.0480900e+00  -3.2059800e+00  -3.3535800e+00  -3.4796400e+00  -3.6082400e+00  -3.7355900e+00  -3.8188100e+00  -3.8893400e+00  -3.9763100e+00  -4.0445700e+00  -4.1154500e+00  -4.1768200e+00];

% 16439
ab1=13.5613+[3.1910900e-01   7.2314700e-01   9.3611300e-01   1.1580400e+00   1.4506100e+00   1.6053500e+00   1.8518100e+00   2.0500300e+00   2.2708000e+00   2.4131000e+00   2.5618400e+00   2.6928700e+00   2.8022900e+00   2.9120000e+00   3.0193500e+00   3.0886800e+00   3.1488300e+00   3.2233500e+00   3.2824500e+00   3.3428700e+00   3.3949100e+00];
ab2=447.206+[1.0864800e+00   8.0584600e-01   9.4353800e-01   1.2179300e+00   1.6262900e+00   1.8570100e+00   2.1734400e+00   2.3992300e+00   2.6357700e+00   2.7787400e+00   2.9292900e+00   3.0671500e+00   3.1717100e+00   3.2645300e+00   3.3439600e+00   3.3927000e+00   3.4327900e+00   3.4774800e+00   3.5118900e+00   3.5459400e+00   3.5719300e+00];
ab3=-699.132+[-9.9227400e-01  -1.2773200e+00  -1.4446800e+00  -1.6103800e+00  -1.8253400e+00  -1.9391400e+00  -2.1178800e+00  -2.2674200e+00  -2.4327100e+00  -2.5387400e+00  -2.6547200e+00  -2.7633700e+00  -2.8558700e+00  -2.9489000e+00  -3.0399300e+00  -3.0988600e+00  -3.1488500e+00  -3.2103700e+00  -3.2596000e+00  -3.3106300e+00  -3.3544800e+00];

% 17116
ac1=16.2684+[3.1756800e-01   7.0006200e-01   8.8442700e-01   1.0722200e+00   1.3250500e+00   1.4591800e+00   1.6789500e+00   1.8599800e+00   2.0603600e+00   2.1879700e+00   2.3194400e+00   2.4332300e+00   2.5276800e+00   2.6207000e+00   2.7094300e+00   2.7656100e+00   2.8138500e+00   2.8727400e+00   2.9185200e+00   2.9640600e+00   3.0021200e+00];
ac2=443.597+[1.2257500e+00   9.7246600e-01   1.1517200e+00   1.4760600e+00   1.9457900e+00   2.2082300e+00   2.5678900e+00   2.8247300e+00   3.0943400e+00   3.2579200e+00   3.4307500e+00   3.5894600e+00   3.7109400e+00   3.8202600e+00   3.9154800e+00   3.9744500e+00   4.0232500e+00   4.0784900e+00   4.1214600e+00   4.1644400e+00   4.1980400e+00];
ac3=-706.266+[-1.1326600e+00  -1.4255200e+00  -1.6098900e+00  -1.7976800e+00  -2.0441600e+00  -2.1751300e+00  -2.3796400e+00  -2.5503700e+00  -2.7368600e+00  -2.8545500e+00  -2.9820500e+00  -3.1007500e+00  -3.2006500e+00  -3.2990600e+00  -3.3928400e+00  -3.4526100e+00  -3.5027400e+00  -3.5633900e+00  -3.6114000e+00  -3.6603100e+00  -3.7012400e+00];

% 14886
ad1=9.91704+[5.2208400e-01   1.1686900e+00   1.5374600e+00   1.9158800e+00   2.3923300e+00   2.6402500e+00   3.0196600e+00   3.3164200e+00   3.6444300e+00   3.8556100e+00   4.0778500e+00   4.2780900e+00   4.4452000e+00   4.6132300e+00   4.7769500e+00   4.8847900e+00   4.9790800e+00   5.0964400e+00   5.1906900e+00   5.2867700e+00   5.3713000e+00];
ad2=444.847+[1.4321600e+00   9.6951000e-01   1.0349700e+00   1.2602100e+00   1.6347600e+00   1.8572200e+00   2.1712100e+00   2.4030300e+00   2.6464000e+00   2.7933700e+00   2.9496200e+00   3.0907000e+00   3.1983700e+00   3.2916500e+00   3.3689000e+00   3.4141100e+00   3.4494800e+00   3.4864300e+00   3.5136700e+00   3.5399300e+00   3.5569200e+00];
ad3=-691.954+[-1.0061900e+00  -1.2989300e+00  -1.4738300e+00  -1.6503000e+00  -1.8787800e+00  -2.0027900e+00  -2.1989500e+00  -2.3624600e+00  -2.5491800e+00  -2.6737900e+00  -2.8133300e+00  -2.9450600e+00  -3.0586800e+00  -3.1766200e+00  -3.2958300e+00  -3.3748300e+00  -3.4426600e+00  -3.5275300e+00  -3.5952100e+00  -3.6663000e+00  -3.7291700e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3']
y15=[ya1',ya2',ya3']

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_6P
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 1297
ae1=12.7746+[-3.0399900e-01  -5.5369900e-03   3.7244100e-01   8.3054800e-01   1.2307900e+00   1.7124700e+00   2.2062800e+00   2.7285300e+00   3.0146500e+00   3.4430500e+00   3.7513300e+00   3.9258700e+00   4.1444200e+00   4.3446800e+00   4.5202600e+00   4.6885500e+00   4.7810700e+00   4.9376000e+00   5.0325700e+00   5.0954800e+00   5.1677500e+00];
ae2=447.736+[2.4876100e+00   2.4923600e+00   2.5952200e+00   2.7415600e+00   2.8547300e+00   2.9496100e+00   3.0229000e+00   3.0879100e+00   3.1350500e+00   3.2452100e+00   3.3526200e+00   3.4240500e+00   3.5245000e+00   3.6276800e+00   3.7271300e+00   3.8277100e+00   3.8845500e+00   3.9818000e+00   4.0387000e+00   4.0751500e+00   4.1143300e+00];
ae3=-690.116+[-1.1890200e+00  -1.6952600e+00  -1.9566500e+00  -2.2122400e+00  -2.3967500e+00  -2.5995100e+00  -2.8174000e+00  -3.0721300e+00  -3.2216400e+00  -3.4649700e+00  -3.6521100e+00  -3.7629200e+00  -3.9079500e+00  -4.0479800e+00  -4.1774600e+00  -4.3060900e+00  -4.3789700e+00  -4.5066300e+00  -4.5858100e+00  -4.6384400e+00  -4.6991800e+00];

% 16439
af1=13.5613+[-3.2124000e-01  -1.3600300e-01   9.8758600e-02   3.9499400e-01   6.7245300e-01   1.0301600e+00   1.4100900e+00   1.8173200e+00   2.0432100e+00   2.3830600e+00   2.6271000e+00   2.7655100e+00   2.9395800e+00   3.0996800e+00   3.2428200e+00   3.3825400e+00   3.4602000e+00   3.5923400e+00   3.6725000e+00   3.7259400e+00   3.7875500e+00];
af2=447.206+[1.8134300e+00   1.7695300e+00   1.8796900e+00   2.0624300e+00   2.2138400e+00   2.3436600e+00   2.4402000e+00   2.5128700e+00   2.5586500e+00   2.6585400e+00   2.7542100e+00   2.8161200e+00   2.9015000e+00   2.9883200e+00   3.0703000e+00   3.1525200e+00   3.1986300e+00   3.2780400e+00   3.3249700e+00   3.3553900e+00   3.3886700e+00];
af3=-699.132+[-9.0469200e-01  -1.3496100e+00  -1.5775300e+00  -1.7952800e+00  -1.9441900e+00  -2.1071000e+00  -2.2827400e+00  -2.4895500e+00  -2.6103900e+00  -2.8065700e+00  -2.9572500e+00  -3.0457600e+00  -3.1612200e+00  -3.2713700e+00  -3.3722500e+00  -3.4725200e+00  -3.5296600e+00  -3.6292600e+00  -3.6907900e+00  -3.7317400e+00  -3.7789500e+00];

% 17116
ag1=16.2684+[-3.4470400e-01  -1.6766900e-01   4.8037500e-02   3.1127700e-01   5.5542000e-01   8.7669000e-01   1.2236100e+00   1.6030000e+00   1.8136200e+00   2.1283800e+00   2.3518000e+00   2.4774000e+00   2.6342000e+00   2.7762500e+00   2.9012400e+00   3.0208100e+00   3.0860500e+00   3.1944000e+00   3.2581600e+00   3.3002600e+00   3.3478300e+00];
ag2=449.981+[1.9898500e+00   1.9843400e+00   2.1391600e+00   2.3719000e+00   2.5613300e+00   2.7301100e+00   2.8614100e+00   2.9666300e+00   3.0300000e+00   3.1592500e+00   3.2784000e+00   3.3543400e+00   3.4581200e+00   3.5630900e+00   3.6621200e+00   3.7618500e+00   3.8181100e+00   3.9154800e+00   3.9736800e+00   4.0115800e+00   4.0535700e+00];
ag3=-696.273+[-1.0629800e+00  -1.5422300e+00  -1.8013800e+00  -2.0437300e+00  -2.2041300e+00  -2.3775400e+00  -2.5630000e+00  -2.7828300e+00  -2.9108700e+00  -3.1199400e+00  -3.2808500e+00  -3.3751800e+00  -3.4980200e+00  -3.6147400e+00  -3.7209000e+00  -3.8254200e+00  -3.8844300e+00  -3.9859400e+00  -4.0475000e+00  -4.0881200e+00  -4.1343000e+00];

% 14886
ah1=9.91704+[-2.6361700e-01   6.3223700e-02   4.8614700e-01   1.0088100e+00   1.4688600e+00   2.0160200e+00   2.5712800e+00   3.1507800e+00   3.4689100e+00   3.9491200e+00   4.2988400e+00   4.4988700e+00   4.7518000e+00   4.9871400e+00   5.1973300e+00   5.4031800e+00   5.5185400e+00   5.7180700e+00   5.8421400e+00   5.9250900e+00   6.0219300e+00];
ah2=448.847+[2.3816500e+00   2.3342900e+00   2.3729700e+00   2.4441400e+00   2.4972600e+00   2.5308200e+00   2.5491200e+00   2.5628100e+00   2.5821100e+00   2.6481300e+00   2.7216500e+00   2.7728800e+00   2.8468500e+00   2.9240200e+00   2.9988600e+00   3.0741200e+00   3.1162600e+00   3.1871900e+00   3.2273100e+00   3.2525700e+00   3.2785400e+00];
ah3=-691.954+[-1.0819800e+00  -1.5427200e+00  -1.7599200e+00  -1.9773500e+00  -2.1399300e+00  -2.3224600e+00  -2.5218700e+00  -2.7549300e+00  -2.8923700e+00  -3.1155200e+00  -3.2874000e+00  -3.3892900e+00  -3.5229300e+00  -3.6524100e+00  -3.7726600e+00  -3.8933300e+00  -3.9624500e+00  -4.0850800e+00  -4.1625300e+00  -4.2144500e+00  -4.2751600e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_6P
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 1297
ai1=12.7746+[-1.7128900e-01  -7.3300000e-02   1.3001300e-01   2.7379800e-01   5.1473100e-01   7.3765700e-01   1.0139600e+00   1.2680700e+00   1.6076600e+00   1.9130900e+00   2.2789700e+00   2.6460500e+00   2.9667900e+00   3.3326500e+00   3.5459100e+00   3.9211300e+00   4.0694300e+00   4.3139000e+00   4.4722600e+00   4.6394200e+00   4.7773600e+00];
ai2=447.736+[2.9455100e+00   2.9510400e+00   3.0934000e+00   3.2048800e+00   3.3964000e+00   3.5576500e+00   3.7171900e+00   3.8288500e+00   3.9359800e+00   4.0087000e+00   4.0797400e+00   4.1373200e+00   4.1816800e+00   4.2302700e+00   4.2590700e+00   4.3117500e+00   4.3337600e+00   4.3730300e+00   4.4017000e+00   4.4345800e+00   4.4631500e+00];
ai3=-690.116+[-1.4399000e+00  -1.6621800e+00  -1.8918900e+00  -2.0277100e+00  -2.2209900e+00  -2.3645700e+00  -2.5152200e+00  -2.6372700e+00  -2.8018300e+00  -2.9501700e+00  -3.1310400e+00  -3.3184600e+00  -3.4870700e+00  -3.6830800e+00  -3.7996000e+00  -4.0106900e+00  -4.0969300e+00  -4.2437700e+00  -4.3427000e+00  -4.4512700e+00  -4.5439500e+00];

% 16439
aj1=13.5613+[-2.2044400e-01  -1.6520900e-01  -6.1972400e-02   1.2498200e-02   1.4288100e-01   2.7420700e-01   4.5890400e-01   6.4515500e-01   9.0596500e-01   1.1442300e+00   1.4354300e+00   1.7325200e+00   1.9940500e+00   2.2918800e+00   2.4653200e+00   2.7693500e+00   2.8900400e+00   3.0902800e+00   3.2207500e+00   3.3594900e+00   3.4748000e+00];
aj2=447.206+[2.1526800e+00   2.1358000e+00   2.2547400e+00   2.3590700e+00   2.5543800e+00   2.7319000e+00   2.9114600e+00   3.0346300e+00   3.1444500e+00   3.2171400e+00   3.2850800e+00   3.3362600e+00   3.3765800e+00   3.4239100e+00   3.4529100e+00   3.5071700e+00   3.5298000e+00   3.5691300e+00   3.5965900e+00   3.6276100e+00   3.6546000e+00];
aj3=-699.132+[-1.1264800e+00  -1.3103900e+00  -1.4942100e+00  -1.6018200e+00  -1.7510400e+00  -1.8583100e+00  -1.9681200e+00  -2.0563700e+00  -2.1803500e+00  -2.2968200e+00  -2.4416500e+00  -2.5944700e+00  -2.7337900e+00  -2.8969200e+00  -2.9944000e+00  -3.1722000e+00  -3.2451300e+00  -3.3696000e+00  -3.4530200e+00  -3.5440300e+00  -3.6217700e+00];

% 17116
ak1=16.2684+[-2.4201000e-01  -1.9366800e-01  -1.1007300e-01  -5.1957900e-02   4.6226600e-02   1.4599600e-01   2.9512300e-01   4.5329700e-01   6.8526900e-01   9.0144900e-01   1.1685100e+00   1.4434300e+00   1.6860100e+00   1.9617500e+00   2.1217700e+00   2.4007000e+00   2.5107300e+00   2.6919400e+00   2.8085400e+00   2.9309800e+00   3.0316400e+00];
ak2=449.981+[2.3669000e+00   2.3649100e+00   2.5235600e+00   2.6551500e+00   2.8938900e+00   3.1063600e+00   3.3214300e+00   3.4717000e+00   3.6120500e+00   3.7090100e+00   3.8041600e+00   3.8804800e+00   3.9411200e+00   4.0106000e+00   4.0522600e+00   4.1287500e+00   4.1602600e+00   4.2147500e+00   4.2526200e+00   4.2951700e+00   4.3320200e+00];
ak3=-696.273+[-1.3288600e+00  -1.5224700e+00  -1.7315900e+00  -1.8542300e+00  -2.0221700e+00  -2.1396600e+00  -2.2571400e+00  -2.3509600e+00  -2.4847500e+00  -2.6104100e+00  -2.7666900e+00  -2.9307300e+00  -3.0784600e+00  -3.2497200e+00  -3.3513100e+00  -3.5351300e+00  -3.6100000e+00  -3.7371500e+00  -3.8218100e+00  -3.9135000e+00  -3.9912700e+00];

% 14886
al1=9.91704+[-1.2909300e-01  -1.4171500e-02   2.2985000e-01   4.0470100e-01   7.0241000e-01   9.7898200e-01   1.3158800e+00   1.6185900e+00   2.0112000e+00   2.3586500e+00   2.7716400e+00   3.1838800e+00   3.5440600e+00   3.9557400e+00   4.1965800e+00   4.6228400e+00   4.7925400e+00   5.0746000e+00   5.2598200e+00   5.4580000e+00   5.6235700e+00];
al2=444.847+[2.8113300e+00   2.7920600e+00   2.8766600e+00   2.9484900e+00   3.0756000e+00   3.1829800e+00   3.2864300e+00   3.3551200e+00   3.4150900e+00   3.4512400e+00   3.4822000e+00   3.5024000e+00   3.5157700e+00   3.5303400e+00   3.5396300e+00   3.5581300e+00   3.5664700e+00   3.5826000e+00   3.5953600e+00   3.6105300e+00   3.6239000e+00];
al3=-691.954+[-1.2862800e+00  -1.4919100e+00  -1.6822200e+00  -1.7939500e+00  -1.9546900e+00  -2.0772800e+00  -2.2096200e+00  -2.3179900e+00  -2.4636000e+00  -2.5961900e+00  -2.7588100e+00  -2.9285600e+00  -3.0836400e+00  -3.2665300e+00  -3.3764400e+00  -3.5780800e+00  -3.6612900e+00  -3.8038800e+00  -3.9005800e+00  -4.0074200e+00  -4.0993300e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_6P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 1297
am1=12.7746+[3.3679900e-01   3.6043500e-01   4.1887300e-01   4.8882100e-01   5.4701900e-01   6.3261900e-01   7.5428000e-01   8.3823600e-01   9.7959600e-01   1.1211700e+00   1.2375700e+00   1.4467600e+00   1.6735800e+00   1.8272300e+00   2.0789600e+00   2.2658000e+00   2.4910400e+00   2.7567100e+00   2.8957100e+00   3.1348200e+00   3.3183700e+00];
am2=447.736+[2.5609300e+00   2.5814600e+00   2.6941900e+00   2.8228100e+00   2.9327000e+00   3.0928700e+00   3.3099900e+00   3.4494900e+00   3.6571900e+00   3.8197700e+00   3.9284800e+00   4.0905500e+00   4.2287700e+00   4.3047200e+00   4.4147500e+00   4.4840400e+00   4.5622500e+00   4.6446400e+00   4.6855500e+00   4.7523300e+00   4.8012500e+00];
am3=-690.116+[-1.7303000e+00  -1.7789600e+00  -1.8866400e+00  -1.9924700e+00  -2.0773300e+00  -2.1903000e+00  -2.3274400e+00  -2.4118000e+00  -2.5381800e+00  -2.6462500e+00  -2.7258600e+00  -2.8601400e+00  -2.9963400e+00  -3.0835300e+00  -3.2226500e+00  -3.3230000e+00  -3.4432400e+00  -3.5845000e+00  -3.6585400e+00  -3.7870400e+00  -3.8878000e+00];
% 16439
an1=13.5613+[1.6922800e-01   1.8132700e-01   2.0217900e-01   2.2565800e-01   2.4509400e-01   2.7381600e-01   3.2049700e-01   3.5888200e-01   4.3791600e-01   5.2854000e-01   6.0895500e-01   7.6868200e-01   9.5040000e-01   1.0744500e+00   1.2788700e+00   1.4311900e+00   1.6160900e+00   1.8354700e+00   1.9504900e+00   2.1489700e+00   2.3014300e+00];
an2=447.206+[1.8377900e+00   1.8390900e+00   1.9187900e+00   2.0258600e+00   2.1200900e+00   2.2654300e+00   2.4737200e+00   2.6111500e+00   2.8139900e+00   2.9741200e+00   3.0811800e+00   3.2331100e+00   3.3561300e+00   3.4222800e+00   3.5178500e+00   3.5784200e+00   3.6474400e+00   3.7219100e+00   3.7596200e+00   3.8223200e+00   3.8690500e+00];
an3=-699.132+[-1.4183800e+00  -1.4449600e+00  -1.5116100e+00  -1.5832800e+00  -1.6402800e+00  -1.7157000e+00  -1.8067500e+00  -1.8618700e+00  -1.9406500e+00  -2.0086200e+00  -2.0609200e+00  -2.1523300e+00  -2.2506100e+00  -2.3158900e+00  -2.4227900e+00  -2.5025300e+00  -2.6004000e+00  -2.7179300e+00  -2.7802400e+00  -2.8895900e+00  -2.9759600e+00];
% 17116
ao1=16.2684+[1.5435300e-01   1.6123500e-01   1.6748900e-01   1.7481600e-01   1.7979700e-01   1.8581900e-01   1.9894500e-01   2.1430000e-01   2.5681200e-01   3.1700200e-01   3.7624100e-01   5.0365200e-01   6.5687700e-01   7.6436500e-01   9.4329600e-01   1.0784100e+00   1.2432000e+00   1.4397800e+00   1.5429200e+00   1.7209800e+00   1.8577500e+00];
ao2=449.981+[2.0571100e+00   2.0638800e+00   2.1647700e+00   2.2953400e+00   2.4091700e+00   2.5827600e+00   2.8281700e+00   2.9893100e+00   3.2264900e+00   3.4144200e+00   3.5408600e+00   3.7229500e+00   3.8741700e+00   3.9571500e+00   4.0785400e+00   4.1563800e+00   4.2451200e+00   4.3409800e+00   4.3895000e+00   4.4702300e+00   4.5304500e+00];
ao3=-696.273+[-1.6334300e+00  -1.6607700e+00  -1.7364400e+00  -1.8185600e+00  -1.8835600e+00  -1.9691000e+00  -2.0704900e+00  -2.1311000e+00  -2.2154100e+00  -2.2877000e+00  -2.3434400e+00  -2.4415300e+00  -2.5483800e+00  -2.6195000e+00  -2.7357700e+00  -2.8219200e+00  -2.9269900e+00  -3.0518000e+00  -3.1175900e+00  -3.2325000e+00  -3.3228300e+00];
% 14886
ap1=9.91704+[3.8729600e-01   4.2103500e-01   5.0584200e-01   6.0420500e-01   6.8712500e-01   8.1026300e-01   9.8651100e-01   1.1077800e+00   1.3084100e+00   1.5001000e+00   1.6518700e+00   1.9163400e+00   2.1934800e+00   2.3770800e+00   2.6752500e+00   2.8941100e+00   3.1572900e+00   3.4663400e+00   3.6279400e+00   3.9057300e+00   4.1189400e+00];
ap2=444.847+[2.4108500e+00   2.4189000e+00   2.4971800e+00   2.5901700e+00   2.6705300e+00   2.7885700e+00   2.9495500e+00   3.0531200e+00   3.2069400e+00   3.3261400e+00   3.4051200e+00   3.5215100e+00   3.6186100e+00   3.6705100e+00   3.7442700e+00   3.7894200e+00   3.8400600e+00   3.8923800e+00   3.9181800e+00   3.9599700e+00   3.9903800e+00];
ap3=-691.954+[-1.5620500e+00  -1.6046600e+00  -1.6925500e+00  -1.7784700e+00  -1.8476500e+00  -1.9402500e+00  -2.0543900e+00  -2.1257000e+00  -2.2344500e+00  -2.3289500e+00  -2.3991400e+00  -2.5173700e+00  -2.6368300e+00  -2.7136100e+00  -2.8369600e+00  -2.9270900e+00  -3.0363100e+00  -3.1666700e+00  -3.2356600e+00  -3.3565500e+00  -3.4521700e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_6P
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 1297
aq1=12.7746+[-4.3484900e-01   1.1242100e+00   1.8799600e+00   2.3210000e+00   2.6209700e+00   2.9249200e+00   3.2513000e+00   3.5912400e+00   3.8130300e+00   4.0314300e+00   4.2449300e+00   4.4412400e+00   4.5360700e+00   4.7120700e+00   4.7998500e+00   4.9158200e+00   5.0028000e+00   5.0591800e+00   5.1345800e+00   5.2095200e+00   5.2742900e+00];
aq2=447.736+[2.5760800e+00   1.6217500e+00   1.5156700e+00   1.6518200e+00   1.8713100e+00   2.1593300e+00   2.4903300e+00   2.7951800e+00   2.9872500e+00   3.1727900e+00   3.3480900e+00   3.5021600e+00   3.5713500e+00   3.6879100e+00   3.7427300e+00   3.8127800e+00   3.8651900e+00   3.8984600e+00   3.9379400e+00   3.9691400e+00   3.9898300e+00];
aq3=-690.116+[-9.0088400e-02  -2.0484300e+00  -2.3893000e+00  -2.6023500e+00  -2.7675500e+00  -2.9501300e+00  -3.1576600e+00  -3.3895900e+00  -3.5453800e+00  -3.7061700e+00  -3.8705700e+00  -4.0251800e+00  -4.1019400e+00  -4.2461900e+00  -4.3203000e+00  -4.4216000e+00  -4.4995700e+00  -4.5514900e+00  -4.6205200e+00  -4.6864900e+00  -4.7442100e+00];
% 16439
ar1=13.5613+[-4.2097600e-01   7.1020400e-01   1.2407100e+00   1.5556100e+00   1.7767600e+00   2.0053700e+00   2.2534900e+00   2.5132600e+00   2.6843000e+00   2.8555700e+00   3.0242000e+00   3.1779800e+00   3.2532000e+00   3.3931000e+00   3.4649300e+00   3.5627600e+00   3.6371700e+00   3.6856500e+00   3.7507100e+00   3.8147200e+00   3.8704900e+00];
ar2=447.206+[1.7838300e+00   1.1391300e+00   1.1455700e+00   1.3156200e+00   1.5252600e+00   1.7806900e+00   2.0663200e+00   2.3206000e+00   2.4789000e+00   2.6304400e+00   2.7739600e+00   2.9009200e+00   2.9569700e+00   3.0515800e+00   3.0954700e+00   3.1504200e+00   3.1914300e+00   3.2176700e+00   3.2490200e+00   3.2745300e+00   3.2922900e+00];
ar3=-699.132+[7.7023900e-02  -1.7286400e+00  -2.0335900e+00  -2.2018500e+00  -2.3268800e+00  -2.4663700e+00  -2.6245700e+00  -2.8051300e+00  -2.9254300e+00  -3.0477600e+00  -3.1717300e+00  -3.2880100e+00  -3.3455300e+00  -3.4524500e+00  -3.5072300e+00  -3.5823500e+00  -3.6406300e+00  -3.6793500e+00  -3.7311600e+00  -3.7808800e+00  -3.8242200e+00];
% 17116
as1=16.2684+[-4.5758100e-01   6.8111800e-01   1.1780100e+00   1.4550000e+00   1.6457000e+00   1.8456100e+00   2.0643300e+00   2.2997400e+00   2.4537400e+00   2.6059200e+00   2.7525600e+00   2.8839000e+00   2.9474900e+00   3.0636100e+00   3.1222700e+00   3.2001000e+00   3.2579600e+00   3.2947900e+00   3.3434600e+00   3.3910900e+00   3.4311600e+00];
as2=449.981+[1.9827400e+00   1.3593000e+00   1.4098800e+00   1.6207100e+00   1.8662700e+00   2.1606900e+00   2.4877800e+00   2.7806500e+00   2.9637800e+00   3.1402100e+00   3.3088400e+00   3.4589800e+00   3.5261100e+00   3.6412500e+00   3.6955500e+00   3.7648900e+00   3.8171300e+00   3.8508700e+00   3.8921500e+00   3.9269500e+00   3.9527300e+00];
as3=-696.273+[-9.3101500e-02  -1.9297100e+00  -2.2505300e+00  -2.4278500e+00  -2.5648500e+00  -2.7226000e+00  -2.9024700e+00  -3.1071700e+00  -3.2422400e+00  -3.3778000e+00  -3.5129000e+00  -3.6377400e+00  -3.6986200e+00  -3.8098600e+00  -3.8659400e+00  -3.9413100e+00  -3.9990300e+00  -4.0369200e+00  -4.0868800e+00  -4.1340300e+00  -4.1738400e+00];
% 14886
at1=9.91704+[-3.8613900e-01   1.2288400e+00   2.0583300e+00   2.5652800e+00   2.9161900e+00   3.2696700e+00   3.6484800e+00   4.0363800e+00   4.2915600e+00   4.5467700e+00   4.8016300e+00   5.0397400e+00   5.1562600e+00   5.3758500e+00   5.4875000e+00   5.6392800e+00   5.7556700e+00   5.8325400e+00   5.9365700e+00   6.0400300e+00   6.1318600e+00];
at2=444.847+[2.4369800e+00   1.4236200e+00   1.2390300e+00   1.3110500e+00   1.4801500e+00   1.7175500e+00   1.9956100e+00   2.2515600e+00   2.4115700e+00   2.5639800e+00   2.7048700e+00   2.8264700e+00   2.8796300e+00   2.9657300e+00   3.0047000e+00   3.0522700e+00   3.0870500e+00   3.1084600e+00   3.1320200e+00   3.1480700e+00   3.1551800e+00];
at3=-691.954+[6.2514600e-02  -1.8820000e+00  -2.1954800e+00  -2.3896100e+00  -2.5347000e+00  -2.6910100e+00  -2.8680400e+00  -3.0672200e+00  -3.2025000e+00  -3.3438600e+00  -3.4909400e+00  -3.6314300e+00  -3.7020500e+00  -3.8367800e+00  -3.9068900e+00  -4.0044000e+00  -4.0804600e+00  -4.1316500e+00  -4.2007000e+00  -4.2677900e+00  -4.3279500e+00];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_6P
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 1297
au1=12.7746+[3.1852000e-01   3.4078600e-01   3.9575100e-01   4.6231700e-01   5.1795400e-01   6.0003400e-01   7.1697300e-01   7.9770600e-01   9.1580200e-01   1.0407000e+00   1.1854600e+00   1.3615300e+00   1.5305000e+00   1.7541800e+00   2.0155500e+00   2.1495900e+00   2.3664700e+00   2.5874000e+00   3.0032800e+00   3.0571000e+00   3.2200900e+00];
au2=447.736+[2.6057600e+00   2.6260500e+00   2.7348500e+00   2.8581000e+00   2.9637500e+00   3.1194000e+00   3.3328300e+00   3.4714000e+00   3.6543800e+00   3.8107400e+00   3.9546500e+00   4.1003400e+00   4.2144800e+00   4.3362000e+00   4.4518300e+00   4.5051400e+00   4.5839000e+00   4.6556700e+00   4.7775300e+00   4.7927100e+00   4.8372400e+00];
au3=-690.116+[-1.7472500e+00  -1.7948900e+00  -1.9006500e+00  -2.0040600e+00  -2.0868500e+00  -2.1970500e+00  -2.3311400e+00  -2.4137600e+00  -2.5226200e+00  -2.6215700e+00  -2.7227500e+00  -2.8376500e+00  -2.9413600e+00  -3.0703300e+00  -3.2141700e+00  -3.2864400e+00  -3.4017600e+00  -3.5185200e+00  -3.7392100e+00  -3.7681000e+00  -3.8567400e+00];
% 16439
av1=13.5613+[1.4615900e-01   1.5733500e-01   1.7595600e-01   1.9765200e-01   2.1587000e-01   2.4287500e-01   2.8699500e-01   3.2306800e-01   3.8709100e-01   4.6458600e-01   5.6278800e-01   6.9541800e-01   8.2998600e-01   1.0097700e+00   1.2219900e+00   1.3312500e+00   1.5090200e+00   1.6914400e+00   2.0363000e+00   2.0810100e+00   2.2165300e+00];
av2=447.206+[1.8708400e+00   1.8714700e+00   1.9464700e+00   2.0478100e+00   2.1380000e+00   2.2792900e+00   2.4840200e+00   2.6206600e+00   2.7991900e+00   2.9533700e+00   3.0956800e+00   3.2337700e+00   3.3373100e+00   3.4450200e+00   3.5460100e+00   3.5927300e+00   3.6624400e+00   3.7271200e+00   3.8402600e+00   3.8547000e+00   3.8972900e+00];
av3=-699.132+[-1.4334300e+00  -1.4589900e+00  -1.5233500e+00  -1.5922800e+00  -1.6472200e+00  -1.7201400e+00  -1.8085300e+00  -1.8622700e+00  -1.9296200e+00  -1.9906100e+00  -2.0561700e+00  -2.1332100e+00  -2.2061000e+00  -2.3012500e+00  -2.4114800e+00  -2.4683400e+00  -2.5613800e+00  -2.6577400e+00  -2.8438800e+00  -2.8684600e+00  -2.9442700e+00];
% 17116
aw1=16.2684+[1.3041600e-01   1.3639900e-01   1.4069900e-01   1.4663000e-01   1.5072200e-01   1.5536700e-01   1.6634300e-01   1.7955500e-01   2.1176800e-01   2.6042900e-01   3.3081400e-01   4.3452500e-01   5.4577500e-01   6.9949300e-01   8.8485700e-01   9.8111000e-01   1.1389100e+00   1.3019100e+00   1.6108200e+00   1.6508200e+00   1.7721200e+00];
aw2=449.981+[2.0970500e+00   2.1029500e+00   2.1981100e+00   2.3217200e+00   2.4305900e+00   2.5992600e+00   2.8403900e+00   3.0005600e+00   3.2091300e+00   3.3895500e+00   3.5571600e+00   3.7216900e+00   3.8474700e+00   3.9810000e+00   4.1089000e+00   4.1684800e+00   4.2576100e+00   4.3405700e+00   4.4858800e+00   4.5043900e+00   4.5591100e+00];
aw3=-696.273+[-1.6551300e+00  -1.6812800e+00  -1.7539300e+00  -1.8324200e+00  -1.8947100e+00  -1.9771000e+00  -2.0754400e+00  -2.1346100e+00  -2.2068500e+00  -2.2716600e+00  -2.3414900e+00  -2.4237800e+00  -2.5025400e+00  -2.6059600e+00  -2.7257200e+00  -2.7871900e+00  -2.8871100e+00  -2.9896800e+00  -3.1858700e+00  -3.2116600e+00  -3.2909500e+00];
% 14886
ax1=9.91704+[3.7090600e-01   4.0314200e-01   4.8391700e-01   5.7818700e-01   6.5794300e-01   7.7686300e-01   9.4755200e-01   1.0652200e+00   1.2348500e+00   1.4070400e+00   1.5980000e+00   1.8231800e+00   2.0327500e+00   2.3029600e+00   2.6130800e+00   2.7710700e+00   3.0253300e+00   3.2829700e+00   3.7668200e+00   3.8294800e+00   4.0191500e+00];
ax2=444.847+[2.4504300e+00   2.4584600e+00   2.5336900e+00   2.6224000e+00   2.6994000e+00   2.8139200e+00   2.9722000e+00   3.0752200e+00   3.2111500e+00   3.3263400e+00   3.4313500e+00   3.5366300e+00   3.6177300e+00   3.7021800e+00   3.7798800e+00   3.8151500e+00   3.8666500e+00   3.9127000e+00   3.9896500e+00   3.9992100e+00   4.0271100e+00];
ax3=-691.954+[-1.5725900e+00  -1.6143000e+00  -1.7007800e+00  -1.7849800e+00  -1.8527000e+00  -1.9432700e+00  -2.0549200e+00  -2.1246800e+00  -2.2180700e+00  -2.3042700e+00  -2.3933200e+00  -2.4945800e+00  -2.5856600e+00  -2.6992100e+00  -2.8268000e+00  -2.8915000e+00  -2.9960000e+00  -3.1033000e+00  -3.3095500e+00  -3.3367900e+00  -3.4208400e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_6P
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 1297
ay1=12.7746+[-4.3481100e-01  -1.8729400e-02   4.3344800e-01   9.0524800e-01   1.4160000e+00   1.7744300e+00   2.2597300e+00   2.7967400e+00   3.0904900e+00   3.4554200e+00   3.7082400e+00   3.9666700e+00   4.1595900e+00   4.3501100e+00   4.5035800e+00   4.6779900e+00   4.8224500e+00   4.8995100e+00   5.0182400e+00   5.1074000e+00   5.1780400e+00];
ay2=447.736+[2.5760400e+00   2.3919500e+00   2.5111200e+00   2.6548500e+00   2.7843300e+00   2.8503900e+00   2.9290300e+00   3.0157600e+00   3.0845400e+00   3.2042400e+00   3.3113000e+00   3.4379800e+00   3.5443400e+00   3.6571300e+00   3.7529100e+00   3.8640700e+00   3.9518300e+00   3.9994100e+00   4.0729300e+00   4.1255200e+00   4.1639700e+00];
ay3=-690.116+[-9.1370300e-02  -1.6754400e+00  -1.9843500e+00  -2.2333000e+00  -2.4581200e+00  -2.6111200e+00  -2.8253500e+00  -3.0890000e+00  -3.2463300e+00  -3.4591400e+00  -3.6164000e+00  -3.7840800e+00  -3.9160900e+00  -4.0519000e+00  -4.1656100e+00  -4.2975800e+00  -4.4025200e+00  -4.4624400e+00  -4.5588600e+00  -4.6327000e+00  -4.6917000e+00];
% 16439
az1=13.5613+[-4.2095300e-01  -1.5549700e-01   1.3361500e-01   4.4731500e-01   8.1245000e-01   1.0807800e+00   1.4540500e+00   1.8722600e+00   2.1035100e+00   2.3928600e+00   2.5929700e+00   2.7973500e+00   2.9510000e+00   3.1033200e+00   3.2286300e+00   3.3742800e+00   3.4986900e+00   3.5642200e+00   3.6648500e+00   3.7407800e+00   3.8011300e+00];
az2=447.206+[1.7840500e+00   1.6946100e+00   1.8210700e+00   2.0007300e+00   2.1726700e+00   2.2626900e+00   2.3643400e+00   2.4586800e+00   2.5229500e+00   2.6286300e+00   2.7219500e+00   2.8312200e+00   2.9207700e+00   3.0152600e+00   3.0943100e+00   3.1856600e+00   3.2581700e+00   3.2975000e+00   3.3585800e+00   3.4025800e+00   3.4354600e+00];
az3=-699.132+[7.5821900e-02  -1.3315200e+00  -1.6026500e+00  -1.8146600e+00  -1.9964600e+00  -2.1206200e+00  -2.2933900e+00  -2.5068700e+00  -2.6335200e+00  -2.8041900e+00  -2.9298900e+00  -3.0630200e+00  -3.1672400e+00  -3.2733100e+00  -3.3614000e+00  -3.4636200e+00  -3.5452800e+00  -3.5921300e+00  -3.6672500e+00  -3.7246200e+00  -3.7704100e+00];
% 17116
ba1=16.2684+[-4.5755800e-01  -1.9074000e-01   7.7090500e-02   3.5800700e-01   6.8330500e-01   9.2639700e-01   1.2678000e+00   1.6570200e+00   1.8720300e+00   2.1393400e+00   2.3219900e+00   2.5064400e+00   2.6437300e+00   2.7779500e+00   2.8868400e+00   3.0111700e+00   3.1163500e+00   3.1707500e+00   3.2518400e+00   3.3117100e+00   3.3581700e+00];
ba2=449.981+[1.9828700e+00   1.9082000e+00   2.0846000e+00   2.3133000e+00   2.5310200e+00   2.6484200e+00   2.7836900e+00   2.9117000e+00   2.9952900e+00   3.1277300e+00   3.2416200e+00   3.3732100e+00   3.4804100e+00   3.5932600e+00   3.6878100e+00   3.7976000e+00   3.8851200e+00   3.9329000e+00   4.0077300e+00   4.0622900e+00   4.1036400e+00];
ba3=-696.273+[-9.4209400e-02  -1.5188700e+00  -1.8250900e+00  -2.0609000e+00  -2.2570000e+00  -2.3889700e+00  -2.5712300e+00  -2.7980000e+00  -2.9330400e+00  -3.1162300e+00  -3.2514400e+00  -3.3942700e+00  -3.5058300e+00  -3.6187300e+00  -3.7117400e+00  -3.8183800e+00  -3.9020300e+00  -3.9498400e+00  -4.0254100e+00  -4.0823100e+00  -4.1269000e+00];
% 14886
bb1=9.91704+[-3.8609900e-01   5.5574500e-02   5.5804400e-01   1.0935800e+00   1.6759700e+00   2.0807200e+00   2.6257000e+00   3.2220900e+00   3.5495600e+00   3.9597800e+00   4.2475100e+00   4.5450700e+00   4.7700400e+00   4.9953300e+00   5.1797800e+00   5.3935000e+00   5.5726500e+00   5.6697700e+00   5.8231700e+00   5.9405800e+00   6.0354400e+00];
bb2=444.847+[2.4370000e+00   2.2316700e+00   2.2792500e+00   2.3497400e+00   2.4080000e+00   2.4309200e+00   2.4562200e+00   2.4899100e+00   2.5290800e+00   2.6096000e+00   2.6875000e+00   2.7827800e+00   2.8642800e+00   2.9511600e+00   3.0248200e+00   3.1094500e+00   3.1753400e+00   3.2106200e+00   3.2638400e+00   3.3006500e+00   3.3261800e+00];
bb3=-691.954+[6.1123100e-02  -1.5280100e+00  -1.7875100e+00  -1.9999100e+00  -2.1985900e+00  -2.3370800e+00  -2.5335300e+00  -2.7750800e+00  -2.9189500e+00  -3.1126900e+00  -3.2559300e+00  -3.4090800e+00  -3.5299000e+00  -3.6548000e+00  -3.7599800e+00  -3.8835200e+00  -3.9836800e+00  -4.0411800e+00  -4.1349900e+00  -4.2078100e+00  -4.2669400e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_6P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 1297
bc1=12.7746+[3.8812000e-01   4.1780900e-01   4.9133200e-01   5.7580000e-01   6.7883400e-01   7.6410200e-01   9.0296000e-01   1.0386800e+00   1.2206000e+00   1.4010900e+00   1.6068300e+00   1.7871200e+00   2.0239800e+00   2.2108300e+00   2.5794200e+00   2.7237300e+00   2.9830300e+00   3.1376400e+00   3.3878600e+00   3.5663600e+00   3.7410100e+00];
bc2=447.736+[2.8364000e+00   2.8540200e+00   2.9743700e+00   3.1126300e+00   3.2713100e+00   3.3977800e+00   3.5845700e+00   3.7439100e+00   3.9211000e+00   4.0626000e+00   4.1917200e+00   4.2929900e+00   4.4073800e+00   4.4847300e+00   4.6197700e+00   4.6693900e+00   4.7553700e+00   4.8050500e+00   4.8840900e+00   4.9402300e+00   4.9951100e+00];
bc3=-690.116+[-1.3218300e+00  -1.3769400e+00  -1.4979600e+00  -1.6138300e+00  -1.7352000e+00  -1.8294600e+00  -1.9643200e+00  -2.0784500e+00  -2.2130000e+00  -2.3378900e+00  -2.4728100e+00  -2.5891400e+00  -2.7395600e+00  -2.8554300e+00  -3.0815300e+00  -3.1698400e+00  -3.3289400e+00  -3.4240600e+00  -3.5796900e+00  -3.6931600e+00  -3.8065000e+00];
% 16439
bd1=13.5613+[2.2240800e-01   2.3899000e-01   2.6933600e-01   3.0392600e-01   3.4734500e-01   3.8386100e-01   4.5056000e-01   5.2608700e-01   6.4298600e-01   7.7102400e-01   9.2566600e-01   1.0660600e+00   1.2570600e+00   1.4075200e+00   1.7058100e+00   1.8234100e+00   2.0371300e+00   2.1645800e+00   2.3712100e+00   2.5190300e+00   2.6640600e+00];
bd2=447.206+[2.0702900e+00   2.0705800e+00   2.1635100e+00   2.2863500e+00   2.4380300e+00   2.5629900e+00   2.7527700e+00   2.9148400e+00   3.0920000e+00   3.2281600e+00   3.3486700e+00   3.4399200e+00   3.5369000e+00   3.6027300e+00   3.7207900e+00   3.7652700e+00   3.8431800e+00   3.8892200e+00   3.9629100e+00   4.0154100e+00   4.0666500e+00];
bd3=-699.132+[-1.1512300e+00  -1.1834200e+00  -1.2639600e+00  -1.3463200e+00  -1.4342400e+00  -1.5022400e+00  -1.5959000e+00  -1.6712800e+00  -1.7591800e+00  -1.8425100e+00  -1.9359700e+00  -2.0188200e+00  -2.1291000e+00  -2.2169300e+00  -2.3933700e+00  -2.4633800e+00  -2.5909300e+00  -2.6681500e+00  -2.7966900e+00  -2.8916000e+00  -2.9866300e+00];
% 17116
be1=16.2684+[2.0733300e-01   2.1748600e-01   2.2952100e-01   2.4397600e-01   2.6314800e-01   2.7958500e-01   3.1465000e-01   3.6113700e-01   4.4398900e-01   5.4383100e-01   6.7176300e-01   7.9063700e-01   9.5684300e-01   1.0897200e+00   1.3558200e+00   1.4611000e+00   1.6527300e+00   1.7669600e+00   1.9520500e+00   2.0841900e+00   2.2135600e+00];
be2=449.981+[2.3181800e+00   2.3254900e+00   2.4435700e+00   2.5935700e+00   2.7758700e+00   2.9248200e+00   3.1487300e+00   3.3395800e+00   3.5490300e+00   3.7118000e+00   3.8580000e+00   3.9701600e+00   4.0917600e+00   4.1753700e+00   4.3253000e+00   4.3815400e+00   4.4798100e+00   4.5376800e+00   4.6302000e+00   4.6960000e+00   4.7602400e+00];
be3=-696.273+[-1.3985200e+00  -1.4321300e+00  -1.5230000e+00  -1.6165900e+00  -1.7161100e+00  -1.7925200e+00  -1.8957000e+00  -1.9774000e+00  -2.0716600e+00  -2.1608000e+00  -2.2609800e+00  -2.3499500e+00  -2.4684400e+00  -2.5628400e+00  -2.7510200e+00  -2.8251600e+00  -2.9594400e+00  -3.0403800e+00  -3.1746400e+00  -3.2733800e+00  -3.3720100e+00];
% 14886
bf1=9.91704+[4.3791600e-01   4.7938400e-01   5.8444600e-01   7.0304600e-01   8.4662500e-01   9.6539800e-01   1.1565700e+00   1.3398800e+00   1.5784700e+00   1.8070700e+00   2.0595600e+00   2.2780600e+00   2.5605800e+00   2.7804200e+00   3.2104900e+00   3.3784700e+00   3.6802200e+00   3.8602000e+00   4.1517500e+00   4.3602500e+00   4.5647900e+00];
bf2=444.847+[2.6550600e+00   2.6583600e+00   2.7395500e+00   2.8377000e+00   2.9517300e+00   3.0431000e+00   3.1786300e+00   3.2941600e+00   3.4216900e+00   3.5222400e+00   3.6123500e+00   3.6824500e+00   3.7601100e+00   3.8115800e+00   3.9005300e+00   3.9331700e+00   3.9897200e+00   4.0224800e+00   4.0750000e+00   4.1126400e+00   4.1495900e+00];
bf3=-691.954+[-1.0947100e+00  -1.1427200e+00  -1.2421800e+00  -1.3373400e+00  -1.4377500e+00  -1.5165300e+00  -1.6315500e+00  -1.7305600e+00  -1.8489200e+00  -1.9596300e+00  -2.0798400e+00  -2.1837700e+00  -2.3182300e+00  -2.4226000e+00  -2.6291500e+00  -2.7107100e+00  -2.8588200e+00  -2.9481700e+00  -3.0957800e+00  -3.2043400e+00  -3.3132600e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_6P
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 1297
bg1=12.7746+[-2.9740500e-01  -2.3942900e-01  -1.4473400e-01  -4.9668200e-02   7.8013000e-02   1.4152900e-01   2.7685700e-01   4.2221600e-01   5.8561700e-01   7.5995100e-01   1.0460400e+00   1.1412300e+00   1.4693400e+00   1.5878700e+00   1.8953700e+00   2.0642900e+00   2.3662300e+00   2.5324700e+00   2.7966900e+00   3.0129500e+00   3.2150800e+00];
bg2=447.736+[2.7438700e+00   2.7608500e+00   2.8967300e+00   3.0438400e+00   3.2361700e+00   3.3263100e+00   3.5066800e+00   3.6856000e+00   3.8628800e+00   4.0268800e+00   4.2412800e+00   4.3043400e+00   4.4889200e+00   4.5456300e+00   4.6737400e+00   4.7367600e+00   4.8380500e+00   4.8908700e+00   4.9706700e+00   5.0336500e+00   5.0912500e+00];
bg3=-690.116+[-7.2232400e-01  -9.6205300e-01  -1.1728900e+00  -1.3217300e+00  -1.4921400e+00  -1.5654000e+00  -1.7036900e+00  -1.8355500e+00  -1.9685000e+00  -2.0981900e+00  -2.2890100e+00  -2.3501600e+00  -2.5545500e+00  -2.6259200e+00  -2.8070900e+00  -2.9059300e+00  -3.0813700e+00  -3.1777200e+00  -3.3297400e+00  -3.4554200e+00  -3.5759000e+00];
% 16439
bh1=13.5613+[-2.9872300e-01  -2.6853800e-01  -2.2323300e-01  -1.7882000e-01  -1.1957000e-01  -8.9783800e-02  -2.3291000e-02   5.2635800e-02   1.4874400e-01   2.6299000e-01   4.7156000e-01   5.4459300e-01   8.0560100e-01   9.0076400e-01   1.1497100e+00   1.2881500e+00   1.5361900e+00   1.6731200e+00   1.8909400e+00   2.0699600e+00   2.2380500e+00];
bh2=447.206+[2.0430200e+00   2.0328900e+00   2.1171400e+00   2.2306500e+00   2.3936400e+00   2.4761800e+00   2.6495700e+00   2.8261100e+00   3.0013700e+00   3.1601900e+00   3.3612900e+00   3.4185900e+00   3.5787700e+00   3.6275100e+00   3.7373700e+00   3.7917900e+00   3.8822300e+00   3.9307800e+00   4.0058700e+00   4.0657400e+00   4.1208100e+00];
bh3=-699.132+[-5.8657500e-01  -7.8625900e-01  -9.4891800e-01  -1.0610500e+00  -1.1888300e+00  -1.2434200e+00  -1.3448600e+00  -1.4377100e+00  -1.5288200e+00  -1.6158800e+00  -1.7459600e+00  -1.7885200e+00  -1.9361000e+00  -1.9894100e+00  -2.1287000e+00  -2.2063200e+00  -2.3465600e+00  -2.4247400e+00  -2.5507200e+00  -2.6565600e+00  -2.7587100e+00];
% 17116
bi1=16.2684+[-3.2813800e-01  -3.0051100e-01  -2.7043900e-01  -2.4320600e-01  -2.0809300e-01  -1.9047800e-01  -1.4983300e-01  -1.0150400e-01  -3.4450200e-02   5.1456900e-02   2.2042600e-01   2.8140300e-01   5.0588500e-01   5.8927900e-01   8.1012400e-01   9.3396400e-01   1.1569900e+00   1.2802500e+00   1.4765500e+00   1.6378700e+00   1.7892700e+00];
bi2=449.981+[2.2464200e+00   2.2462300e+00   2.3599400e+00   2.5026500e+00   2.7026900e+00   2.8021800e+00   3.0085100e+00   3.2169000e+00   3.4233200e+00   3.6110700e+00   3.8522100e+00   3.9216600e+00   4.1193300e+00   4.1803800e+00   4.3198400e+00   4.3893000e+00   4.5044600e+00   4.5660500e+00   4.6610600e+00   4.7368300e+00   4.8064600e+00];
bi3=-696.273+[-7.6833000e-01  -9.7654800e-01  -1.1571300e+00  -1.2853700e+00  -1.4318900e+00  -1.4942000e+00  -1.6089500e+00  -1.7127100e+00  -1.8130900e+00  -1.9080900e+00  -2.0499500e+00  -2.0963300e+00  -2.2571100e+00  -2.3152300e+00  -2.4667200e+00  -2.5505100e+00  -2.7003500e+00  -2.7833500e+00  -2.9164200e+00  -3.0276800e+00  -3.1345700e+00];
% 14886
bk1=9.91704+[-2.5342700e-01  -1.8655400e-01  -6.3765400e-02   6.1825300e-02   2.3172300e-01   3.1614900e-01   4.9570100e-01   6.8792400e-01   9.0103600e-01   1.1242800e+00   1.4794500e+00   1.5959200e+00   1.9901500e+00   2.1304200e+00   2.4906600e+00   2.6874100e+00   3.0374100e+00   3.2299400e+00   3.5356100e+00   3.7858600e+00   4.0200300e+00];
bk2=444.847+[2.6061700e+00   2.6083800e+00   2.7027000e+00   2.8089200e+00   2.9491400e+00   3.0151900e+00   3.1477300e+00   3.2794300e+00   3.4095800e+00   3.5293800e+00   3.6836900e+00   3.7287200e+00   3.8584200e+00   3.8975400e+00   3.9841000e+00   4.0259500e+00   4.0922800e+00   4.1267800e+00   4.1788900e+00   4.2201000e+00   4.2578500e+00];
bk3=-691.954+[-5.6563500e-01  -7.9349200e-01  -9.7460600e-01  -1.0971300e+00  -1.2367400e+00  -1.2969900e+00  -1.4118200e+00  -1.5228500e+00  -1.6367000e+00  -1.7491300e+00  -1.9156200e+00  -1.9691500e+00  -2.1488000e+00  -2.2119300e+00  -2.3734300e+00  -2.4624600e+00  -2.6228200e+00  -2.7119100e+00  -2.8541500e+00  -2.9729700e+00  -3.0876700e+00];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (6P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (6P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')