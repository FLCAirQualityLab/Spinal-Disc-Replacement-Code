%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under lateral bending (5n)
% 20212,40296,25651,42160
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 20212,40296,25651,42160
%% model15_intact_TLC_4N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 20212
aa1=-10.8616+[0.237303 0.31288 0.351397 0.370228 0.381912 0.391195 0.403932 0.411525 0.41968 0.426958 0.431411 0.436007 0.45379 0.497703 0.537359 0.562988 0.57647 0.557766 0.513821 0.473171 0.431502];
aa2=446.379+[0.413703 0.296671 0.470126 0.858419 1.4205 2.12954 2.98047 3.89265 4.82493 5.8058 6.77089 7.77528 8.76902 9.76788 10.621 11.4701 12.2275 12.8904 13.4936 13.9771 14.4441];
aa3=-704.985+[-0.501412 -0.496391 -0.510042 -0.539247 -0.585026 -0.653807 -0.765933 -0.919539 -1.1065 -1.3323 -1.58128 -1.8733 -2.19289 -2.53625 -2.85321 -3.20505 -3.55489 -3.89302 -4.21926 -4.49417 -4.76405];

% 40296
ab1=-12.2381+[0.123435 0.174575 0.202616 0.216278 0.22497 0.232783 0.245353 0.254658 0.268628 0.283895 0.296851 0.315201 0.344883 0.394893 0.433773 0.460938 0.479437 0.472969 0.444385 0.415451 0.385476];
ab2=446.122+[0.252332 0.0815928 0.122571 0.331254 0.676166 1.13434 1.69575 2.30524 2.94156 3.62658 4.31063 5.03119 5.75016 6.47204 7.08543 7.69396 8.23129 8.69702 9.11592 9.4469 9.76496];
ab3=-714.556+[-0.468917 -0.438405 -0.421603 -0.417336 -0.423762 -0.443703 -0.492387 -0.569795 -0.673395 -0.80553 -0.955713 -1.13868 -1.34086 -1.55245 -1.74553 -1.96374 -2.18347 -2.39871 -2.60059 -2.76643 -2.9274];

% 25651
ac1=-9.36067+[0.270513 0.347636 0.387766 0.409586 0.425609 0.43972 0.456944 0.468697 0.480078 0.489549 0.496251 0.503631 0.524353 0.573579 0.618612 0.649329 0.666627 0.65005 0.608196 0.569218 0.529495 ];
ac2=443.597+[0.404337 0.284193 0.444241 0.814097 1.35476 2.04038 2.86571 3.75318 4.66296 5.62297 6.57079 7.56056 8.54295 9.53447 10.3838 11.231 11.9881 12.6517 13.2571 13.7437 14.215];
ac3=-706.266+[-0.440591 -0.426772 -0.407389 -0.388305 -0.373627 -0.371393 -0.400117 -0.464806 -0.561918 -0.694585 -0.853122 -1.05186 -1.28007 -1.53202 -1.76971 -2.0397 -2.31203 -2.57763 -2.83496 -3.05194 -3.26484];

% 42160
ad1=-14.6392+[0.138744 0.196419 0.227168 0.241111 0.248626 0.254628 0.265308 0.272171 0.282938 0.294503 0.303477 0.316712 0.342279 0.389432 0.427427 0.453003 0.469352 0.459338 0.426653 0.394178 0.360711];
ad2=448.856+[0.338222 0.153144 0.210969 0.458411 0.859299 1.38715 2.03176 2.72952 3.4554 4.23341 5.00642 5.81653 6.62169 7.42717 8.11164 8.79102 9.39315 9.91671 10.387 10.7586 11.1154];
ad3=-710.316+[-0.51616 -0.472536 -0.465788 -0.488074 -0.534615 -0.606296 -0.719007 -0.86766 -1.04738 -1.26267 -1.49662 -1.76889 -2.06081 -2.36316 -2.63595 -2.93786 -3.23813 -3.52941 -3.80216 -4.02619 -4.24439];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];
% 20212
ae1=-10.8616+[-0.322039 -0.274874 -0.212712 -0.153142 -0.121714 -0.0716782 -0.0221612 0.0179193 0.0556734 0.0808902 0.102527 0.116023 0.125501 0.127398 0.122106 0.110905 0.0935449 0.0730283 0.0376357 0.00257202 -0.0402057];
ae2=446.379+[1.21324 1.07661 1.00488 1.00717 1.03272 1.11673 1.26674 1.46998 1.77222 2.07166 2.43316 2.77237 3.16842 3.68124 4.14043 4.66367 5.21666 5.6959 6.35155 6.90711 7.54336];
ae3=-704.985+[-0.790441 -0.970197 -1.0187 -1.04279 -1.05495 -1.07864 -1.10923 -1.14485 -1.19616 -1.24711 -1.3132 -1.38054 -1.46338 -1.56288 -1.65639 -1.77177 -1.90225 -2.0242 -2.20962 -2.38009 -2.5853];

% 40296
af1=-12.2381+[-0.296706 -0.275924 -0.227934 -0.186388 -0.167537 -0.133547 -0.093802 -0.0612192 -0.0297956 -0.00653794 0.0145336 0.0291072 0.0421385 0.0573526 0.0661948 0.0704102 0.0673811 0.0607085 0.0452363 0.0302468 0.0132214];
af2= 446.122+[0.803328 0.590812 0.342196 0.168415 0.103395 0.0397918 0.0240425 0.0559111 0.147636 0.263464 0.422305 0.584344 0.784119 1.05666 1.31118 1.61023 1.93835 2.22959 2.63549 2.98642 3.39876];
af3=-714.556+[-0.751604 -0.883601 -0.854455 -0.81125 -0.790283 -0.759468 -0.733308 -0.714681 -0.698544 -0.687848 -0.682756 -0.6853 -0.693657 -0.711019 -0.731306 -0.760156 -0.798247 -0.837828 -0.906414 -0.974153 -1.061];

% 25651
ag1=-9.36067+[-0.292646 -0.244635 -0.180422 -0.118129 -0.0853903 -0.0335446 0.0183992 0.0615604 0.102959 0.131153 0.155773 0.171652 0.183529 0.188165 0.185107 0.176217 0.160806 0.14166 0.107752 0.0737794 0.0319828];
ag2=443.677+[1.15065 1.01058 0.925408 0.913504 0.931216 1.00184 1.1369 1.32467 1.60766 1.89027 2.23307 2.55595 2.93413 3.4245 3.86543 4.36988 4.9053 5.37089 6.01003 6.55353 7.17813];
ag3=-706.563+[-0.648179 -0.821058 -0.841778 -0.834885 -0.829762 -0.823702 -0.819224 -0.816325 -0.81781 -0.823485 -0.837255 -0.856823 -0.884855 -0.911441 -0.940617 -0.983898 -1.0404 -1.09921 -1.19893 -1.29717 -1.42084];

% 42160
ah1=-14.6392+[-0.323489 -0.295695 -0.23926 -0.191439 -0.170004 -0.13207 -0.0892078 -0.0550712 -0.0224867 0.00145008 0.0225702 0.0365564 0.0485425 0.0622417 0.068963 0.0700601 0.0632777 0.0531404 0.0329759 0.0139615 -0.00762303];
ah2=448.856+[0.94052 0.696063 0.430045 0.251245 0.187132 0.129467 0.124317 0.17243 0.290838 0.434519 0.628339 0.824007 1.06335 1.38685 1.68652 2.03579 2.41584 2.75066 3.21446 3.61352 4.08103 ];
ah3=-710.316+[-0.858051 -0.964187 -0.918337 -0.868092 -0.846217 -0.817054 -0.796108 -0.787482 -0.788875 -0.797085 -0.816597 -0.843635 -0.881581 -0.938134 -0.994514 -1.06499 -1.14759 -1.22567 -1.3469 -1.45981 -1.59993];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4N
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 20212
ai1=-10.8616+[-0.237609 -0.191944 -0.133715 -0.0768157 -0.0472633 -0.00154442 0.0393689 0.0795284 0.108029 0.126423 0.146847 0.154234 0.155256 0.149487 0.136689 0.116326 0.0892378 0.0544481 0.00675228 -0.0398858 -0.0979295];
ai2=446.379+[1.42477 1.28903 1.21542 1.21844 1.24532 1.33336 1.47383 1.71399 1.99965 2.24808 2.62428 2.96029 3.30993 3.73118 4.1416 4.61199 5.06858 5.56382 6.12618 6.6318 7.21125];
ai3=-704.985+[-0.908536 -0.999082 -1.02233 -1.04091 -1.05275 -1.07957 -1.11068 -1.15569 -1.20638 -1.25009 -1.30107 -1.28973 -1.25887 -1.22418 -1.19795 -1.17722 -1.17106 -1.18016 -1.21785 -1.27315 -1.35569];

% 40296
aj1=-12.2381+[-0.2408 -0.219153 -0.175669 -0.139078 -0.120714 -0.087314 -0.0525535 -0.0200557 0.0049413 0.0203658 0.0388404 0.0608217 0.0810597 0.0988882 0.10854 0.112716 0.112971 0.104462 0.0874049 0.0674487 0.0408574 ];
aj2=446.122+[0.873877 0.686511 0.455226 0.291098 0.229343 0.169622 0.152422 0.190734 0.278945 0.373127 0.530084 0.654542 0.767822 0.902014 1.03358 1.18074 1.3256 1.48815 1.69833 1.91099 2.16735];
aj3=-714.556+[-0.83035 -0.884874 -0.838939 -0.792787 -0.770691 -0.741961 -0.720089 -0.70198 -0.689716 -0.683317 -0.686562 -0.693607 -0.692804 -0.689493 -0.690506 -0.695444 -0.702733 -0.715483 -0.73652 -0.76306 -0.801746];

% 25651
ak1=-9.36067+[-0.206337 -0.158932 -0.0979194 -0.0380396 -0.00718186 0.0404957 0.0838404 0.127494 0.159257 0.180031 0.20334 0.213088 0.216694 0.213691 0.203113 0.184826 0.159253 0.125601 0.0783238 0.0317741 -0.0267472];
ak2=443.677+[1.3488 1.21255 1.128 1.11781 1.13704 1.21185 1.33832 1.56045 1.82824 2.06262 2.41673 2.72804 3.05182 3.44484 3.83102 4.27718 4.71445 5.19334 5.74302 6.24186 6.81785 ];
ak3=-706.563+[-0.738806 -0.82688 -0.825816 -0.814542 -0.809215 -0.805892 -0.803296 -0.802421 -0.805844 -0.811054 -0.799926 -0.71582 -0.601734 -0.46575 -0.340716 -0.204832 -0.0874461 0.0226073 0.111462 0.163053 0.199573];

% 42160
al1=-14.6392+[-0.261043 -0.232898 -0.18189 -0.139948 -0.119095 -0.0821663 -0.0449686 -0.0110227 0.0147668 0.0304629 0.0488628 0.0712097 0.0915311 0.108812 0.117107 0.119186 0.117129 0.105481 0.0847615 0.0615766 0.0314862 ];
al2=448.856+[1.02138 0.808433 0.561523 0.392908 0.332312 0.278496 0.271233 0.328738 0.442039 0.558912 0.750157 0.901313 1.04004 1.20419 1.36406 1.54234 1.7169 1.91118 2.15973 2.40788 2.70409];
al3=-710.316+[-0.940231 -0.973396 -0.912404 -0.860058 -0.83728 -0.810433 -0.793786 -0.787835 -0.792382 -0.801663 -0.829331 -0.855536 -0.873355 -0.892636 -0.91579 -0.945798 -0.977607 -1.01741 -1.07178 -1.12982 -1.20462];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 20212
am1=-10.8616+[0.090966 0.108522 0.13135 0.148136 0.160944 0.177695 0.195498 0.207811 0.219087 0.229065 0.236315 0.244289 0.24912 0.250804 0.24766 0.240456 0.230347 0.21775 0.197844 0.175411 0.155693];
am2=446.379+[0.899489 0.841843 0.801008 0.797539 0.804169 0.835007 0.904677 1.00483 1.14198 1.33391 1.52737 1.78088 2.01514 2.28101 2.58772 2.94466 3.28319 3.6512 4.11829 4.54802 4.87799];
am3=-704.985+[-0.86313 -0.869286 -0.883891 -0.900498 -0.914403 -0.936645 -0.967348 -0.99777 -1.03121 -1.07224 -1.11047 -1.16 -1.2072 -1.25627 -1.30907 -1.37384 -1.44013 -1.5192 -1.62768 -1.73452 -1.82137];
% 40296
an1=-12.2381+[-0.0539516 -0.0427842 -0.0209699 -0.00299195 0.0103669 0.0282228 0.0483994 0.0636094 0.0749995 0.0862917 0.0953963 0.10369 0.108927 0.11589 0.126131 0.135503 0.141037 0.143258 0.140326 0.133614 0.125986];
an2=446.122+[0.432532 0.35243 0.201436 0.0804257 -0.00858318 -0.106206 -0.180664 -0.215942 -0.223978 -0.199532 -0.152979 -0.073372 0.0142741 0.124041 0.261546 0.4319 0.599229 0.785886 1.03136 1.26259 1.44353 ];
an3=-714.556+[-0.79231 -0.782207 -0.744349 -0.713132 -0.689441 -0.660732 -0.635477 -0.618762 -0.604387 -0.589492 -0.577508 -0.565924 -0.560334 -0.55899 -0.56018 -0.565565 -0.574632 -0.588663 -0.612527 -0.63765 -0.659589];
% 25651
ao1=-9.36067+[0.130737 0.148928 0.172898 0.190945 0.204863 0.222925 0.242286 0.256418 0.269701 0.281876 0.290956 0.301031 0.307611 0.310938 0.309399 0.303796 0.295101 0.283771 0.264943 0.243318 0.224219];
ao2=443.677+[0.851766 0.793394 0.743276 0.729668 0.727832 0.746583 0.802551 0.88993 1.01331 1.18923 1.36859 1.60536 1.82546 2.07556 2.36495 2.70325 3.02536 3.37677 3.82459 4.23827 4.557 ];
ao3=-706.563+[-0.739154 -0.743348 -0.73944 -0.735235 -0.731403 -0.728259 -0.729211 -0.730453 -0.731277 -0.733248 -0.736018 -0.741887 -0.750702 -0.755906 -0.7585 -0.766232 -0.778964 -0.800502 -0.83724 -0.878748 -0.915731];
% 42160
ap1=-14.6392+[-0.0493544 -0.0362003 -0.0111841 0.00938573 0.0245791 0.0446148 0.0665784 0.0825433 0.0943313 0.105945 0.115241 0.123365 0.128021 0.134292 0.143618 0.15146 0.155125 0.154985 0.148677 0.138847 0.128776];
ap2=448.856+[0.511745 0.422355 0.261237 0.13537 0.0441844 -0.0525401 -0.123277 -0.152407 -0.15043 -0.110005 -0.0460361 0.0572228 0.167661 0.303687 0.472164 0.678852 0.880486 1.10411 1.39596 1.66873 1.88096];
ap3=-710.316+[-0.841263 -0.823828 -0.777389 -0.741445 -0.715206 -0.685752 -0.661802 -0.648593 -0.640514 -0.635982 -0.635525 -0.640013 -0.650385 -0.667725 -0.691346 -0.723805 -0.759177 -0.802308 -0.863716 -0.923286 -0.971726];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3 ];
% 20212
aq1=-10.8616+[-0.401806 0.336695 0.409687 0.417753 0.417013 0.415209 0.395172 0.371591 0.35851 0.324991 0.274428 0.236021 0.207015 0.178102 0.128647 0.0837992 0.0395807 0.00448718 -0.0278684 -0.0566627 -0.0778714];
aq2= 446.379+[1.11968 0.3659 1.04758 1.90794 2.99773 4.12049 5.45494 6.6664 7.78221 8.80705 9.76187 10.4925 11.3389 12.105 12.8423 13.5149 14.2087 14.9604 15.4827 16.1103 16.6294];
aq3=704.985+[0.123842 -0.805593 -0.869002 -0.982352 -1.15306 -1.36043 -1.67102 -2.00793 -2.35464 -2.57525 -2.77289 -2.92606 -3.11322 -3.30124 -3.50308 -3.71701 -3.95428 -4.22616 -4.40972 -4.6243 -4.76941];
% 40296
ar1=-12.2381+[-0.211763 0.117334 0.176277 0.194574 0.210148 0.22405 0.231578 0.237594 0.248022 0.259581 0.257807 0.255559 0.258815 0.261325 0.25018 0.241832 0.234188 0.240676 0.239006 0.236276 0.22863 ];
ar2=446.122+[0.668103 -0.156344 0.14809 0.649969 1.32037 2.02522 2.87734 3.66192 4.39566 4.99692 5.50668 5.87112 6.26175 6.61899 6.97425 7.30997 7.65684 8.02324 8.24833 8.50996 8.67107];
ar3=-714.556+[0.114342 -0.676088 -0.640511 -0.655587 -0.708722 -0.78682 -0.924366 -1.08437 -1.25427 -1.40305 -1.53763 -1.63522 -1.74205 -1.84478 -1.9596 -2.07408 -2.19913 -2.32358 -2.40581 -2.50494 -2.56818];
% 25651
as1=-9.36067+[-0.36511 0.381073 0.462605 0.476939 0.482947 0.487175 0.472856 0.453402 0.444476 0.41539 0.369147 0.33498 0.311616 0.288299 0.243213 0.201896 0.160932 0.131076 0.102585 0.0782163 0.0593975];
as2=443.677+[1.04913 0.328265 0.971514 1.79152 2.83614 3.91699 5.20681 6.38287 7.47129 8.46815 9.40163 10.1218 10.9636 11.7336 12.4808 13.1676 13.8814 14.6628 15.2131 15.8797 16.442];
as3=-706.563+[0.290135 -0.696224 -0.676645 -0.699242 -0.758084 -0.849197 -1.0189 -1.22534 -1.45041 -1.51741 -1.55084 -1.56997 -1.59111 -1.62941 -1.68883 -1.77583 -1.88317 -2.01148 -2.08332 -2.16509 -2.18115];
% 42160
at1=-14.6392+[-0.24874 0.142971 0.205786 0.221779 0.23292 0.24184 0.242473 0.241564 0.244652 0.250761 0.244095 0.238816 0.239099 0.239088 0.22429 0.212756 0.202109 0.207662 0.205128 0.201496 0.193446 ];
at2=448.856+[0.825379 -0.144218 0.221189 0.804357 1.5775 2.38823 3.36537 4.26195 5.09566 5.77654 6.35398 6.7662 7.20758 7.6105 8.01081 8.38874 8.77938 9.19092 9.44442 9.73938 9.92213];
at3=-710.316+[-0.0104733 -0.668906 -0.671177 -0.742899 -0.8719 -1.03267 -1.27439 -1.53409 -1.79891 -2.02696 -2.23192 -2.38054 -2.54295 -2.69718 -2.86529 -3.03096 -3.21038 -3.39118 -3.51017 -3.65313 -3.74546];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3 ];
% 20212
au1=-10.8616+[0.0660434 0.0830278 0.106193 0.127571 0.138948 0.161601 0.184484 0.20086 0.213257 0.223661 0.231812 0.239011 0.244651 0.246147 0.243307 0.237092 0.228294 0.215725 0.198974 0.179277 0.156799 ];
au2=446.379+[0.900609 0.843765 0.80305 0.793408 0.799861 0.839934 0.90717 1.00287 1.13503 1.30255 1.50193 1.73065 2.0107 2.24837 2.56021 2.89884 3.20742 3.58881 4.00285 4.40232 4.79544 ];
au3=-704.985+[-0.858817 -0.865198 -0.881299 -0.90176 -0.913624 -0.93965 -0.968087 -0.996625 -1.02854 -1.06548 -1.10564 -1.15106 -1.20831 -1.25209 -1.30561 -1.36642 -1.42612 -1.50691 -1.60159 -1.69915 -1.80107];
% 40296
av1=-12.2381+[-0.0560071 -0.0458864 -0.0252124 -0.00382041 0.00645417 0.0250647 0.0379438 0.0493683 0.062038 0.0742319 0.0862595 0.0963487 0.105131 0.112239 0.123057 0.132516 0.138094 0.141111 0.139409 0.13425 0.126056];
av2=446.122+[0.402313 0.323881 0.181638 0.0530163 -0.00665257 -0.103722 -0.17227 -0.209543 -0.22145 -0.206001 -0.162391 -0.0941139 0.00674306 0.10373 0.241897 0.401735 0.552931 0.744787 0.960366 1.17339 1.38719];
av3=-714.556+[-0.792025 -0.782412 -0.74451 -0.706222 -0.687887 -0.657914 -0.638054 -0.622818 -0.608043 -0.593716 -0.580328 -0.568545 -0.560054 -0.558858 -0.559528 -0.563678 -0.571192 -0.584682 -0.604588 -0.626662 -0.651503];
% 25651
aw1=-9.36067+[0.107468 0.125063 0.149132 0.171525 0.1835 0.207259 0.231551 0.249413 0.263529 0.275806 0.285842 0.294955 0.302767 0.305774 0.304626 0.299969 0.292495 0.281282 0.265552 0.246607 0.224869 ];
aw2=443.677+[0.85269 0.795058 0.744972 0.723644 0.723562 0.750227 0.8047 0.887811 1.00629 1.15937 1.34394 1.5574 1.8204 2.04384 2.33791 2.65868 2.9521 3.31604 3.71267 4.09678 4.47616];
aw3=-706.563+[-0.73196 -0.73629 -0.734215 -0.731791 -0.730502 -0.728808 -0.729271 -0.729256 -0.729059 -0.730925 -0.733932 -0.739704 -0.750727 -0.754936 -0.757044 -0.76333 -0.773947 -0.794757 -0.82542 -0.861911 -0.904093];
% 42160
ax1=-14.6392+[-0.0511071 -0.039161 -0.0155055 0.00874157 0.0203575 0.0412334 0.0551968 0.0672602 0.0805298 0.0931668 0.105556 0.115667 0.123923 0.130455 0.140371 0.148443 0.152378 0.153023 0.148368 0.140378 0.129298];
ax2=448.856+[0.478028 0.390527 0.23948 0.107071 0.0470118 -0.0481513 -0.113889 -0.145619 -0.148056 -0.118939 -0.0575603 0.0318847 0.159812 0.280186 0.449758 0.644033 0.826497 1.05671 1.31353 1.56539 1.81662];
ax3=-710.316+[-0.838366 -0.821674 -0.776235 -0.733863 -0.714495 -0.684409 -0.665661 -0.653591 -0.644611 -0.639023 -0.637266 -0.639719 -0.650041 -0.665452 -0.688817 -0.718538 -0.749916 -0.793442 -0.846558 -0.90057 -0.956906];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 20212
ay1=-10.8616+[-0.401788 -0.177881 -0.0103098 0.100898 0.198372 0.254215 0.286881 0.292975 0.287294 0.278911 0.25427 0.213947 0.165226 0.0939351 0.0279326 -0.0483347 -0.145249 -0.232248 -0.324199 -0.403809 -0.468723 ];
ay2=446.379+[1.12007 0.818804 0.819644 0.976243 1.29268 1.71344 2.3562 3.09467 3.82483 4.64654 5.54971 6.4116 7.22439 8.19115 8.97724 9.78317 10.7122 11.5072 12.3512 13.1957 13.9917];
ay3=-704.985+[0.122619 -0.974911 -0.973608 -0.980414 -1.01092 -1.06384 -1.16031 -1.28669 -1.42774 -1.60164 -1.70969 -1.81386 -1.93307 -2.08696 -2.23377 -2.40256 -2.6352 -2.86696 -3.13549 -3.42688 -3.6982 ];
% 40296
az1=-12.2381+[-0.211769 -0.21483 -0.0967389 -0.0186848 0.0477608 0.0884931 0.116684 0.130851 0.139047 0.143145 0.156639 0.160447 0.15574 0.133992 0.10445 0.0680413 0.01817 -0.0283249 -0.0772943 -0.109743 -0.133553];
az2=446.122+[0.66834 0.258211 0.0894408 0.0781614 0.164229 0.338903 0.664274 1.08276 1.52183 2.03299 2.54838 3.00137 3.42172 3.90006 4.28185 4.68658 5.18306 5.62004 6.08907 6.54984 6.95318];
az3=-714.556+[0.113813 -0.856448 -0.779729 -0.727382 -0.689844 -0.675273 -0.680364 -0.70531 -0.745968 -0.803185 -0.883833 -0.966805 -1.05662 -1.16615 -1.25866 -1.36282 -1.50009 -1.63092 -1.78295 -1.93512 -2.07586];
% 25651
ba1=-9.36067+[-0.365092 -0.143393 0.0283445 0.14351 0.246245 0.307392 0.346095 0.357533 0.355891 0.351501 0.330809 0.294084 0.247696 0.178314 0.113172 0.0368301 -0.0610818 -0.149108 -0.241795 -0.321551 -0.385991];
ba2=443.677+[1.04957 0.755267 0.744274 0.886343 1.18196 1.57972 2.19198 2.89971 3.60248 4.39631 5.26215 6.09084 6.87803 7.82175 8.59629 9.39731 10.3287 11.132 11.9914 12.8587 13.686];
ba3=-706.563+[0.28882 -0.826095 -0.798414 -0.77251 -0.753949 -0.750074 -0.767352 -0.808354 -0.867613 -0.95026 -0.922005 -0.879161 -0.856231 -0.831965 -0.830808 -0.851143 -0.921573 -1.01732 -1.14475 -1.29117 -1.414];
% 42160
bb1=-14.6392+[-0.248732 -0.223697 -0.0921935 -0.00667699 0.0647317 0.107437 0.135209 0.146865 0.151575 0.151007 0.159975 0.158751 0.14837 0.120016 0.0851111 0.0436448 -0.0118936 -0.0632626 -0.117998 -0.155188 -0.183131];
bb2=448.856+[0.825649 0.326842 0.152301 0.153543 0.265396 0.476363 0.860697 1.34881 1.85726 2.44624 3.03872 3.56066 4.04281 4.58897 5.02316 5.4819 6.04261 6.53489 7.06264 7.57972 8.03246 ];
bb3=-710.316+[-0.0110182 -0.905978 -0.817782 -0.769514 -0.74641 -0.755378 -0.801846 -0.878505 -0.973172 -1.09377 -1.23987 -1.38423 -1.53172 -1.70706 -1.8523 -2.01228 -2.21819 -2.41023 -2.63004 -2.84908 -3.05057];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3 ];
% 20212
bc1=-10.8616+[0.14562 0.167667 0.195298 0.214628 0.234714 0.242316 0.258719 0.266645 0.275055 0.280514 0.283289 0.28386 0.283708 0.278261 0.268827 0.256143 0.240619 0.222458 0.201284 0.176159 0.146564];
bc2=446.379+[1.07675 1.00947 0.975278 0.990899 1.04481 1.0851 1.23494 1.34006 1.51567 1.75622 2.02935 2.30799 2.60001 2.9849 3.32772 3.69262 4.10671 4.54644 4.99375 5.46589 5.93953];
bc3=-704.985+[-0.585003 -0.592923 -0.62175 -0.654132 -0.69575 -0.715192 -0.765801 -0.794331 -0.837037 -0.890731 -0.94837 -1.00707 -1.06876 -1.14204 -1.20592 -1.27778 -1.36567 -1.46678 -1.58099 -1.71241 -1.85342];
% 40296
bd1=-12.2381+[0.00596392 0.0211339 0.048779 0.0708216 0.0939399 0.102812 0.120356 0.127593 0.13638 0.143409 0.148383 0.150708 0.151714 0.155717 0.160032 0.161517 0.159826 0.154258 0.146989 0.138131 0.127962];
bd2=446.122+[0.498484 0.401878 0.251309 0.154623 0.06054 0.028248 -0.0166451 -0.0215068 -0.000949077 0.059823 0.151768 0.262308 0.38937 0.569823 0.738094 0.924601 1.14381 1.38599 1.6401 1.91464 2.19695];
bd3=-714.556+[-0.522187 -0.509308 -0.474682 -0.450252 -0.425188 -0.416286 -0.398906 -0.391041 -0.380749 -0.371421 -0.363504 -0.358906 -0.35665 -0.359975 -0.364635 -0.373446 -0.387628 -0.410655 -0.443517 -0.486803 -0.536921 ];
% 25651
be1=-9.36067+[0.185688 0.208349 0.2367 0.256758 0.278125 0.286435 0.305117 0.314526 0.325074 0.333065 0.338448 0.341487 0.343701 0.3411 0.334127 0.323874 0.310731 0.294643 0.275266 0.251768 0.223487];
be2=443.677+[1.01382 0.945133 0.900183 0.904776 0.944354 0.977854 1.1097 1.20473 1.36605 1.59003 1.8466 2.10998 2.38719 2.7529 3.07966 3.42874 3.82634 4.25016 4.68285 5.14104 5.60215 ];
be3=-706.563+[-0.430726 -0.435404 -0.443148 -0.453555 -0.465249 -0.469854 -0.479194 -0.483504 -0.490815 -0.501816 -0.514884 -0.530594 -0.548765 -0.563306 -0.574825 -0.591796 -0.618616 -0.656373 -0.707241 -0.772302 -0.84722 ];
% 42160
bf1=-14.6392+[0.0086072 0.0259035 0.0568412 0.081392 0.107057 0.116992 0.136469 0.144344 0.153754 0.161131 0.166195 0.16824 0.168767 0.172124 0.175606 0.175828 0.172348 0.164354 0.154279 0.142072 0.128448];
bf2=448.856+[0.623689 0.516475 0.355749 0.255916 0.161663 0.130664 0.0934587 0.095231 0.128765 0.209275 0.324886 0.460624 0.614806 0.831254 1.03174 1.25242 1.50983 1.79214 2.08623 2.40235 2.7261];
bf3=-710.316+[-0.603201 -0.581824 -0.538335 -0.510318 -0.483554 -0.474837 -0.461317 -0.457466 -0.455526 -0.4595 -0.467926 -0.481191 -0.498559 -0.528426 -0.557431 -0.59277 -0.637395 -0.693393 -0.76005 -0.839518 -0.926598];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ];
% 20212
bg1=-10.8616+[-0.290584 -0.193767 -0.0687673 0.0265831 0.0618078 0.122593 0.160462 0.196638 0.221125 0.231651 0.237282 0.232897 0.219227 0.19295 0.161635 0.118307 0.0685747 0.00325778 -0.0575245 -0.135139 -0.214805];
bg2=446.379+[1.36888 1.16525 1.12528 1.21029 1.28387 1.51271 1.7585 2.13373 2.65875 3.00324 3.63634 4.04158 4.58923 5.19664 5.77296 6.40999 7.04217 7.77663 8.39119 9.12923 9.82645 ];
bg3=-704.985+[-0.492421 -0.717847 -0.756638 -0.786894 -0.802019 -0.839927 -0.877711 -0.938019 -1.02719 -1.08866 -1.15201 -1.14811 -1.14628 -1.16202 -1.18981 -1.2409 -1.31059 -1.42173 -1.54076 -1.70582 -1.87595];
% 40296
bh1=-12.2381+[-0.262043 -0.218809 -0.122471 -0.0475311 -0.0200093 0.0263328 0.0536305 0.0806278 0.100937 0.107851 0.122687 0.134288 0.145025 0.148752 0.144689 0.133961 0.116473 0.0890298 0.0624201 0.0282351 -0.0114031];
bh2=446.122+[0.846901 0.534666 0.314417 0.227151 0.214389 0.23539 0.299304 0.438196 0.679803 0.854866 1.18124 1.36751 1.60338 1.86145 2.09934 2.35846 2.62053 2.95003 3.24951 3.62176 3.98939 ];
bh3=-714.556+[-0.447652 -0.61604 -0.564932 -0.520739 -0.504349 -0.476779 -0.460426 -0.445957 -0.440215 -0.441814 -0.459182 -0.467438 -0.481563 -0.507557 -0.540579 -0.584276 -0.635643 -0.70331 -0.77247 -0.869553 -0.971942];
% 25651
bi1=-9.36067+[-0.2566 -0.160992 -0.0346225 0.063297 0.100087 0.165035 0.20679 0.248055 0.278357 0.292254 0.303354 0.302367 0.292828 0.270487 0.242327 0.201678 0.153436 0.0889995 0.028123 -0.0508442 -0.133554];
bi2=443.677+[1.29559 1.08453 1.02948 1.09962 1.16576 1.37696 1.60722 1.96211 2.46264 2.79262 3.39574 3.77879 4.29779 4.8777 5.43183 6.04934 6.66761 7.39309 8.00511 8.74522 9.44859 ];
bi3=-706.563+[-0.323524 -0.536574 -0.545021 -0.542653 -0.540481 -0.534958 -0.532465 -0.537421 -0.556214 -0.573623 -0.541972 -0.461955 -0.350582 -0.243129 -0.150465 -0.0662167 -0.00225237 0.0342219 0.0314843 0.00426576 -0.0421511];
% 42160
bk1=-14.6392+[-0.294117 -0.236874 -0.129976 -0.0474863 -0.0172659 0.0335079 0.0631617 0.0919398 0.11276 0.119302 0.133491 0.144806 0.15479 0.156566 0.149801 0.135295 0.113789 0.0818333 0.0511997 0.0111807 -0.0339248 ];
bk2=448.856+[1.02023 0.672348 0.437707 0.35195 0.343232 0.379114 0.461186 0.630646 0.917587 1.12308 1.50257 1.71923 1.99456 2.29527 2.57175 2.8723 3.17498 3.55322 3.89516 4.31896 4.73636 ];
bk3=-710.316+[-0.582165 -0.71771 -0.650534 -0.6029 -0.587664 -0.567601 -0.562354 -0.568236 -0.594632 -0.618658 -0.676191 -0.707898 -0.753221 -0.814314 -0.880356 -0.960808 -1.04924 -1.16244 -1.27245 -1.42105 -1.57457];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
