%% foramen height and width narrowing/widening 
% for all models for the c3-c4 right hand side foramen 
% 4457,20101,9037,21922

% 5P!!



k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 4457,20101,9037,21922
%% model15_intact_TLC_5P
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 4457
aa1=-9.37506+[5.0731200e-01   1.2636400e+00   2.0869700e+00   2.8358400e+00   3.5670700e+00   4.2416000e+00   5.0070200e+00   5.8534000e+00   6.3607100e+00   6.9749000e+00   7.5030500e+00   8.0133500e+00   8.3161200e+00   8.6156700e+00   8.8993600e+00   9.1828800e+00   9.5294300e+00   9.7172800e+00   9.9690700e+00   1.0263300e+01   1.0424800e+01];
aa2=448.144+[1.0306900e+00   6.0548600e-02  -1.8690300e-01   3.2093200e-02   5.0665900e-01   1.0935600e+00   1.8723000e+00   2.7945200e+00   3.3647700e+00   4.0812400e+00   4.7137600e+00   5.3178400e+00   5.6518900e+00   5.9586000e+00   6.2272300e+00   6.4995000e+00   6.8463600e+00   7.0397000e+00   7.3042000e+00   7.6182900e+00   7.7905500e+00];
aa3=-689.149+[-6.7815900e-01  -3.8735100e-01  -1.6418600e-01  -2.3396500e-02   7.3231900e-02   1.3130900e-01   1.6718700e-01   1.7455900e-01   1.6495300e-01   1.3946900e-01   1.1211000e-01   9.6501400e-02   9.2946500e-02   9.4971400e-02   9.9062400e-02   1.0314900e-01   1.0579600e-01   1.0526600e-01   1.0365100e-01   9.9598700e-02   9.5726000e-02];

% 20101
ab1=-11.8681+[3.3679400e-01   8.7913100e-01   1.4789400e+00   2.0344400e+00   2.5817700e+00   3.0915700e+00   3.6743900e+00   4.3233000e+00   4.7154500e+00   5.1909000e+00   5.5975900e+00   5.9835000e+00   6.2135800e+00   6.4403600e+00   6.6550100e+00   6.8691400e+00   7.1314200e+00   7.2742700e+00   7.4654200e+00   7.6861700e+00   7.8069100e+00];
ab2=447.151+[5.9687600e-01  -2.3088800e-01  -4.8334300e-01  -3.5439900e-01  -1.2752100e-02   4.2590900e-01   1.0137200e+00   1.7161000e+00   2.1558300e+00   2.7108800e+00   3.2013900e+00   3.6652500e+00   3.9170500e+00   4.1516900e+00   4.3577400e+00   4.5662500e+00   4.8326800e+00   4.9817100e+00   5.1865600e+00   5.4315600e+00   5.5666100e+00];
ab3=-698.575+[-5.1114300e-01  -2.3520600e-01  -4.4205400e-03   1.6039700e-01   2.9277100e-01   3.9395500e-01   4.8897700e-01   5.6964800e-01   6.0787500e-01   6.4424400e-01   6.7295400e-01   7.1085500e-01   7.3791300e-01   7.6807100e-01   7.9844900e-01   8.2942500e-01   8.6667100e-01   8.8573500e-01   9.1032400e-01   9.3651600e-01   9.4970100e-01];

% 9037
ac1=-7.50723+[5.6194400e-01   1.3515900e+00   2.2130100e+00   2.9945800e+00   3.7542500e+00   4.4524300e+00   5.2436600e+00   6.1154800e+00   6.6360100e+00   7.2629500e+00   7.8010600e+00   8.3203200e+00   8.6283100e+00   8.9309200e+00   9.2164400e+00   9.5015600e+00   9.8499900e+00   1.0038800e+01   1.0291800e+01   1.0587200e+01   1.0749100e+01];
ac2=444.719+[1.0471600e+00   1.4270300e-01  -5.2354200e-02   2.0089300e-01   6.9986300e-01   1.3038800e+00   2.0987100e+00   3.0359200e+00   3.6139900e+00   4.3370800e+00   4.9747400e+00   5.5843500e+00   5.9227800e+00   6.2331800e+00   6.5054700e+00   6.7814200e+00   7.1327200e+00   7.3283400e+00   7.5958100e+00   7.9132700e+00   8.0872400e+00];
ac3=-690.512+[-6.4682200e-01  -4.6851200e-01  -3.1136100e-01  -2.0039200e-01  -1.1686000e-01  -6.2339200e-02  -2.4348600e-02  -1.2432500e-02  -1.9495900e-02  -4.0285700e-02  -6.3707800e-02  -7.7327200e-02  -8.2000400e-02  -8.2671700e-02  -8.2890500e-02  -8.3421200e-02  -8.6330800e-02  -8.9696100e-02  -9.5018100e-02  -1.0346500e-01  -1.0987100e-01];

% 21922
ad1=-12.9198+[3.2311600e-01   8.8136400e-01   1.4926800e+00   2.0561500e+00   2.6112300e+00   3.1283000e+00   3.7182900e+00   4.3758900e+00   4.7739900e+00   5.2596500e+00   5.6756800e+00   6.0717600e+00   6.3083200e+00   6.5430700e+00   6.7660300e+00   6.9884800e+00   7.2607900e+00   7.4090200e+00   7.6072500e+00   7.8359900e+00   7.9612500e+00];
ad2=450.785+[6.8449100e-01  -2.1837000e-01  -4.9772800e-01  -3.6326200e-01   6.8631600e-04   4.6859100e-01   1.0959900e+00   1.8455600e+00   2.3135500e+00   2.9052600e+00   3.4280000e+00   3.9236100e+00   4.1923500e+00   4.4421700e+00   4.6609200e+00   4.8820500e+00   5.1644000e+00   5.3222800e+00   5.5393100e+00   5.7987900e+00   5.9417000e+00];
ad3=-694.998+[-6.0699400e-01  -2.4740900e-01   1.4322900e-02   1.7604600e-01   2.8814000e-01   3.6141300e-01   4.1706500e-01   4.4964100e-01   4.5861400e-01   4.5700600e-01   4.5172900e-01   4.5574500e-01   4.6478500e-01   4.7922400e-01   4.9681700e-01   5.1497700e-01   5.3576500e-01   5.4551800e-01   5.5712200e-01   5.6759700e-01   5.7223100e-01];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5P
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 4457
ae1=-9.37506+[-3.0640500e-01   7.6114400e-02   6.1802000e-01   1.2859500e+00   2.0153200e+00   2.9448600e+00   3.6375600e+00   4.3027500e+00   5.0129900e+00   5.7298100e+00   6.4407600e+00   7.0609400e+00   7.6981900e+00   8.4095100e+00   8.8773100e+00   9.3274300e+00   9.7777700e+00   1.0109700e+01   1.0444700e+01   1.0717200e+01   1.0982500e+01];
ae2=448.144+[2.1859200e+00   1.8088800e+00   1.3956800e+00   9.7950300e-01   6.2792700e-01   3.4106600e-01   2.3339100e-01   2.1562000e-01   3.0509000e-01   5.1645800e-01   8.5402700e-01   1.2554200e+00   1.7770300e+00   2.4842300e+00   3.0279400e+00   3.6295100e+00   4.3089900e+00   4.8638500e+00   5.4551700e+00   5.9430500e+00   6.4214200e+00];
ae3=-689.149+[-1.1481100e+00  -1.2347800e+00  -9.8284700e-01  -7.0751200e-01  -4.7297100e-01  -2.5108400e-01  -1.2120800e-01  -1.7699100e-02   7.1647200e-02   1.4181900e-01   1.9224300e-01   2.1747000e-01   2.2698500e-01   2.1535200e-01   1.9677300e-01   1.7478400e-01   1.4785200e-01   1.2266700e-01   9.0868100e-02   6.0111900e-02   2.7075100e-02];

% 20101
af1=-11.8681+[-3.2046100e-01  -7.5944600e-02   2.8191500e-01   7.4103100e-01   1.2637300e+00   1.9544200e+00   2.4800200e+00   2.9920800e+00   3.5434300e+00   4.1038300e+00   4.6628100e+00   5.1518500e+00   5.6604400e+00   6.2282900e+00   6.6012200e+00   6.9601700e+00   7.3199800e+00   7.5836900e+00   7.8475100e+00   8.0619400e+00   8.2715800e+00];
af2=447.151+[1.5394400e+00   1.1578900e+00   7.7560000e-01   3.9097200e-01   5.5011500e-02  -2.4081700e-01  -3.7367400e-01  -4.3002700e-01  -4.0062800e-01  -2.7226400e-01  -3.8266300e-02   2.5415400e-01   6.4372800e-01   1.1796700e+00   1.5952300e+00   2.0590400e+00   2.5845600e+00   3.0170900e+00   3.4806100e+00   3.8625900e+00   4.2365700e+00];
af3=-698.575+[-8.3785300e-01  -9.1104900e-01  -6.6989700e-01  -3.9710400e-01  -1.5805900e-01   7.9333400e-02   2.2678800e-01   3.5181600e-01   4.7028700e-01   5.7668400e-01   6.6960500e-01   7.3907700e-01   8.0023400e-01   8.5666900e-01   8.8965800e-01   9.2087600e-01   9.5174200e-01   9.7202200e-01   9.8923400e-01   1.0000800e+00   1.0086200e+00];

% 9037
ag1=-7.50723+[-2.5743400e-01   1.4857700e-01   7.2511600e-01   1.4302800e+00   2.1942700e+00   3.1596200e+00   3.8746200e+00   4.5589800e+00   5.2875600e+00   6.0216000e+00   6.7481500e+00   7.3804300e+00   8.0294200e+00   8.7519900e+00   9.2269600e+00   9.6831000e+00   1.0138900e+01   1.0474400e+01   1.0812200e+01   1.1087000e+01   1.1354900e+01];
ag2=444.719+[2.1685800e+00   1.8213300e+00   1.4545800e+00   1.0925800e+00   7.9408800e-01   5.6522400e-01   4.9537900e-01   5.1059300e-01   6.3154900e-01   8.7094900e-01   1.2320900e+00   1.6501100e+00   2.1850700e+00   2.9015000e+00   3.4486300e+00   4.0498900e+00   4.7261500e+00   5.2771200e+00   5.8632700e+00   6.3470700e+00   6.8220700e+00];
ag3=-690.512+[-1.0346900e+00  -1.1655900e+00  -9.8056600e-01  -7.8089500e-01  -6.1653900e-01  -4.6748700e-01  -3.8313300e-01  -3.1766600e-01  -2.6288800e-01  -2.2108100e-01  -1.9219900e-01  -1.8026500e-01  -1.7850900e-01  -1.9122000e-01  -2.0615600e-01  -2.1954600e-01  -2.3341000e-01  -2.4677200e-01  -2.6538600e-01  -2.8538100e-01  -3.0843900e-01];

% 21922
ah1=-12.9198+[-3.6086200e-01  -1.0437000e-01   2.6125300e-01   7.2781700e-01   1.2568500e+00   1.9566000e+00   2.4896100e+00   3.0087300e+00   3.5684000e+00   4.1368800e+00   4.7042200e+00   5.2012700e+00   5.7178500e+00   6.2954900e+00   6.6744600e+00   7.0396700e+00   7.4061400e+00   7.6753100e+00   7.9455300e+00   8.1648700e+00   8.3787200e+00];
ah2=450.785+[1.7083600e+00   1.3119300e+00   8.9670500e-01   4.7290900e-01   1.0173200e-01  -2.2603300e-01  -3.7526500e-01  -4.4224400e-01  -4.1774000e-01  -2.8707600e-01  -4.2538400e-02   2.6633400e-01   6.7921300e-01   1.2500400e+00   1.6937000e+00   2.1903100e+00   2.7538600e+00   3.2174700e+00   3.7141300e+00   4.1229800e+00   4.5227200e+00];
ah3=-694.998+[-1.0313900e+00  -1.0844700e+00  -8.0445300e-01  -4.8689200e-01  -2.0852500e-01   6.4800200e-02   2.3125500e-01   3.6919600e-01   4.9510000e-01   6.0160600e-01   6.8638900e-01   7.4152800e-01   7.8115500e-01   8.0413500e-01   8.0911200e-01   8.0684100e-01   7.9788500e-01   7.8493900e-01   7.6617000e-01   7.4721000e-01   7.2655500e-01];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5P
t2=[2 2.05126 2.1153 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 4457
ai1=-9.37506+[-1.7017400e-01  -2.5947900e-02   3.0596800e-01   7.1418500e-01   9.4563500e-01   1.3915300e+00   2.1663300e+00   2.4147600e+00   2.9303900e+00   3.6914500e+00   4.1664000e+00   4.6777900e+00   5.3646200e+00   5.9882800e+00   6.6164400e+00   7.2368800e+00   7.7830000e+00   8.3362600e+00   8.8216800e+00   9.3209100e+00   9.8129300e+00];
ai2=448.144+[2.5984000e+00   2.4073000e+00   2.1176000e+00   1.8241700e+00   1.6767400e+00   1.4329000e+00   1.1194200e+00   1.0388300e+00   9.0138000e-01   7.6919300e-01   7.2097000e-01   7.0317000e-01   7.3730300e-01   8.2385800e-01   9.7180300e-01   1.1935800e+00   1.4527600e+00   1.7516800e+00   2.0623300e+00   2.4324400e+00   2.8517300e+00];
ai3=-689.149+[-1.3210800e+00  -1.3313100e+00  -1.1322100e+00  -9.0353400e-01  -7.8614200e-01  -5.9185200e-01  -3.3236000e-01  -2.6342000e-01  -1.3894600e-01   1.1298300e-02   9.1737800e-02   1.6754700e-01   2.5203800e-01   3.1308200e-01   3.6106500e-01   3.9377800e-01   4.1173700e-01   4.2214600e-01   4.2720000e-01   4.2834900e-01   4.2420700e-01];

% 20101
aj1=-11.8681+[-2.1616900e-01  -1.3208400e-01   5.7672200e-02   3.0287500e-01   4.4714000e-01   7.3576400e-01   1.2755300e+00   1.4547600e+00   1.8358100e+00   2.4117100e+00   2.7781700e+00   3.1753800e+00   3.7113200e+00   4.2012200e+00   4.6988400e+00   5.1928000e+00   5.6300600e+00   6.0756700e+00   6.4692500e+00   6.8732800e+00   7.2705200e+00];
aj2=447.151+[1.8236600e+00   1.6598600e+00   1.4038200e+00   1.1373000e+00   1.0008600e+00   7.7035700e-01   4.5654700e-01   3.7119000e-01   2.1582800e-01   4.5300200e-02  -3.1811700e-02  -8.4626900e-02  -1.0605300e-01  -7.9172300e-02  -3.4088100e-04   1.4248900e-01   3.2212500e-01   5.3500400e-01   7.6464900e-01   1.0434300e+00   1.3628300e+00];
aj3=-698.575+[-9.6580700e-01  -9.9494600e-01  -8.2971700e-01  -6.2308600e-01  -5.1377200e-01  -3.2743100e-01  -7.1308100e-02  -9.9797200e-04   1.3057300e-01   2.9887700e-01   3.9375100e-01   4.8750800e-01   6.0098900e-01   6.9327600e-01   7.7714300e-01   8.5049200e-01   9.0890900e-01   9.6328600e-01   1.0092000e+00   1.0565600e+00   1.1025900e+00];

% 9037
ak1=-7.50723+[-1.1656300e-01   3.7332500e-02   3.9575500e-01   8.3386000e-01   1.0809100e+00   1.5536700e+00   2.3667700e+00   2.6257800e+00   3.1614500e+00   3.9478700e+00   4.4368900e+00   4.9621300e+00   5.6656600e+00   6.3029000e+00   6.9427500e+00   7.5723000e+00   8.1250200e+00   8.6839100e+00   9.1727400e+00   9.6742700e+00   1.0167800e+01];
ak2=444.719+[2.5710800e+00   2.3960200e+00   2.1411900e+00   1.8879800e+00   1.7622200e+00   1.5569100e+00   1.3005500e+00   1.2364700e+00   1.1309800e+00   1.0412700e+00   1.0179800e+00   1.0257400e+00   1.0920900e+00   1.2058100e+00   1.3784000e+00   1.6208800e+00   1.8956700e+00   2.2088100e+00   2.5293600e+00   2.9070700e+00   3.3315500e+00];
ak3=-690.512+[-1.1726200e+00  -1.2120200e+00  -1.0653700e+00  -8.9407900e-01  -8.0667100e-01  -6.6410700e-01  -4.7746700e-01  -4.2900900e-01  -3.4331700e-01  -2.4342500e-01  -1.9217200e-01  -1.4598500e-01  -9.8302800e-02  -6.7677100e-02  -4.7094500e-02  -3.7538400e-02  -3.6886900e-02  -4.2362500e-02  -4.8728000e-02  -5.6476300e-02  -6.6516000e-02];

% 21922
al1=-12.9198+[-2.5352100e-01  -1.6190200e-01   3.5652400e-02   2.8708800e-01   4.3399400e-01   7.2667700e-01   1.2725900e+00   1.4537600e+00   1.8390400e+00   2.4214300e+00   2.7923300e+00   3.1946600e+00   3.7379700e+00   4.2348100e+00   4.7403600e+00   5.2437900e+00   5.6902300e+00   6.1455900e+00   6.5489900e+00   6.9640300e+00   7.3724100e+00];
al2=450.785+[2.0291800e+00   1.8554600e+00   1.5787700e+00   1.2867100e+00   1.1365400e+00   8.8210900e-01   5.3705300e-01   4.4326400e-01   2.7227200e-01   8.3679500e-02  -3.0075200e-03  -6.4260400e-02  -9.3965100e-02  -7.1486000e-02   6.4822600e-03   1.5338400e-01   3.4058300e-01   5.6311300e-01   8.0439600e-01   1.0987900e+00   1.4371900e+00];
al3=-694.998+[-1.2003100e+00  -1.2156400e+00  -1.0243700e+00  -7.8705400e-01  -6.6165100e-01  -4.4778100e-01  -1.5606200e-01  -7.6190800e-02   7.3192100e-02   2.6238200e-01   3.6856000e-01   4.7259200e-01   5.9681800e-01   6.9570300e-01   7.8282900e-01   8.5484200e-01   9.0823000e-01   9.5553100e-01   9.9224500e-01   1.0264800e+00   1.0557100e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 4457
am1=-9.37506+[3.5697400e-01   4.0354900e-01   5.4114300e-01   7.2446500e-01   8.2187400e-01   1.0745200e+00   1.2910600e+00   1.5478100e+00   1.8793400e+00   2.1774400e+00   2.5925900e+00   2.8901600e+00   3.2405700e+00   3.6515100e+00   4.0470300e+00   4.5365800e+00   4.9403600e+00   5.4030500e+00   6.0209300e+00   6.2364000e+00   6.6863000e+00];
am2=448.144+[1.9618200e+00   1.8896100e+00   1.7565100e+00   1.6091600e+00   1.5378300e+00   1.3694800e+00   1.2413100e+00   1.1042400e+00   9.5381000e-01   8.4349500e-01   7.2209500e-01   6.5483800e-01   5.8998900e-01   5.3337800e-01   4.9850800e-01   4.7920500e-01   4.8159400e-01   5.0813100e-01   5.8088500e-01   6.1420500e-01   7.0160900e-01];
am3=-689.149+[-1.2861900e+00  -1.2356900e+00  -1.1035400e+00  -9.5384300e-01  -8.8134200e-01  -7.1264300e-01  -5.8623500e-01  -4.5341000e-01  -3.0603600e-01  -1.9418800e-01  -6.3726300e-02   1.6473800e-02   1.0203400e-01   1.9095300e-01   2.6602100e-01   3.4671900e-01   4.0540800e-01   4.6376800e-01   5.2776400e-01   5.4700800e-01   5.8165300e-01];
% 20101
an1=-11.8681+[1.9195900e-01   2.1914600e-01   2.8622800e-01   3.7653500e-01   4.2590800e-01   5.5804100e-01   6.7670500e-01   8.2716000e-01   1.0326600e+00   1.2287600e+00   1.5152400e+00   1.7267900e+00   1.9809600e+00   2.2853000e+00   2.5827800e+00   2.9563100e+00   3.2688200e+00   3.6315400e+00   4.1202700e+00   4.2911200e+00   4.6483100e+00];
an2=447.151+[1.2337100e+00   1.1880900e+00   1.0953600e+00   9.8018400e-01   9.2102200e-01   7.7496500e-01   6.5810700e-01   5.2944400e-01   3.7986500e-01   2.6112600e-01   1.1878000e-01   3.2870100e-02  -5.7103300e-02  -1.4695500e-01  -2.1706500e-01  -2.8300900e-01  -3.2112300e-01  -3.4275400e-01  -3.3661700e-01  -3.2679100e-01  -2.8934900e-01];
an3=-698.575+[-8.9701400e-01  -8.7852400e-01  -7.9487300e-01  -6.8258300e-01  -6.2433200e-01  -4.8222400e-01  -3.7097600e-01  -2.5285200e-01  -1.1867000e-01  -1.3782800e-02   1.1338900e-01   1.9425700e-01   2.8259400e-01   3.7813700e-01   4.6287900e-01   5.5975900e-01   6.3364600e-01   7.1156700e-01   8.0582000e-01   8.3671500e-01   8.9751400e-01];
% 9037
ao1=-7.50723+[4.2968700e-01   4.7839800e-01   6.2647000e-01   8.2427800e-01   9.2935200e-01   1.2013400e+00   1.4335800e+00   1.7083300e+00   2.0609400e+00   2.3760000e+00   2.8119700e+00   3.1229200e+00   3.4878800e+00   3.9142700e+00   4.3232400e+00   4.8278900e+00   5.2428900e+00   5.7168600e+00   6.3475000e+00   6.5668800e+00   7.0239400e+00];
ao2=444.719+[1.9664300e+00   1.9012400e+00   1.7863800e+00   1.6614700e+00   1.6016200e+00   1.4617600e+00   1.3565500e+00   1.2455500e+00   1.1259500e+00   1.0404900e+00   9.5010100e-01   9.0302300e-01   8.6068800e-01   8.2886200e-01   8.1639300e-01   8.2335300e-01   8.4624800e-01   8.9481700e-01   9.9484600e-01   1.0372300e+00   1.1426600e+00];
ao3=-690.512+[-1.1964600e+00  -1.1607300e+00  -1.0596900e+00  -9.4479300e-01  -8.8927300e-01  -7.6079300e-01  -6.6526700e-01  -5.6592600e-01  -4.5662100e-01  -3.7416200e-01  -2.7917500e-01  -2.2140100e-01  -1.6053500e-01  -9.8583600e-02  -4.7712200e-02   4.7535700e-03   4.1408800e-02   7.5800400e-02   1.0960100e-01   1.1862900e-01   1.3257200e-01];
% 21922
ap1=-12.9198+[1.6308400e-01   1.9509700e-01   2.7029000e-01   3.6772800e-01   4.2003200e-01   5.5762300e-01   6.7952700e-01   8.3239900e-01   1.0401600e+00   1.2380400e+00   1.5267100e+00   1.7397200e+00   1.9957800e+00   2.3026500e+00   2.6027800e+00   2.9797500e+00   3.2953500e+00   3.6622100e+00   4.1575300e+00   4.3309600e+00   4.6940500e+00];
ap2=450.785+[1.3985100e+00   1.3492400e+00   1.2476400e+00   1.1204000e+00   1.0547600e+00   8.9276000e-01   7.6302200e-01   6.2042200e-01   4.5526600e-01   3.2481200e-01   1.6946800e-01   7.6137000e-02  -2.1631800e-02  -1.1954800e-01  -1.9647600e-01  -2.6970200e-01  -3.1287300e-01  -3.3914400e-01  -3.3730700e-01  -3.2860800e-01  -2.9264200e-01];
ap3=-694.998+[-1.0828400e+00  -1.0585900e+00  -9.6232300e-01  -8.3429800e-01  -7.6793900e-01  -6.0657600e-01  -4.8031100e-01  -3.4640300e-01  -1.9491400e-01  -7.7102100e-02   6.4395400e-02   1.5346700e-01   2.5050500e-01   3.5518300e-01   4.4776400e-01   5.5317900e-01   6.3320000e-01   7.1712700e-01   8.1774800e-01   8.5055700e-01   9.1459500e-01];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5P
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 4457
aq1=-9.37506+[-4.4029300e-01   1.5038000e+00   2.4737900e+00   3.4355500e+00   4.0722500e+00   5.0420900e+00   5.7534000e+00   6.4910000e+00   7.1241200e+00   7.7879400e+00   8.3093800e+00   8.5844900e+00   8.9232600e+00   9.2640300e+00   9.5384400e+00   9.8944600e+00   1.0073100e+01   1.0367000e+01   1.0642500e+01   1.0867000e+01   1.1097900e+01];
aq2=448.144+[2.2729300e+00   1.4617100e-01  -3.4712600e-01  -2.4445700e-01   1.1271500e-01   9.4900500e-01   1.6895800e+00   2.5083900e+00   3.2491300e+00   4.0918600e+00   4.7822000e+00   5.1306100e+00   5.5400500e+00   5.9284400e+00   6.2418600e+00   6.6631700e+00   6.8818100e+00   7.2416600e+00   7.5811200e+00   7.8668800e+00   8.1650800e+00];
aq3=689.149+[-1.2343600e-01  -7.6400400e-01  -4.8497900e-01  -2.9480400e-01  -2.0689200e-01  -1.2174000e-01  -9.3645300e-02  -9.1832100e-02  -1.1122900e-01  -1.4600400e-01  -1.7371700e-01  -1.8297700e-01  -1.8568500e-01  -1.8747800e-01  -1.9022000e-01  -1.9649100e-01  -2.0169700e-01  -2.1269300e-01  -2.2650600e-01  -2.4178300e-01  -2.6115000e-01];
% 20101
ar1=-11.8681+[-4.2105700e-01   1.0157000e+00   1.7324000e+00   2.4533700e+00   2.9375200e+00   3.6844600e+00   4.2391600e+00   4.8155400e+00   5.3133600e+00   5.8335200e+00   6.2361100e+00   6.4460600e+00   6.7071900e+00   6.9682800e+00   7.1777600e+00   7.4493700e+00   7.5877100e+00   7.8145500e+00   8.0274400e+00   8.2017300e+00   8.3820300e+00];
ar2=447.151+[1.4900500e+00  -3.0984600e-01  -7.6290300e-01  -7.3565300e-01  -4.8373300e-01   1.4338100e-01   7.0891100e-01   1.3355000e+00   1.9019400e+00   2.5489100e+00   3.0767000e+00   3.3402700e+00   3.6495400e+00   3.9419100e+00   4.1785100e+00   4.4977200e+00   4.6635000e+00   4.9386100e+00   5.1990000e+00   5.4183200e+00   5.6476800e+00];
ar3=-698.575+[6.5302800e-02  -4.0004200e-01  -1.0770400e-01   1.1061600e-01   2.2824900e-01   3.7336000e-01   4.5675300e-01   5.2432800e-01   5.6816400e-01   6.0432100e-01   6.3342000e-01   6.5257800e-01   6.8099500e-01   7.1120300e-01   7.3550100e-01   7.6678300e-01   7.8136900e-01   8.0405400e-01   8.2335500e-01   8.3683700e-01   8.4807700e-01];
% 9037
as1=-7.50723+[-3.8446300e-01   1.6299300e+00   2.6424000e+00   3.6413000e+00   4.3009000e+00   5.3032500e+00   6.0356000e+00   6.7936100e+00   7.4431800e+00   8.1226500e+00   8.6572300e+00   8.9391100e+00   9.2845900e+00   9.6313300e+00   9.9100900e+00   1.0271100e+01   1.0451900e+01   1.0748400e+01   1.1026200e+01   1.1252600e+01   1.1485200e+01];
as2=444.719+[2.2354400e+00   2.6408800e-01  -1.5916400e-01  -7.4485800e-03   3.7240800e-01   1.2335700e+00   1.9869700e+00   2.8171100e+00   3.5661000e+00   4.4151100e+00   5.1109100e+00   5.4629200e+00   5.8763200e+00   6.2691900e+00   6.5860300e+00   7.0112800e+00   7.2314800e+00   7.5934700e+00   7.9348000e+00   8.2219300e+00   8.5213700e+00];
as3=-690.512+[5.8991400e-02  -8.7458000e-01  -6.8942700e-01  -5.4964100e-01  -4.7625700e-01  -3.9643900e-01  -3.6490400e-01  -3.5723400e-01  -3.6989600e-01  -3.9487900e-01  -4.1447700e-01  -4.2091300e-01  -4.2135300e-01  -4.2281200e-01  -4.2552700e-01  -4.3163500e-01  -4.3650800e-01  -4.4720400e-01  -4.6078800e-01  -4.7551400e-01  -4.9418500e-01];
% 21922
at1=-12.9198+[-4.7550300e-01   1.0067500e+00   1.7332900e+00   2.4638500e+00   2.9538100e+00   3.7078500e+00   4.2680100e+00   4.8502400e+00   5.3531100e+00   5.8797900e+00   6.2861100e+00   6.4981000e+00   6.7634300e+00   7.0290300e+00   7.2422400e+00   7.5190600e+00   7.6605300e+00   7.8931900e+00   8.1114900e+00   8.2899000e+00   8.4742700e+00];
at2=450.785+[1.6833300e+00  -2.8876800e-01  -7.9452400e-01  -7.7397800e-01  -5.0617400e-01   1.6259000e-01   7.6635300e-01   1.4352300e+00   2.0400100e+00   2.7315500e+00   3.2965100e+00   3.5789500e+00   3.9100800e+00   4.2226700e+00   4.4754100e+00   4.8159900e+00   4.9926900e+00   5.2854400e+00   5.5622200e+00   5.7952800e+00   6.0390000e+00];
at3=-694.998+[-1.5938200e-01  -4.2497900e-01  -7.5960600e-02   1.5207500e-01   2.5565700e-01   3.6074300e-01   4.0619900e-01   4.3074100e-01   4.3457200e-01   4.2329300e-01   4.1137900e-01   4.0944200e-01   4.1371100e-01   4.2148200e-01   4.2772000e-01   4.3486000e-01   4.3708700e-01   4.3980700e-01   4.4034400e-01   4.3782400e-01   4.3211600e-01];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5P
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 4457
au1=-9.37506+[3.3988300e-01   3.8432200e-01   5.1713900e-01   6.9445500e-01   7.8881800e-01   1.0342500e+00   1.2449200e+00   1.4953800e+00   1.8082300e+00   2.0996900e+00   2.5160400e+00   2.8406100e+00   3.2974500e+00   3.6533400e+00   3.9592700e+00   4.5397400e+00   4.9479200e+00   5.2976600e+00   5.8112400e+00   6.1285500e+00   6.5499800e+00];
au2=448.144+[1.9866000e+00   1.9165700e+00   1.7866300e+00   1.6425900e+00   1.5728400e+00   1.4079200e+00   1.2822700e+00   1.1474200e+00   1.0035100e+00   8.9307800e-01   7.6731300e-01   6.9205700e-01   6.0934700e-01   5.6255400e-01   5.3538000e-01   5.1217100e-01   5.1767600e-01   5.3640400e-01   5.8816500e-01   6.3303800e-01   7.1014200e-01];
au3=-689.149+[-1.2875100e+00  -1.2374800e+00  -1.1070800e+00  -9.5994100e-01  -8.8866000e-01  -7.2216700e-01  -5.9715400e-01  -4.6487000e-01  -3.2241200e-01  -2.0972100e-01  -7.4177700e-02   1.5689400e-02   1.2774800e-01   2.0466100e-01   2.6369800e-01   3.6112500e-01   4.2027500e-01   4.6551800e-01   5.2237700e-01   5.5243700e-01   5.8658700e-01];
% 20101
av1=-11.8681+[1.6997400e-01   1.9493200e-01   2.5831900e-01   3.4457200e-01   3.9200100e-01   5.1937300e-01   6.3404800e-01   7.7976900e-01   9.7228300e-01   1.1626300e+00   1.4479700e+00   1.6777300e+00   2.0093000e+00   2.2735000e+00   2.5032300e+00   2.9459400e+00   3.2621800e+00   3.5361300e+00   3.9414400e+00   4.1925800e+00   4.5267300e+00];
av2=447.151+[1.2432900e+00   1.1992400e+00   1.1097900e+00   9.9877600e-01   9.4169500e-01   8.0057400e-01   6.8735200e-01   5.6210600e-01   4.2039400e-01   3.0281500e-01   1.5767000e-01   6.2876500e-02  -5.2507400e-02  -1.2822300e-01  -1.8240400e-01  -2.6059200e-01  -2.9603500e-01  -3.1359400e-01  -3.1639700e-01  -3.0561700e-01  -2.7463400e-01];
av3=-698.575+[-8.9375500e-01  -8.7532900e-01  -7.9396300e-01  -6.8528000e-01  -6.2871000e-01  -4.8964700e-01  -3.8042900e-01  -2.6325200e-01  -1.3395800e-01  -2.8845000e-02   1.0245600e-01   1.9261900e-01   3.0842500e-01   3.9139900e-01   4.5785600e-01   5.7427800e-01   6.4903800e-01   7.0893400e-01   7.9011100e-01   8.3698000e-01   8.9524000e-01];
% 9037
aw1=-7.50723+[4.1513500e-01   4.6148500e-01   6.0418700e-01   7.9528200e-01   8.9695100e-01   1.1608700e+00   1.3866800e+00   1.6545600e+00   1.9873900e+00   2.2956800e+00   2.7332100e+00   3.0725200e+00   3.5481800e+00   3.9172600e+00   4.2336000e+00   4.8319200e+00   5.2512000e+00   5.6094700e+00   6.1340300e+00   6.4572100e+00   6.8854500e+00];
aw2=444.719+[1.9912800e+00   1.9280500e+00   1.8158300e+00   1.6936000e+00   1.6350200e+00   1.4978400e+00   1.3946000e+00   1.2853000e+00   1.1707600e+00   1.0850100e+00   9.9091700e-01   9.3797300e-01   8.8462800e-01   8.5925600e-01   8.4950900e-01   8.5754300e-01   8.8360800e-01   9.1908300e-01   9.9399400e-01   1.0523900e+00   1.1465700e+00];
aw3=-690.512+[-1.1941100e+00  -1.1586200e+00  -1.0589700e+00  -9.4617100e-01  -8.9166000e-01  -7.6502300e-01  -6.7057300e-01  -5.7158100e-01  -4.6578500e-01  -3.8253300e-01  -2.8361200e-01  -2.1873700e-01  -1.3906500e-01  -8.5561400e-02  -4.5447400e-02   1.8194000e-02   5.5100400e-02   8.2038200e-02   1.1324600e-01   1.2800700e-01   1.4247800e-01];
% 21922
ax1=-12.9198+[1.3890300e-01   1.6886700e-01   2.4082200e-01   3.3457000e-01   3.8512300e-01   5.1840100e-01   6.3654800e-01   7.8495500e-01   9.7975200e-01   1.1718800e+00   1.4594800e+00   1.6908400e+00   2.0249700e+00   2.2914200e+00   2.5232400e+00   2.9701600e+00   3.2896800e+00   3.5667700e+00   3.9774200e+00   4.2323400e+00   4.5720300e+00];
ax2=450.785+[1.4125100e+00   1.3650100e+00   1.2668900e+00   1.1440500e+00   1.0805700e+00   9.2364600e-01   7.9777200e-01   6.5870500e-01   5.0199800e-01   3.7260300e-01   2.1377900e-01   1.1058200e-01  -1.5187900e-02  -9.7997200e-02  -1.5758900e-01  -2.4455000e-01  -2.8500000e-01  -3.0618600e-01  -3.1308900e-01  -3.0418800e-01  -2.7486300e-01];
ax3=-694.998+[-1.0848600e+00  -1.0608200e+00  -9.6695000e-01  -8.4268200e-01  -7.7803300e-01  -6.1970000e-01  -4.9559300e-01  -3.6260800e-01  -2.1652500e-01  -9.8318900e-02   4.8112500e-02   1.4758300e-01   2.7501200e-01   3.6603300e-01   4.3871600e-01   5.6545800e-01   6.4636500e-01   7.1093700e-01   7.9791100e-01   8.4781800e-01   9.0939500e-01];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5P
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 4457
ay1=-9.37506+[-4.4025400e-01   7.6310600e-01   1.5520500e+00   2.5164500e+00   3.2301200e+00   4.0816300e+00   4.8059900e+00   5.5387900e+00   6.2804000e+00   6.9599200e+00   7.6845700e+00   8.2749700e+00   8.7170900e+00   9.1586300e+00   9.4452300e+00   9.8103200e+00   1.0028400e+01   1.0317500e+01   1.0570500e+01   1.0828500e+01   1.1071600e+01];
ay2=448.144+[2.2728400e+00   1.0818300e+00   5.6337500e-01   1.2321900e-01  -2.2469300e-02   3.7045300e-02   2.8798900e-01   7.2440700e-01   1.3305500e+00   2.0129300e+00   2.8509200e+00   3.6307200e+00   4.2886200e+00   5.0013200e+00   5.4448500e+00   5.9823900e+00   6.3027500e+00   6.7129700e+00   7.0565400e+00   7.4040500e+00   7.7371500e+00];
ay3=-689.149+[-1.2469200e-01  -9.7573500e-01  -6.9364200e-01  -4.2628500e-01  -2.7590900e-01  -1.3531000e-01  -4.3686500e-02   2.1888600e-02   5.9672300e-02   6.6618000e-02   4.6654500e-02   1.0997400e-02  -2.3014500e-02  -5.9282200e-02  -8.0885300e-02  -1.0362400e-01  -1.1683200e-01  -1.3533500e-01  -1.5225200e-01  -1.7145000e-01  -1.9248000e-01];
% 20101
az1=-11.8681+[-4.2103300e-01   4.2013700e-01   9.9016100e-01   1.7051900e+00   2.2425200e+00   2.8900500e+00   3.4462800e+00   4.0147400e+00   4.5946800e+00   5.1309100e+00   5.7041800e+00   6.1721800e+00   6.5234100e+00   6.8718400e+00   7.0958200e+00   7.3789400e+00   7.5492500e+00   7.7743600e+00   7.9711500e+00   8.1722900e+00   8.3626900e+00];
az2=447.151+[1.4902400e+00   4.9195800e-01   2.0078200e-02  -3.9417200e-01  -5.5603900e-01  -5.5753000e-01  -3.9265500e-01  -7.7114300e-02   3.7715600e-01   8.9330800e-01   1.5353100e+00   2.1388700e+00   2.6433500e+00   3.1929000e+00   3.5350200e+00   3.9485000e+00   4.1936100e+00   4.5072900e+00   4.7705900e+00   5.0372700e+00   5.2942100e+00];
az3=-698.575+[6.4117900e-02  -6.3727100e-01  -3.4822400e-01  -6.7685700e-02   9.9850900e-02   2.6797400e-01   3.9088500e-01   4.9819400e-01   5.8922600e-01   6.5472000e-01   7.0664100e-01   7.3659700e-01   7.5718000e-01   7.7563200e-01   7.8907400e-01   8.1069500e-01   8.2442300e-01   8.4191400e-01   8.5682700e-01   8.7136500e-01   8.8334100e-01];
% 9037
ba1=-7.50723+[-3.8442200e-01   8.7056400e-01   1.6967400e+00   2.7014300e+00   3.4404200e+00   4.3192400e+00   5.0648100e+00   5.8178900e+00   6.5780800e+00   7.2738500e+00   8.0148300e+00   8.6170900e+00   9.0694100e+00   9.5197300e+00   9.8113900e+00   1.0182400e+01   1.0403800e+01   1.0696800e+01   1.0952700e+01   1.1213200e+01   1.1458200e+01];
ba2=444.719+[2.2354000e+00   1.1474900e+00   6.8776600e-01   3.1362400e-01   2.0923000e-01   3.1018400e-01   5.8990800e-01   1.0493900e+00   1.6730700e+00   2.3670700e+00   3.2137600e+00   3.9966400e+00   4.6554700e+00   5.3660800e+00   5.8088600e+00   6.3468100e+00   6.6676100e+00   7.0786800e+00   7.4231800e+00   7.7716700e+00   8.1053300e+00];
ba3=-690.512+[5.7604800e-02  -9.8994900e-01  -7.9283200e-01  -6.1370700e-01  -5.1391000e-01  -4.1856100e-01  -3.5380600e-01  -3.0465800e-01  -2.7469500e-01  -2.6747400e-01  -2.8155400e-01  -3.0676900e-01  -3.2849200e-01  -3.4850500e-01  -3.6140400e-01  -3.7617400e-01  -3.8516800e-01  -3.9922500e-01  -4.1342900e-01  -4.3036900e-01  -4.4921900e-01];
% 21922
bb1=-12.9198+[-4.7547600e-01   3.9907400e-01   9.7876300e-01   1.7034000e+00   2.2485700e+00   2.9055800e+00   3.4694000e+00   4.0448100e+00   4.6323600e+00   5.1752900e+00   5.7555800e+00   6.2297600e+00   6.5841900e+00   6.9368200e+00   7.1639400e+00   7.4514200e+00   7.6245500e+00   7.8538200e+00   8.0547200e+00   8.2601300e+00   8.4547600e+00];
bb2=450.785+[1.6834100e+00   5.9257100e-01   7.2646300e-02  -3.8785000e-01  -5.7006100e-01  -5.7952600e-01  -4.0875400e-01  -7.5839400e-02   4.0616000e-01   9.5591200e-01   1.6407700e+00   2.2859800e+00   2.8263800e+00   3.4161800e+00   3.7828600e+00   4.2251600e+00   4.4870800e+00   4.8219400e+00   5.1025700e+00   5.3864700e+00   5.6599400e+00];
bb3=-694.998+[-1.6044100e-01  -7.4954000e-01  -4.0619400e-01  -7.4579600e-02   1.1612000e-01   2.9522400e-01   4.1454500e-01   5.0640400e-01   5.7135100e-01   6.0391500e-01   6.1243000e-01   5.9895100e-01   5.8059300e-01   5.5456000e-01   5.4048400e-01   5.2954300e-01   5.2407800e-01   5.1724400e-01   5.1220800e-01   5.0680100e-01   4.9945800e-01];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 4457
bc1=-9.37506+[4.0951700e-01   4.7029100e-01   6.4008500e-01   8.3411800e-01   1.1083300e+00   1.2459100e+00   1.6331700e+00   1.8748700e+00   2.1960100e+00   2.5787900e+00   2.9570500e+00   3.3937900e+00   3.7918400e+00   4.3584100e+00   4.6814400e+00   5.2688600e+00   5.6554800e+00   6.1484400e+00   6.5983500e+00   7.2804200e+00   7.5181400e+00];
bc2=448.144+[2.2612600e+00   2.1748500e+00   2.0218100e+00   1.8785200e+00   1.6976100e+00   1.6147000e+00   1.4111900e+00   1.3033700e+00   1.1811700e+00   1.0634400e+00   9.7266400e-01   8.9445000e-01   8.4589300e-01   8.1127600e-01   8.0778600e-01   8.3907300e-01   8.7819200e-01   9.5468600e-01   1.0515400e+00   1.2456400e+00   1.3243900e+00];
bc3=-689.149+[-8.5921900e-01  -8.0389100e-01  -6.6350800e-01  -5.2938500e-01  -3.6339300e-01  -2.8923700e-01  -1.0870600e-01  -1.3469100e-02   9.7176200e-02   2.0927000e-01   3.0458800e-01   3.9895900e-01   4.7314200e-01   5.6445200e-01   6.1003700e-01   6.7963700e-01   7.1843700e-01   7.5991500e-01   7.9047500e-01   8.2545100e-01   8.3546400e-01];
% 20101
bd1=-11.8681+[2.4412800e-01   2.7870500e-01   3.6986100e-01   4.7802200e-01   6.3369700e-01   7.1412000e-01   9.5079300e-01   1.1026900e+00   1.3154700e+00   1.5772500e+00   1.8446200e+00   2.1605900e+00   2.4542500e+00   2.8819800e+00   3.1298400e+00   3.5845700e+00   3.8864700e+00   4.2736400e+00   4.6294500e+00   5.1710000e+00   5.3595300e+00];
bd2=447.151+[1.4800000e+00   1.4197800e+00   1.3009200e+00   1.1810000e+00   1.0239200e+00   9.4956700e-01   7.5969200e-01   6.5314000e-01   5.2674000e-01   3.9695400e-01   2.8596400e-01   1.7843800e-01   9.9382300e-02   1.5883600e-02  -1.7875100e-02  -4.6039000e-02  -4.8880600e-02  -2.7455100e-02   1.8114500e-02   1.3311900e-01   1.8404700e-01];
bd3=-698.575+[-6.3160100e-01  -6.0593700e-01  -5.0513100e-01  -3.9479100e-01  -2.5121600e-01  -1.8529700e-01  -2.0421600e-02   6.9637400e-02   1.7606100e-01   2.8820600e-01   3.8746100e-01   4.9091500e-01   5.7707700e-01   6.8971200e-01   7.4953100e-01   8.4978900e-01   9.1158700e-01   9.8403300e-01   1.0447600e+00   1.1282900e+00   1.1552500e+00];
% 9037
be1=-7.50723+[4.8159700e-01   5.4527800e-01   7.2725800e-01   9.3576200e-01   1.2296500e+00   1.3769600e+00   1.7899000e+00   2.0460900e+00   2.3851300e+00   2.7868700e+00   3.1820600e+00   3.6363000e+00   4.0487200e+00   4.6337000e+00   4.9662900e+00   5.5689900e+00   5.9645000e+00   6.4672900e+00   6.9245700e+00   7.6153300e+00   7.8555900e+00];
be2=444.719+[2.2426500e+00   2.1639500e+00   2.0306300e+00   1.9084100e+00   1.7558200e+00   1.6866900e+00   1.5195200e+00   1.4324800e+00   1.3361000e+00   1.2464500e+00   1.1811900e+00   1.1301200e+00   1.1046100e+00   1.1007200e+00   1.1139200e+00   1.1736000e+00   1.2304700e+00   1.3280900e+00   1.4426700e+00   1.6612900e+00   1.7480700e+00];
be3=-690.512+[-7.0677700e-01  -6.6778200e-01  -5.6174000e-01  -4.6088600e-01  -3.3734400e-01  -2.8282300e-01  -1.5186300e-01  -8.3827800e-02  -5.8622800e-03   7.1525600e-02   1.3627200e-01   1.9878200e-01   2.4630800e-01   3.0246500e-01   3.2905000e-01   3.6613600e-01   3.8439300e-01   4.0113100e-01   4.1037100e-01   4.1479900e-01   4.1464100e-01];
% 21922
bf1=-12.9198+[2.1334200e-01   2.5340000e-01   3.5349400e-01   4.6797200e-01   6.2998300e-01   7.1253200e-01   9.5350800e-01   1.1073600e+00   1.3224700e+00   1.5870300e+00   1.8572200e+00   2.1766500e+00   2.4735300e+00   2.9062700e+00   3.1572300e+00   3.6182600e+00   3.9248300e+00   4.3187000e+00   4.6815600e+00   5.2352900e+00   5.4283200e+00];
bf2=450.785+[1.6817900e+00   1.6169900e+00   1.4864200e+00   1.3532100e+00   1.1784400e+00   1.0957400e+00   8.8486900e-01   7.6702300e-01   6.2775900e-01   4.8546300e-01   3.6423100e-01   2.4683300e-01   1.6029400e-01   6.7479300e-02   2.9052000e-02  -5.6613900e-03  -1.2007400e-02   6.5995600e-03   5.0977500e-02   1.6655900e-01   2.1835900e-01];
bf3=-694.998+[-8.5956700e-01  -8.2676400e-01  -7.0964100e-01  -5.8224200e-01  -4.1680400e-01  -3.4090500e-01  -1.5152900e-01  -4.8533600e-02   7.2542800e-02   1.9899100e-01   3.1007300e-01   4.2507400e-01   5.2011800e-01   6.4406800e-01   7.0972600e-01   8.1875900e-01   8.8562900e-01   9.6301500e-01   1.0270600e+00   1.1134500e+00   1.1407600e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5P
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 4457
bg1=-9.37506+[-3.0019200e-01   3.3390200e-01   1.4551600e+00   1.9848100e+00   2.9099900e+00   3.7346100e+00   4.3391900e+00   5.0177000e+00   5.7504700e+00   6.4459000e+00   7.0113600e+00   7.8082600e+00   8.2372200e+00   8.8994000e+00   9.2737300e+00   9.7005900e+00   9.9922700e+00   1.0295400e+01   1.0581500e+01   1.0825900e+01   1.1019400e+01];
bg2=448.144+[2.4402900e+00   1.8982100e+00   1.1260700e+00   8.6590300e-01   5.6043400e-01   4.7441900e-01   5.3928000e-01   7.4784100e-01   1.1462200e+00   1.6513800e+00   2.1509400e+00   2.9673400e+00   3.4637900e+00   4.3246400e+00   4.8846000e+00   5.6000200e+00   6.0956900e+00   6.6014800e+00   7.0553200e+00   7.4198600e+00   7.6972300e+00];
bg3=-689.149+[-6.9515600e-01  -7.5683900e-01  -3.3046000e-01  -1.7132700e-01   4.9938400e-02   1.9679700e-01   2.8049900e-01   3.5408600e-01   4.0749100e-01   4.3342100e-01   4.3298200e-01   4.0226800e-01   3.7224100e-01   3.0585600e-01   2.5863100e-01   2.0046900e-01   1.5960400e-01   1.1816700e-01   8.1194100e-02   5.1464000e-02   2.7349600e-02];
% 20101
bh1=-11.8681+[-2.9902300e-01   1.3765000e-01   9.4141900e-01   1.3288400e+00   2.0162600e+00   2.6385800e+00   3.0972800e+00   3.6167600e+00   4.1828500e+00   4.7245300e+00   5.1678000e+00   5.7980000e+00   6.1399800e+00   6.6691300e+00   6.9658300e+00   7.3017700e+00   7.5303700e+00   7.7669900e+00   7.9892800e+00   8.1775600e+00   8.3261300e+00];
bh2=447.151+[1.7507100e+00   1.2028300e+00   5.0313100e-01   2.5812500e-01  -4.9943100e-02  -1.7277300e-01  -1.5748500e-01  -2.8092600e-02   2.5466200e-01   6.2638400e-01   1.0003700e+00   1.6189200e+00   1.9997000e+00   2.6610400e+00   3.0893300e+00   3.6411600e+00   4.0247000e+00   4.4150400e+00   4.7655900e+00   5.0486500e+00   5.2644000e+00];
bh3=-698.575+[-5.5128000e-01  -5.8085000e-01  -1.4884400e-01   1.8656200e-02   2.6047800e-01   4.3362700e-01   5.4252500e-01   6.5006000e-01   7.4864200e-01   8.2685400e-01   8.7673600e-01   9.2819500e-01   9.4756800e-01   9.6689800e-01   9.7530600e-01   9.8344000e-01   9.8845800e-01   9.9498800e-01   1.0013400e+00   1.0063600e+00   1.0098400e+00];
% 9037
bi1=-7.50723+[-2.4777100e-01   4.1350500e-01   1.5914000e+00   2.1451400e+00   3.1072800e+00   3.9599200e+00   4.5827000e+00   5.2801900e+00   6.0325100e+00   6.7453800e+00   7.3236600e+00   8.1382500e+00   8.5753300e+00   9.2495500e+00   9.6317700e+00   1.0066100e+01   1.0362500e+01   1.0670400e+01   1.0960700e+01   1.1208000e+01   1.1403400e+01];
bi2=444.719+[2.4035900e+00   1.8982000e+00   1.2089500e+00   9.8519300e-01   7.3707600e-01   6.9492300e-01   7.8754100e-01   1.0231100e+00   1.4458000e+00   1.9699700e+00   2.4815400e+00   3.3117900e+00   3.8130700e+00   4.6780700e+00   5.2390500e+00   5.9524500e+00   6.4468700e+00   6.9521600e+00   7.4064500e+00   7.7718000e+00   8.0498700e+00];
bi3=-690.512+[-5.2198300e-01  -6.4369400e-01  -3.4470100e-01  -2.3682200e-01  -9.1452500e-02   1.6281800e-03   5.3825300e-02   9.9730200e-02   1.3249500e-01   1.4583000e-01   1.4018700e-01   1.0770400e-01   7.9845200e-02   2.2510300e-02  -1.5490500e-02  -5.8930300e-02  -9.0420100e-02  -1.2356900e-01  -1.5491900e-01  -1.8156900e-01  -2.0396900e-01];
% 21922
bk1=-12.9198+[-3.4854100e-01   1.0956900e-01   9.2879400e-01   1.3220700e+00   2.0196800e+00   2.6517700e+00   3.1181000e+00   3.6461900e+00   4.2204600e+00   4.7695800e+00   5.2195500e+00   5.8580400e+00   6.2055000e+00   6.7430000e+00   7.0428700e+00   7.3837900e+00   7.6162300e+00   7.8567600e+00   8.0829100e+00   8.2747400e+00   8.4263400e+00];
bk2=450.785+[1.9490300e+00   1.3799400e+00   6.0983800e-01   3.3832600e-01  -3.9858000e-03  -1.4420900e-01  -1.3346400e-01  -3.4903200e-04   2.9664800e-01   6.8962100e-01   1.0864200e+00   1.7432900e+00   2.1484100e+00   2.8534700e+00   3.3113700e+00   3.9020100e+00   4.3119700e+00   4.7288600e+00   5.1026900e+00   5.4040700e+00   5.6336300e+00];
bk3=-694.998+[-7.8074900e-01  -7.7978400e-01  -2.6477100e-01  -6.6844700e-02   2.1438700e-01   4.0867600e-01   5.2460100e-01   6.3090700e-01   7.1723600e-01   7.7551900e-01   8.0331800e-01   8.1610500e-01   8.1050000e-01   7.8362200e-01   7.5930700e-01   7.2384600e-01   6.9870700e-01   6.7443000e-01   6.5347600e-01   6.3687000e-01   6.2400200e-01];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (5P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (5P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')