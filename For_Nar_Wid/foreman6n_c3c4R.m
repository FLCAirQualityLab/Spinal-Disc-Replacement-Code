%% foramen height and width narrowing/widening 
% for all models for the c3-c4 right hand side foramen 
% 4457,20101,9037,21922

% 6N!!

% Values for displacement and base coordinates have not yet been updated from copy paste.

k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 4457,20101,9037,21922
%% model15_intact_TLC_6N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 4457
aa1=-9.37506+[5.0731200e-01   3.3303100e-01  -1.5975600e-02  -3.1740900e-01  -7.3802700e-01  -9.0178800e-01  -1.1464100e+00  -1.4738000e+00  -1.6606700e+00  -1.8854700e+00  -2.0883200e+00  -2.2484400e+00  -2.4280800e+00  -2.6042200e+00  -2.7716600e+00  -2.9461500e+00  -3.0949700e+00  -3.1835900e+00  -3.3027600e+00  -3.4116400e+00  -3.5081200e+00];
aa2=448.144+[1.0306900e+00   2.9847300e-01   8.7381300e-02   9.7979300e-02   3.0160900e-01   3.9361900e-01   5.3657300e-01   7.4343100e-01   8.6279900e-01   1.0042800e+00   1.1228500e+00   1.2062700e+00   1.2961300e+00   1.3794800e+00   1.4525300e+00   1.5371100e+00   1.6135400e+00   1.6542400e+00   1.7048700e+00   1.7499500e+00   1.7898800e+00];
aa3=-689.149+[-6.7815900e-01  -7.6220700e-01  -8.7418600e-01  -1.0113800e+00  -1.2184600e+00  -1.2972700e+00  -1.4172500e+00  -1.5848300e+00  -1.6830900e+00  -1.7999700e+00  -1.9032800e+00  -1.9831600e+00  -2.0718000e+00  -2.1584800e+00  -2.2402500e+00  -2.3268700e+00  -2.4010400e+00  -2.4439900e+00  -2.5011800e+00  -2.5533700e+00  -2.5983300e+00];

% 20101
ab1=-11.8681+[3.3679400e-01   2.5172600e-01   1.2375600e-02  -1.9795100e-01  -5.0446400e-01  -6.2762100e-01  -8.1306000e-01  -1.0623000e+00  -1.2054000e+00  -1.3793900e+00  -1.5367300e+00  -1.6607000e+00  -1.7999800e+00  -1.9361100e+00  -2.0652400e+00  -2.1999300e+00  -2.3148700e+00  -2.3833800e+00  -2.4758500e+00  -2.5606300e+00  -2.6361900e+00];
ab2=447.151+[5.9687600e-01   6.3950100e-02  -2.5761000e-02   4.1942400e-02   2.6479600e-01   3.5917100e-01   5.0285000e-01   7.0642500e-01   8.2491100e-01   9.6697400e-01   1.0867500e+00   1.1729400e+00   1.2660300e+00   1.3535600e+00   1.4330200e+00   1.5225500e+00   1.6029900e+00   1.6473400e+00   1.7045900e+00   1.7566800e+00   1.8025000e+00];
ab3=-698.575+[-5.1114300e-01  -6.0558500e-01  -7.2402700e-01  -8.5149900e-01  -1.0337300e+00  -1.1022600e+00  -1.2050200e+00  -1.3454100e+00  -1.4266700e+00  -1.5229800e+00  -1.6101500e+00  -1.6784800e+00  -1.7548200e+00  -1.8299400e+00  -1.9007300e+00  -1.9771500e+00  -2.0438300e+00  -2.0828600e+00  -2.1350700e+00  -2.1829600e+00  -2.2252200e+00];

% 9037
ac1=-7.50723+[5.6194400e-01   3.1794300e-01  -9.9846000e-02  -4.6092700e-01  -9.5382800e-01  -1.1435200e+00  -1.4267300e+00  -1.8092400e+00  -2.0296400e+00  -2.2966400e+00  -2.5371700e+00  -2.7269300e+00  -2.9413700e+00  -3.1538600e+00  -3.3570900e+00  -3.5703400e+00  -3.7540200e+00  -3.8640700e+00  -4.0131700e+00  -4.1513200e+00  -4.2752700e+00];
ac2=444.719+[1.0471600e+00   2.8983500e-01   4.4024100e-02   2.1169800e-02   1.8052100e-01   2.5688000e-01   3.7720400e-01   5.5355300e-01   6.5556300e-01   7.7665000e-01   8.7797900e-01   9.4862100e-01   1.0243700e+00   1.0940300e+00   1.1546400e+00   1.2263900e+00   1.2919900e+00   1.3265100e+00   1.3691200e+00   1.4069500e+00   1.4405800e+00];
ac3=-690.512+[-6.4682200e-01  -7.6420000e-01  -8.7960500e-01  -1.0076100e+00  -1.1887800e+00  -1.2574500e+00  -1.3627100e+00  -1.5114200e+00  -1.5999400e+00  -1.7070500e+00  -1.8028900e+00  -1.8782300e+00  -1.9630500e+00  -2.0476900e+00  -2.1292800e+00  -2.2163600e+00  -2.2919700e+00  -2.3366900e+00  -2.3974900e+00  -2.4542500e+00  -2.5043500e+00];

% 21922
ad1=-12.9198+[3.2311600e-01   2.7831200e-01   7.4318000e-02  -1.0668700e-01  -3.8181500e-01  -4.9428800e-01  -6.6395900e-01  -8.9014200e-01  -1.0186700e+00  -1.1739100e+00  -1.3150200e+00  -1.4263500e+00  -1.5506000e+00  -1.6707200e+00  -1.7837900e+00  -1.9009700e+00  -2.0000000e+00  -2.0586200e+00  -2.1370800e+00  -2.2079000e+00  -2.2703900e+00];
ad2=450.785+[6.8449100e-01   1.1075700e-01   8.0235400e-03   7.6269600e-02   3.1203500e-01   4.1185300e-01   5.6355800e-01   7.7750600e-01   9.0121100e-01   1.0484600e+00   1.1722500e+00   1.2607200e+00   1.3557800e+00   1.4442800e+00   1.5236100e+00   1.6131600e+00   1.6933500e+00   1.7369900e+00   1.7924700e+00   1.8422300e+00   1.8853700e+00];
ad3=-694.998+[-6.0699400e-01  -6.4587200e-01  -7.4041600e-01  -8.6007300e-01  -1.0467900e+00  -1.1179800e+00  -1.2247300e+00  -1.3696900e+00  -1.4525500e+00  -1.5494000e+00  -1.6366100e+00  -1.7041200e+00  -1.7787400e+00  -1.8509100e+00  -1.9176500e+00  -1.9899300e+00  -2.0526400e+00  -2.0886600e+00  -2.1358900e+00  -2.1782700e+00  -2.2149300e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_6N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 4457
ae1=-9.37506+[-3.0640500e-01   2.8647100e-01  -3.8156800e-01  -6.6223900e-01  -9.8951000e-01  -1.2678500e+00  -1.5547600e+00  -1.8313700e+00  -2.1843900e+00  -2.3508900e+00  -2.5746000e+00  -2.7703200e+00  -2.9946900e+00  -3.1440300e+00  -3.2839200e+00  -3.5424200e+00  -3.6589000e+00  -3.7706400e+00  -3.8628300e+00  -4.0017900e+00  -4.0678800e+00];
ae2=448.144+[2.1859200e+00  -3.6934600e-01  -2.3117300e-01  -1.4017300e-01   1.6999100e-02   1.5202400e-01   2.7551200e-01   3.9687600e-01   5.5487500e-01   6.2767100e-01   7.1019800e-01   7.7550700e-01   8.5104100e-01   8.9669200e-01   9.3744500e-01   1.0008600e+00   1.0273000e+00   1.0462700e+00   1.0589900e+00   1.0756400e+00   1.0831100e+00];
ae3=-689.149+[-1.1481100e+00  -1.2013300e+00  -1.4320600e+00  -1.5322200e+00  -1.6669500e+00  -1.7856600e+00  -1.9104000e+00  -2.0349100e+00  -2.1980000e+00  -2.2746800e+00  -2.3761500e+00  -2.4629700e+00  -2.5634000e+00  -2.6299000e+00  -2.6923000e+00  -2.8035300e+00  -2.8529700e+00  -2.8995500e+00  -2.9374700e+00  -2.9936500e+00  -3.0201000e+00];

% 20101
af1=-11.8681+[-3.2046100e-01   2.0305500e-01  -2.6091700e-01  -4.5858500e-01  -6.9793400e-01  -9.0480900e-01  -1.1202100e+00  -1.3280400e+00  -1.5945100e+00  -1.7214000e+00  -1.8923600e+00  -2.0427300e+00  -2.2147400e+00  -2.3288500e+00  -2.4355000e+00  -2.6323400e+00  -2.7209900e+00  -2.8064500e+00  -2.8772500e+00  -2.9840200e+00  -3.0353800e+00];
af2=447.151+[1.5394400e+00  -5.6074000e-01  -2.9038000e-01  -1.3087300e-01   5.7879100e-02   2.0659100e-01   3.4306500e-01   4.7592600e-01   6.4838300e-01   7.2830500e-01   8.2332700e-01   8.9967800e-01   9.8725900e-01   1.0420600e+00   1.0925900e+00   1.1769200e+00   1.2139200e+00   1.2442100e+00   1.2669800e+00   1.3002200e+00   1.3153800e+00];
af3=-698.575+[-8.3785300e-01  -8.7732500e-01  -1.1179000e+00  -1.2119200e+00  -1.3333500e+00  -1.4381400e+00  -1.5472400e+00  -1.6557500e+00  -1.7964600e+00  -1.8628100e+00  -1.9507800e+00  -2.0274300e+00  -2.1175600e+00  -2.1775200e+00  -2.2339300e+00  -2.3369600e+00  -2.3833100e+00  -2.4273100e+00  -2.4634600e+00  -2.5179500e+00  -2.5444500e+00];

% 9037
ag1=-7.50723+[-2.5743400e-01   2.8054400e-01  -4.9957200e-01  -8.4131000e-01  -1.2251800e+00  -1.5491600e+00  -1.8825800e+00  -2.2058700e+00  -2.6214100e+00  -2.8183900e+00  -3.0845200e+00  -3.3170200e+00  -3.5855700e+00  -3.7653000e+00  -3.9348700e+00  -4.2510600e+00  -4.3954400e+00  -4.5345700e+00  -4.6503300e+00  -4.8267500e+00  -4.9118200e+00];
ag2=444.719+[2.1685800e+00  -3.4672700e-01  -2.7734600e-01  -2.1778800e-01  -9.2536000e-02   1.6991000e-02   1.1567400e-01   2.1352700e-01   3.4211300e-01   4.0152900e-01   4.6684000e-01   5.1811800e-01   5.7785700e-01   6.1339700e-01   6.4487000e-01   6.9222000e-01   7.1175300e-01   7.2451000e-01   7.3231200e-01   7.4193500e-01   7.4619400e-01];
ag3=-690.512+[-1.0346900e+00  -1.2672600e+00  -1.4733200e+00  -1.5697300e+00  -1.6908600e+00  -1.7968900e+00  -1.9096200e+00  -2.0235600e+00  -2.1747800e+00  -2.2469500e+00  -2.3446300e+00  -2.4293400e+00  -2.5286500e+00  -2.5955100e+00  -2.6591800e+00  -2.7763900e+00  -2.8301400e+00  -2.8819100e+00  -2.9250300e+00  -2.9907000e+00  -3.0224500e+00];

% 21922
ah1=-12.9198+[-3.6086200e-01   2.2286500e-01  -1.9012400e-01  -3.5554600e-01  -5.6955300e-01  -7.5679900e-01  -9.5254300e-01  -1.1405000e+00  -1.3797700e+00  -1.4933000e+00  -1.6454100e+00  -1.7798600e+00  -1.9326300e+00  -2.0333400e+00  -2.1267600e+00  -2.2974100e+00  -2.3730700e+00  -2.4457100e+00  -2.5053900e+00  -2.5942500e+00  -2.6364900e+00];
ah2=450.785+[1.7083600e+00  -5.5453900e-01  -2.7629900e-01  -1.1856100e-01   7.5782300e-02   2.3045700e-01   3.7222500e-01   5.1032200e-01   6.8900200e-01   7.7137100e-01   8.6799400e-01   9.4504700e-01   1.0329900e+00   1.0872800e+00   1.1367200e+00   1.2169400e+00   1.2512100e+00   1.2781200e+00   1.2974700e+00   1.3246300e+00   1.3364300e+00];
ah3=-694.998+[-1.0313900e+00  -8.7771200e-01  -1.1108200e+00  -1.1938400e+00  -1.3139300e+00  -1.4194700e+00  -1.5287500e+00  -1.6374000e+00  -1.7775000e+00  -1.8429800e+00  -1.9279400e+00  -2.0014400e+00  -2.0873400e+00  -2.1436200e+00  -2.1958800e+00  -2.2888900e+00  -2.3296600e+00  -2.3675100e+00  -2.3979100e+00  -2.4426300e+00  -2.4639300e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_6N
t2=[2 2.05126 2.1153 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 4457
ai1=-9.37506+[-1.7017400e-01   2.9169100e-01  -2.2302800e-01  -7.0341400e-01  -8.9932900e-01  -1.3415900e+00  -1.5807700e+00  -1.9013000e+00  -2.1039800e+00  -2.2990500e+00  -2.5203900e+00  -2.7990100e+00  -3.0162200e+00  -3.1608500e+00  -3.3275900e+00  -3.4843200e+00  -3.6287600e+00  -3.7643600e+00  -3.9141700e+00  -4.0138600e+00  -4.0831700e+00];
ai2=448.144+[2.5984000e+00  -1.4255500e-01  -2.0013100e-01  -9.9857700e-02  -1.6933100e-02   1.8971000e-01   2.9012200e-01   4.2705000e-01   5.1538200e-01   6.0306200e-01   6.8914200e-01   7.8066000e-01   8.5162700e-01   8.9423800e-01   9.4002000e-01   9.7811300e-01   1.0115400e+00   1.0366700e+00   1.0573500e+00   1.0685800e+00   1.0760500e+00];
ai3=-689.149+[-1.3210800e+00  -1.2264800e+00  -1.3923400e+00  -1.5535500e+00  -1.6332400e+00  -1.8207600e+00  -1.9251400e+00  -2.0705200e+00  -2.1628100e+00  -2.2520200e+00  -2.3528100e+00  -2.4762200e+00  -2.5725800e+00  -2.6365300e+00  -2.7100400e+00  -2.7770000e+00  -2.8379600e+00  -2.8945600e+00  -2.9558700e+00  -2.9957100e+00  -3.0232300e+00];

% 20101
aj1=-11.8681+[-2.1616900e-01   2.0918800e-01  -1.4658500e-01  -4.8701600e-01  -6.3039600e-01  -9.5901500e-01  -1.1388500e+00  -1.3792600e+00  -1.5327600e+00  -1.6813400e+00  -1.8503600e+00  -2.0644600e+00  -2.2311100e+00  -2.3417000e+00  -2.4691300e+00  -2.5886500e+00  -2.6987800e+00  -2.8025000e+00  -2.9177600e+00  -2.9945900e+00  -3.0485400e+00];
aj2=447.151+[1.8236600e+00  -3.8500800e-01  -3.0599400e-01  -8.6978200e-02   1.7203700e-02   2.4810600e-01   3.5916700e-01   5.1025800e-01   6.0632700e-01   7.0149400e-01   7.9879500e-01   9.0593100e-01   9.8835900e-01   1.0399300e+00   1.0975500e+00   1.1479400e+00   1.1936700e+00   1.2318000e+00   1.2685200e+00   1.2915200e+00   1.3069200e+00];
aj3=-698.575+[-9.6580700e-01  -8.9407100e-01  -1.0732500e+00  -1.2297800e+00  -1.3018500e+00  -1.4672700e+00  -1.5586700e+00  -1.6852300e+00  -1.7650400e+00  -1.8425800e+00  -1.9299800e+00  -2.0389200e+00  -2.1258300e+00  -2.1836200e+00  -2.2502600e+00  -2.3124100e+00  -2.3696100e+00  -2.4229800e+00  -2.4815100e+00  -2.5204400e+00  -2.5480400e+00];

% 9037
ak1=-7.50723+[-1.1656300e-01   2.8571900e-01  -3.1653300e-01  -8.9283000e-01  -1.1227000e+00  -1.6377400e+00  -1.9156100e+00  -2.2909200e+00  -2.5284000e+00  -2.7583800e+00  -3.0212300e+00  -3.3517800e+00  -3.6114000e+00  -3.7852200e+00  -3.9870400e+00  -4.1781000e+00  -4.3560000e+00  -4.5242100e+00  -4.7119800e+00  -4.8383200e+00  -4.9271700e+00];
ak2=444.719+[2.5710800e+00  -1.2766000e-01  -2.3467400e-01  -1.8351400e-01  -1.1943300e-01   4.6887300e-02   1.2688400e-01   2.3667600e-01   3.0852900e-01   3.8051700e-01   4.4935900e-01   5.2097500e-01   5.7688500e-01   6.0984000e-01   6.4478200e-01   6.7321600e-01   6.9804500e-01   7.1556000e-01   7.2834800e-01   7.3464900e-01   7.3879500e-01];
ak3=-690.512+[-1.1726200e+00  -1.2739000e+00  -1.4316900e+00  -1.5882800e+00  -1.6606200e+00  -1.8287100e+00  -1.9232500e+00  -2.0568700e+00  -2.1422200e+00  -2.2256200e+00  -2.3219300e+00  -2.4421700e+00  -2.5375700e+00  -2.6019300e+00  -2.6771500e+00  -2.7474700e+00  -2.8130700e+00  -2.8754200e+00  -2.9450600e+00  -2.9917500e+00  -3.0247000e+00];

% 21922
al1=-12.9198+[-2.5352100e-01   2.2860100e-01  -8.6996100e-02  -3.7869900e-01  -5.0684100e-01  -8.0403100e-01  -9.6764400e-01  -1.1845500e+00  -1.3231800e+00  -1.4566200e+00  -1.6072900e+00  -1.7989700e+00  -1.9472500e+00  -2.0450300e+00  -2.1568500e+00  -2.2608700e+00  -2.3556000e+00  -2.4441200e+00  -2.5415100e+00  -2.6056100e+00  -2.6502100e+00];
al2=450.785+[2.0291800e+00  -3.6059100e-01  -2.8665400e-01  -7.2964500e-02   3.3797700e-02   2.7339300e-01   3.8877800e-01   5.4569900e-01   6.4536800e-01   7.4381200e-01   8.4325300e-01   9.5145800e-01   1.0341800e+00   1.0851900e+00   1.1413700e+00   1.1894500e+00   1.2322300e+00   1.2666400e+00   1.2979400e+00   1.3165800e+00   1.3285300e+00];
al3=-694.998+[-1.2003100e+00  -9.1324000e-01  -1.0748600e+00  -1.2119500e+00  -1.2824100e+00  -1.4482000e+00  -1.5397200e+00  -1.6661100e+00  -1.7458000e+00  -1.8228600e+00  -1.9079000e+00  -2.0124900e+00  -2.0953200e+00  -2.1495400e+00  -2.2111200e+00  -2.2674600e+00  -2.3183000e+00  -2.3646700e+00  -2.4140000e+00  -2.4459700e+00  -2.4682400e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_6N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 4457
am1=-9.37506+[3.5697400e-01   3.8442400e-01  -1.8655700e-01  -6.3751000e-01  -1.0635200e+00  -1.1896100e+00  -1.5459800e+00  -1.8063000e+00  -2.0704300e+00  -2.2697200e+00  -2.4840700e+00  -2.7212800e+00  -2.9218700e+00  -3.1339200e+00  -3.2989200e+00  -3.4538700e+00  -3.5970200e+00  -3.7309200e+00  -3.8416700e+00  -4.0052800e+00  -4.0403800e+00];
am2=448.144+[1.9618200e+00   3.3282500e-01  -4.1954300e-02  -7.0358300e-02   8.3363600e-02   1.3716600e-01   2.8893100e-01   4.0179400e-01   5.1741300e-01   6.0720900e-01   6.9420800e-01   7.7516200e-01   8.4422000e-01   9.1050200e-01   9.5711500e-01   9.9611000e-01   1.0295400e+00   1.0551400e+00   1.0715300e+00   1.0907200e+00   1.0946000e+00];
am3=-689.149+[-1.2861900e+00  -1.2451300e+00  -1.4028400e+00  -1.5357500e+00  -1.7072200e+00  -1.7607000e+00  -1.9151100e+00  -2.0316800e+00  -2.1531400e+00  -2.2442900e+00  -2.3424300e+00  -2.4479300e+00  -2.5380200e+00  -2.6327500e+00  -2.7064200e+00  -2.7734100e+00  -2.8345700e+00  -2.8913300e+00  -2.9372600e+00  -3.0037800e+00  -3.0179900e+00];
% 20101
an1=-11.8681+[1.9195900e-01   2.7547100e-01  -1.1722800e-01  -4.3787500e-01  -7.4984300e-01  -8.4369800e-01  -1.1111900e+00  -1.3066900e+00  -1.5058200e+00  -1.6574700e+00  -1.8208700e+00  -2.0028700e+00  -2.1564400e+00  -2.3183200e+00  -2.4439600e+00  -2.5616800e+00  -2.6704000e+00  -2.7723900e+00  -2.8573300e+00  -2.9829700e+00  -3.0102600e+00];
an2=447.151+[1.2337100e+00  -3.0747600e-02  -1.8795100e-01  -7.7631900e-02   1.2765200e-01   1.8875600e-01   3.5674100e-01   4.8049700e-01   6.0701200e-01   7.0440100e-01   8.0167500e-01   8.9561600e-01   9.7488100e-01   1.0535700e+00   1.1117400e+00   1.1625900e+00   1.2081200e+00   1.2464100e+00   1.2742300e+00   1.3124800e+00   1.3202400e+00];
an3=-698.575+[-8.9701400e-01  -8.9239900e-01  -1.0760100e+00  -1.2107700e+00  -1.3645700e+00  -1.4118100e+00  -1.5472700e+00  -1.6492300e+00  -1.7542700e+00  -1.8336400e+00  -1.9188500e+00  -2.0118600e+00  -2.0927600e+00  -2.1783800e+00  -2.2452200e+00  -2.3075100e+00  -2.3649800e+00  -2.4185700e+00  -2.4624400e+00  -2.5274900e+00  -2.5417700e+00];
% 9037
ao1=-7.50723+[4.2968700e-01   3.9184700e-01  -2.7829100e-01  -8.1776700e-01  -1.3192400e+00  -1.4660600e+00  -1.8799600e+00  -2.1838100e+00  -2.4939300e+00  -2.7287400e+00  -2.9832500e+00  -3.2648300e+00  -3.5044100e+00  -3.7593100e+00  -3.9593300e+00  -4.1485300e+00  -4.3250500e+00  -4.4914800e+00  -4.6302000e+00  -4.8381400e+00  -4.8833000e+00];
ao2=444.719+[1.9664300e+00   3.4122500e-01  -8.0599800e-02  -1.5062000e-01  -3.7065400e-02   5.4105600e-03   1.2646400e-01   2.1746400e-01   3.1122100e-01   3.8500500e-01   4.5519600e-01   5.1894100e-01   5.7381200e-01   6.2567700e-01   6.6143700e-01   6.9076300e-01   7.1560100e-01   7.3357200e-01   7.4402000e-01   7.5494900e-01   7.5711600e-01];
ao3=-690.512+[-1.1964600e+00  -1.2587100e+00  -1.4297300e+00  -1.5680200e+00  -1.7265900e+00  -1.7748200e+00  -1.9142800e+00  -2.0209900e+00  -2.1333500e+00  -2.2184800e+00  -2.3119700e+00  -2.4144200e+00  -2.5030200e+00  -2.5979000e+00  -2.6731400e+00  -2.7433600e+00  -2.8090600e+00  -2.8714700e+00  -2.9232800e+00  -3.0010500e+00  -3.0180400e+00];
% 21922
ap1=-12.9198+[1.6308400e-01   2.8874100e-01  -5.8015200e-02  -3.3346300e-01  -6.1097600e-01  -6.9591900e-01  -9.3917900e-01  -1.1162500e+00  -1.2955300e+00  -1.4318400e+00  -1.5775400e+00  -1.7403200e+00  -1.8770400e+00  -2.0201600e+00  -2.1302500e+00  -2.2325500e+00  -2.3259600e+00  -2.4128500e+00  -2.4847000e+00  -2.5892400e+00  -2.6117400e+00];
ap2=450.785+[1.3985100e+00   2.9488300e-02  -1.5586400e-01  -5.9923400e-02   1.4806600e-01   2.1140100e-01   3.8600300e-01   5.1470600e-01   6.4589600e-01   7.4668100e-01   8.4629200e-01   9.4139700e-01   1.0213000e+00   1.0995500e+00   1.1563600e+00   1.2050200e+00   1.2476600e+00   1.2823200e+00   1.3063200e+00   1.3374000e+00   1.3433800e+00];
ap3=-694.998+[-1.0828400e+00  -9.5081100e-01  -1.0908100e+00  -1.1977800e+00  -1.3448600e+00  -1.3919700e+00  -1.5277500e+00  -1.6299500e+00  -1.7346800e+00  -1.8136400e+00  -1.8968700e+00  -1.9863900e+00  -2.0639000e+00  -2.1446700e+00  -2.2065700e+00  -2.2632000e+00  -2.3143900e+00  -2.3610900e+00  -2.3983600e+00  -2.4519200e+00  -2.4634700e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_6N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 4457
aq1=-9.37506+[-4.4029300e-01   2.2257200e-01  -1.1195700e-01  -5.4013900e-01  -8.8811500e-01  -1.1878200e+00  -1.5079500e+00  -1.8167700e+00  -2.0195700e+00  -2.2534900e+00  -2.4651700e+00  -2.7293600e+00  -2.9372200e+00  -3.0763400e+00  -3.2479300e+00  -3.4094400e+00  -3.5590800e+00  -3.6976200e+00  -3.8830900e+00  -3.9834100e+00  -4.0529100e+00];
aq2=448.144+[2.2729300e+00   6.7724500e-01   2.1655400e-01   4.8975400e-02   6.0389700e-02   1.6116400e-01   2.8517200e-01   4.1234300e-01   4.9800100e-01   6.0049500e-01   6.8702900e-01   7.7714700e-01   8.4664000e-01   8.8923100e-01   9.3857400e-01   9.7962100e-01   1.0149600e+00   1.0439200e+00   1.0720000e+00   1.0833900e+00   1.0908500e+00];
aq3=689.149+[-1.2343600e-01  -1.3174300e+00  -1.4100500e+00  -1.5202200e+00  -1.6422700e+00  -1.7660200e+00  -1.9034200e+00  -2.0417700e+00  -2.1334800e+00  -2.2394000e+00  -2.3357500e+00  -2.4528900e+00  -2.5453800e+00  -2.6070400e+00  -2.6831600e+00  -2.7530200e+00  -2.8164200e+00  -2.8751500e+00  -2.9517600e+00  -2.9922500e+00  -3.0200500e+00];
% 20101
ar1=-11.8681+[-4.2105700e-01   1.5036300e-01  -6.4487100e-02  -3.6650400e-01  -6.1894800e-01  -8.4080600e-01  -1.0811200e+00  -1.3127400e+00  -1.4661100e+00  -1.6442400e+00  -1.8057600e+00  -2.0085400e+00  -2.1678600e+00  -2.2742100e+00  -2.4050900e+00  -2.5282500e+00  -2.6421900e+00  -2.7477300e+00  -2.8901600e+00  -2.9672700e+00  -3.0213200e+00];
ar2=447.151+[1.4900500e+00   2.5678600e-01  -8.6550500e-03  -1.3711400e-02   8.1668800e-02   2.0981400e-01   3.5076900e-01   4.9219100e-01   5.8589900e-01   6.9733900e-01   7.9336300e-01   8.9742700e-01   9.7731800e-01   1.0277400e+00   1.0882500e+00   1.1411800e+00   1.1884300e+00   1.2296400e+00   1.2763500e+00   1.2992600e+00   1.3143200e+00];
ar3=-698.575+[6.5302800e-02  -9.6164000e-01  -1.0728300e+00  -1.1923800e+00  -1.3048200e+00  -1.4141300e+00  -1.5347800e+00  -1.6560300e+00  -1.7354900e+00  -1.8280900e+00  -1.9120100e+00  -2.0155300e+00  -2.0989600e+00  -2.1548200e+00  -2.2239300e+00  -2.2884300e+00  -2.3480800e+00  -2.4034400e+00  -2.4766300e+00  -2.5162600e+00  -2.5441800e+00];
% 9037
as1=-7.50723+[-3.8446300e-01   2.2334600e-01  -1.8906300e-01  -7.0115200e-01  -1.1169500e+00  -1.4679400e+00  -1.8398200e+00  -2.2004900e+00  -2.4375900e+00  -2.7124200e+00  -2.9631200e+00  -3.2762400e+00  -3.5240700e+00  -3.6907400e+00  -3.8976700e+00  -4.0937700e+00  -4.2771400e+00  -4.4484500e+00  -4.6800400e+00  -4.8070000e+00  -4.8958200e+00];
as2=444.719+[2.2354400e+00   6.6941200e-01   1.7719100e-01  -2.6624200e-02  -4.6666800e-02   2.7214400e-02   1.2395000e-01   2.2528900e-01   2.9455400e-01   3.7850200e-01   4.4856400e-01   5.1964500e-01   5.7465600e-01   6.0787900e-01   6.4595500e-01   6.7691000e-01   7.0328300e-01   7.2427200e-01   7.4246100e-01   7.4884600e-01   7.5296000e-01];
as3=-690.512+[5.8991400e-02  -1.2992500e+00  -1.4162900e+00  -1.5408600e+00  -1.6644600e+00  -1.7786700e+00  -1.9035100e+00  -2.0305800e+00  -2.1152600e+00  -2.2140700e+00  -2.3055500e+00  -2.4191000e+00  -2.5101100e+00  -2.5716800e+00  -2.6488300e+00  -2.7213200e+00  -2.7888100e+00  -2.8526900e+00  -2.9387600e+00  -2.9859400e+00  -3.0189700e+00];
% 21922
at1=-12.9198+[-4.7550300e-01   1.6154700e-01  -1.3291700e-02  -2.7261800e-01  -4.9158400e-01  -6.9062800e-01  -9.0910100e-01  -1.1187000e+00  -1.2575000e+00  -1.4181400e+00  -1.5625800e+00  -1.7443100e+00  -1.8864700e+00  -1.9808500e+00  -2.0961900e+00  -2.2039300e+00  -2.3025600e+00  -2.3929800e+00  -2.5139200e+00  -2.5783900e+00  -2.6232600e+00];
at2=450.785+[1.6833300e+00   3.4367700e-01   4.4980100e-02   1.6913100e-02   1.0322600e-01   2.3376300e-01   3.7979800e-01   5.2669800e-01   6.2394800e-01   7.3935000e-01   8.3789700e-01   9.4341300e-01   1.0239400e+00   1.0741700e+00   1.1336900e+00   1.1847300e+00   1.2293500e+00   1.2673000e+00   1.3078900e+00   1.3265500e+00   1.3383000e+00];
at3=-694.998+[-1.5938200e-01  -1.0488700e+00  -1.1123600e+00  -1.1955200e+00  -1.2893800e+00  -1.3949800e+00  -1.5150400e+00  -1.6361400e+00  -1.7155000e+00  -1.8077300e+00  -1.8900000e+00  -1.9898800e+00  -2.0698600e+00  -2.1227200e+00  -2.1872500e+00  -2.2463500e+00  -2.2999500e+00  -2.3487800e+00  -2.4112900e+00  -2.4440900e+00  -2.4668400e+00];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_6N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 4457
au1=-9.37506+[3.3988300e-01   3.7234700e-01  -1.6794700e-01  -5.9516400e-01  -8.6582800e-01  -1.2423600e+00  -1.5534700e+00  -1.7902700e+00  -2.0648200e+00  -2.2894900e+00  -2.4964000e+00  -2.7279200e+00  -2.9324800e+00  -3.1482200e+00  -3.3154200e+00  -3.4723600e+00  -3.6171300e+00  -3.7519000e+00  -3.9013400e+00  -3.9992400e+00  -4.0654400e+00];
au2=448.144+[1.9866000e+00   4.0026700e-01   4.6844400e-02   1.1405400e-02   7.5671800e-02   2.2896100e-01   3.5135200e-01   4.4867300e-01   5.6337200e-01   6.6194400e-01   7.4364000e-01   8.1851200e-01   8.8670500e-01   9.5274700e-01   9.9987500e-01   1.0393500e+00   1.0732700e+00   1.1001200e+00   1.1229900e+00   1.1353300e+00   1.1433600e+00];
au3=-689.149+[-1.2875100e+00  -1.2483300e+00  -1.4036400e+00  -1.5216900e+00  -1.6207100e+00  -1.7763500e+00  -1.9035700e+00  -2.0056700e+00  -2.1288400e+00  -2.2297900e+00  -2.3226800e+00  -2.4235700e+00  -2.5137300e+00  -2.6086700e+00  -2.6824100e+00  -2.7496500e+00  -2.8109500e+00  -2.8674100e+00  -2.9291300e+00  -2.9690900e+00  -2.9959900e+00];
% 20101
av1=-11.8681+[1.6997400e-01   2.5598700e-01  -1.0580800e-01  -4.0708600e-01  -6.0488700e-01  -8.8562600e-01  -1.1226100e+00  -1.3018200e+00  -1.5096600e+00  -1.6812300e+00  -1.8395700e+00  -2.0177900e+00  -2.1749300e+00  -2.3401000e+00  -2.4677500e+00  -2.5872400e+00  -2.6973800e+00  -2.8003500e+00  -2.9150500e+00  -2.9901600e+00  -3.0414800e+00];
av2=447.151+[1.2432900e+00   6.6479000e-03  -1.2972600e-01  -2.0301600e-02   9.3953000e-02   2.7132800e-01   4.0989700e-01   5.1816800e-01   6.4570200e-01   7.5336100e-01   8.4555800e-01   9.3421500e-01   1.0135300e+00   1.0928100e+00   1.1520000e+00   1.2039400e+00   1.2505300e+00   1.2906100e+00   1.3295000e+00   1.3534400e+00   1.3689600e+00];
av3=-698.575+[-8.9375500e-01  -8.8848800e-01  -1.0694000e+00  -1.1908800e+00  -1.2809000e+00  -1.4189300e+00  -1.5309900e+00  -1.6207900e+00  -1.7276500e+00  -1.8157700e+00  -1.8966100e+00  -1.9857000e+00  -2.0667700e+00  -2.1527100e+00  -2.2196700e+00  -2.2821700e+00  -2.3398100e+00  -2.3930600e+00  -2.4520500e+00  -2.4910800e+00  -2.5180700e+00];
% 9037
aw1=-7.50723+[4.1513500e-01   3.8393100e-01  -2.5789700e-01  -7.7376300e-01  -1.0952800e+00  -1.5328800e+00  -1.8920900e+00  -2.1671300e+00  -2.4887300e+00  -2.7528500e+00  -2.9980000e+00  -3.2723300e+00  -3.5160600e+00  -3.7749000e+00  -3.9772700e+00  -4.1686100e+00  -4.3469300e+00  -4.5144400e+00  -4.7019000e+00  -4.8264100e+00  -4.9115200e+00];
aw2=444.719+[1.9912800e+00   4.0776900e-01   5.4937100e-03  -7.0541900e-02  -3.1531400e-02   8.8390300e-02   1.8570100e-01   2.6396600e-01   3.5646200e-01   4.3733600e-01   5.0315500e-01   5.6160400e-01   6.1563100e-01   6.6725000e-01   7.0353100e-01   7.3335100e-01   7.5867900e-01   7.7792100e-01   7.9287900e-01   8.0028900e-01   8.0506800e-01];
aw3=-690.512+[-1.1941100e+00  -1.2539800e+00  -1.4214600e+00  -1.5477000e+00  -1.6432600e+00  -1.7837400e+00  -1.8995300e+00  -1.9932700e+00  -2.1075600e+00  -2.2019700e+00  -2.2906500e+00  -2.3890300e+00  -2.4779100e+00  -2.5731700e+00  -2.6486000e+00  -2.7191800e+00  -2.7851600e+00  -2.8474300e+00  -2.9174100e+00  -2.9641200e+00  -2.9962000e+00];
% 21922
ax1=-12.9198+[1.3890300e-01   2.6618000e-01  -4.7398300e-02  -3.0181500e-01  -4.7491100e-01  -7.2926300e-01  -9.4601800e-01  -1.1091300e+00  -1.2965800e+00  -1.4511100e+00  -1.5925800e+00  -1.7522200e+00  -1.8924300e+00  -2.0386900e+00  -2.1506900e+00  -2.2546600e+00  -2.3493500e+00  -2.4369900e+00  -2.5337900e+00  -2.5961900e+00  -2.6384500e+00];
ax2=450.785+[1.4125100e+00   7.5884300e-02  -8.7401400e-02   5.4108100e-03   1.1702200e-01   3.0047200e-01   4.4362200e-01   5.5589500e-01   6.8775100e-01   7.9901500e-01   8.9320800e-01   9.8256000e-01   1.0622600e+00   1.1409000e+00   1.1986100e+00   1.2482200e+00   1.2917700e+00   1.3280900e+00   1.3616000e+00   1.3812400e+00   1.3934600e+00];
ax3=-694.998+[-1.0848600e+00  -9.5693100e-01  -1.0947100e+00  -1.1856400e+00  -1.2662000e+00  -1.4033300e+00  -1.5147200e+00  -1.6044200e+00  -1.7104900e+00  -1.7980000e+00  -1.8767200e+00  -1.9620100e+00  -2.0394400e+00  -2.1202900e+00  -2.1821700e+00  -2.2388300e+00  -2.2900400e+00  -2.3362100e+00  -2.3860500e+00  -2.4181900e+00  -2.4400700e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_6N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 4457
ay1=-9.37506+[-4.4025400e-01   2.7809800e-01  -1.4105000e-01  -5.1412300e-01  -8.8474700e-01  -1.2276600e+00  -1.4978200e+00  -1.8020700e+00  -2.1477800e+00  -2.3341400e+00  -2.5823000e+00  -2.7905700e+00  -2.9626100e+00  -3.2176300e+00  -3.3583000e+00  -3.4922500e+00  -3.6382800e+00  -3.7745000e+00  -3.9257900e+00  -4.0258100e+00  -4.0951000e+00];
ay2=448.144+[2.2728400e+00   3.6663800e-01   5.4815300e-02   7.5311800e-03   7.7983700e-02   2.1423300e-01   3.1803700e-01   4.3860300e-01   5.8193400e-01   6.6001600e-01   7.4876200e-01   8.1519400e-01   8.7077600e-01   9.4579100e-01   9.8377200e-01   1.0162200e+00   1.0500400e+00   1.0764400e+00   1.0991800e+00   1.1113900e+00   1.1194200e+00];
ay3=-689.149+[-1.2469200e-01  -1.2729900e+00  -1.3964900e+00  -1.4980100e+00  -1.6284400e+00  -1.7701800e+00  -1.8800600e+00  -2.0101900e+00  -2.1647300e+00  -2.2481700e+00  -2.3580300e+00  -2.4487700e+00  -2.5240800e+00  -2.6357900e+00  -2.6973000e+00  -2.7538600e+00  -2.8153900e+00  -2.8723000e+00  -2.9342700e+00  -2.9744100e+00  -3.0020300e+00];
% 20101
az1=-11.8681+[-4.2103300e-01   1.8776500e-01  -8.7474500e-02  -3.4924500e-01  -6.1846200e-01  -8.7397800e-01  -1.0796500e+00  -1.3100600e+00  -1.5723100e+00  -1.7149000e+00  -1.9051900e+00  -2.0656900e+00  -2.1980000e+00  -2.3934300e+00  -2.5010600e+00  -2.6033300e+00  -2.7147100e+00  -2.8189400e+00  -2.9354100e+00  -3.0124600e+00  -3.0664200e+00];
az2=447.151+[1.4902400e+00  -7.3153700e-03  -1.3173700e-01  -5.1017300e-02   9.8318600e-02   2.5620900e-01   3.7397300e-01   5.0897500e-01   6.6757800e-01   7.5354400e-01   8.5585200e-01   9.3406700e-01   9.9877500e-01   1.0897000e+00   1.1380900e+00   1.1810500e+00   1.2273900e+00   1.2669800e+00   1.3058000e+00   1.3298800e+00   1.3458000e+00];
az3=-698.575+[6.4117900e-02  -9.1941900e-01  -1.0615300e+00  -1.1684900e+00  -1.2880100e+00  -1.4139100e+00  -1.5108400e+00  -1.6255100e+00  -1.7599500e+00  -1.8327200e+00  -1.9286500e+00  -2.0092800e+00  -2.0773900e+00  -2.1786700e+00  -2.2346200e+00  -2.2874600e+00  -2.3453000e+00  -2.3990100e+00  -2.4582500e+00  -2.4974700e+00  -2.5251900e+00];
% 9037
ba1=-7.50723+[-3.8442200e-01   2.8142500e-01  -2.2538500e-01  -6.7434000e-01  -1.1172700e+00  -1.5155700e+00  -1.8270700e+00  -2.1800100e+00  -2.5847700e+00  -2.8039500e+00  -3.0975600e+00  -3.3441700e+00  -3.5490200e+00  -3.8548400e+00  -4.0250600e+00  -4.1880700e+00  -4.3676500e+00  -4.5366200e+00  -4.7259800e+00  -4.8527100e+00  -4.9414200e+00];
ba2=444.719+[2.2354000e+00   3.6901500e-01   1.6154200e-02  -6.6268800e-02  -3.0887900e-02   7.5049200e-02   1.5709200e-01   2.5330700e-01   3.6892600e-01   4.3253400e-01   5.0281100e-01   5.5471800e-01   5.9855300e-01   6.5677600e-01   6.8580500e-01   7.1014500e-01   7.3536200e-01   7.5413300e-01   7.6894600e-01   7.7622800e-01   7.8095100e-01];
ba3=-690.512+[5.7604800e-02  -1.2771100e+00  -1.4138500e+00  -1.5222200e+00  -1.6503400e+00  -1.7782000e+00  -1.8779500e+00  -1.9974000e+00  -2.1408200e+00  -2.2191900e+00  -2.3247400e+00  -2.4133700e+00  -2.4877500e+00  -2.6001400e+00  -2.6633400e+00  -2.7228300e+00  -2.7889900e+00  -2.8516800e+00  -2.9219300e+00  -2.9689100e+00  -3.0018900e+00];
% 21922
bb1=-12.9198+[-4.7547600e-01   1.9966600e-01  -3.2001600e-02  -2.5416100e-01  -4.8724800e-01  -7.1897000e-01  -9.0736200e-01  -1.1173900e+00  -1.3542200e+00  -1.4826200e+00  -1.6530000e+00  -1.7970300e+00  -1.9152400e+00  -2.0884100e+00  -2.1828700e+00  -2.2720500e+00  -2.3680100e+00  -2.4569500e+00  -2.5555000e+00  -2.6198000e+00  -2.6644700e+00];
bb2=450.785+[1.6834100e+00   6.0567300e-02  -8.8335000e-02  -2.2068800e-02   1.2147000e-01   2.8491500e-01   4.0671700e-01   5.4663100e-01   7.1081200e-01   7.9948800e-01   9.0355800e-01   9.8240700e-01   1.0474000e+00   1.1373500e+00   1.1843200e+00   1.2252700e+00   1.2686300e+00   1.3044800e+00   1.3379100e+00   1.3576200e+00   1.3701100e+00];
bb3=-694.998+[-1.6044100e-01  -9.8584800e-01  -1.0888100e+00  -1.1694000e+00  -1.2730700e+00  -1.3982400e+00  -1.4947300e+00  -1.6091000e+00  -1.7427700e+00  -1.8147500e+00  -1.9076100e+00  -1.9849000e+00  -2.0499300e+00  -2.1450200e+00  -2.1965400e+00  -2.2444200e+00  -2.2958700e+00  -2.3425300e+00  -2.3926000e+00  -2.4248500e+00  -2.4472800e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_6N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 4457
bc1=-9.37506+[4.0951700e-01   1.8263500e-01  -2.9691300e-01  -5.9933300e-01  -8.8496300e-01  -1.3869800e+00  -1.6568300e+00  -1.7191300e+00  -1.9933000e+00  -2.2138800e+00  -2.3624100e+00  -2.5855600e+00  -2.9176600e+00  -2.9618400e+00  -3.1245100e+00  -3.4138700e+00  -3.4498600e+00  -3.5931000e+00  -3.7012300e+00  -3.8635100e+00  -3.9391500e+00];
bc2=448.144+[2.2612600e+00   2.1885700e-01   2.8691800e-01   3.7377800e-01   4.9229100e-01   7.0929500e-01   8.3150600e-01   8.5943600e-01   9.8681500e-01   1.0938200e+00   1.1619200e+00   1.2545100e+00   1.3826100e+00   1.4015500e+00   1.4664400e+00   1.5794300e+00   1.5932600e+00   1.6423500e+00   1.6758600e+00   1.7198100e+00   1.7389000e+00];
bc3=-689.149+[-8.5921900e-01  -8.0684100e-01  -9.7014100e-01  -1.0782900e+00  -1.1956400e+00  -1.4166500e+00  -1.5435100e+00  -1.5733000e+00  -1.7083400e+00  -1.8172800e+00  -1.8891100e+00  -1.9950800e+00  -2.1525900e+00  -2.1742400e+00  -2.2530400e+00  -2.3936000e+00  -2.4108900e+00  -2.4786500e+00  -2.5295500e+00  -2.6055100e+00  -2.6401700e+00];
% 20101
bd1=-11.8681+[2.4412800e-01   1.2710100e-01  -1.9968200e-01  -4.1475800e-01  -6.2470900e-01  -1.0001100e+00  -1.2024700e+00  -1.2493500e+00  -1.4566800e+00  -1.6252800e+00  -1.7396900e+00  -1.9117200e+00  -2.1675000e+00  -2.2014200e+00  -2.3259100e+00  -2.5475600e+00  -2.5752300e+00  -2.6855600e+00  -2.7688000e+00  -2.8941200e+00  -2.9527300e+00];
bd2=447.151+[1.4800000e+00  -4.9485500e-02   1.4142400e-01   2.9194000e-01   4.3624900e-01   6.8048900e-01   8.1318500e-01   8.4370700e-01   9.8168600e-01   1.0952400e+00   1.1680400e+00   1.2685900e+00   1.4093000e+00   1.4294500e+00   1.5000900e+00   1.6249500e+00   1.6405200e+00   1.6976200e+00   1.7388300e+00   1.7961600e+00   1.8215300e+00];
bd3=-698.575+[-6.3160100e-01  -6.4614200e-01  -8.1471200e-01  -9.1621400e-01  -1.0214900e+00  -1.2164700e+00  -1.3253100e+00  -1.3504900e+00  -1.4634600e+00  -1.5551700e+00  -1.6163200e+00  -1.7078300e+00  -1.8457400e+00  -1.8648000e+00  -1.9344200e+00  -2.0604700e+00  -2.0763100e+00  -2.1387600e+00  -2.1858700e+00  -2.2567800e+00  -2.2900000e+00];
% 9037
be1=-7.50723+[4.8159700e-01   1.5919300e-01  -4.1645400e-01  -7.8041900e-01  -1.1152100e+00  -1.7002600e+00  -2.0176000e+00  -2.0914000e+00  -2.4181200e+00  -2.6810700e+00  -2.8581600e+00  -3.1235300e+00  -3.5223400e+00  -3.5757000e+00  -3.7721800e+00  -4.1255100e+00  -4.1699800e+00  -4.3470400e+00  -4.4819600e+00  -4.6866900e+00  -4.7832700e+00];
be2=444.719+[2.2426500e+00   1.9724100e-01   2.1135800e-01   2.6597500e-01   3.5681400e-01   5.2834500e-01   6.2636600e-01   6.4870700e-01   7.5146400e-01   8.3955700e-01   8.9555500e-01   9.7122400e-01   1.0751000e+00   1.0908400e+00   1.1444400e+00   1.2380900e+00   1.2495700e+00   1.2897800e+00   1.3168300e+00   1.3515400e+00   1.3664600e+00];
be3=-690.512+[-7.0677700e-01  -7.8719300e-01  -9.3891500e-01  -1.0408800e+00  -1.1453900e+00  -1.3422600e+00  -1.4571700e+00  -1.4844600e+00  -1.6091100e+00  -1.7103800e+00  -1.7779400e+00  -1.8790300e+00  -2.0329900e+00  -2.0542200e+00  -2.1323700e+00  -2.2749400e+00  -2.2928900e+00  -2.3641200e+00  -2.4188200e+00  -2.5024600e+00  -2.5415800e+00];
% 21922
bf1=-12.9198+[2.1334200e-01   1.5410800e-01  -1.2390100e-01  -3.0698900e-01  -4.9428000e-01  -8.3355000e-01  -1.0151000e+00  -1.0568300e+00  -1.2403000e+00  -1.3899400e+00  -1.4916500e+00  -1.6452900e+00  -1.8717600e+00  -1.9016400e+00  -2.0112600e+00  -2.2041800e+00  -2.2279600e+00  -2.3227900e+00  -2.3935600e+00  -2.4989100e+00  -2.5476900e+00];
bf2=450.785+[1.6817900e+00   1.7892400e-02   2.0813200e-01   3.5758600e-01   5.0698000e-01   7.6241300e-01   9.0061000e-01   9.3220700e-01   1.0746700e+00   1.1918800e+00   1.2667100e+00   1.3693900e+00   1.5113000e+00   1.5316600e+00   1.6026200e+00   1.7264600e+00   1.7417200e+00   1.7969800e+00   1.8360800e+00   1.8889300e+00   1.9116800e+00];
bf3=-694.998+[-8.5956700e-01  -7.0724300e-01  -8.6038800e-01  -9.5169500e-01  -1.0560200e+00  -1.2529400e+00  -1.3620700e+00  -1.3870400e+00  -1.4986400e+00  -1.5894200e+00  -1.6495700e+00  -1.7388400e+00  -1.8710000e+00  -1.8893400e+00  -1.9558400e+00  -2.0743700e+00  -2.0890300e+00  -2.1461900e+00  -2.1884700e+00  -2.2505900e+00  -2.2791000e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_6N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 4457
bg1=-9.37506+[-3.0019200e-01  -1.3543200e-02  -7.7907300e-02  -2.7189500e-01  -7.3871900e-01  -9.1445600e-01  -1.3029400e+00  -1.5609300e+00  -1.8039100e+00  -1.9490800e+00  -2.1192900e+00  -2.3186400e+00  -2.5416800e+00  -2.7429900e+00  -2.9219000e+00  -3.1047500e+00  -3.2688300e+00  -3.4510000e+00  -3.5963900e+00  -3.7724800e+00  -3.8501200e+00];
bg2=448.144+[2.4402900e+00   2.1658700e+00   1.9575900e+00   1.8095600e+00   1.5352800e+00   1.4463000e+00   1.3234800e+00   1.2867800e+00   1.2776700e+00   1.2792200e+00   1.2957600e+00   1.3274800e+00   1.3768300e+00   1.4291200e+00   1.4815100e+00   1.5394100e+00   1.5957900e+00   1.6604200e+00   1.7095100e+00   1.7648800e+00   1.7885900e+00];
bg3=-689.149+[-6.9515600e-01  -1.0220900e+00  -1.1075900e+00  -1.1761100e+00  -1.2930100e+00  -1.3452700e+00  -1.4855300e+00  -1.5900500e+00  -1.6925500e+00  -1.7547900e+00  -1.8293900e+00  -1.9167700e+00  -2.0149100e+00  -2.1040400e+00  -2.1852600e+00  -2.2684300e+00  -2.3441600e+00  -2.4280800e+00  -2.4943500e+00  -2.5747600e+00  -2.6095900e+00];
% 20101
bh1=-11.8681+[-2.9902300e-01  -5.9436700e-02  -5.8877800e-02  -1.7780700e-01  -4.9987400e-01  -6.2942300e-01  -9.2047800e-01  -1.1151400e+00  -1.3009700e+00  -1.4126800e+00  -1.5441000e+00  -1.6983500e+00  -1.8709100e+00  -2.0267300e+00  -2.1645900e+00  -2.3056400e+00  -2.4321600e+00  -2.5730600e+00  -2.6858100e+00  -2.8226100e+00  -2.8832700e+00];
bh2=447.151+[1.7507100e+00   1.4571200e+00   1.3405500e+00   1.2943400e+00   1.2356600e+00   1.2064300e+00   1.1716900e+00   1.1785700e+00   1.2025900e+00   1.2224100e+00   1.2572600e+00   1.3067900e+00   1.3714500e+00   1.4352800e+00   1.4968200e+00   1.5630900e+00   1.6266400e+00   1.6993500e+00   1.7559500e+00   1.8220300e+00   1.8503600e+00];
bh3=-698.575+[-5.5128000e-01  -8.0624200e-01  -8.8381000e-01  -9.5425700e-01  -1.0752400e+00  -1.1242300e+00  -1.2496400e+00  -1.3403600e+00  -1.4283300e+00  -1.4818100e+00  -1.5461900e+00  -1.6224100e+00  -1.7092200e+00  -1.7889900e+00  -1.8618300e+00  -1.9372500e+00  -2.0068500e+00  -2.0849800e+00  -2.1470200e+00  -2.2230300e+00  -2.2566700e+00];
% 9037
bi1=-7.50723+[-2.4777100e-01   4.1682600e-03  -1.2447100e-01  -3.8183300e-01  -9.6483800e-01  -1.1769600e+00  -1.6372800e+00  -1.9428600e+00  -2.2306400e+00  -2.4029500e+00  -2.6056000e+00  -2.8424000e+00  -3.1071200e+00  -3.3468300e+00  -3.5602200e+00  -3.7789400e+00  -3.9766500e+00  -4.1979100e+00  -4.3755300e+00  -4.5931200e+00  -4.6899900e+00];
bi2=444.719+[2.4035900e+00   2.1109800e+00   1.8696900e+00   1.6916200e+00   1.3716200e+00   1.2689500e+00   1.1175100e+00   1.0617200e+00   1.0348800e+00   1.0260200e+00   1.0302800e+00   1.0481100e+00   1.0824200e+00   1.1214700e+00   1.1624300e+00   1.2090100e+00   1.2553700e+00   1.3091800e+00   1.3500100e+00   1.3957600e+00   1.4153700e+00];
bi3=-690.512+[-5.2198300e-01  -8.5112700e-01  -9.3912700e-01  -1.0134500e+00  -1.1579500e+00  -1.2178700e+00  -1.3649900e+00  -1.4709600e+00  -1.5736100e+00  -1.6360300e+00  -1.7104200e+00  -1.7971800e+00  -1.8943800e+00  -1.9831100e+00  -2.0641900e+00  -2.1478200e+00  -2.2247400e+00  -2.3113000e+00  -2.3807900e+00  -2.4670400e+00  -2.5051900e+00];
% 21922
bk1=-12.9198+[-3.4854100e-01  -7.0517800e-02  -3.1370400e-02  -1.1400000e-01  -3.7190500e-01  -4.8266400e-01  -7.3970100e-01  -9.1230000e-01  -1.0777000e+00  -1.1770400e+00  -1.2937500e+00  -1.4313500e+00  -1.5858800e+00  -1.7251400e+00  -1.8481600e+00  -1.9737500e+00  -2.0855900e+00  -2.2092000e+00  -2.3075100e+00  -2.4254900e+00  -2.4774200e+00];
bk2=450.785+[1.9490300e+00   1.6632800e+00   1.5389800e+00   1.4818200e+00   1.3858800e+00   1.3457200e+00   1.2961700e+00   1.2965100e+00   1.3160000e+00   1.3334100e+00   1.3662100e+00   1.4141800e+00   1.4777800e+00   1.5408400e+00   1.6019000e+00   1.6676500e+00   1.7305200e+00   1.8019900e+00   1.8569700e+00   1.9198600e+00   1.9463400e+00];
bk3=-694.998+[-7.8074900e-01  -1.0321700e+00  -1.0879400e+00  -1.1344500e+00  -1.1953300e+00  -1.2272000e+00  -1.3275000e+00  -1.4054700e+00  -1.4834300e+00  -1.5312400e+00  -1.5898200e+00  -1.6603300e+00  -1.7417100e+00  -1.8167600e+00  -1.8856700e+00  -1.9570300e+00  -2.0226700e+00  -2.0957500e+00  -2.1530300e+00  -2.2218300e+00  -2.2517700e+00];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (6N)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (6N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')