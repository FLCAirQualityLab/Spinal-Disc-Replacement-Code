%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under lateral bending (5P)
% 20212,40296,25651,42160
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 20212,40296,25651,42160
%% model15_intact_TLC_5P
t15=[2 2.05 2.10719 2.15841 2.20749 2.25204 2.30359 2.36468 2.40251 2.45207 2.50137 2.56422 2.60772 2.65475 2.70141 2.75163 2.81747 2.85415 2.90465 2.96581 3 ];

% 20212
aa1=-10.8616+[0.237303 0.645569 1.10732 1.54552 1.98382 2.39664 2.87209 3.40502 3.72928 4.12287 4.459 4.77427 4.96122 5.14663 5.32208 5.49679 5.71039 5.82682 5.98255 6.16225 6.26055 ];
aa2=446.379+[0.413703 -0.296477 -0.524341 -0.428427 -0.15014 0.213622 0.702841 1.28842 1.65778 2.12376 2.53568 2.92142 3.13006 3.32623 3.49948 3.6751 3.89994 4.02581 4.19884 4.4059 4.52036];
aa3=-704.985+[-0.501412 -0.259452 -0.0469087 0.111671 0.244825 0.351574 0.458094 0.556839 0.608027 0.662943 0.709937 0.767817 0.80685 0.848328 0.888972 0.930684 0.982056 1.00923 1.04524 1.08545 1.10648];

% 40296
ab1=-12.2381+[0.123435 0.361 0.642345 0.916586 1.19519 1.46204 1.77375 2.12551 2.34097 2.60117 2.8211 3.02098 3.13832 3.25736 3.37072 3.48334 3.6203 3.695 3.79554 3.91144 3.9747];
ab2=446.122+[0.252332 -0.256139 -0.427299 -0.379895 -0.206514 0.0307231 0.353529 0.73885 0.983058 1.29074 1.5621 1.80766 1.93769 2.06453 2.17809 2.2941 2.44456 2.52985 2.64719 2.78735 2.86532];
ab3=-714.556+[-0.468917 -0.299893 -0.148595 -0.0210456 0.0954247 0.196109 0.303344 0.412592 0.473973 0.544084 0.605115 0.672241 0.715769 0.759394 0.802078 0.846125 0.900936 0.93028 0.968826 1.01204 1.03544];

% 25651
ac1=-9.36067+[0.270513 0.698386 1.18356 1.64254 2.09935 2.52788 3.02092 3.57143 3.90505 4.30732 4.6503 4.97156 5.16185 5.34905 5.52557 5.70133 5.91635 6.03356 6.19039 6.37144 6.47035];
ac2=443.597+[0.404337 -0.258137 -0.452092 -0.336711 -0.0466819 0.323938 0.81847 1.40777 1.77871 2.24435 2.65549 3.04022 3.24905 3.44503 3.61842 3.79423 4.01927 4.14517 4.31817 4.52509 4.63943];
ac3=-706.266+[-0.440591 -0.279071 -0.10856 0.035619 0.167518 0.279588 0.397032 0.510235 0.570025 0.63671 0.694142 0.761909 0.804913 0.849116 0.890842 0.933492 0.98625 1.01434 1.05181 1.09403 1.11607];

% 42160
ad1=-14.6392+[0.138744 0.411853 0.72643 1.02916 1.33519 1.62753 1.96783 2.35187 2.58639 2.87124 3.11207 3.33214 3.46172 3.59317 3.71873 3.84341 3.995 4.07773 4.18894 4.31697 4.38699];
ad2=448.856+[0.338222 -0.247361 -0.447059 -0.399217 -0.208271 0.0546971 0.413821 0.843579 1.11539 1.46042 1.76543 2.04386 2.19132 2.33455 2.46237 2.59293 2.76208 2.85787 2.98956 3.14676 3.23406];
ad3=-710.316+[-0.51616 -0.275955 -0.0877778 0.0551988 0.175458 0.273395 0.372317 0.46924 0.522092 0.579634 0.628269 0.682833 0.720314 0.75863 0.797303 0.836981 0.88562 0.91132 0.944656 0.981301 1.00111];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5P
t1=[2 2.05126 2.10091 2.15165 2.20195 2.26309 2.30825 2.35242 2.40115 2.45206 2.50453 2.55201 2.60315 2.66299 2.70555 2.75188 2.8058 2.85226 2.9048 2.95124 3];
% 20212
ae1=-10.8616+[-0.322039 -0.165789 0.0781981 0.410806 0.812012 1.3632 1.79186 2.21459 2.67207 3.13921 3.6064 4.01524 4.44273 4.92112 5.23568 5.53982 5.84466 6.06698 6.2884 6.46835 6.64411];
ae2=446.379+[1.21324 0.846398 0.506397 0.170873 -0.125269 -0.393531 -0.519136 -0.577993 -0.563275 -0.46369 -0.273864 -0.0336133 0.290204 0.736411 1.08264 1.4694 1.9077 2.2698 2.65878 2.97954 3.29369 ];
ae3=-704.985+[-0.790441 -0.87948 -0.66069 -0.410282 -0.188893 0.0339783 0.174882 0.296472 0.414393 0.523728 0.623431 0.702368 0.776819 0.853155 0.902669 0.953151 1.00707 1.04701 1.08613 1.11586 1.14369];

% 40296
af1=-12.2381+[-0.296706 -0.264046 -0.195681 -0.070622 0.122153 0.428312 0.684876 0.946903 1.23444 1.5319 1.83153 2.09382 2.37248 2.6861 2.89147 3.09115 3.28875 3.42984 3.56386 3.6734 3.78173];
af2=446.122+[0.803328 0.455701 0.231503 0.0388672 -0.137844 -0.326502 -0.42493 -0.476261 -0.475295 -0.415776 -0.292499 -0.133296 0.0869921 0.390935 0.625252 0.889113 1.1863 1.42702 1.68002 1.89463 2.10843];
af3=-714.556+[-0.751604 -0.865272 -0.743412 -0.595591 -0.456445 -0.290828 -0.173149 -0.0658828 0.0435315 0.150987 0.25462 0.342411 0.43052 0.52801 0.594269 0.661309 0.733292 0.78661 0.840133 0.88318 0.92481];

% 25651
ag1=-9.36067+[-0.292646 -0.128953 0.129529 0.478309 0.894854 1.46143 1.89938 2.33012 2.79493 3.26912 3.74251 4.15594 4.58786 5.07009 5.38723 5.6932 5.99943 6.22242 6.44393 6.62417 6.80059];
ag2=443.677+[1.15065 0.801021 0.492911 0.195346 -0.0642724 -0.294329 -0.396016 -0.434703 -0.401821 -0.28734 -0.0869042 0.158896 0.485138 0.929123 1.27133 1.65084 2.07908 2.43218 2.81094 3.12346 3.42998];
ag3=-706.563+[-0.648179 -0.762935 -0.587914 -0.387777 -0.212373 -0.0359001 0.0768166 0.175478 0.273402 0.367651 0.457914 0.533262 0.608479 0.691737 0.749552 0.812389 0.882532 0.936602 0.991278 1.03386 1.07405];

% 42160
ah1=-14.6392+[-0.323489 -0.26825 -0.176327 -0.0251912 0.192466 0.531048 0.812653 1.09858 1.41241 1.73645 2.06316 2.35018 2.65433 2.99724 3.22141 3.43902 3.65442 3.80805 3.95441 4.07414 4.19236];
ah2=448.856+[0.94052 0.539131 0.283891 0.0628047 -0.139521 -0.357938 -0.474358 -0.538489 -0.544333 -0.484557 -0.351997 -0.176455 0.0677993 0.408817 0.672918 0.971855 1.31002 1.58413 1.87242 2.11674 2.35995];
ah3=-710.316+[-0.858051 -0.922063 -0.766131 -0.585059 -0.415556 -0.213364 -0.0710907 0.0565966 0.183723 0.3045 0.41601 0.506013 0.591784 0.680237 0.736624 0.789668 0.84333 0.880431 0.915998 0.943483 0.969317];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5P
t2=[2 2.05126 2.11533 2.17471 2.20404 2.25438 2.33159 2.3549 2.4016 2.46738 2.50746 2.55002 2.60679 2.65835 2.71084 2.76368 2.81124 2.86007 2.90407 2.95108 3];

% 20212
ai1=-10.8616+[-0.237609 -0.193265 -0.0887963 0.0612126 0.155431 0.356103 0.763457 0.903668 1.20736 1.67611 1.97762 2.30609 2.75121 3.15999 3.57741 3.99281 4.36119 4.73768 5.07134 5.41413 5.75136];
ai2=446.379+[1.42477 1.27489 1.04451 0.809414 0.689281 0.485744 0.200935 0.122114 -0.0227882 -0.186659 -0.262827 -0.318223 -0.348963 -0.336626 -0.278696 -0.164897 -0.0179814 0.158131 0.350459 0.584657 0.853576 ];
ai3=-704.985+[-0.908536 -0.946269 -0.79775 -0.608722 -0.50798 -0.33535 -0.0954958 -0.0291093 0.095801 0.257661 0.349982 0.442305 0.555942 0.650449 0.738607 0.818623 0.885039 0.949064 1.00514 1.06492 1.12539];

% 40296
aj1=-12.2381+[-0.2408 -0.247864 -0.268056 -0.267446 -0.254527 -0.201078 -0.0214373 0.0506426 0.218127 0.495877 0.680541 0.884709 1.16438 1.4244 1.69397 1.96434 2.20499 2.45315 2.67518 2.90333 3.12729];
aj2=446.122+[0.873877 0.752996 0.60399 0.477056 0.413707 0.30405 0.119079 0.0609542 -0.0517062 -0.190102 -0.258244 -0.311695 -0.35012 -0.355798 -0.325907 -0.253231 -0.155945 -0.0368026 0.0971684 0.259247 0.443336];
aj3=-714.556+[-0.83035 -0.89148 -0.828637 -0.738486 -0.685106 -0.590046 -0.432289 -0.383089 -0.283816 -0.145352 -0.0622606 0.0231839 0.131978 0.226589 0.317908 0.404667 0.48016 0.555414 0.621871 0.693025 0.765488];

% 25651
ak1=-9.36067+[-0.206337 -0.160607 -0.0467705 0.115288 0.216146 0.428671 0.853045 0.998039 1.31066 1.79081 2.09854 2.43303 2.88532 3.29992 3.722 4.14042 4.51057 4.88828 5.22185 5.56377 5.89977];
ak2=443.677+[1.3488 1.20723 0.997782 0.788541 0.682582 0.504401 0.256213 0.18793 0.0634973 -0.0734515 -0.133913 -0.173493 -0.184639 -0.156151 -0.0841496 0.0405105 0.194698 0.376904 0.572356 0.807512 1.07536];
ak3=-706.563+[-0.738806 -0.791569 -0.673413 -0.519867 -0.437886 -0.297849 -0.103122 -0.0494283 0.0510215 0.181436 0.255524 0.329634 0.420969 0.497427 0.5698 0.637309 0.695233 0.75193 0.803626 0.861301 0.922132];

% 42160
al1=-14.6392+[-0.261043 -0.257276 -0.260766 -0.242789 -0.220609 -0.151462 0.0551225 0.135824 0.321645 0.626395 0.828229 1.05116 1.3563 1.63974 1.9334 2.22887 2.49225 2.76362 3.00637 3.25572 3.50021];
al2=448.856+[1.02138 0.879984 0.711211 0.567713 0.495757 0.37163 0.161999 0.0955689 -0.0341948 -0.19537 -0.276083 -0.340759 -0.390443 -0.402931 -0.375676 -0.299629 -0.194955 -0.0661566 0.0803209 0.259432 0.463968 ];
al3=-710.316+[-0.940231 -0.980832 -0.894825 -0.783596 -0.719198 -0.605594 -0.416567 -0.357209 -0.236911 -0.0695015 0.0305503 0.132764 0.261595 0.372221 0.477149 0.574133 0.656074 0.73647 0.805001 0.875549 0.944787];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 20212
am1=-10.8616+[0.090966 0.104096 0.130136 0.168642 0.191584 0.259073 0.326252 0.419897 0.557867 0.69823 0.912803 1.07627 1.27574 1.51794 1.75759 2.06171 2.31868 2.61937 3.02715 3.1701 3.46962 ];
am2=446.379+[0.899489 0.859903 0.778886 0.678783 0.627545 0.500012 0.397297 0.282714 0.146902 0.0367254 -0.0992392 -0.183707 -0.273563 -0.365122 -0.43849 -0.510527 -0.555247 -0.586245 -0.595657 -0.591866 -0.568434];
am3=-704.985+[-0.86313 -0.84767 -0.771637 -0.668588 -0.61491 -0.48333 -0.379851 -0.269533 -0.143461 -0.0442714 0.0769998 0.154807 0.240334 0.333532 0.416887 0.513125 0.587311 0.666449 0.763737 0.796032 0.860374];
% 40296
an1=-12.2381+[-0.0539516 -0.0618996 -0.0988962 -0.141435 -0.16065 -0.197664 -0.216054 -0.218547 -0.196506 -0.152925 -0.0646354 0.0135153 0.115259 0.246 0.381412 0.559626 0.715196 0.902014 1.16051 1.2518 1.44417];
an2=446.122+[0.432532 0.410463 0.381244 0.350428 0.334703 0.291474 0.252203 0.202602 0.129803 0.058745 -0.0429926 -0.113427 -0.192487 -0.277839 -0.349856 -0.425069 -0.474857 -0.51581 -0.544241 -0.548484 -0.544413];
an3=-714.556+[-0.79231 -0.791296 -0.769976 -0.73693 -0.718287 -0.665125 -0.619954 -0.567874 -0.497992 -0.435136 -0.348479 -0.288253 -0.218923 -0.139736 -0.0659577 0.0224045 0.0917822 0.168305 0.266081 0.299118 0.365953];
% 25651
ao1=-9.36067+[0.130737 0.142465 0.169387 0.211481 0.236774 0.311256 0.384768 0.486103 0.633509 0.781547 1.00589 1.17573 1.38212 1.63174 1.87792 2.18945 2.45189 2.75796 3.17161 3.31629 3.61883 ];
ao2=443.677+[0.851766 0.814508 0.741625 0.653437 0.608729 0.497981 0.409251 0.310501 0.193421 0.0983467 -0.0187993 -0.0911601 -0.167493 -0.244027 -0.303691 -0.359622 -0.391821 -0.409453 -0.40252 -0.393348 -0.359363 ];
ao3=-706.563+[-0.739154 -0.729615 -0.668047 -0.583359 -0.539176 -0.430565 -0.345265 -0.254549 -0.150812 -0.0691491 0.0310306 0.0956398 0.166517 0.243495 0.312116 0.391141 0.451934 0.516607 0.595882 0.622127 0.674398];
% 42160
ap1=-14.6392+[-0.0493544 -0.0528663 -0.0812485 -0.114438 -0.129233 -0.155392 -0.165905 -0.159768 -0.126315 -0.072368 0.0304359 0.118846 0.232825 0.378154 0.527688 0.723509 0.893592 1.09735 1.37919 1.47872 1.6885];
ap2=448.856+[0.511745 0.486858 0.455118 0.42176 0.4046 0.356828 0.313453 0.258812 0.177838 0.0981526 -0.0167046 -0.0964205 -0.186167 -0.283519 -0.366182 -0.453246 -0.511592 -0.560989 -0.5979 -0.604488 -0.60399];
ap3=-710.316+[-0.841263 -0.835696 -0.80766 -0.76755 -0.745442 -0.683107 -0.630707 -0.570403 -0.488794 -0.414614 -0.311572 -0.239873 -0.157206 -0.0627291 0.0251199 0.129976 0.212084 0.302413 0.417076 0.455625 0.533172 ];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5P
t4=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3];
% 20212
aq1=-10.8616+[-0.401806 0.705927 1.2661 1.8427 2.23542 2.85034 3.31173 3.79215 4.20818 4.64197 4.97609 5.14928 5.36572 5.58184 5.75525 5.97964 6.0939 6.28133 6.45763 6.6022 6.75212];
aq2=446.379+[1.11968 -0.412459 -0.80117 -0.793354 -0.591649 -0.074039 0.396229 0.917497 1.38835 1.92589 2.36122 2.57682 2.83074 3.07065 3.26514 3.52856 3.66597 3.8953 4.11292 4.29632 4.4881];
aq3=704.985+[0.123842 -0.42807 -0.159158 0.0511561 0.170461 0.326519 0.423394 0.509105 0.572107 0.633105 0.685466 0.717606 0.761873 0.808037 0.845716 0.895482 0.919821 0.95879 0.993851 1.0209 1.04667];
% 40296
ar1=-12.2381+[-0.211763 0.220666 0.514263 0.839501 1.07161 1.45329 1.7493 2.05898 2.32872 2.6071 2.81587 2.92101 3.05441 3.18639 3.29184 3.4265 3.4948 3.60649 3.71182 3.79757 3.88549];
ar2=446.122+[0.668103 -0.408182 -0.616243 -0.602674 -0.471619 -0.124876 0.191492 0.540904 0.855091 1.21653 1.50411 1.64397 1.81191 1.97064 2.10049 2.27632 2.36763 2.52146 2.66921 2.79316 2.9209];
ar3=-714.556+[0.114342 -0.548952 -0.38755 -0.230311 -0.126071 0.0268726 0.132962 0.235643 0.318467 0.402624 0.473086 0.513268 0.564652 0.617719 0.661288 0.718987 0.747649 0.793654 0.836344 0.870501 0.904326];
% 25651
as1=-9.36067+[-0.36511 0.766852 1.34541 1.93766 2.34005 2.96929 3.43998 3.92936 4.35261 4.79271 5.13252 5.3086 5.52719 5.74517 5.91989 6.14572 6.2604 6.44805 6.62451 6.76936 6.91959];
as2=443.677+[1.04913 -0.365597 -0.70379 -0.668113 -0.457936 0.0636526 0.532395 1.05054 1.51756 2.04852 2.47819 2.69123 2.94191 3.17928 3.37169 3.63207 3.7677 3.99389 4.20856 4.38944 4.57851];
as3=-706.563+[0.290135 -0.44961 -0.244023 -0.0617273 0.053886 0.217571 0.325745 0.425017 0.501121 0.5788 0.645999 0.685251 0.737067 0.789391 0.831929 0.88825 0.915942 0.960217 1.00023 1.03167 1.06221];
% 42160
at1=-14.6392+[-0.24874 0.273655 0.600463 0.959449 1.21458 1.63108 1.9533 2.29077 2.58465 2.8892 3.11744 3.23277 3.37915 3.52433 3.64039 3.78863 3.86381 3.9867 4.10255 4.19669 4.29313 ];
at2=448.856+[0.825379 -0.456509 -0.700028 -0.68981 -0.543894 -0.157489 0.196068 0.587479 0.940445 1.34944 1.67688 1.83693 2.02854 2.20942 2.35732 2.55732 2.66103 2.83546 3.00284 3.14322 3.28789];
at3=-710.316+[-0.0104733 -0.488259 -0.28678 -0.109365 -0.00203136 0.144541 0.240737 0.330728 0.400528 0.466312 0.519588 0.55101 0.592491 0.636633 0.672715 0.719893 0.743038 0.779621 0.81311 0.839236 0.864621];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5P
t5=[2 2.05126 2.11533 2.17471 2.20107 2.25991 2.30337 2.35035 2.40415 2.45064 2.51269 2.558 2.61911 2.66482 2.70279 2.77248 2.82013 2.86034 2.91837 2.95368 3 ];
% 20212
au1=-10.8616+[0.0660434 0.0769472 0.10008 0.135971 0.157685 0.221927 0.286234 0.376016 0.504154 0.639354 0.851614 1.02845 1.28866 1.49905 1.68385 2.04388 2.30406 2.53093 2.86846 3.07831 3.35823];
au2=446.379+[0.900609 0.862293 0.784303 0.688186 0.639024 0.516618 0.417508 0.306552 0.178517 0.0699911 -0.0676138 -0.160311 -0.275146 -0.352191 -0.40867 -0.49385 -0.536082 -0.560537 -0.575411 -0.57312 -0.554763];
au3=-704.985+[-0.858817 -0.843372 -0.769475 -0.669828 -0.617753 -0.48911 -0.387576 -0.278203 -0.1568 -0.057488 0.0675674 0.15425 0.266406 0.347421 0.412771 0.528404 0.603557 0.664353 0.747783 0.796566 0.858001];
% 40296
av1=-12.2381+[-0.0560071 -0.0625134 -0.0973116 -0.137405 -0.155683 -0.191651 -0.209876 -0.213752 -0.195 -0.154657 -0.0699903 0.0133894 0.146435 0.260502 0.364476 0.574672 0.732433 0.872817 1.08523 1.21859 1.3976];
av2=446.122+[0.402313 0.381058 0.35498 0.327331 0.313095 0.273635 0.236241 0.188921 0.122219 0.0544529 -0.045216 -0.120625 -0.220229 -0.291157 -0.345812 -0.433909 -0.481442 -0.512872 -0.542246 -0.55094 -0.549849];
av3=-714.556+[-0.792025 -0.790604 -0.768724 -0.734876 -0.716113 -0.663716 -0.618893 -0.568187 -0.502351 -0.440824 -0.353957 -0.288069 -0.197885 -0.1295 -0.0724073 0.0322434 0.101945 0.159961 0.241926 0.291 0.35383];
% 25651
aw1=-9.36067+[0.107468 0.116833 0.140437 0.179446 0.203278 0.273947 0.344229 0.441322 0.578314 0.721085 0.943219 1.12705 1.39619 1.61293 1.80278 2.17153 2.43709 2.66803 3.01065 3.2231 3.50591];
aw2=443.677+[0.85269 0.816554 0.746247 0.661487 0.618589 0.512443 0.426927 0.331492 0.221354 0.127859 0.00953901 -0.0697347 -0.16685 -0.230841 -0.276641 -0.342655 -0.372346 -0.386617 -0.387553 -0.377202 -0.348813 ];
aw3=-706.563+[-0.73196 -0.722321 -0.662618 -0.580946 -0.538203 -0.432287 -0.348674 -0.2588 -0.158933 -0.077198 0.026014 0.0979643 0.190792 0.257645 0.311451 0.406472 0.468122 0.517855 0.585909 0.625613 0.67553];
% 42160
ax1=-14.6392+[-0.0511071 -0.0531415 -0.0792875 -0.109906 -0.123759 -0.148981 -0.159307 -0.154711 -0.125106 -0.0745853 0.0246096 0.119192 0.268163 0.394832 0.509684 0.740655 0.913043 1.06619 1.29772 1.44317 1.63836];
ax2=448.856+[0.478028 0.454124 0.426046 0.396294 0.380812 0.337303 0.295871 0.243746 0.169693 0.0937878 -0.018545 -0.103858 -0.216915 -0.297913 -0.360668 -0.462662 -0.518575 -0.556385 -0.593342 -0.605725 -0.608187];
ax3=-710.316+[-0.838366 -0.832484 -0.804231 -0.763549 -0.741448 -0.680274 -0.628259 -0.569566 -0.492829 -0.420387 -0.317405 -0.239129 -0.131876 -0.050481 0.0173932 0.141466 0.223848 0.292285 0.388518 0.445843 0.518798];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5P
t6=[2 2.06926 2.11039 2.16205 2.20253 2.25469 2.30237 2.35235 2.40447 2.45402 2.50951 2.55995 2.60457 2.66104 2.70282 2.76219 2.80057 2.85371 2.90136 2.95138 3];
% 20212
ay1=-10.8616+[-0.401788 0.207996 0.64173 1.20552 1.6386 2.16658 2.6249 3.09682 3.57998 4.02847 4.50886 4.90247 5.19755 5.49188 5.68047 5.91726 6.05921 6.24661 6.4105 6.57806 6.73673];
ay2=446.379+[1.12007 0.259788 -0.148321 -0.508909 -0.656497 -0.671201 -0.541156 -0.28253 0.0948561 0.524349 1.05948 1.56285 1.98137 2.43722 2.72112 3.06447 3.26803 3.52865 3.748 3.97067 4.18552];
ay3=-704.985+[0.122619 -0.635024 -0.371058 -0.111814 0.046428 0.209993 0.334209 0.447815 0.550331 0.631289 0.705127 0.758015 0.799899 0.843125 0.873053 0.915835 0.942732 0.977792 1.00796 1.03834 1.06594];
% 40296
az1=-12.2381+[-0.211769 -0.0829505 0.125237 0.428312 0.678319 0.994465 1.27771 1.5758 1.88439 2.17381 2.48451 2.74029 2.92708 3.10861 3.2228 3.36681 3.45214 3.56413 3.66244 3.76234 3.85547 ];
az2=446.122+[0.66834 0.0113813 -0.236247 -0.452147 -0.551361 -0.569258 -0.484596 -0.312308 -0.0559123 0.23433 0.597236 0.940987 1.22284 1.53369 1.72866 1.96706 2.1083 2.28846 2.44002 2.59307 2.73694];
az3=-714.556+[0.113813 -0.701168 -0.535692 -0.368988 -0.250427 -0.11331 -0.00089719 0.111091 0.220521 0.31592 0.412689 0.48907 0.551119 0.614559 0.657189 0.713872 0.748825 0.79435 0.833565 0.873235 0.909799];
% 25651
ba1=-9.36067+[-0.365092 0.260869 0.710594 1.2917 1.73521 2.27418 2.74119 3.22171 3.71263 4.16796 4.65521 5.05365 5.35324 5.65107 5.84158 6.08052 6.22367 6.41235 6.57699 6.74518 6.90419];
ba2=443.677+[1.04957 0.257431 -0.107346 -0.421365 -0.542001 -0.532789 -0.388737 -0.121514 0.259341 0.687946 1.21852 1.71438 2.12553 2.57098 2.84874 3.18551 3.38536 3.64142 3.85715 4.07632 4.28763];
ba3=-706.563+[0.28882 -0.579963 -0.374526 -0.174073 -0.0478677 0.0898191 0.201386 0.310434 0.415215 0.504017 0.591265 0.660176 0.717751 0.780457 0.82188 0.877194 0.911168 0.954745 0.991409 1.02803 1.06173];
% 42160
bb1=-14.6392+[-0.248732 -0.0579431 0.180848 0.516942 0.792252 1.1395 1.44916 1.77388 2.11041 2.42584 2.76474 3.04376 3.247 3.44467 3.56948 3.7272 3.82073 3.94359 4.05153 4.16114 4.26337];
bb2=448.856+[0.825649 0.0301473 -0.255655 -0.506578 -0.623574 -0.649826 -0.559883 -0.371269 -0.0868709 0.237545 0.645764 1.03466 1.35545 1.71029 1.93261 2.20402 2.36469 2.56949 2.74148 2.91499 3.07799];
bb3=-710.316+[-0.0110182 -0.698686 -0.491704 -0.284867 -0.141684 0.0169909 0.139856 0.255474 0.361739 0.448788 0.530734 0.589269 0.633634 0.675347 0.704405 0.744826 0.770103 0.803381 0.832581 0.862097 0.889046];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35451 2.40116 2.45302 2.50151 2.55488 2.60159 2.66574 2.70148 2.76497 2.80618 2.85814 2.90512 2.97561 3];
% 20212
bc1=-10.8616+[0.14562 0.163179 0.206504 0.264083 0.353213 0.402339 0.557441 0.662499 0.816719 1.01283 1.21876 1.46723 1.70189 2.04872 2.25133 2.6251 2.87412 3.19523 3.49192 3.94515 4.10327];
bc2=446.379+[1.07675 1.02405 0.92132 0.81871 0.683693 0.619272 0.452441 0.356965 0.241407 0.119591 0.0128901 -0.0930258 -0.173288 -0.260715 -0.297879 -0.335685 -0.346397 -0.337697 -0.305825 -0.215535 -0.174401];
bc3=-704.985+[-0.585003 -0.563132 -0.471778 -0.371027 -0.239242 -0.178518 -0.0258957 0.0580031 0.157732 0.263714 0.358338 0.457888 0.541642 0.652224 0.711536 0.812267 0.875192 0.950154 1.01412 1.1043 1.13407];
% 40296
bd1=-12.2381+[0.00596392 -0.00202293 -0.0327864 -0.0552893 -0.0737004 -0.0763626 -0.0588637 -0.0341256 0.0186066 0.099701 0.197085 0.325173 0.453814 0.654573 0.774887 1.00102 1.15315 1.35292 1.54058 1.83025 1.93193];
bd2=446.122+[0.498484 0.469304 0.435087 0.404959 0.3631 0.340719 0.268701 0.217583 0.144127 0.0560761 -0.0283068 -0.118833 -0.19261 -0.277179 -0.315514 -0.362237 -0.38186 -0.388566 -0.375336 -0.322645 -0.297197 ];
bd3=-714.556+[-0.522187 -0.520275 -0.495236 -0.462518 -0.414903 -0.392275 -0.325115 -0.280614 -0.218389 -0.144884 -0.0740967 0.00524487 0.0755572 0.172518 0.226454 0.321589 0.382732 0.45732 0.522888 0.618051 0.650474];
% 25651
be1=-9.36067+[0.185688 0.201951 0.24686 0.308551 0.404408 0.457272 0.622875 0.734221 0.896189 1.10067 1.31407 1.5703 1.81146 2.16641 2.37318 2.75358 3.00632 3.33128 3.63051 4.08616 4.24484 ];
be2=443.677+[1.01382 0.964108 0.87154 0.781321 0.66368 0.607844 0.463667 0.381193 0.281447 0.17661 0.0852414 -0.00440525 -0.0708934 -0.1399 -0.166998 -0.187736 -0.187765 -0.166689 -0.124716 -0.0210477 0.024263];
be3=-706.563+[-0.430726 -0.416138 -0.342825 -0.261251 -0.154551 -0.105503 0.0176476 0.0853393 0.165855 0.251725 0.328519 0.409403 0.47759 0.567287 0.615163 0.696453 0.747042 0.807473 0.85915 0.932297 0.956608];
% 42160
bf1=-14.6392+[0.0086072 0.00537656 -0.0160391 -0.0298295 -0.0370811 -0.0350435 -0.00475831 0.0279811 0.0920287 0.186846 0.297773 0.441382 0.584111 0.805202 0.937353 1.1857 1.35286 1.57222 1.77803 2.09534 2.2067];
bf2=448.856+[0.623689 0.591221 0.553911 0.520514 0.473892 0.449032 0.368432 0.310531 0.227143 0.12733 0.0314729 -0.0717762 -0.156551 -0.255036 -0.300451 -0.357732 -0.383151 -0.395352 -0.385282 -0.333764 -0.307876];
bf3=-710.316+[-0.603201 -0.596197 -0.563607 -0.523656 -0.466395 -0.439365 -0.359057 -0.305447 -0.230233 -0.141333 -0.0555869 0.0404614 0.125419 0.242028 0.306656 0.419921 0.492351 0.580218 0.656767 0.766195 0.803025];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5P
t14=[2 2.05026 2.12154 2.15397 2.21175 2.26507 2.30594 2.35377 2.40753 2.45988 2.50332 2.56615 2.60113 2.66023 2.70008 2.7573 2.80337 2.85729 2.91233 2.96086 3];
% 20212
bg1=-10.8616+[-0.290584 0.0216678 0.624785 0.925041 1.4705 1.97414 2.34875 2.77565 3.24431 3.69483 4.06453 4.5922 4.8793 5.32423 5.57304 5.85497 6.04597 6.24275 6.4271 6.58343 6.70689];
bg2=446.379+[1.36888 0.843886 0.241498 0.0287693 -0.245787 -0.363002 -0.358797 -0.258524 -0.0269463 0.281043 0.592713 1.11011 1.42952 1.98363 2.34012 2.80073 3.12158 3.44762 3.74051 3.97747 4.15823];
bg3=-704.985+[-0.492421 -0.544743 -0.154014 -0.00040768 0.224546 0.389456 0.496097 0.605039 0.709998 0.798616 0.8603 0.933506 0.967394 1.01409 1.04201 1.07623 1.10032 1.12745 1.15331 1.17467 1.19101];
% 40296
bh1=-12.2381+[-0.262043 -0.14277 0.13082 0.282345 0.58127 0.876298 1.10196 1.36387 1.65771 1.94405 2.18131 2.52349 2.71131 3.00299 3.16291 3.34403 3.46406 3.58452 3.6953 3.78859 3.86024];
bh2=446.122+[0.846901 0.380824 0.0346031 -0.0875946 -0.266187 -0.353899 -0.356992 -0.295853 -0.142151 0.0650787 0.276599 0.628707 0.849299 1.23079 1.47248 1.79079 2.01412 2.2409 2.44377 2.60688 2.72812];
bh3=-714.556+[-0.447652 -0.552333 -0.334001 -0.242904 -0.0866952 0.0458214 0.138371 0.239526 0.344374 0.440294 0.514 0.612726 0.663584 0.741709 0.789197 0.845253 0.883665 0.924824 0.963367 0.994953 1.01894 ];
% 25651
bi1=-9.36067+[-0.2566 0.062668 0.689029 0.999333 1.55994 2.07456 2.45608 2.8901 3.36649 3.82402 4.19863 4.73352 5.0235 5.47264 5.72484 6.00953 6.20216 6.40069 6.58654 6.74384 6.86784];
bi2=443.677+[1.29559 0.793442 0.252746 0.0660937 -0.169513 -0.259206 -0.239119 -0.12541 0.115834 0.429202 0.742252 1.25876 1.57537 2.12202 2.47245 2.92291 3.23676 3.55609 3.84348 4.07628 4.25398];
bi3=-706.563+[-0.323524 -0.413657 -0.111084 0.00796113 0.183672 0.315576 0.404268 0.499518 0.597289 0.684563 0.748914 0.830474 0.871435 0.933711 0.974339 1.02715 1.06386 1.1034 1.13957 1.16861 1.19047];
% 42160
bk1=-14.6392+[-0.294117 -0.14205 0.174396 0.344259 0.675857 1.00133 1.2498 1.53755 1.85885 2.17159 2.43122 2.80474 3.01037 3.32958 3.50399 3.70179 3.83306 3.96508 4.08674 4.18922 4.26796 ];
bk2=448.856+[1.02023 0.491676 0.0927792 -0.0482587 -0.25686 -0.362768 -0.371526 -0.308251 -0.141612 0.0859358 0.32034 0.71167 0.958315 1.38689 1.66045 2.02117 2.27407 2.53075 2.76015 2.94433 3.08106];
bk3=-710.316+[-0.582165 -0.624731 -0.346561 -0.232742 -0.0389821 0.121613 0.229833 0.343148 0.453957 0.550359 0.620653 0.709523 0.752023 0.812174 0.845069 0.879953 0.903052 0.928508 0.953156 0.973782 0.989746];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of lateral bending (5P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of lateral bending(5P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
