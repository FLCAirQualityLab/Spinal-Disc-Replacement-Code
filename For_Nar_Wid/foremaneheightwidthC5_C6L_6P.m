%% this code finds c5-c6 left handed side foreman height and width narrowing/widening under lateral bending (6P)
clf
clear all
k=21;
%% model15_intact/TLC_6P
t15=[2,2.0575,2.1047,2.15542,2.20899,2.25434,2.30803,2.35883,2.40461,2.45206,2.5051,2.55493,2.60055,2.6508,2.70761,2.75783,2.80375,2.85877,2.90932,2.95288,3];
%52253I
aa1=8.79613+[0.0773793,0.0823729,0.114084,0.169097,0.238048,0.300225,0.382124,0.455336,0.51588,0.572523,0.627619,0.672955,0.711654,0.750898,0.791623,0.824497,0.852823,0.88436,0.911169,0.932285,0.953197];
aa2=445.506+[-0.182232,0.0450857,0.246465,0.451682,0.669872,0.841557,1.01196,1.13814,1.23544,1.32222,1.40751,1.47897,1.53317,1.58453,1.63433,1.6741,1.70785,1.74425,1.77528,1.80077,1.82645];
aa3=-724.269+[-0.731418,-0.855178,-0.930323,-0.993545,-1.06708,-1.12424,-1.19769,-1.27399,-1.33414,-1.38809,-1.44171,-1.48845,-1.52834,-1.56689,-1.60547,-1.63607,-1.66212,-1.69069,-1.71484,-1.73374,-1.75229];

%58363R
ab1=15.2185+[0.071198,0.059183,0.0727535,0.106131,0.145589,0.178989,0.224641,0.264277,0.296917,0.327022,0.356835,0.38222,0.403813,0.425238,0.446744,0.463578,0.478119,0.493915,0.507243,0.517699,0.527727];
ab2=451.452+[-0.206034,-0.022771,0.138581,0.306726,0.474038,0.610646,0.747692,0.854738,0.938851,1.01468,1.08674,1.14476,1.1895,1.23222,1.27382,1.30651,1.33436,1.36411,1.38836,1.40759,1.42665];
ab3=-725.54+[-0.393421,-0.475286,-0.53374,-0.606403,-0.682968,-0.7458,-0.827113,-0.89521,-0.949264,-0.997392,-1.04272,-1.07935,-1.10939,-1.13762,-1.16421,-1.18389,-1.20039,-1.21733,-1.23052,-1.24027,-1.24883];

%36619U
ac1=13.469+[0.091201,0.0766222,0.0867951,0.116955,0.161163,0.203504,0.26609,0.325835,0.374473,0.419,0.460971,0.49433,0.522739,0.550692,0.578784,0.600671,0.619017,0.638688,0.654619,0.666361,0.677218];
ac2=448.169+[-0.108023,0.220864,0.499071,0.775556,1.06584,1.29198,1.51819,1.68984,1.82263,1.94133,2.05828,2.15702,2.23327,2.30612,2.37754,2.43478,2.48384,2.53745,2.5835,2.62121,2.65928];
ac3=-721.068+[-0.814338,-1.00105,-1.11642,-1.21165,-1.32036,-1.40389,-1.50743,-1.61314,-1.69479,-1.7664,-1.83634,-1.89653,-1.94664,-1.99339,-2.03848,-2.07327,-2.10256,-2.1339,-2.15978,-2.17935,-2.19779];

%57675L
ad1=12.0806+[0.0350013,0.0225366,0.0354941,0.0651575,0.100869,0.131417,0.171108,0.20591,0.235016,0.262475,0.290274,0.314332,0.33493,0.355825,0.377347,0.39461,0.409681,0.426407,0.440834,0.452443,0.463949];
ad2=448.924+[-0.164776,-0.0172886,0.117896,0.258776,0.398812,0.513124,0.626571,0.715271,0.78518,0.848511,0.909206,0.958479,0.996708,1.03369,1.0703,1.09948,1.12435,1.15129,1.17359,1.19147,1.20951];
ad3=-730.705+[-0.390943,-0.455592,-0.500964,-0.557887,-0.618364,-0.668053,-0.733542,-0.789136,-0.833607,-0.87358,-0.911747,-0.943015,-0.969085,-0.994066,-1.01819,-1.03643,-1.05184,-1.06806,-1.08109,-1.091,-1.10013];

xa1=[ab1-aa1];
xa2=[ab2-aa2];
xa3=[ab3-aa3];
ya1=[ac1-ad1];
ya2=[ac2-ad2];
ya3=[ac3-ad3];
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];
for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end
figure(1)
plot(t15,-1*width15,'k')
hold on
plot(t15,-1*height15,'b')

%% Percent change
figure(2)

pc15x=100-mag15x(21)/mag15x(1)*100;
pc15y=100-mag15y(21)/mag15y(1)*100;
pc15=[pc15y,pc15x];
b=bar(pc15);

pc15x=100-mag15x(21)/mag15x(1)*100;
pc15y=100-mag15y(21)/mag15y(1)*100;
pc15=[pc15y,pc15x];

pc1x=100-mag1x(21)/mag1x(1)*100;
pc1y=100-mag1y(21)/mag1y(1)*100;
pc1=[pc1y,pc1x];

pc2x=100-mag2x(21)/mag2x(1)*100;
pc2y=100-mag2y(21)/mag2y(1)*100;
pc2=[pc2y,pc2x];

pc3x=100-mag3x(21)/mag3x(1)*100;
pc3y=100-mag3y(21)/mag3y(1)*100;
pc3=[pc3y,pc3x];

pc4x=100-mag4x(21)/mag4x(1)*100;
pc4y=100-mag4y(21)/mag4y(1)*100;
pc4=[pc4y,pc4x];

pc5x=100-mag5x(21)/mag5x(1)*100;
pc5y=100-mag5y(21)/mag5y(1)*100;
pc5=[pc5y,pc5x];

pc6x=100-mag6x(21)/mag6x(1)*100;
pc6y=100-mag6y(21)/mag6y(1)*100;
pc6=[pc6y,pc6x];

pc13x=100-mag13x(21)/mag13x(1)*100;
pc13y=100-mag13y(21)/mag13y(1)*100;
pc13=[pc13y,pc13x];

pc14x=100-mag14x(21)/mag14x(1)*100;
pc14y=100-mag14y(21)/mag14y(1)*100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)

