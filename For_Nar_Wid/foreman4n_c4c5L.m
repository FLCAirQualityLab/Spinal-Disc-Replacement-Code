%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under lateral bending (4n)
% 36572,16215,31500,37435
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 36572,16215,31500,37435
%% model15_intact_TLC_4N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 36572
aa1=12.3763+[0.111599 0.15986 0.185914 0.19747 0.203712 0.208993 0.219441 0.226989 0.239929 0.254874 0.267599 0.285957 0.315241 0.362759 0.398444 0.422816 0.439706 0.433623 0.405571 0.37714 0.347518 ];
aa2=446.738+[0.535552 0.410717 0.481027 0.721713 1.10293 1.59482 2.17872 2.80354 3.4449 4.12468 4.80289 5.51652 6.2308 6.96945 7.60214 8.22469 8.76485 9.21839 9.62732 9.95028 10.2624];
aa3=-714.659+[-0.774879 -0.81375 -0.841349 -0.876855 -0.924389 -0.985651 -1.07411 -1.1865 -1.31419 -1.46092 -1.62295 -1.81077 -2.02646 -2.28365 -2.53663 -2.80619 -3.05804 -3.27295 -3.4694 -3.62901 -3.78536];

% 16215
ab1=12.1679+[0.223784 0.297612 0.33563 0.353914 0.364779 0.373267 0.385443 0.392765 0.401242 0.409498 0.414837 0.420238 0.438448 0.481427 0.519423 0.543786 0.556761 0.538684 0.495527 0.455641 0.414508];
ab2=446.385+[0.866838 0.779566 0.963096 1.36508 1.94721 2.67553 3.53781 4.45537 5.38331 6.34957 7.30325 8.301 9.29239 10.3101 11.1858 12.0527 12.8183 13.4782 14.0802 14.563 15.0321];
ab3=-705.203+[-0.935817 -0.979634 -1.01334 -1.05688 -1.11635 -1.19715 -1.31923 -1.4773 -1.65805 -1.86615 -2.09817 -2.37217 -2.68291 -3.04579 -3.4006 -3.78151 -4.1455 -4.47404 -4.78362 -5.04127 -5.29859];

% 31500
ac1=9.70641+[0.238644 0.312293 0.351151 0.3718 0.386401 0.399211 0.415569 0.427009 0.439076 0.45029 0.458596 0.467511 0.48913 0.537036 0.579538 0.60843 0.625105 0.609681 0.56933 0.531818 0.493211];
ac2=444.062+[0.758958 0.660705 0.821312 1.19131 1.73456 2.41964 3.23487 4.10592 4.991 5.91703 6.834 7.79609 8.75453 9.73906 10.5871 11.4283 12.1727 12.816 13.4035 13.8753 14.3342];
ac3=-707.068+[-0.814455 -0.842915 -0.845387 -0.845483 -0.850914 -0.868432 -0.916257 -0.995476 -1.0976 -1.22532 -1.37856 -1.57065 -1.799 -2.07399 -2.34849 -2.64758 -2.93583 -3.19695 -3.44336 -3.64817 -3.85251];

% 37435
ad1=16.2708+[0.132811 0.189102 0.218792 0.231559 0.23747 0.241395 0.250212 0.255427 0.265072 0.275921 0.284249 0.296965 0.321636 0.365935 0.400606 0.423062 0.437238 0.426881 0.394174 0.36175 0.328176];
ad2=449.059+[0.698641 0.570398 0.666189 0.956544 1.40726 1.98302 2.66268 3.38716 4.12712 4.90684 5.68088 6.49119 7.29954 8.13579 8.85333 9.55981 10.1746 10.6909 11.1564 11.5244 11.8802];
ad3=-710.186+[-0.884108 -0.928776 -0.974867 -1.04114 -1.13095 -1.2443 -1.39496 -1.57486 -1.77196 -1.99217 -2.228 -2.49306 -2.7889 -3.13542 -3.4721 -3.82739 -4.15791 -4.43973 -4.69764 -4.90743 -5.11363 ];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3']
y15=[ya1',ya2',ya3']

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];
% 36572
ae1=12.3763+[-0.296363 -0.276183 -0.229378 -0.189016 -0.170696 -0.137518 -0.0986089 -0.0668285 -0.0363818 -0.0139101 0.00658062 0.0208926 0.0338118 0.0489831 0.0580263 0.062585 0.0600333 0.0538842 0.0392102 0.0248864 0.00855437];
ae2=446.738+[0.797079 0.612431 0.405458 0.264586 0.212382 0.167102 0.168774 0.216718 0.32723 0.4574 0.626133 0.792062 0.99284 1.26532 1.5158 1.80932 2.12994 2.41229 2.80359 3.1418 3.54005];
ae3=-714.659+[-0.615151 -0.807318 -0.858539 -0.877244 -0.882193 -0.891506 -0.90078 -0.907893 -0.919679 -0.931498 -0.944772 -0.957066 -0.972352 -0.997652 -1.01688 -1.03892 -1.06513 -1.09036 -1.13574 -1.18169 -1.24257];

% 16215
af1=12.1679+[-0.324978 -0.27913 -0.21845 -0.16062 -0.130043 -0.0812277 -0.033039 0.00577611 0.0422631 0.0666357 0.0877668 0.101153 0.110757 0.112991 0.108251 0.0979573 0.0817144 0.062251 0.0283681 -0.00538582 -0.0466784];
af2=446.385+[1.47688 1.38358 1.35726 1.40214 1.44614 1.55366 1.7289 1.9578 2.28527 2.60155 2.97478 3.31904 3.71661 4.22768 4.68279 5.19878 5.74146 6.21028 6.85051 7.39346 8.0157];
af3=-705.203+[-0.848839 -1.10366 -1.22258 -1.30421 -1.34212 -1.40215 -1.46701 -1.53007 -1.60738 -1.67587 -1.75305 -1.82296 -1.90368 -1.99723 -2.07931 -2.17305 -2.27609 -2.37065 -2.51486 -2.64726 -2.80659];

% 31500
ag1=9.70641+[-0.300144 -0.255196 -0.194225 -0.135075 -0.103801 -0.054013 -0.0042166 0.0369545 0.0763655 0.1032 0.126905 0.142457 0.154325 0.159251 0.156815 0.149074 0.135146 0.117459 0.0857011 0.0536317 0.0140439];
ag2=444.066+[1.35021 1.24445 1.19261 1.21139 1.24186 1.32763 1.47854 1.68208 1.97893 2.26912 2.61432 2.93472 3.30652 3.78526 4.21379 4.70213 5.21861 5.66667 6.28088 6.80364 7.40493];
ag3=-707.086+[-0.716544 -0.953132 -1.03636 -1.08151 -1.10008 -1.12807 -1.1565 -1.1811 -1.21007 -1.23549 -1.26423 -1.29103 -1.32295 -1.35185 -1.37766 -1.40956 -1.44973 -1.49107 -1.5634 -1.6355 -1.72693];

% 37435
ah1=16.2708+[-0.32538 -0.296659 -0.239229 -0.191023 -0.169499 -0.131308 -0.0883305 -0.0544395 -0.0222758 0.00137839 0.0224921 0.0366226 0.0489376 0.0632592 0.0705333 0.0722759 0.0662134 0.0566793 0.0371958 0.018579 -0.00288881];
ah2=449.059+[0.940437 0.728511 0.513521 0.375761 0.327794 0.293459 0.31078 0.380216 0.524228 0.68801 0.896838 1.09988 1.3434 1.6706 1.96858 2.31475 2.68942 3.01655 3.46671 3.85389 4.30854 ];
ah3=-710.186+[-0.667767 -0.853123 -0.909776 -0.937372 -0.947663 -0.967705 -0.989452 -1.01061 -1.0431 -1.07554 -1.11315 -1.14774 -1.18888 -1.24823 -1.29693 -1.35173 -1.41201 -1.46581 -1.54953 -1.62809 -1.7275];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4N
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3 ];

% 36572
ai1=12.3763+[-0.24139 -0.220976 -0.179121 -0.143894 -0.126158 -0.0936448 -0.0596367 -0.0280245 -0.00382705 0.011068 0.0290848 0.0506473 0.0706134 0.0884622 0.0985794 0.103654 0.10493 0.0976655 0.0819633 0.0630372 0.037512];
ai2=446.738+[0.905469 0.759845 0.573669 0.441404 0.392741 0.350053 0.345895 0.399043 0.500324 0.602806 0.766362 0.897127 1.01438 1.14754 1.27088 1.40236 1.52894 1.66912 1.8521 2.0414 2.27122 ];
ai3=-714.659+[-0.763679 -0.884911 -0.915679 -0.925512 -0.929276 -0.937596 -0.943552 -0.950347 -0.959453 -0.967433 -0.985592 -1.00813 -1.0194 -1.02258 -1.01969 -1.01113 -1.00039 -0.986644 -0.973672 -0.968898 -0.970649 ];

% 16215
aj1=12.1679+[-0.242242 -0.198346 -0.142026 -0.0870473 -0.0584009 -0.013942 0.0256836 0.0644542 0.0919145 0.109745 0.129814 0.13693 0.13795 0.13253 0.1204 0.101083 0.0751609 0.0417704 -0.0042443 -0.0493771 -0.105759 ];
aj2=446.385+[1.74178 1.65451 1.62989 1.6741 1.71773 1.82742 1.98976 2.25484 2.55918 2.81802 3.19964 3.53374 3.87826 4.28942 4.68645 5.13806 5.5746 6.04705 6.58251 7.06646 7.62162];
aj3=-705.203+[-1.05161 -1.2135 -1.30408 -1.37571 -1.41154 -1.47105 -1.53084 -1.60235 -1.67239 -1.72661 -1.78475 -1.77918 -1.7476 -1.70548 -1.66711 -1.62549 -1.59411 -1.56954 -1.56588 -1.58014 -1.60971 ];

% 31500
ak1=9.70641+[-0.21745 -0.173502 -0.116084 -0.0594068 -0.0300033 0.0156675 0.0570509 0.0986222 0.128798 0.148679 0.171392 0.180845 0.184547 0.182115 0.172481 0.155691 0.131825 0.100291 0.0555373 0.0112944 -0.0444815];
ak2=444.066+[1.58819 1.49111 1.44332 1.46281 1.49341 1.58179 1.72154 1.95783 2.23445 2.47207 2.82201 3.12153 3.42937 3.79968 4.16064 4.57466 4.97912 5.42163 5.93025 6.39514 6.93305];
ak3=-707.086+[-0.881612 -1.02966 -1.08799 -1.12482 -1.14167 -1.16936 -1.19476 -1.22139 -1.24635 -1.2646 -1.26616 -1.19445 -1.08806 -0.95545 -0.829091 -0.68539 -0.555616 -0.426061 -0.311096 -0.23176 -0.157661];

% 37435
al1=16.2708+[-0.262384 -0.233691 -0.182316 -0.140341 -0.119465 -0.0824389 -0.0453519 -0.0119444 0.0133945 0.0288536 0.0472476 0.0696774 0.0902496 0.108107 0.117361 0.12074 0.119906 0.109493 0.089408 0.0660264 0.0352415];
al2=449.059+[1.06927 0.907029 0.71583 0.587011 0.54294 0.510863 0.520608 0.598172 0.729807 0.858832 1.06095 1.22198 1.36749 1.53247 1.68405 1.84483 1.99852 2.167 2.38416 2.6057 2.87177];
al3=-710.186+[-0.835382 -0.955077 -0.991787 -1.0098 -1.0191 -1.03763 -1.0543 -1.07671 -1.10445 -1.12857 -1.17016 -1.212 -1.24137 -1.26461 -1.27899 -1.28785 -1.29301 -1.29526 -1.30167 -1.31541 -1.33822 ];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3 ];
% 36572
am1=12.3763+[-0.0625365 -0.052131 -0.0313368 -0.0140513 -0.00112796 0.0162404 0.0359868 0.0510703 0.0623745 0.073509 0.0824743 0.0907061 0.0960326 0.103147 0.113684 0.12361 0.12979 0.132777 0.130958 0.125257 0.118364];
am2=446.738+[0.664822 0.600097 0.468152 0.358047 0.274865 0.18356 0.114396 0.0795032 0.0707684 0.0953681 0.141984 0.22051 0.305278 0.411185 0.542105 0.70161 0.857011 1.02999 1.25558 1.46832 1.63579 ];
am3=-714.659+[-1.00175 -1.01322 -1.00779 -0.99966 -0.991779 -0.983431 -0.976509 -0.968065 -0.959677 -0.952704 -0.948169 -0.94375 -0.941123 -0.942975 -0.946113 -0.948124 -0.949749 -0.952485 -0.957012 -0.963266 -0.970583];
% 16215
an1=12.1679+[0.0741139 0.090887 0.113354 0.129675 0.141975 0.158221 0.175618 0.187569 0.198507 0.208241 0.215416 0.223544 0.228686 0.23079 0.228261 0.221953 0.212809 0.201441 0.183281 0.162428 0.143879];
an2=446.385+[1.46322 1.41909 1.38692 1.39084 1.40461 1.44186 1.51712 1.62343 1.7665 1.96294 2.15841 2.41168 2.64381 2.90472 3.20354 3.5492 3.87627 4.22972 4.67522 5.08549 5.40174 ];
an3=-705.203+[-1.33312 -1.35779 -1.38607 -1.41295 -1.43642 -1.46998 -1.50965 -1.54553 -1.58342 -1.62787 -1.66774 -1.71533 -1.75751 -1.80014 -1.84365 -1.89353 -1.94225 -1.99725 -2.06995 -2.14237 -2.20226];
% 31500
ao1=9.70641+[0.100468 0.117419 0.140566 0.157852 0.171025 0.188292 0.206978 0.220532 0.233268 0.244991 0.253833 0.263922 0.270746 0.274491 0.27362 0.269061 0.26153 0.251749 0.235187 0.215658 0.198129];
ao2=444.066+[1.29841 1.25081 1.20533 1.19503 1.19669 1.21728 1.27378 1.36227 1.48611 1.66044 1.83663 2.06724 2.28034 2.52034 2.7963 3.11743 3.42267 3.75411 4.17414 4.56263 4.86304];
ao3=-707.086+[-1.14938 -1.1693 -1.17923 -1.18628 -1.1927 -1.20221 -1.21437 -1.22372 -1.23216 -1.24155 -1.24975 -1.2589 -1.26772 -1.27225 -1.27235 -1.27345 -1.27681 -1.28376 -1.29727 -1.31586 -1.33465 ];
% 37435
ap1=16.2708+[-0.0527419 -0.0396774 -0.0146083 0.00586642 0.0209923 0.0412226 0.0634128 0.0795696 0.0914114 0.103058 0.112442 0.120928 0.126044 0.132939 0.143093 0.151922 0.156521 0.157349 0.152266 0.143506 0.134249 ];
ap2=449.059+[0.808319 0.737642 0.599776 0.487292 0.403202 0.314295 0.250232 0.221863 0.22362 0.265329 0.330562 0.434082 0.542507 0.675484 0.837749 1.03325 1.22223 1.43124 1.70137 1.95381 2.15137];
ap3=-710.186+[-1.08969 -1.10037 -1.09569 -1.08919 -1.08294 -1.07872 -1.07707 -1.07331 -1.07132 -1.07449 -1.08096 -1.0912 -1.1022 -1.11996 -1.14177 -1.16502 -1.18634 -1.2102 -1.24091 -1.27096 -1.29661];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 36572
aq1=12.3763+[-0.215014 0.100606 0.154006 0.170191 0.184808 0.198458 0.206964 0.214476 0.226222 0.238462 0.237408 0.235129 0.2381 0.239939 0.228694 0.220372 0.212808 0.217936 0.215736 0.212301 0.204485];
aq2=446.738+[0.808702 0.209003 0.592599 1.12165 1.80053 2.50237 3.33418 4.09303 4.80674 5.39714 5.89623 6.26024 6.65349 7.01774 7.37424 7.70866 8.05236 8.42919 8.65721 8.92255 9.08161];
aq3=-714.659+[0.194024 -1.08498 -1.14915 -1.20233 -1.27589 -1.36339 -1.49241 -1.63338 -1.78015 -1.91764 -2.0396 -2.1396 -2.25531 -2.37127 -2.48179 -2.59024 -2.70765 -2.85487 -2.94343 -3.05161 -3.11166 ];
% 16215
ar1=12.1679+[-0.403375 0.309289 0.376841 0.383709 0.382299 0.380572 0.362151 0.341051 0.330241 0.298568 0.249842 0.212073 0.183541 0.154744 0.106079 0.0620347 0.0183996 -0.0169086 -0.0494341 -0.0789349 -0.0998884];
ar2=446.385+[1.40349 1.0748 1.82829 2.70456 3.8007 4.91942 6.2322 7.41449 8.50896 9.5101 10.4421 11.1645 12.0067 12.7751 13.5106 14.1819 14.8733 15.635 16.1654 16.7967 17.3152];
ar3=-705.203+[0.136572 -1.47634 -1.62248 -1.75425 -1.93544 -2.14354 -2.43389 -2.73621 -3.0467 -3.23618 -3.39956 -3.54128 -3.71889 -3.90299 -4.08595 -4.27959 -4.50346 -4.77286 -4.95282 -5.18374 -5.31606];
% 31500
as1=9.70641+[-0.371109 0.336421 0.410779 0.423422 0.428484 0.432725 0.420307 0.40385 0.3977 0.371188 0.327631 0.294516 0.272084 0.24924 0.205548 0.165673 0.125866 0.0963425 0.0682161 0.0434546 0.0257855];
as2=444.066+[1.26279 0.895108 1.58608 2.40696 3.44154 4.50298 5.75525 6.88887 7.94234 8.89723 9.78753 10.4805 11.2932 12.0415 12.7646 13.43 14.1205 14.8862 15.4244 16.0711 16.6106 ];
as3=-707.086+[0.278094 -1.27238 -1.33256 -1.38161 -1.46209 -1.56637 -1.73335 -1.92308 -2.12844 -2.18167 -2.19825 -2.21634 -2.23882 -2.28104 -2.33057 -2.40504 -2.50483 -2.63398 -2.70432 -2.80048 -2.80583];
% 37435
at1=16.2708+[-0.248265 0.135299 0.19423 0.208924 0.219342 0.2277 0.228753 0.228834 0.232755 0.239284 0.233134 0.228084 0.22865 0.228054 0.212351 0.199765 0.187702 0.190041 0.185369 0.17897 0.168094 ];
at2=449.059+[1.0122 0.315705 0.785014 1.40814 2.19962 3.01505 3.97713 4.85128 5.66924 6.34429 6.91522 7.33215 7.78261 8.19978 8.60737 8.98918 9.38164 9.81285 10.0744 10.379 10.5625];
at3=-710.186+[0.112597 -1.17507 -1.29317 -1.40122 -1.54162 -1.6996 -1.91346 -2.13381 -2.35561 -2.55801 -2.73723 -2.88182 -3.04777 -3.21159 -3.36755 -3.51931 -3.68249 -3.88492 -4.00758 -4.15667 -4.24157 ];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3 ];
% 36572
au1=12.3763+[-0.0645383 -0.0551317 -0.035502 -0.0151106 -0.00528282 0.0127404 0.0254587 0.0369905 0.0497233 0.0618382 0.0737319 0.0837342 0.092567 0.0997835 0.110871 0.120825 0.126973 0.130765 0.13003 0.125813 0.118504];
au2=446.738+[0.630243 0.566607 0.445571 0.336109 0.283961 0.195086 0.127016 0.085285 0.0692801 0.0833379 0.126478 0.193946 0.292052 0.386085 0.518167 0.668146 0.808721 0.986617 1.1849 1.38054 1.57811];
au3=-714.659+[-0.996715 -1.00736 -1.00349 -0.998438 -0.995195 -0.988127 -0.977438 -0.965672 -0.955536 -0.947966 -0.942777 -0.938525 -0.935011 -0.937264 -0.940486 -0.942163 -0.943484 -0.945935 -0.949329 -0.954295 -0.961827];
% 16215
av1=12.1679+[0.0479822 0.0641841 0.0872333 0.108515 0.119789 0.142256 0.164963 0.181117 0.19319 0.20338 0.211407 0.218674 0.224593 0.226433 0.224189 0.218794 0.210847 0.199514 0.184284 0.166063 0.144983];
av2=446.385+[1.48605 1.44205 1.40626 1.39887 1.40675 1.44813 1.51767 1.6163 1.7527 1.92375 2.12558 2.35481 2.63359 2.8673 3.17167 3.49999 3.79847 4.16516 4.5604 4.94141 5.3179];
av3=-705.203+[-1.34535 -1.36955 -1.39631 -1.42337 -1.43859 -1.47071 -1.5022 -1.53416 -1.57125 -1.61149 -1.65437 -1.69932 -1.75211 -1.79059 -1.83502 -1.8822 -1.92646 -1.98306 -2.04662 -2.11244 -2.18237];
% 31500
aw1=9.70641+[0.0756118 0.0919944 0.11554 0.137593 0.149355 0.172739 0.196703 0.214188 0.227785 0.239664 0.249388 0.258421 0.266399 0.269739 0.269229 0.265521 0.259067 0.249407 0.235645 0.21865 0.198785];
aw2=444.066+[1.31678 1.26937 1.22088 1.19837 1.1977 1.22171 1.27431 1.35597 1.47359 1.6248 1.80631 2.01478 2.27041 2.48516 2.766 3.07073 3.34902 3.69252 4.06476 4.42511 4.78238];
aw3=-707.086+[-1.15639 -1.17587 -1.18506 -1.1911 -1.19429 -1.20119 -1.20766 -1.21398 -1.22195 -1.23068 -1.24022 -1.25006 -1.26243 -1.26646 -1.26637 -1.26684 -1.26943 -1.27582 -1.28646 -1.30194 -1.32262];
% 37435
ax1=16.2708+[-0.0552054 -0.0433065 -0.0192955 0.00535643 0.0170768 0.0381668 0.0522004 0.0644491 0.0778636 0.0905639 0.103047 0.113442 0.122205 0.129287 0.140033 0.149039 0.153826 0.155479 0.151925 0.14494 0.134838];
ax2=449.059+[0.768975 0.699474 0.574475 0.465874 0.415172 0.330232 0.265131 0.228023 0.220978 0.249242 0.311208 0.401055 0.52741 0.645678 0.8097 0.993898 1.16514 1.38045 1.61845 1.85117 2.08466];
ax3=-710.186+[-1.08139 -1.09114 -1.08927 -1.08881 -1.08827 -1.08643 -1.0787 -1.0702 -1.06571 -1.06669 -1.07276 -1.08175 -1.09464 -1.11117 -1.13342 -1.15531 -1.17462 -1.19901 -1.2257 -1.2528 -1.28211];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 36572
ay1=12.3763+[-0.215017 -0.217193 -0.103319 -0.0286459 0.0346078 0.0731724 0.0996462 0.112936 0.121049 0.125456 0.139509 0.144365 0.141276 0.121705 0.0939411 0.0591454 0.0109177 -0.034411 -0.082677 -0.115032 -0.138808];
ay2=446.738+[0.808829 0.344169 0.278658 0.332398 0.47137 0.678112 1.02662 1.45581 1.89396 2.39908 2.90492 3.34245 3.73943 4.18445 4.53793 4.91365 5.37667 5.78841 6.24064 6.69599 7.09432];
ay3=-714.659+[0.193483 -0.883202 -0.960808 -1.00444 -1.04267 -1.07439 -1.1131 -1.155 -1.19834 -1.25031 -1.32339 -1.38738 -1.44423 -1.50595 -1.55553 -1.61468 -1.69641 -1.78042 -1.88451 -2.00435 -2.114];
% 16215
az1=12.1679+[-0.403358 -0.186017 -0.0229561 0.0845813 0.178159 0.230922 0.261346 0.26661 0.261258 0.253839 0.23056 0.192148 0.145699 0.0773287 0.0136278 -0.0603576 -0.154851 -0.240063 -0.330686 -0.409355 -0.473803];
az2=446.385+[1.40391 1.22667 1.3183 1.53673 1.91239 2.37678 3.05072 3.80206 4.53021 5.34387 6.22466 7.05962 7.84149 8.76941 9.52471 10.2992 11.1947 11.9667 12.7944 13.6327 14.4298];
az3=-705.203+[0.135333 -1.23912 -1.36901 -1.46023 -1.56505 -1.66978 -1.80045 -1.93789 -2.07246 -2.22945 -2.31435 -2.38235 -2.45732 -2.55077 -2.64346 -2.75482 -2.92024 -3.0921 -3.30739 -3.54385 -3.77521];
% 31500
ba1=9.70641+[-0.371091 -0.160872 0.00343994 0.113132 0.210412 0.26739 0.303074 0.313327 0.311999 0.308715 0.28995 0.255941 0.212769 0.147577 0.085909 0.0130927 -0.0809537 -0.165876 -0.255989 -0.333431 -0.39625];
ba2=444.066+[1.26326 1.07155 1.13104 1.31918 1.65658 2.08232 2.70926 3.41579 4.10557 4.88006 5.70812 6.49352 7.23455 8.11995 8.84694 9.59945 10.4781 11.2414 12.0648 12.9038 13.7076];
ba3=-707.086+[0.276778 -1.06747 -1.1529 -1.20171 -1.2513 -1.29747 -1.35239 -1.41198 -1.47437 -1.55199 -1.51717 -1.4568 -1.40815 -1.34608 -1.30909 -1.28981 -1.31205 -1.36349 -1.45141 -1.556 -1.64841 ];
% 37435
bb1=16.2708+[-0.248256 -0.224749 -0.0934462 -0.00906453 0.0605677 0.101773 0.128108 0.139087 0.143728 0.143458 0.152982 0.152739 0.143827 0.117185 0.0835706 0.0425044 -0.0136451 -0.0658448 -0.122412 -0.16216 -0.192864];
bb2=449.059+[1.01233 0.438037 0.393144 0.477037 0.657333 0.911317 1.32925 1.83621 2.34893 2.93661 3.52343 4.03174 4.48985 5.00009 5.40351 5.83099 6.3562 6.82268 7.33607 7.85327 8.30604 ];
bb3=-710.186+[0.11204 -0.928339 -1.03316 -1.1027 -1.17043 -1.23211 -1.31239 -1.40065 -1.48912 -1.59243 -1.71827 -1.82919 -1.92667 -2.03248 -2.11647 -2.2123 -2.33935 -2.46466 -2.61578 -2.78595 -2.94103];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 36572
bc1=12.3763+[-0.00126366 0.0131723 0.0398683 0.0611592 0.0835819 0.0922297 0.109489 0.116629 0.125135 0.131795 0.136359 0.138362 0.139121 0.142823 0.146936 0.14841 0.146863 0.141661 0.134938 0.12683 0.117492];
bc2=446.738+[0.696855 0.616087 0.485614 0.40392 0.321748 0.292199 0.24833 0.24309 0.265872 0.330326 0.426938 0.541165 0.670693 0.854223 1.02445 1.20975 1.42557 1.66129 1.90636 2.16885 2.43721];
bc3=-714.659+[-0.705812 -0.716153 -0.717714 -0.722277 -0.725687 -0.726867 -0.726451 -0.725108 -0.725061 -0.727104 -0.731264 -0.736553 -0.742764 -0.758179 -0.771809 -0.785228 -0.800617 -0.819135 -0.842609 -0.870858 -0.90296];
% 16215
bd1=12.1679+[0.129016 0.15022 0.177854 0.197292 0.217202 0.224628 0.24036 0.24787 0.255798 0.260868 0.263361 0.263833 0.263684 0.258338 0.249078 0.236759 0.221941 0.204782 0.184793 0.16108 0.13303];
bd2=446.385+[1.63099 1.57715 1.54507 1.55984 1.61644 1.659 1.81816 1.92955 2.1127 2.36025 2.63953 2.92259 3.21763 3.60417 3.94758 4.31132 4.72053 5.1518 5.58871 6.04849 6.50837];
bd3=-705.203+[-1.0531 -1.08122 -1.11986 -1.15571 -1.20401 -1.22754 -1.29113 -1.32684 -1.37688 -1.43586 -1.49722 -1.55666 -1.6179 -1.69021 -1.75114 -1.81655 -1.89084 -1.97261 -2.0627 -2.16396 -2.27049];
% 31500
be1=9.70641+[0.155694 0.177046 0.205029 0.225021 0.24599 0.254004 0.27164 0.280413 0.290224 0.297577 0.302444 0.305198 0.307254 0.304599 0.297715 0.287794 0.275448 0.260554 0.24265 0.220953 0.194683];
be2=444.066+[1.44871 1.39055 1.34446 1.3454 1.38316 1.41653 1.55045 1.64733 1.81002 2.03392 2.28943 2.55052 2.82421 3.18307 3.50298 3.84338 4.22837 4.63628 5.05142 5.48999 5.93032];
be3=-707.086+[-0.843245 -0.865219 -0.883878 -0.899972 -0.921004 -0.930853 -0.956022 -0.969203 -0.986767 -1.00705 -1.02818 -1.04917 -1.07157 -1.09135 -1.10565 -1.12256 -1.14376 -1.17112 -1.20741 -1.2529 -1.30441 ];
% 37435
bf1=16.2708+[0.00528751 0.0226321 0.0541899 0.0792789 0.105446 0.115492 0.135176 0.143127 0.152436 0.15963 0.164585 0.166678 0.167334 0.171012 0.174817 0.17544 0.172498 0.165165 0.155802 0.144421 0.131522];
bf2=449.059+[0.880613 0.79256 0.656266 0.574931 0.495352 0.467771 0.43207 0.433695 0.470853 0.557405 0.680607 0.822852 0.982193 1.20518 1.41054 1.63229 1.88834 2.16562 2.45143 2.75565 3.06517];
bf3=-710.186+[-0.813393 -0.822364 -0.825313 -0.833808 -0.842466 -0.846123 -0.852673 -0.856024 -0.865039 -0.880466 -0.9007 -0.922857 -0.947098 -0.987074 -1.02278 -1.05908 -1.09983 -1.14448 -1.19366 -1.24833 -1.30682];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ];
% 36572
bg1=12.3763+[-0.262546 -0.219485 -0.124679 -0.0516545 -0.0249947 0.0195808 0.0455329 0.070726 0.0891307 0.0950809 0.108372 0.11918 0.1294 0.133238 0.129899 0.120453 0.104558 0.0787915 0.053574 0.0213048 -0.0166059];
bg2=446.738+[0.872491 0.569782 0.400265 0.361752 0.367816 0.422862 0.510772 0.680421 0.953431 1.1441 1.49459 1.69257 1.93482 2.19035 2.41721 2.65719 2.89383 3.19383 3.46666 3.80149 4.13002 ];
bg3=-714.659+[-0.305877 -0.563955 -0.616135 -0.657693 -0.67356 -0.702366 -0.722855 -0.750076 -0.784085 -0.804968 -0.854855 -0.88135 -0.910647 -0.939355 -0.961608 -0.981538 -1.00023 -1.02801 -1.05797 -1.09463 -1.13189];
% 16215
bh1=12.1679+[-0.293437 -0.199141 -0.075927 0.0173463 0.0514724 0.109675 0.145431 0.179312 0.201772 0.211423 0.215839 0.210916 0.197184 0.171391 0.141093 0.0993626 0.0516046 -0.0113476 -0.0701558 -0.145265 -0.222756 ];
bh2=446.385+[1.65142 1.50579 1.51009 1.63908 1.73395 2.01029 2.29303 2.70783 3.26776 3.6283 4.27812 4.68705 5.23122 5.82861 6.38996 7.00547 7.61107 8.31556 8.90494 9.61024 10.2706];
bh3=-705.203+[-0.521951 -0.890726 -1.01463 -1.11265 -1.15705 -1.25503 -1.33613 -1.43856 -1.5614 -1.63633 -1.71849 -1.72297 -1.72162 -1.72934 -1.73893 -1.75833 -1.78726 -1.8464 -1.91853 -2.01415 -2.11875];
% 31500
bi1=9.70641+[-0.263984 -0.173739 -0.0511113 0.0431866 0.0782201 0.13921 0.177847 0.215796 0.243198 0.255826 0.26532 0.263731 0.254237 0.23263 0.205899 0.16753 0.122117 0.0610883 0.0031187 -0.0719186 -0.151035 ];
bi2=444.066+[1.50764 1.34169 1.31848 1.42006 1.50124 1.74539 2.00039 2.38009 2.89951 3.23654 3.84 4.21525 4.71567 5.26945 5.79363 6.37342 6.94985 7.62832 8.20185 8.89381 9.54756];
bi3=-707.086+[-0.371135 -0.7057 -0.789205 -0.847581 -0.872012 -0.921908 -0.960313 -1.00675 -1.06139 -1.0947 -1.08846 -1.02286 -0.921987 -0.818454 -0.720215 -0.619469 -0.530446 -0.459486 -0.429394 -0.405367 -0.40236 ];
% 37435
bk1=16.2708+[-0.296601 -0.238032 -0.129562 -0.0464936 -0.0162965 0.0338777 0.0628643 0.0903703 0.109856 0.11583 0.129203 0.140189 0.150186 0.152569 0.146807 0.133669 0.113392 0.0819031 0.0509884 0.0105912 -0.0358073];
bk2=449.059+[1.06322 0.724195 0.552141 0.527514 0.542657 0.62228 0.735825 0.946396 1.27649 1.50409 1.91829 2.15213 2.43865 2.73965 3.00538 3.28523 3.55926 3.90457 4.21675 4.59813 4.97086];
bk3=-710.186+[-0.380102 -0.632494 -0.696008 -0.754906 -0.779271 -0.827357 -0.865493 -0.919067 -0.988726 -1.0326 -1.1233 -1.17353 -1.23229 -1.29081 -1.338 -1.3829 -1.42474 -1.48107 -1.53589 -1.60137 -1.66611];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C5-C6 Left Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
