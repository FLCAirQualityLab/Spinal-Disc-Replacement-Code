%% foreman height and width narrowing/widening 

% 6N!!

% for all models for the c3-c4 left hand side foreman under lateral bending (_n)
% 1297,16439,17116,14886

% Values for displacements have not been replaced. base coordinates have,
% but need checking. 
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 1297,16439,17116,14886
%% model15_intact_TLC_6N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 1297
aa1=12.7746+[4.8745400e-01   3.2824200e-01  -2.6196900e-02  -3.5020000e-01  -8.2052000e-01  -1.0080800e+00  -1.2937200e+00  -1.6898800e+00  -1.9238900e+00  -2.2130700e+00  -2.4787900e+00  -2.6917900e+00  -2.9363400e+00  -3.1833200e+00  -3.4239100e+00  -3.6811600e+00  -3.9072200e+00  -4.0446200e+00  -4.2335900e+00  -4.4122600e+00  -4.5756700e+00];
aa2=447.736+[1.5391800e+00   2.3697500e-01  -5.6034300e-01  -1.0561900e+00  -1.4675300e+00  -1.5939900e+00  -1.7727900e+00  -2.0143900e+00  -2.1617100e+00  -2.3496900e+00  -2.5226400e+00  -2.6668600e+00  -2.8403200e+00  -3.0280800e+00  -3.2195300e+00  -3.4181100e+00  -3.5934600e+00  -3.7064900e+00  -3.8696300e+00  -4.0318700e+00  -4.1852300e+00];
aa3=-690.116+[-1.1235400e+00  -8.5035400e-01  -5.8128900e-01  -3.9156900e-01  -1.7683300e-01  -1.0219900e-01   4.4459700e-03   1.4405800e-01   2.2244900e-01   3.1525100e-01   3.9627900e-01   4.5830300e-01   5.2656600e-01   5.9310500e-01   6.5480100e-01   7.1684000e-01   7.6895600e-01   7.9981700e-01   8.4090800e-01   8.7868200e-01   9.1321700e-01];

% 16439
ab1=13.5613+[3.1910900e-01   2.5079200e-01   1.2447000e-02  -2.1075800e-01  -5.4851400e-01  -6.8695300e-01  -8.9870800e-01  -1.1918300e+00  -1.3650500e+00  -1.5800800e+00  -1.7778400e+00  -1.9361700e+00  -2.1177000e+00  -2.3001600e+00  -2.4772700e+00  -2.6665100e+00  -2.8326700e+00  -2.9336700e+00  -3.0725400e+00  -3.2036600e+00  -3.3232300e+00];
ab2=447.206+[1.0864800e+00   2.4674500e-03  -6.6704000e-01  -1.0809700e+00  -1.4261900e+00  -1.5316500e+00  -1.6796700e+00  -1.8786500e+00  -1.9995600e+00  -2.1519500e+00  -2.2934400e+00  -2.4124700e+00  -2.5566000e+00  -2.7137200e+00  -2.8733700e+00  -3.0400100e+00  -3.1877700e+00  -3.2830700e+00  -3.4196500e+00  -3.5551400e+00  -3.6823000e+00];
ab3=-699.132+[-9.9227400e-01  -7.7842900e-01  -5.4896500e-01  -3.9434800e-01  -2.2017600e-01  -1.5991100e-01  -7.4973700e-02   3.5067100e-02   9.6548900e-02   1.6905600e-01   2.3390700e-01   2.8481600e-01   3.4157500e-01   3.9787300e-01   4.5042400e-01   5.0401400e-01   5.4988800e-01   5.7750800e-01   6.1398800e-01   6.4744600e-01   6.7725600e-01];

% 17116
ac1=16.2684+[3.1756800e-01   2.8015800e-01   6.6128900e-02  -1.3893600e-01  -4.6042800e-01  -5.9413200e-01  -7.9943800e-01  -1.0836900e+00  -1.2515800e+00  -1.4600400e+00  -1.6529700e+00  -1.8080200e+00  -1.9857100e+00  -2.1641300e+00  -2.3373200e+00  -2.5225700e+00  -2.6852800e+00  -2.7842000e+00  -2.9201300e+00  -3.0482600e+00  -3.1650600e+00];
ac2=443.597+[1.2257500e+00   2.9080300e-02  -7.3378800e-01  -1.2160200e+00  -1.6319000e+00  -1.7615200e+00  -1.9447200e+00  -2.1928900e+00  -2.3438500e+00  -2.5342400e+00  -2.7099400e+00  -2.8565400e+00  -3.0331000e+00  -3.2245000e+00  -3.4185100e+00  -3.6218100e+00  -3.8024200e+00  -3.9182600e+00  -4.0839600e+00  -4.2481400e+00  -4.4022100e+00];
ac3=-706.266+[-1.1326600e+00  -8.3298500e-01  -5.3667600e-01  -3.3658600e-01  -1.1573800e-01  -3.9367500e-02   6.8951100e-02   2.1078400e-01   2.9116700e-01   3.8711400e-01   4.7344300e-01   5.4183500e-01   6.1872100e-01   6.9582700e-01   7.6886900e-01   8.4394500e-01   9.0869900e-01   9.4798700e-01   1.0007300e+00   1.0498000e+00   1.0940000e+00];

% 14886
ad1=9.91704+[5.2208400e-01   3.1290100e-01  -8.5117000e-02  -4.4329900e-01  -9.4961700e-01  -1.1488200e+00  -1.4507100e+00  -1.8686500e+00  -2.1151900e+00  -2.4195600e+00  -2.6978400e+00  -2.9200900e+00  -3.1752500e+00  -3.4330500e+00  -3.6837900e+00  -3.9515500e+00  -4.1867300e+00  -4.3295500e+00  -4.5258900e+00  -4.7116100e+00  -4.8814800e+00];
ad2=444.847+[1.4321600e+00   2.3930500e-01  -4.6126400e-01  -8.8023100e-01  -1.2053900e+00  -1.3015500e+00  -1.4355000e+00  -1.6138300e+00  -1.7228000e+00  -1.8622800e+00  -1.9915500e+00  -2.1009000e+00  -2.2333300e+00  -2.3779000e+00  -2.5262200e+00  -2.6782400e+00  -2.8116300e+00  -2.8985400e+00  -3.0247200e+00  -3.1505300e+00  -3.2694400e+00];
ad3=-691.954+[-1.0061900e+00  -8.3456500e-01  -6.4546600e-01  -5.1360300e-01  -3.6109700e-01  -3.0840900e-01  -2.3431800e-01  -1.3962700e-01  -8.7955800e-02  -2.8344700e-02   2.2596400e-02   6.0464500e-02   1.0100600e-01   1.3906500e-01   1.7264100e-01   2.0504600e-01   2.3112400e-01   2.4598100e-01   2.6472700e-01   2.8097900e-01   2.9558200e-01];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3']
y15=[ya1',ya2',ya3']

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_6N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 1297
ae1=12.7746+[-3.0399900e-01   2.8347500e-01  -4.0327100e-01  -7.1900900e-01  -1.0943200e+00  -1.4218600e+00  -1.7681600e+00  -2.1127800e+00  -2.5690500e+00  -2.7904400e+00  -3.0950500e+00  -3.3657400e+00  -3.6848700e+00  -3.9024400e+00  -4.1111000e+00  -4.5086500e+00  -4.6946200e+00  -4.8762700e+00  -5.0297700e+00  -5.2681900e+00  -5.3854800e+00];
ae2=447.736+[2.4876100e+00  -3.5723300e-01  -1.2168000e+00  -1.6350700e+00  -1.9592100e+00  -2.2079100e+00  -2.4708300e+00  -2.7302700e+00  -3.0716900e+00  -3.2379400e+00  -3.4838500e+00  -3.7011200e+00  -3.9602700e+00  -4.1425300e+00  -4.3223600e+00  -4.6827400e+00  -4.8586200e+00  -5.0373500e+00  -5.1939100e+00  -5.4443200e+00  -5.5710900e+00];
ae3=-690.116+[-1.1890200e+00  -1.2865000e+00  -8.3910400e-01  -6.4123400e-01  -4.6314600e-01  -3.2928900e-01  -1.9966900e-01  -7.8572600e-02   7.1257900e-02   1.3911300e-01   2.2813700e-01   3.0265400e-01   3.8578000e-01   4.3986300e-01   4.8994100e-01   5.7944900e-01   6.1846800e-01   6.5459500e-01   6.8389700e-01   7.2713400e-01   7.4742600e-01];

% 16439
af1=13.5613+[-3.2124000e-01   2.0122600e-01  -2.6786000e-01  -4.8823300e-01  -7.5986700e-01  -9.9996800e-01  -1.2556500e+00  -1.5094800e+00  -1.8454900e+00  -2.0092500e+00  -2.2344300e+00  -2.4351900e+00  -2.6711300e+00  -2.8314000e+00  -2.9846200e+00  -3.2760000e+00  -3.4119500e+00  -3.5451000e+00  -3.6577300e+00  -3.8326500e+00  -3.9192300e+00];
af2=447.206+[1.8134300e+00  -5.4231500e-01  -1.2671400e+00  -1.6028000e+00  -1.8665800e+00  -2.0729400e+00  -2.2926300e+00  -2.5085500e+00  -2.7915200e+00  -2.9287800e+00  -3.1314300e+00  -3.3109600e+00  -3.5269400e+00  -3.6794700e+00  -3.8296800e+00  -4.1316000e+00  -4.2789700e+00  -4.4291400e+00  -4.5607200e+00  -4.7717100e+00  -4.8794600e+00];
af3=-699.132+[-9.0469200e-01  -1.0731300e+00  -6.7499100e-01  -5.0719300e-01  -3.5781400e-01  -2.4609100e-01  -1.3790200e-01  -3.8258100e-02   8.3003100e-02   1.3781800e-01   2.0956600e-01   2.7050600e-01   3.3923300e-01   3.8414900e-01   4.2599800e-01   5.0170400e-01   5.3502000e-01   5.6637400e-01   5.9197900e-01   6.3064900e-01   6.4923300e-01];

% 17116
ag1=16.2684+[-3.4470400e-01   2.2558100e-01  -2.0965700e-01  -4.1052600e-01  -6.7002900e-01  -9.0225000e-01  -1.1511700e+00  -1.3988500e+00  -1.7272000e+00  -1.8875000e+00  -2.1080900e+00  -2.3056800e+00  -2.5380900e+00  -2.6960600e+00  -2.8471100e+00  -3.1343300e+00  -3.2681700e+00  -3.3994000e+00  -3.5103700e+00  -3.6826500e+00  -3.7679500e+00];
ag2=449.981+[1.9898500e+00  -5.3764800e-01  -1.3974500e+00  -1.8049000e+00  -2.1284400e+00  -2.3803800e+00  -2.6463600e+00  -2.9076200e+00  -3.2503100e+00  -3.4165200e+00  -3.6602900e+00  -3.8756900e+00  -4.1346200e+00  -4.3171100e+00  -4.4968100e+00  -4.8570700e+00  -5.0329100e+00  -5.2115000e+00  -5.3677900e+00  -5.6184100e+00  -5.7463500e+00];
ag3=-696.273+[-1.0629800e+00  -1.1007100e+00  -6.0779600e-01  -3.9503100e-01  -2.0662600e-01  -6.5094000e-02   7.3466200e-02   2.0227300e-01   3.6088000e-01   4.3342500e-01   5.2999100e-01   6.1271800e-01   7.0703500e-01   7.6949800e-01   8.2833400e-01   9.3678200e-01   9.8553300e-01   1.0321300e+00   1.0707700e+00   1.1299100e+00   1.1587500e+00];

% 14886
ah1=9.91704+[-2.6361700e-01   2.7595600e-01  -4.7706600e-01  -8.2634100e-01  -1.2282000e+00  -1.5750200e+00  -1.9391800e+00  -2.3003500e+00  -2.7768900e+00  -3.0075200e+00  -3.3243900e+00  -3.6048200e+00  -3.9350400e+00  -4.1597800e+00  -4.3751400e+00  -4.7851600e+00  -4.9769400e+00  -5.1640300e+00  -5.3220900e+00  -5.5675000e+00  -5.6882700e+00];
ah2=448.847+[2.3816500e+00  -3.2634100e-01  -1.0369800e+00  -1.3755900e+00  -1.6288200e+00  -1.8218100e+00  -2.0280000e+00  -2.2308500e+00  -2.4969500e+00  -2.6265300e+00  -2.8207700e+00  -2.9928400e+00  -3.1977200e+00  -3.3423800e+00  -3.4852900e+00  -3.7728000e+00  -3.9130800e+00  -4.0564200e+00  -4.1822300e+00  -4.3833600e+00  -4.4850300e+00];
ah3=-691.954+[-1.0819800e+00  -1.3266200e+00  -9.9450500e-01  -8.5315000e-01  -7.2587100e-01  -6.3145100e-01  -5.4208000e-01  -4.6061900e-01  -3.6249500e-01  -3.1930300e-01  -2.6454600e-01  -2.1994400e-01  -1.7187700e-01  -1.4172200e-01  -1.1472600e-01  -6.9490300e-02  -5.1378500e-02  -3.5757600e-02  -2.3935700e-02  -8.0463700e-03  -1.3105400e-03];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_6N
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 1297
ai1=12.7746+[-1.7128900e-01   2.8891500e-01  -2.3509100e-01  -7.6765200e-01  -9.9215600e-01  -1.5130200e+00  -1.8033100e+00  -2.2057800e+00  -2.4664100e+00  -2.7233300e+00  -3.0228000e+00  -3.4071600e+00  -3.7160900e+00  -3.9266700e+00  -4.1753400e+00  -4.4147600e+00  -4.6418800e+00  -4.8603900e+00  -5.1093300e+00  -5.2801500e+00  -5.4023000e+00];
ai2=447.736+[2.9455100e+00  -1.3872800e-01  -9.7214300e-01  -1.6805300e+00  -1.8864200e+00  -2.2913900e+00  -2.5116100e+00  -2.8198700e+00  -3.0104700e+00  -3.1980500e+00  -3.4342600e+00  -3.7421600e+00  -3.9922600e+00  -4.1685700e+00  -4.3834100e+00  -4.5979300e+00  -4.8080300e+00  -5.0186800e+00  -5.2704300e+00  -5.4491400e+00  -5.5800400e+00];
ai3=-690.116+[-1.4399000e+00  -1.3035600e+00  -9.4003700e-01  -6.1142400e-01  -5.0398600e-01  -2.8995100e-01  -1.8305300e-01  -4.3202300e-02   4.1605600e-02   1.2134100e-01   2.0984500e-01   3.1563100e-01   3.9529300e-01   4.4726400e-01   5.0615000e-01   5.6005200e-01   6.0848600e-01   6.5227500e-01   6.9931300e-01   7.2986500e-01   7.5086900e-01];

% 16439
aj1=13.5613+[-2.2044400e-01   2.0738000e-01  -1.4773900e-01  -5.2149000e-01  -6.8405100e-01  -1.0657200e+00  -1.2802300e+00  -1.5760400e+00  -1.7685800e+00  -1.9587900e+00  -2.1802200e+00  -2.4654400e+00  -2.6940500e+00  -2.8493200e+00  -3.0323200e+00  -3.2081200e+00  -3.3745600e+00  -3.5348800e+00  -3.7178500e+00  -3.8435400e+00  -3.9338800e+00];
aj2=447.206+[2.1526800e+00  -3.6970900e-01  -1.0670800e+00  -1.6386200e+00  -1.8060000e+00  -2.1416600e+00  -2.3259900e+00  -2.5827000e+00  -2.7409300e+00  -2.8963000e+00  -3.0913400e+00  -3.3462000e+00  -3.5552300e+00  -3.7029700e+00  -3.8827400e+00  -4.0627300e+00  -4.2389900e+00  -4.4161200e+00  -4.6280600e+00  -4.7790300e+00  -4.8904000e+00];
aj3=-699.132+[-1.1264800e+00  -1.0873300e+00  -7.6553500e-01  -4.8312000e-01  -3.9313200e-01  -2.1445800e-01  -1.2506800e-01  -1.0558500e-02   5.8369400e-02   1.2312700e-01   1.9456100e-01   2.8119900e-01   3.4733700e-01   3.9065300e-01   4.4006600e-01   4.8573800e-01   5.2702800e-01   5.6495300e-01   6.0626300e-01   6.3380200e-01   6.5308500e-01];

% 17116
ak1=16.2684+[-2.4201000e-01   2.3125200e-01  -9.6382900e-02  -4.4080100e-01  -5.9606000e-01  -9.6506800e-01  -1.1742700e+00  -1.4628900e+00  -1.6514700e+00  -1.8377800e+00  -2.0546900e+00  -2.3355100e+00  -2.5608900e+00  -2.7140500e+00  -2.8946100e+00  -3.0680100e+00  -3.2320300e+00  -3.3900900e+00  -3.5704800e+00  -3.6943900e+00  -3.7834600e+00];
ak2=449.981+[2.3669000e+00  -3.5059300e-01  -1.1625100e+00  -1.8507000e+00  -2.0545800e+00  -2.4636400e+00  -2.6864200e+00  -2.9963800e+00  -3.1878700e+00  -3.3762400e+00  -3.6112100e+00  -3.9167600e+00  -4.1670800e+00  -4.3436700e+00  -4.5584400e+00  -4.7731300e+00  -4.9834100e+00  -5.1941900e+00  -5.4459000e+00  -5.6251200e+00  -5.7573000e+00];
ak3=-696.273+[-1.3288600e+00  -1.1287600e+00  -7.2371300e-01  -3.6521300e-01  -2.5126200e-01  -2.4573500e-02   9.0115500e-02   2.3865100e-01   3.2861600e-01   4.1378100e-01   5.0941100e-01   6.2692500e-01   7.1771200e-01   7.7797200e-01   8.4756800e-01   9.1282100e-01   9.7279400e-01   1.0288600e+00   1.0911700e+00   1.1333100e+00   1.1632000e+00];

% 14886
al1=9.91704+[-1.2909300e-01   2.8154800e-01  -2.9536900e-01  -8.8036200e-01  -1.1208400e+00  -1.6724500e+00  -1.9772500e+00  -2.3988200e+00  -2.6705200e+00  -2.9381200e+00  -3.2497200e+00  -3.6478000e+00  -3.9672100e+00  -4.1845700e+00  -4.4410600e+00  -4.6878700e+00  -4.9220000e+00  -5.1470200e+00  -5.4031900e+00  -5.5789300e+00  -5.7046200e+00];
al2=444.847+[2.8113300e+00  -1.1737700e-01  -8.2844600e-01  -1.4088700e+00  -1.5717400e+00  -1.8874600e+00  -2.0604900e+00  -2.3022400e+00  -2.4508700e+00  -2.5965300e+00  -2.7824500e+00  -3.0265300e+00  -3.2244900e+00  -3.3646200e+00  -3.5357200e+00  -3.7069000e+00  -3.8744500e+00  -4.0431400e+00  -4.2454200e+00  -4.3890100e+00  -4.4940500e+00];
al3=-691.954+[-1.2862800e+00  -1.3293200e+00  -1.0655400e+00  -8.3118300e-01  -7.5481900e-01  -6.0410800e-01  -5.3073600e-01  -4.3733200e-01  -3.8159800e-01  -3.3023400e-01  -2.7519500e-01  -2.1176100e-01  -1.6580000e-01  -1.3688400e-01  -1.0534000e-01  -7.7898200e-02  -5.4735300e-02  -3.5383900e-02  -1.6477300e-02  -5.3879300e-03   1.6056700e-03];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_6N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 1297
am1=12.7746+[3.3679900e-01   3.7948800e-01  -1.9806800e-01  -6.9484700e-01  -1.1876600e+00  -1.3366200e+00  -1.7662300e+00  -2.0906200e+00  -2.4298900e+00  -2.6919700e+00  -2.9817200e+00  -3.3083200e+00  -3.5920400e+00  -3.9000900e+00  -4.1469100e+00  -4.3843600e+00  -4.6100800e+00  -4.8267400e+00  -5.0103500e+00  -5.2921700e+00  -5.3545400e+00];
am2=447.736+[2.5609300e+00   4.4455900e-01  -7.9841700e-01  -1.5716100e+00  -2.0544400e+00  -2.1745700e+00  -2.5011300e+00  -2.7435700e+00  -2.9969100e+00  -3.1874200e+00  -3.4124400e+00  -3.6730400e+00  -3.9002200e+00  -4.1556700e+00  -4.3691800e+00  -4.5820500e+00  -4.7916200e+00  -5.0012200e+00  -5.1858400e+00  -5.4825600e+00  -5.5498600e+00];
am3=-690.116+[-1.7303000e+00  -1.4011800e+00  -9.6137000e-01  -6.4479200e-01  -4.1125000e-01  -3.5078600e-01  -1.8985100e-01  -7.6490600e-02   3.5462200e-02   1.1694800e-01   2.0298200e-01   2.9407200e-01   3.6878300e-01   4.4583800e-01   5.0476100e-01   5.5865400e-01   6.0723400e-01   6.5114600e-01   6.8650500e-01   7.3764000e-01   7.4842000e-01];
% 16439
an1=13.5613+[1.6922800e-01   2.7020100e-01  -1.1802300e-01  -4.6759100e-01  -8.2424500e-01  -9.3349400e-01  -1.2505600e+00  -1.4893700e+00  -1.7391000e+00  -1.9329900e+00  -2.1469500e+00  -2.3889900e+00  -2.5986200e+00  -2.8254500e+00  -3.0065600e+00  -3.1803800e+00  -3.3453000e+00  -3.5037400e+00  -3.6384000e+00  -3.8451400e+00  -3.8911900e+00];
an2=447.206+[1.8377900e+00   1.0188400e-01  -9.2739600e-01  -1.5511300e+00  -1.9424300e+00  -2.0421200e+00  -2.3153200e+00  -2.5172500e+00  -2.7276300e+00  -2.8854700e+00  -3.0713000e+00  -3.2868800e+00  -3.4764200e+00  -3.6904300e+00  -3.8691700e+00  -4.0479100e+00  -4.2238500e+00  -4.4002000e+00  -4.5557300e+00  -4.8065300e+00  -4.8639100e+00];
an3=-699.132+[-1.4183800e+00  -1.1712000e+00  -7.8557100e-01  -5.1205400e-01  -3.1755400e-01  -2.6719500e-01  -1.3266700e-01  -3.9310700e-02   5.1531600e-02   1.1779700e-01   1.8734500e-01   2.6182100e-01   3.2372100e-01   3.8790400e-01   4.3741400e-01   4.8311500e-01   5.2461700e-01   5.6271500e-01   5.9374200e-01   6.3981700e-01   6.4974600e-01];
% 17116
ao1=16.2684+[1.5435300e-01   2.8914000e-01  -6.6875900e-02  -3.8883700e-01  -7.2907400e-01  -8.3479700e-01  -1.1435400e+00  -1.3767500e+00  -1.6209200e+00  -1.8108700e+00  -2.0204700e+00  -2.2585700e+00  -2.4651500e+00  -2.6888100e+00  -2.8674700e+00  -3.0389000e+00  -3.2014300e+00  -3.3576400e+00  -3.4904200e+00  -3.6941600e+00  -3.7395700e+00];
ao2=449.981+[2.0571100e+00   1.6704000e-01  -1.0094000e+00  -1.7491400e+00  -2.2230300e+00  -2.3437400e+00  -2.6742200e+00  -2.9184300e+00  -3.1729200e+00  -3.3643300e+00  -3.5885900e+00  -3.8472900e+00  -4.0745900e+00  -4.3306500e+00  -4.5442200e+00  -4.7574300e+00  -4.9672300e+00  -5.1770500e+00  -5.3617400e+00  -5.6594000e+00  -5.7274800e+00];
ao3=-696.273+[-1.6334300e+00  -1.2543100e+00  -7.5607200e-01  -4.0447300e-01  -1.5598500e-01  -9.1831800e-02   8.0351000e-02   2.0097200e-01   3.1960600e-01   4.0668200e-01   4.9955800e-01   6.0027100e-01   6.8484000e-01   7.7377700e-01   8.4339400e-01   9.0856000e-01   9.6871200e-01   1.0249100e+00   1.0714300e+00   1.1417700e+00   1.1571600e+00];
% 14886
ap1=9.91704+[3.8729600e-01   3.8096800e-01  -2.5752300e-01  -8.0320000e-01  -1.3312200e+00  -1.4888400e+00  -1.9405600e+00  -2.2802200e+00  -2.6344500e+00  -2.9073900e+00  -3.2088800e+00  -3.5473900e+00  -3.8409100e+00  -4.1590500e+00  -4.4136600e+00  -4.6584700e+00  -4.8911400e+00  -5.1142600e+00  -5.3032100e+00  -5.5932100e+00  -5.6573900e+00];
ap2=444.847+[2.4108500e+00   4.2825900e-01  -6.6479000e-01  -1.3145100e+00  -1.7007700e+00  -1.7953500e+00  -2.0517000e+00  -2.2412600e+00  -2.4390700e+00  -2.5869400e+00  -2.7634300e+00  -2.9696600e+00  -3.1490400e+00  -3.3515900e+00  -3.5214900e+00  -3.6912100e+00  -3.8583500e+00  -4.0261400e+00  -4.1744000e+00  -4.4127800e+00  -4.4667700e+00];
ap3=-691.954+[-1.5620500e+00  -1.3816400e+00  -1.0739600e+00  -8.5220600e-01  -6.8846600e-01  -6.4618800e-01  -5.3511500e-01  -4.5888900e-01  -3.8531000e-01  -3.3275300e-01  -2.7902600e-01  -2.2399300e-01  -1.8036100e-01  -1.3708100e-01  -1.0543400e-01  -7.7896400e-02  -5.4571000e-02  -3.5062900e-02  -2.0499900e-02  -1.7428200e-03   1.8403500e-03];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_6N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 1297
aq1=12.7746+[-4.3484900e-01   2.2124800e-01  -1.1919100e-01  -5.8484100e-01  -9.8527400e-01  -1.3384700e+00  -1.7244500e+00  -2.1097700e+00  -2.3688800e+00  -2.6748600e+00  -2.9598700e+00  -3.3229200e+00  -3.6165300e+00  -3.8173000e+00  -4.0707500e+00  -4.3150100e+00  -4.5476000e+00  -4.7689800e+00  -5.0747200e+00  -5.2462500e+00  -5.3680900e+00];
aq2=447.736+[2.5760800e+00   6.9832400e-01  -4.2107800e-01  -1.2948200e+00  -1.8490400e+00  -2.1777200e+00  -2.4839400e+00  -2.7796800e+00  -2.9702300e+00  -3.1915200e+00  -3.4087000e+00  -3.6954200e+00  -3.9295500e+00  -4.0943600e+00  -4.3086400e+00  -4.5229200e+00  -4.7340800e+00  -4.9426300e+00  -5.2461100e+00  -5.4248200e+00  -5.5543500e+00];
aq3=-690.116+[-9.0088400e-02  -1.3693100e+00  -1.0345700e+00  -7.1217200e-01  -4.9496100e-01  -3.4395400e-01  -1.9863300e-01  -6.4165100e-02   2.0917100e-02   1.1594500e-01   2.0029100e-01   3.0125400e-01   3.7789300e-01   4.2818900e-01   4.8928200e-01   5.4525700e-01   5.9586700e-01   6.4127500e-01   7.0000000e-01   7.3098500e-01   7.5210700e-01];
% 16439
ar1=13.5613+[-4.2097600e-01   1.4885600e-01  -6.3154300e-02  -3.8777400e-01  -6.7503300e-01  -9.3274400e-01  -1.2176000e+00  -1.5009300e+00  -1.6922100e+00  -1.9188700e+00  -2.1296000e+00  -2.3988400e+00  -2.6160800e+00  -2.7641800e+00  -2.9505800e+00  -3.1300300e+00  -3.3004900e+00  -3.4625400e+00  -3.6871700e+00  -3.8132000e+00  -3.9033100e+00];
ar2=447.206+[1.7838300e+00   2.9753200e-01  -6.2401900e-01  -1.3314300e+00  -1.7741900e+00  -2.0439500e+00  -2.2999700e+00  -2.5466800e+00  -2.7051300e+00  -2.8888400e+00  -3.0686300e+00  -3.3063100e+00  -3.5021400e+00  -3.6405400e+00  -3.8202400e+00  -4.0002500e+00  -4.1778300e+00  -4.3533900e+00  -4.6094600e+00  -4.7606600e+00  -4.8711200e+00];
ar3=-699.132+[7.7023900e-02  -1.1340100e+00  -8.4882400e-01  -5.6860600e-01  -3.8795100e-01  -2.6289900e-01  -1.4145200e-01  -3.0751700e-02   3.8559000e-02   1.1611400e-01   1.8455300e-01   2.6737100e-01   3.3112400e-01   3.7313900e-01   4.2448000e-01   4.7197500e-01   5.1523900e-01   5.5452100e-01   6.0623700e-01   6.3423800e-01   6.5367900e-01];
% 17116
as1=16.2684+[-4.5758100e-01   1.6575200e-01  -1.7487200e-02  -3.1529700e-01  -5.8464400e-01  -8.3264700e-01  -1.1099900e+00  -1.3866200e+00  -1.5740000e+00  -1.7962600e+00  -2.0028800e+00  -2.2679400e+00  -2.4821900e+00  -2.6283500e+00  -2.8123700e+00  -2.9895300e+00  -3.1576900e+00  -3.3175300e+00  -3.5391900e+00  -3.6635000e+00  -3.7524100e+00];
as2=449.981+[1.9827400e+00   3.7164200e-01  -6.7074900e-01  -1.4967900e+00  -2.0234700e+00  -2.3478100e+00  -2.6561000e+00  -2.9535100e+00  -3.1449500e+00  -3.3674500e+00  -3.5844800e+00  -3.8696400e+00  -4.1042200e+00  -4.2696600e+00  -4.4843800e+00  -4.6991100e+00  -4.9108400e+00  -5.1198800e+00  -5.4239700e+00  -5.6033400e+00  -5.7343100e+00];
as3=-696.273+[-9.3101500e-02  -1.2243200e+00  -8.4736300e-01  -4.8370600e-01  -2.4782900e-01  -8.7059200e-02   6.8827800e-02   2.1222400e-01   3.0254800e-01   4.0433500e-01   4.9549500e-01   6.0731800e-01   6.9440700e-01   7.5246200e-01   8.2422700e-01   8.9156400e-01   9.5386000e-01   1.0114000e+00   1.0887200e+00   1.1313800e+00   1.1613600e+00];
% 14886
at1=9.91704+[-3.8613900e-01   2.2014000e-01  -1.6974100e-01  -6.8276900e-01  -1.1171800e+00  -1.4926700e+00  -1.8985500e+00  -2.3020400e+00  -2.5721500e+00  -2.8906100e+00  -3.1869600e+00  -3.5630300e+00  -3.8665700e+00  -4.0738000e+00  -4.3351600e+00  -4.5868500e+00  -4.8264700e+00  -5.0544000e+00  -5.3688800e+00  -5.5452700e+00  -5.6705800e+00];
at2=444.847+[2.4369800e+00   6.8050900e-01  -3.1852700e-01  -1.0697400e+00  -1.5313500e+00  -1.7951600e+00  -2.0377200e+00  -2.2702700e+00  -2.4192900e+00  -2.5913600e+00  -2.7614400e+00  -2.9882700e+00  -3.1733600e+00  -3.3041500e+00  -3.4745400e+00  -3.6454000e+00  -3.8137900e+00  -3.9804300e+00  -4.2240500e+00  -4.3676900e+00  -4.4716900e+00];
at3=-691.954+[6.2514600e-02  -1.3432700e+00  -1.1160300e+00  -8.9296900e-01  -7.4494800e-01  -6.4052300e-01  -5.4062500e-01  -4.5056800e-01  -3.9444000e-01  -3.3300400e-01  -2.8010100e-01  -2.1896300e-01  -1.7425000e-01  -1.4580900e-01  -1.1244400e-01  -8.3290700e-02  -5.8400400e-02  -3.7653600e-02  -1.3272100e-02  -1.8308000e-03   5.3699900e-03];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_6N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 1297
au1=12.7746+[3.1852000e-01   3.6665700e-01  -1.7892800e-01  -6.5069300e-01  -9.6229100e-01  -1.4039400e+00  -1.7776500e+00  -2.0707800e+00  -2.4217400e+00  -2.7161800e+00  -2.9950200e+00  -3.3126500e+00  -3.6005900e+00  -3.9127400e+00  -4.1620100e+00  -4.4017500e+00  -4.6294800e+00  -4.8472900e+00  -5.0960000e+00  -5.2648700e+00  -5.3822000e+00];
au2=447.736+[2.6057600e+00   5.4515400e-01  -6.9259300e-01  -1.4675900e+00  -1.8287500e+00  -2.1889700e+00  -2.4653900e+00  -2.6804600e+00  -2.9433500e+00  -3.1560800e+00  -3.3713500e+00  -3.6259700e+00  -3.8555700e+00  -4.1132100e+00  -4.3273000e+00  -4.5408400e+00  -4.7512600e+00  -4.9607400e+00  -5.2106200e+00  -5.3877400e+00  -5.5135900e+00];
au3=-690.116+[-1.7472500e+00  -1.4272200e+00  -9.7676700e-01  -6.5640000e-01  -4.9496800e-01  -3.1296900e-01  -1.7778200e-01  -7.6821100e-02   3.8728000e-02   1.2979700e-01   2.1207400e-01   3.0039900e-01   3.7601000e-01   4.5382400e-01   5.1319700e-01   5.6745700e-01   6.1631800e-01   6.6017300e-01   7.0745000e-01   7.3793400e-01   7.5834000e-01];
% 16439
av1=13.5613+[1.4615900e-01   2.4982000e-01  -1.0589200e-01  -4.3500600e-01  -6.6008900e-01  -9.8462000e-01  -1.2640700e+00  -1.4814300e+00  -1.7408100e+00  -1.9593900e+00  -2.1660300e+00  -2.4021500e+00  -2.6155900e+00  -2.8461000e+00  -3.0294100e+00  -3.2052700e+00  -3.3719400e+00  -3.5315900e+00  -3.7141200e+00  -3.8379300e+00  -3.9244500e+00];
av2=447.206+[1.8708400e+00   1.7855600e-01  -8.4539900e-01  -1.4679200e+00  -1.7567300e+00  -2.0554700e+00  -2.2855600e+00  -2.4644000e+00  -2.6824700e+00  -2.8587200e+00  -3.0363200e+00  -3.2465900e+00  -3.4378200e+00  -3.6533900e+00  -3.8323200e+00  -4.0112600e+00  -4.1876300e+00  -4.3634400e+00  -4.5736200e+00  -4.7231000e+00  -4.8302000e+00];
av3=-699.132+[-1.4334300e+00  -1.1948900e+00  -8.0051100e-01  -5.2314600e-01  -3.8842100e-01  -2.3648200e-01  -1.2307500e-01  -3.9603400e-02   5.4430900e-02   1.2864900e-01   1.9527800e-01   2.6754200e-01   3.3023200e-01   3.9507500e-01   4.4492500e-01   4.9090400e-01   5.3259900e-01   5.7049700e-01   6.1198500e-01   6.3936900e-01   6.5805300e-01];
% 17116
aw1=16.2684+[1.3041600e-01   2.6742800e-01  -5.4201100e-02  -3.5449600e-01  -5.6690300e-01  -8.8082600e-01  -1.1535500e+00  -1.3661200e+00  -1.6197600e+00  -1.8340200e+00  -2.0365500e+00  -2.2688600e+00  -2.4792700e+00  -2.7066000e+00  -2.8874800e+00  -3.0609500e+00  -3.2252200e+00  -3.3825000e+00  -3.5624500e+00  -3.6844400e+00  -3.7697200e+00];
aw2=449.981+[2.0970500e+00   2.5672900e-01  -9.1557300e-01  -1.6556300e+00  -2.0038900e+00  -2.3653400e+00  -2.6441300e+00  -2.8605500e+00  -3.1242800e+00  -3.3380300e+00  -3.5524700e+00  -3.8047600e+00  -4.0342100e+00  -4.2923200e+00  -4.5063700e+00  -4.7200900e+00  -4.9306800e+00  -5.1402600e+00  -5.3902200e+00  -5.5678400e+00  -5.6950100e+00];
aw3=-696.273+[-1.6551300e+00  -1.2896900e+00  -7.8223100e-01  -4.2593300e-01  -2.5243900e-01  -5.9059300e-02   8.6571500e-02   1.9450200e-01   3.1742200e-01   4.1499000e-01   5.0404500e-01   6.0194700e-01   6.8767000e-01   7.7760900e-01   8.4777200e-01   9.1343500e-01   9.7398800e-01   1.0300700e+00   1.0925900e+00   1.1345200e+00   1.1634600e+00];
% 14886
ax1=9.91704+[3.7090600e-01   3.7099500e-01  -2.3764800e-01  -7.5916200e-01  -1.0957400e+00  -1.5633300e+00  -1.9552800e+00  -2.2617600e+00  -2.6281100e+00  -2.9346100e+00  -3.2246100e+00  -3.5537500e+00  -3.8515600e+00  -4.1738900e+00  -4.4310000e+00  -4.6781400e+00  -4.9128700e+00  -5.1372600e+00  -5.3932300e+00  -5.5670200e+00  -5.6877800e+00];
ax2=444.847+[2.4504300e+00   5.1888700e-01  -5.6733500e-01  -1.2184900e+00  -1.5124900e+00  -1.7970100e+00  -2.0142400e+00  -2.1825800e+00  -2.3883600e+00  -2.5536200e+00  -2.7225300e+00  -2.9244500e+00  -3.1058600e+00  -3.3101400e+00  -3.4803700e+00  -3.6504800e+00  -3.8181600e+00  -3.9855500e+00  -4.1859100e+00  -4.3280200e+00  -4.4288900e+00];
ax3=-691.954+[-1.5725900e+00  -1.3961700e+00  -1.0785900e+00  -8.5329700e-01  -7.4096000e-01  -6.1324400e-01  -5.2040700e-01  -4.5254000e-01  -3.7662000e-01  -3.1786100e-01  -2.6650800e-01  -2.1324900e-01  -1.6908900e-01  -1.2540000e-01  -9.3506400e-02  -6.5825200e-02  -4.2423900e-02  -2.3047700e-02  -3.9622300e-03   7.1145200e-03   1.3962400e-02];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_6N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 1297
ay1=12.7746+[-4.3481100e-01   2.7508600e-01  -1.5035100e-01  -5.5783400e-01  -9.8416000e-01  -1.3863200e+00  -1.7094400e+00  -2.0848000e+00  -2.5280700e+00  -2.7736000e+00  -3.1090100e+00  -3.3960100e+00  -3.6385500e+00  -4.0083900e+00  -4.2186900e+00  -4.4228400e+00  -4.6518900e+00  -4.8713200e+00  -5.1221200e+00  -5.2934400e+00  -5.4153100e+00];
ay2=447.736+[2.5760400e+00   4.2889500e-01  -6.3709100e-01  -1.3211800e+00  -1.8529900e+00  -2.1830200e+00  -2.4230700e+00  -2.7012500e+00  -3.0308600e+00  -3.2109100e+00  -3.4747400e+00  -3.7028800e+00  -3.8962300e+00  -4.2023400e+00  -4.3834800e+00  -4.5646700e+00  -4.7751600e+00  -4.9852800e+00  -5.2357200e+00  -5.4137500e+00  -5.5432300e+00];
ay3=-690.116+[-9.1370300e-02  -1.3752900e+00  -9.9916300e-01  -7.1602200e-01  -4.8437800e-01  -3.1856400e-01  -2.0066200e-01  -7.0762000e-02   7.3596900e-02   1.4828700e-01   2.4562700e-01   3.2380400e-01   3.8650700e-01   4.7740700e-01   5.2650000e-01   5.7221800e-01   6.2098700e-01   6.6487400e-01   7.1209600e-01   7.4265900e-01   7.6354900e-01];
% 16439
az1=13.5613+[-4.2095300e-01   1.8484400e-01  -8.6712400e-02  -3.6939300e-01  -6.7567700e-01  -9.7107400e-01  -1.2127000e+00  -1.4913300e+00  -1.8194500e+00  -2.0019000e+00  -2.2508400e+00  -2.4643800e+00  -2.6443800e+00  -2.9177100e+00  -3.0726500e+00  -3.2227800e+00  -3.3907600e+00  -3.5518300e+00  -3.7363400e+00  -3.8624000e+00  -3.9525900e+00];
az2=447.206+[1.7840500e+00   7.8337700e-02  -7.9981000e-01  -1.3522400e+00  -1.7773200e+00  -2.0517100e+00  -2.2521300e+00  -2.4838700e+00  -2.7579100e+00  -2.9071600e+00  -3.1251800e+00  -3.3142400e+00  -3.4757700e+00  -3.7322200e+00  -3.8837300e+00  -4.0358500e+00  -4.2124100e+00  -4.3889300e+00  -4.5996800e+00  -4.7499100e+00  -4.8600400e+00];
az3=-699.132+[7.5821900e-02  -1.1464300e+00  -8.2019800e-01  -5.7342900e-01  -3.7936000e-01  -2.4076300e-01  -1.4164200e-01  -3.3830900e-02   8.3872800e-02   1.4471500e-01   2.2386800e-01   2.8818700e-01   3.4036100e-01   4.1631300e-01   4.5763900e-01   4.9651000e-01   5.3811100e-01   5.7608700e-01   6.1754700e-01   6.4505800e-01   6.6422600e-01];
% 17116
ba1=16.2684+[-4.5755800e-01   2.0364900e-01  -3.6934500e-02  -2.9492800e-01  -5.8203300e-01  -8.6797100e-01  -1.1038600e+00  -1.3764600e+00  -1.6976800e+00  -1.8766400e+00  -2.1210300e+00  -2.3314700e+00  -2.5090400e+00  -2.7788000e+00  -2.9317400e+00  -3.0799200e+00  -3.2455400e+00  -3.4043200e+00  -3.5862900e+00  -3.7105700e+00  -3.7995100e+00];
ba2=449.981+[1.9828700e+00   1.4319700e-01  -8.6233700e-01  -1.5165100e+00  -2.0279600e+00  -2.3592600e+00  -2.6016500e+00  -2.8815700e+00  -3.2126600e+00  -3.3932100e+00  -3.6554500e+00  -3.8820600e+00  -4.0756000e+00  -4.3823500e+00  -4.5635100e+00  -4.7450600e+00  -4.9558000e+00  -5.1661200e+00  -5.4167300e+00  -5.5952800e+00  -5.7261000e+00];
ba3=-696.273+[-9.4209400e-02  -1.2287000e+00  -8.0727400e-01  -4.9107100e-01  -2.4091600e-01  -6.4585900e-02   6.2452700e-02   2.0179200e-01   3.5561100e-01   4.3589000e-01   5.4208800e-01   6.2938200e-01   7.0084400e-01   8.0646100e-01   8.6486800e-01   9.2041100e-01   9.8085900e-01   1.0370800e+00   1.0996300e+00   1.1418100e+00   1.1715500e+00];
% 14886
bb1=9.91704+[-3.8609900e-01   2.7467100e-01  -2.0573600e-01  -6.5625900e-01  -1.1189300e+00  -1.5445300e+00  -1.8834000e+00  -2.2758300e+00  -2.7381200e+00  -2.9935000e+00  -3.3418100e+00  -3.6388200e+00  -3.8895000e+00  -4.2711300e+00  -4.4879100e+00  -4.6982600e+00  -4.9343000e+00  -5.1602700e+00  -5.4183100e+00  -5.5945500e+00  -5.7199200e+00];
bb2=444.847+[2.4370000e+00   4.1613500e-01  -5.1977000e-01  -1.0971600e+00  -1.5327000e+00  -1.7940200e+00  -1.9831600e+00  -2.2016700e+00  -2.4597400e+00  -2.6002300e+00  -2.8085900e+00  -2.9895100e+00  -3.1424900e+00  -3.3855900e+00  -3.5297800e+00  -3.6742500e+00  -3.8420300e+00  -4.0100500e+00  -4.2109000e+00  -4.3537400e+00  -4.4575300e+00];
bb3=-691.954+[6.1123100e-02  -1.3584200e+00  -1.0946400e+00  -8.9467600e-01  -7.3346700e-01  -6.1703800e-01  -5.3572400e-01  -4.4823800e-01  -3.5347000e-01  -3.0564800e-01  -2.4543900e-01  -1.9865700e-01  -1.6224700e-01  -1.1161200e-01  -8.5584400e-02  -6.2328100e-02  -3.9004700e-02  -1.9662900e-02  -6.8605100e-04   1.0351400e-02   1.7284100e-02];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_6N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 1297
bc1=12.7746+[3.8812000e-01   1.7945200e-01  -3.1873300e-01  -6.5451700e-01  -9.7900500e-01  -1.5709000e+00  -1.9044100e+00  -1.9832900e+00  -2.3388100e+00  -2.6317800e+00  -2.8323000e+00  -3.1374300e+00  -3.6083100e+00  -3.6725200e+00  -3.9111700e+00  -4.3513500e+00  -4.4078800e+00  -4.6348200e+00  -4.8109000e+00  -5.0839300e+00  -5.2155200e+00];
bc2=447.736+[2.8364000e+00   6.8320500e-02  -6.7720500e-01  -1.0972700e+00  -1.3879200e+00  -1.8538300e+00  -2.1127900e+00  -2.1758000e+00  -2.4589100e+00  -2.6779100e+00  -2.8270900e+00  -3.0539600e+00  -3.4210100e+00  -3.4693800e+00  -3.6518500e+00  -4.0003800e+00  -4.0470300e+00  -4.2383700e+00  -4.3941500e+00  -4.6484700e+00  -4.7757400e+00];
bc3=-690.116+[-1.3218300e+00  -8.1450100e-01  -4.4645900e-01  -2.4103600e-01  -8.5182200e-02   1.6087900e-01   2.8858000e-01   3.1798000e-01   4.4448200e-01   5.4037000e-01   6.0231300e-01   6.9129200e-01   8.1783200e-01   8.3402400e-01   8.9250500e-01   9.9309800e-01   1.0053600e+00   1.0525200e+00   1.0877300e+00   1.1403100e+00   1.1653700e+00];
% 16439
bd1=13.5613+[2.2240800e-01   1.2861700e-01  -2.0570700e-01  -4.4281700e-01  -6.7939000e-01  -1.1169300e+00  -1.3630300e+00  -1.4212600e+00  -1.6840600e+00  -1.9019500e+00  -2.0518300e+00  -2.2801200e+00  -2.6314300e+00  -2.6792000e+00  -2.8563400e+00  -3.1829800e+00  -3.2249700e+00  -3.3938800e+00  -3.5246300e+00  -3.7272900e+00  -3.8247100e+00];
bd2=447.206+[2.0702900e+00  -1.9522500e-01  -8.1680600e-01  -1.1609500e+00  -1.4052300e+00  -1.8014200e+00  -2.0215000e+00  -2.0749400e+00  -2.3143700e+00  -2.4996200e+00  -2.6261400e+00  -2.8192500e+00  -3.1336300e+00  -3.1755000e+00  -3.3330900e+00  -3.6348900e+00  -3.6751800e+00  -3.8407100e+00  -3.9746300e+00  -4.1927200e+00  -4.3013800e+00];
bd3=-699.132+[-1.1512300e+00  -7.4470500e-01  -4.2207900e-01  -2.4577500e-01  -1.1336300e-01   9.3588400e-02   1.9971200e-01   2.2398700e-01   3.2770000e-01   4.0671700e-01   4.5824200e-01   5.3372000e-01   6.4331300e-01   6.5763200e-01   7.0964600e-01   8.0057100e-01   8.1173300e-01   8.5540500e-01   8.8790500e-01   9.3642700e-01   9.5912800e-01];
% 17116
be1=16.2684+[2.0733300e-01   1.5961700e-01  -1.4196200e-01  -3.6025600e-01  -5.8591100e-01  -1.0091500e+00  -1.2481100e+00  -1.3046200e+00  -1.5598100e+00  -1.7723600e+00  -1.9190000e+00  -2.1434000e+00  -2.4890200e+00  -2.5360800e+00  -2.7108400e+00  -3.0331500e+00  -3.0745500e+00  -3.2413100e+00  -3.3703100e+00  -3.5703100e+00  -3.6664800e+00];
be2=449.981+[2.3181800e+00  -1.6354700e-01  -9.0129200e-01  -1.3166100e+00  -1.6119500e+00  -2.0899500e+00  -2.3556500e+00  -2.4201500e+00  -2.7095600e+00  -2.9343300e+00  -3.0875300e+00  -3.3206400e+00  -3.6987000e+00  -3.7492000e+00  -3.9389300e+00  -4.3020700e+00  -4.3505500e+00  -4.5491400e+00  -4.7095900e+00  -4.9703400e+00  -5.1001400e+00];
be3=-696.273+[-1.3985200e+00  -8.0524000e-01  -4.0212500e-01  -1.7909500e-01  -1.2522200e-02   2.4942400e-01   3.8554300e-01   4.1693600e-01   5.5224300e-01   6.5602600e-01   7.2419100e-01   8.2488100e-01   9.7363400e-01   9.9319100e-01   1.0646400e+00   1.1916900e+00   1.2075300e+00   1.2700800e+00   1.3174100e+00   1.3893300e+00   1.4234300e+00];
% 14886
bf1=9.91704+[4.3791600e-01   1.5952400e-01  -3.9758000e-01  -7.6753200e-01  -1.1160000e+00  -1.7432500e+00  -2.0949400e+00  -2.1780600e+00  -2.5521900e+00  -2.8590000e+00  -3.0683300e+00  -3.3854900e+00  -3.8742800e+00  -3.9408100e+00  -4.1875900e+00  -4.6422500e+00  -4.7006800e+00  -4.9348000e+00  -5.1163600e+00  -5.3976200e+00  -5.5331000e+00];
bf2=444.847+[2.6550600e+00   7.3640900e-02  -5.4701000e-01  -8.8887300e-01  -1.1198300e+00  -1.4868100e+00  -1.6897000e+00  -1.7391700e+00  -1.9607100e+00  -2.1304100e+00  -2.2462700e+00  -2.4232500e+00  -2.7109000e+00  -2.7484300e+00  -2.8905200e+00  -3.1619700e+00  -3.1983100e+00  -3.3481600e+00  -3.4706900e+00  -3.6716100e+00  -3.7722800e+00];
bf3=-691.954+[-1.0947100e+00  -7.9619600e-01  -5.2537100e-01  -3.7762200e-01  -2.6541400e-01  -9.1776700e-02  -4.4172700e-03   1.5374500e-02   9.8941400e-02   1.6089200e-01   2.0007100e-01   2.5477800e-01   3.2843000e-01   3.3753500e-01   3.6960800e-01   4.2121100e-01   4.2711900e-01   4.4884000e-01   4.6399300e-01   4.8495800e-01   4.9459500e-01];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_6N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 1297
bg1=12.7746+[-2.9740500e-01  -1.3419100e-02  -7.9059300e-02  -2.9015600e-01  -8.2905600e-01  -1.0382500e+00  -1.5093100e+00  -1.8329000e+00  -2.1450300e+00  -2.3353000e+00  -2.5624300e+00  -2.8319100e+00  -3.1382600e+00  -3.4205400e+00  -3.6759800e+00  -3.9418700e+00  -4.1864900e+00  -4.4652200e+00  -4.6928900e+00  -4.9781600e+00  -5.1075400e+00];
bg2=447.736+[2.7438700e+00   2.2526600e+00   1.5353700e+00   8.8489900e-01  -3.0622600e-01  -6.8358100e-01  -1.3804100e+00  -1.7933100e+00  -2.1526100e+00  -2.3609600e+00  -2.5928300e+00  -2.8458500e+00  -3.1104900e+00  -3.3437800e+00  -3.5459200e+00  -3.7505300e+00  -3.9375800e+00  -4.1527900e+00  -4.3328000e+00  -4.5702600e+00  -4.6814300e+00];
bg3=-690.116+[-7.2232400e-01  -1.0611700e+00  -8.3116400e-01  -5.8589000e-01  -1.5325600e-01  -3.2997900e-02   1.8678400e-01   3.1636700e-01   4.2876600e-01   4.9247900e-01   5.6478800e-01   6.4556400e-01   7.3125000e-01   8.0480100e-01   8.6725400e-01   9.2886200e-01   9.8263700e-01   1.0405000e+00   1.0858100e+00   1.1404800e+00   1.1648700e+00];
% 16439
bh1=13.5613+[-2.9872300e-01  -5.9451700e-02  -5.4452300e-02  -1.8110600e-01  -5.5006900e-01  -7.0234100e-01  -1.0495500e+00  -1.2888700e+00  -1.5216200e+00  -1.6639400e+00  -1.8339600e+00  -2.0360800e+00  -2.2657800e+00  -2.4774900e+00  -2.6684700e+00  -2.8673300e+00  -3.0502500e+00  -3.2589100e+00  -3.4294800e+00  -3.6429500e+00  -3.7397600e+00];
bh2=447.206+[2.0430200e+00   1.5680200e+00   9.6415500e-01   4.2206500e-01  -5.3985400e-01  -8.4516300e-01  -1.4185100e+00  -1.7617300e+00  -2.0610900e+00  -2.2347600e+00  -2.4283400e+00  -2.6411600e+00  -2.8658000e+00  -3.0658000e+00  -3.2401800e+00  -3.4172600e+00  -3.5801100e+00  -3.7674800e+00  -3.9238500e+00  -4.1295100e+00  -4.2254900e+00];
bh3=-699.132+[-5.8657500e-01  -9.2655800e-01  -7.4600400e-01  -5.3890200e-01  -1.7068300e-01  -7.1585700e-02   1.0841600e-01   2.1431800e-01   3.0605200e-01   3.5807700e-01   4.1737800e-01   4.8499900e-01   5.5862100e-01   6.2331800e-01   6.7922800e-01   7.3496600e-01   7.8453000e-01   8.3858200e-01   8.8112200e-01   9.3252600e-01   9.5522100e-01];
% 17116
bi1=16.2684+[-3.2813800e-01  -5.8966600e-02  -2.5150500e-02  -1.2687400e-01  -4.5785100e-01  -6.0066300e-01  -9.3356100e-01  -1.1648500e+00  -1.3910200e+00  -1.5296100e+00  -1.6955000e+00  -1.8936100e+00  -2.1197300e+00  -2.3285200e+00  -2.5172900e+00  -2.7141700e+00  -2.8953500e+00  -3.1020500e+00  -3.2711200e+00  -3.4827300e+00  -3.5787400e+00];
bi2=449.981+[2.2464200e+00   1.7508500e+00   1.0703800e+00   4.4832800e-01  -6.7271000e-01  -1.0262000e+00  -1.6881600e+00  -2.0864800e+00  -2.4355100e+00  -2.6386700e+00  -2.8664100e+00  -3.1178200e+00  -3.3844300e+00  -3.6225300e+00  -3.8307700e+00  -4.0427900e+00  -4.2382900e+00  -4.4635400e+00  -4.6514000e+00  -4.8981300e+00  -5.0132200e+00];
bi3=-696.273+[-7.6833000e-01  -1.1162200e+00  -8.8208200e-01  -6.1750000e-01  -1.3467600e-01  -1.7209900e-03   2.4030700e-01   3.8354900e-01   5.0822600e-01   5.7941500e-01   6.6055900e-01   7.5277000e-01   8.5308500e-01   9.4164500e-01   1.0185900e+00   1.0957700e+00   1.1650200e+00   1.2414100e+00   1.3021800e+00   1.3768800e+00   1.4102500e+00];
% 14886
bk1=9.91704+[-2.5342700e-01   7.7056400e-05  -1.0972900e-01  -3.6069300e-01  -9.6418900e-01  -1.1911400e+00  -1.6931000e+00  -2.0350400e+00  -2.3631500e+00  -2.5625800e+00  -2.8001900e+00  -3.0809200e+00  -3.3988500e+00  -3.6911700e+00  -3.9549200e+00  -4.2289100e+00  -4.4807700e+00  -4.7675700e+00  -5.0014900e+00  -5.2943500e+00  -5.4271100e+00];
bk2=444.847+[2.6061700e+00   2.1429500e+00   1.5066400e+00   9.3878600e-01  -9.1105700e-02  -4.1776300e-01  -1.0171600e+00  -1.3676800e+00  -1.6694900e+00  -1.8433300e+00  -2.0346000e+00  -2.2411900e+00  -2.4546500e+00  -2.6411300e+00  -2.8013400e+00  -2.9623200e+00  -3.1084900e+00  -3.2760200e+00  -3.4163800e+00  -3.6021700e+00  -3.6891800e+00];
bk3=-691.954+[-5.6563500e-01  -9.0406200e-01  -7.4035700e-01  -5.6368400e-01  -2.6579600e-01  -1.8677700e-01  -4.4881000e-02   3.6844800e-02   1.0643500e-01   1.4502400e-01   1.8843800e-01   2.3651500e-01   2.8673600e-01   3.2859400e-01   3.6290700e-01   3.9569900e-01   4.2307600e-01   4.5092400e-01   4.7168300e-01   4.9502500e-01   5.0505400e-01];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (6N)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (6N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')