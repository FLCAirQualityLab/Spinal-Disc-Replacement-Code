%% foramen height and width narrowing/widening 
% for all models for the c3-c4 right hand side foramen 
% 4457,20101,9037,21922

% 5N!!

% Values for displacement and base coordinates have not yet been updated from copy paste.

k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 4457,20101,9037,21922
%% model15_intact_TLC_5N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 4457
aa1=-9.37506+[5.0731200e-01   7.7645100e-03  -4.3072000e-01  -1.1044600e+00  -1.7626000e+00  -2.3750000e+00  -2.8996000e+00  -3.4518900e+00  -4.0545600e+00  -4.5264100e+00  -5.1149100e+00  -5.4117200e+00  -5.8002400e+00  -6.0537800e+00  -6.3238900e+00  -6.5977800e+00  -6.8340000e+00  -7.0976200e+00  -7.2686200e+00  -7.5051500e+00  -7.6379800e+00];
aa2=448.144+[1.0306900e+00   3.0518600e-01   2.9862300e-01   6.3547000e-01   1.2304700e+00   1.9236700e+00   2.6158500e+00   3.4238200e+00   4.3841000e+00   5.1481600e+00   6.0974300e+00   6.5667600e+00   7.1632800e+00   7.5423100e+00   7.9321100e+00   8.3211100e+00   8.6643000e+00   9.0671200e+00   9.3322100e+00   9.7008100e+00   9.9122900e+00];
aa3=-689.149+[-6.7815900e-01  -8.7507300e-01  -1.0436700e+00  -1.3749000e+00  -1.7225000e+00  -2.0600700e+00  -2.3696000e+00  -2.7184500e+00  -3.1392600e+00  -3.4906100e+00  -3.9536900e+00  -4.1965200e+00  -4.5221600e+00  -4.7347300e+00  -4.9628300e+00  -5.1989400e+00  -5.4096800e+00  -5.6587400e+00  -5.8239400e+00  -6.0568900e+00  -6.1922600e+00];

% 20101
ab1=-11.8681+[3.3679400e-01   8.3985100e-03  -3.0647300e-01  -7.9624000e-01  -1.2885900e+00  -1.7565500e+00  -2.1629000e+00  -2.5923500e+00  -3.0598000e+00  -3.4253800e+00  -3.8798800e+00  -4.1075300e+00  -4.4047600e+00  -4.6000200e+00  -4.8081400e+00  -5.0195400e+00  -5.2021100e+00  -5.4067000e+00  -5.5394700e+00  -5.7225100e+00  -5.8248400e+00];
ab2=447.151+[5.9687600e-01   2.5077600e-02   3.8838000e-02   3.2903300e-01   8.2108600e-01   1.3890800e+00   1.9522700e+00   2.6112700e+00   3.3971300e+00   4.0232200e+00   4.7943000e+00   5.1736100e+00   5.6548100e+00   5.9580200e+00   6.2678400e+00   6.5759200e+00   6.8474400e+00   7.1657200e+00   7.3756800e+00   7.6688900e+00   7.8376300e+00];
ab3=-698.575+[-5.1114300e-01  -7.0239800e-01  -8.6446600e-01  -1.1611300e+00  -1.4664100e+00  -1.7566300e+00  -2.0169100e+00  -2.3082400e+00  -2.6600100e+00  -2.9533300e+00  -3.3331500e+00  -3.5295100e+00  -3.7915600e+00  -3.9592600e+00  -4.1369200e+00  -4.3196700e+00  -4.4819600e+00  -4.6725700e+00  -4.7979700e+00  -4.9743600e+00  -5.0769100e+00];

% 9037
ac1=-7.50723+[5.6194400e-01   2.1800400e-02  -4.4302500e-01  -1.1584200e+00  -1.8518500e+00  -2.4944500e+00  -3.0443300e+00  -3.6248500e+00  -4.2627300e+00  -4.7633000e+00  -5.3880100e+00  -5.7041500e+00  -6.1189600e+00  -6.3893400e+00  -6.6778900e+00  -6.9713300e+00  -7.2252700e+00  -7.5102200e+00  -7.6952900e+00  -7.9518100e+00  -8.0964400e+00];
ac2=444.719+[1.0471600e+00   3.0155400e-01   2.7044100e-01   5.6116600e-01   1.1105600e+00   1.7626100e+00   2.4198900e+00   3.1912300e+00   4.1109300e+00   4.8448000e+00   5.7588600e+00   6.2112300e+00   6.7866200e+00   7.1528700e+00   7.5295900e+00   7.9056900e+00   8.2379300e+00   8.6284000e+00   8.8858000e+00   9.2441000e+00   9.4498400e+00];
ac3=-690.512+[-6.4682200e-01  -8.5119300e-01  -9.9379300e-01  -1.2605600e+00  -1.5287500e+00  -1.7844700e+00  -2.0168700e+00  -2.2787800e+00  -2.5975900e+00  -2.8670900e+00  -3.2253400e+00  -3.4147900e+00  -3.6713500e+00  -3.8393300e+00  -4.0204600e+00  -4.2088700e+00  -4.3775100e+00  -4.5771800e+00  -4.7101900e+00  -4.8986700e+00  -5.0087600e+00];

% 21922
ad1=-12.9198+[3.2311600e-01  -7.4547300e-03  -3.2673800e-01  -8.2367900e-01  -1.3275200e+00  -1.8079700e+00  -2.2253400e+00  -2.6653700e+00  -3.1420300e+00  -3.5146000e+00  -3.9787100e+00  -4.2111800e+00  -4.5146100e+00  -4.7145600e+00  -4.9279000e+00  -5.1445500e+00  -5.3314200e+00  -5.5402600e+00  -5.6758500e+00  -5.8624600e+00  -5.9663600e+00];
ad2=450.785+[6.8449100e-01   7.1421600e-02   8.9024900e-02   4.0827700e-01   9.4501600e-01   1.5612100e+00   2.1705100e+00   2.8824700e+00   3.7312800e+00   4.4072100e+00   5.2397500e+00   5.6492500e+00   6.1686000e+00   6.4954200e+00   6.8291300e+00   7.1609000e+00   7.4531200e+00   7.7957000e+00   8.0213300e+00   8.3361600e+00   8.5173500e+00];
ad3=-694.998+[-6.0699400e-01  -7.5567700e-01  -9.2334000e-01  -1.2532900e+00  -1.6108000e+00  -1.9588900e+00  -2.2758600e+00  -2.6336400e+00  -3.0661400e+00  -3.4256800e+00  -3.8907000e+00  -4.1303300e+00  -4.4484900e+00  -4.6520900e+00  -4.8669800e+00  -5.0873600e+00  -5.2829600e+00  -5.5130300e+00  -5.6643500e+00  -5.8769200e+00  -6.0003600e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 4457
ae1=-9.37506+[-3.0640500e-01  -2.0881800e-01  -4.3745700e-01  -7.8808200e-01  -1.2860100e+00  -1.5289900e+00  -2.0620500e+00  -2.5545300e+00  -3.0913200e+00  -3.6038700e+00  -4.0824600e+00  -4.5354800e+00  -5.0402800e+00  -5.5090000e+00  -6.1264500e+00  -6.5000600e+00  -6.7392400e+00  -7.1168700e+00  -7.3537500e+00  -7.7799100e+00  -7.8264700e+00];
ae2=448.144+[2.1859200e+00   1.9900500e+00   1.8953500e+00   1.8939300e+00   1.9472000e+00   1.9949100e+00   2.1582700e+00   2.3754100e+00   2.6944300e+00   3.0798800e+00   3.4937200e+00   3.9288700e+00   4.4807000e+00   5.0654800e+00   5.9340500e+00   6.5124600e+00   6.9092000e+00   7.5730900e+00   8.0163100e+00   8.8420200e+00   8.9336200e+00];
ae3=-689.149+[-1.1481100e+00  -1.4986000e+00  -1.7153200e+00  -1.9158100e+00  -2.1766900e+00  -2.3020900e+00  -2.5759500e+00  -2.8292500e+00  -3.1102200e+00  -3.3859900e+00  -3.6500300e+00  -3.9066500e+00  -4.2065200e+00  -4.5050000e+00  -4.9328500e+00  -5.2119000e+00  -5.4035400e+00  -5.7284900e+00  -5.9496900e+00  -6.3708700e+00  -6.4184500e+00];

% 20101
af1=-11.8681+[-3.2046100e-01  -2.2060900e-01  -3.3156300e-01  -5.6220800e-01  -9.1152400e-01  -1.0870600e+00  -1.4809300e+00  -1.8535200e+00  -2.2665900e+00  -2.6639300e+00  -3.0369300e+00  -3.3922400e+00  -3.7887900e+00  -4.1564500e+00  -4.6429800e+00  -4.9380400e+00  -5.1267000e+00  -5.4234500e+00  -5.6082700e+00  -5.9387800e+00  -5.9746500e+00];
af2=447.151+[1.5394400e+00   1.2966200e+00   1.2099200e+00   1.2254400e+00   1.2903600e+00   1.3388900e+00   1.4889600e+00   1.6797700e+00   1.9549500e+00   2.2857700e+00   2.6398800e+00   3.0087100e+00   3.4733400e+00   3.9638400e+00   4.6780300e+00   5.1463300e+00   5.4660300e+00   5.9979000e+00   6.3522500e+00   7.0130200e+00   7.0864400e+00];
af3=-698.575+[-8.3785300e-01  -1.1034800e+00  -1.2753000e+00  -1.4525300e+00  -1.6832100e+00  -1.7936800e+00  -2.0333900e+00  -2.2560600e+00  -2.5035500e+00  -2.7469400e+00  -2.9805500e+00  -3.2063100e+00  -3.4678700e+00  -3.7260200e+00  -4.0869600e+00  -4.3157900e+00  -4.4708400e+00  -4.7299100e+00  -4.9038500e+00  -5.2326700e+00  -5.2697500e+00];

% 9037
ag1=-7.50723+[-2.5743400e-01  -1.6565200e-01  -4.2761300e-01  -8.1273400e-01  -1.3551300e+00  -1.6184400e+00  -2.1931100e+00  -2.7208400e+00  -3.2927000e+00  -3.8362300e+00  -4.3421300e+00  -4.8202700e+00  -5.3540600e+00  -5.8514100e+00  -6.5076200e+00  -6.9053600e+00  -7.1609500e+00  -7.5663900e+00  -7.8221300e+00  -8.2837400e+00  -8.3342400e+00];
ag2=444.719+[2.1685800e+00   1.9655000e+00   1.8414000e+00   1.8109500e+00   1.8278800e+00   1.8592400e+00   1.9887400e+00   2.1765300e+00   2.4652700e+00   2.8230800e+00   3.2122100e+00   3.6245900e+00   4.1507900e+00   4.7112300e+00   5.5475400e+00   6.1066700e+00   6.4909900e+00   7.1352400e+00   7.5661500e+00   8.3707900e+00   8.4602100e+00];
ag3=-690.512+[-1.0346900e+00  -1.3752400e+00  -1.5614500e+00  -1.7315700e+00  -1.9528200e+00  -2.0594900e+00  -2.2907600e+00  -2.5021800e+00  -2.7336500e+00  -2.9582900e+00  -3.1717000e+00  -3.3775100e+00  -3.6158900e+00  -3.8514600e+00  -4.1846800e+00  -4.4000600e+00  -4.5479800e+00  -4.7992700e+00  -4.9711100e+00  -5.3004500e+00  -5.3378600e+00];

% 21922
ah1=-12.9198+[-3.6086200e-01  -2.5921000e-01  -3.7137800e-01  -6.0314200e-01  -9.5291400e-01  -1.1286100e+00  -1.5243500e+00  -1.9002700e+00  -2.3187000e+00  -2.7230200e+00  -3.1037700e+00  -3.4668100e+00  -3.8711000e+00  -4.2449500e+00  -4.7400000e+00  -5.0405100e+00  -5.2323600e+00  -5.5333200e+00  -5.7202300e+00  -6.0539700e+00  -6.0901400e+00];
ah2=450.785+[1.7083600e+00   1.4647200e+00   1.3780500e+00   1.3976100e+00   1.4710000e+00   1.5242100e+00   1.6868400e+00   1.8936900e+00   2.1915300e+00   2.5483300e+00   2.9299200e+00   3.3271700e+00   3.8272900e+00   4.3552600e+00   5.1258500e+00   5.6313900e+00   5.9765900e+00   6.5508400e+00   6.9334900e+00   7.6462500e+00   7.7253800e+00];
ah3=-694.998+[-1.0313900e+00  -1.2961800e+00  -1.4684300e+00  -1.6504500e+00  -1.8907000e+00  -2.0065100e+00  -2.2611100e+00  -2.5033100e+00  -2.7790100e+00  -3.0555200e+00  -3.3249100e+00  -3.5882400e+00  -3.8970900e+00  -4.2056700e+00  -4.6446600e+00  -4.9266900e+00  -5.1187800e+00  -5.4405300e+00  -5.6571500e+00  -6.0666400e+00  -6.1127600e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5N
t2=[2 2.05126 2.1153 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 4457
ai1=-9.37506+[-1.7017400e-01  -1.4243800e-01  -2.5574800e-01  -4.3224200e-01  -6.6520000e-01  -9.8594600e-01  -1.1449100e+00  -1.5143300e+00  -1.9017100e+00  -2.2883000e+00  -2.7753500e+00  -3.0658700e+00  -3.4688200e+00  -4.1049100e+00  -4.3716000e+00  -4.7026600e+00  -5.3418100e+00  -5.6032300e+00  -6.0499000e+00  -6.5111400e+00  -6.7239100e+00];
ai2=448.144+[2.5984000e+00   2.5012400e+00   2.4811400e+00   2.5055800e+00   2.5528900e+00   2.6323500e+00   2.6768600e+00   2.7886100e+00   2.9225800e+00   3.0770100e+00   3.2947900e+00   3.4414000e+00   3.6581200e+00   4.0471000e+00   4.2262600e+00   4.4669400e+00   4.9899200e+00   5.2238500e+00   5.6549100e+00   6.1464100e+00   6.3894600e+00];
ai3=-689.149+[-1.3210800e+00  -1.4973000e+00  -1.6835100e+00  -1.8454400e+00  -2.0203800e+00  -2.2397200e+00  -2.3417500e+00  -2.5620900e+00  -2.7818900e+00  -2.9976800e+00  -3.2652200e+00  -3.4215500e+00  -3.6374400e+00  -3.9769700e+00  -4.1206000e+00  -4.3030300e+00  -4.6681300e+00  -4.8218800e+00  -5.0930000e+00  -5.3878200e+00  -5.5298400e+00];

% 20101
aj1=-11.8681+[-2.1616900e-01  -1.8148400e-01  -2.1861300e-01  -3.1310600e-01  -4.5424200e-01  -6.6119100e-01  -7.6850000e-01  -1.0275200e+00  -1.3085400e+00  -1.5956400e+00  -1.9646800e+00  -2.1878000e+00  -2.4992700e+00  -2.9978300e+00  -3.2084900e+00  -3.4706300e+00  -3.9781100e+00  -4.1857600e+00  -4.5396500e+00  -4.9043300e+00  -5.0721000e+00];
aj2=447.151+[1.8236600e+00   1.7076500e+00   1.6655400e+00   1.6818500e+00   1.7232400e+00   1.7932500e+00   1.8312400e+00   1.9267700e+00   2.0463300e+00   2.1842400e+00   2.3777200e+00   2.5070100e+00   2.6953200e+00   3.0273000e+00   3.1797300e+00   3.3833500e+00   3.8235700e+00   4.0194700e+00   4.3789900e+00   4.7843900e+00   4.9842000e+00];
aj3=-698.575+[-9.6580700e-01  -1.0862800e+00  -1.2159800e+00  -1.3425100e+00  -1.4841300e+00  -1.6630800e+00  -1.7469600e+00  -1.9321900e+00  -2.1222500e+00  -2.3113400e+00  -2.5478600e+00  -2.6870700e+00  -2.8789000e+00  -3.1795900e+00  -3.3066600e+00  -3.4675900e+00  -3.7870200e+00  -3.9198800e+00  -4.1517900e+00  -4.4001200e+00  -4.5188900e+00];

% 9037
ak1=-7.50723+[-1.1656300e-01  -9.0507600e-02  -2.2248200e-01  -4.2130500e-01  -6.8042600e-01  -1.0358100e+00  -1.2111300e+00  -1.6163400e+00  -2.0395600e+00  -2.4596800e+00  -2.9863500e+00  -3.2983300e+00  -3.7296400e+00  -4.4054300e+00  -4.6881600e+00  -5.0389400e+00  -5.7165100e+00  -5.9939200e+00  -6.4677900e+00  -6.9573700e+00  -7.1835000e+00];
ak2=444.719+[2.5710800e+00   2.4711600e+00   2.4308200e+00   2.4336400e+00   2.4570200e+00   2.5063500e+00   2.5370000e+00   2.6193500e+00   2.7253100e+00   2.8541500e+00   3.0424000e+00   3.1730100e+00   3.3687300e+00   3.7277200e+00   3.8949000e+00   4.1209400e+00   4.6160600e+00   4.8387800e+00   5.2510200e+00   5.7232500e+00   5.9574700e+00];
ak3=-690.512+[-1.1726200e+00  -1.3445800e+00  -1.5031200e+00  -1.6375500e+00  -1.7825600e+00  -1.9642200e+00  -2.0485400e+00  -2.2305900e+00  -2.4136300e+00  -2.5940800e+00  -2.8185200e+00  -2.9494400e+00  -3.1300500e+00  -3.4123100e+00  -3.5314300e+00  -3.6822100e+00  -3.9827100e+00  -4.1088700e+00  -4.3304600e+00  -4.5692400e+00  -4.6839000e+00];

% 21922
al1=-12.9198+[-2.5352100e-01  -2.2189800e-01  -2.6402700e-01  -3.6160100e-01  -5.0535900e-01  -7.1369000e-01  -8.2127000e-01  -1.0808500e+00  -1.3611100e+00  -1.6479400e+00  -2.0176800e+00  -2.2425100e+00  -2.5574000e+00  -3.0647700e+00  -3.2795200e+00  -3.5469300e+00  -4.0642500e+00  -4.2756700e+00  -4.6360600e+00  -5.0076900e+00  -5.1785200e+00];
al2=450.785+[2.0291800e+00   1.9077600e+00   1.8672800e+00   1.8878700e+00   1.9348800e+00   2.0132900e+00   2.0557500e+00   2.1620800e+00   2.2941100e+00   2.4455300e+00   2.6568400e+00   2.7972400e+00   3.0010300e+00   3.3591100e+00   3.5232300e+00   3.7425500e+00   4.2163000e+00   4.4269100e+00   4.8135000e+00   5.2502200e+00   5.4655300e+00];
al3=-694.998+[-1.2003100e+00  -1.3159700e+00  -1.4493400e+00  -1.5817500e+00  -1.7306400e+00  -1.9196900e+00  -2.0088000e+00  -2.2067300e+00  -2.4111700e+00  -2.6161800e+00  -2.8742900e+00  -3.0275200e+00  -3.2394400e+00  -3.5755300e+00  -3.7187000e+00  -3.9013700e+00  -4.2675400e+00  -4.4210500e+00  -4.6913400e+00  -4.9848100e+00  -5.1261600e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 4457
am1=-9.37506+[3.5697400e-01   3.5473300e-01   2.8175200e-01   1.8004800e-01   4.9378100e-02  -1.0691300e-01  -3.1374900e-01  -4.1464300e-01  -6.2589800e-01  -8.5615400e-01  -1.0817800e+00  -1.3929800e+00  -1.6144700e+00  -1.8879100e+00  -2.2311800e+00  -2.5442500e+00  -2.8207500e+00  -3.1092700e+00  -3.7011600e+00  -3.7826200e+00  -4.0424800e+00];
am2=448.144+[1.9618200e+00   1.9374800e+00   1.9551200e+00   1.9942100e+00   2.0486800e+00   2.1171100e+00   2.2106100e+00   2.2566000e+00   2.3537700e+00   2.4603200e+00   2.5644200e+00   2.7095900e+00   2.8170200e+00   2.9547700e+00   3.1336400e+00   3.3013600e+00   3.4543300e+00   3.6190400e+00   3.9768600e+00   4.0274400e+00   4.1918000e+00];
am3=-689.149+[-1.2861900e+00  -1.3406200e+00  -1.4615800e+00  -1.5799000e+00  -1.7110500e+00  -1.8527500e+00  -2.0302200e+00  -2.1114200e+00  -2.2722000e+00  -2.4381800e+00  -2.5924200e+00  -2.7930800e+00  -2.9315800e+00  -3.1002900e+00  -3.3073600e+00  -3.4920400e+00  -3.6517500e+00  -3.8173600e+00  -4.1554800e+00  -4.2021500e+00  -4.3503100e+00];
% 20101
an1=-11.8681+[1.9195900e-01   1.9598900e-01   1.6888500e-01   1.2220300e-01   5.5279900e-02  -2.9278300e-02  -1.4602800e-01  -2.0541900e-01  -3.3368500e-01  -4.8023400e-01  -6.3009200e-01  -8.4543700e-01  -1.0032300e+00  -1.2027000e+00  -1.4582000e+00  -1.6943800e+00  -1.9051500e+00  -2.1269200e+00  -2.5855000e+00  -2.6488900e+00  -2.8522800e+00];
an2=447.151+[1.2337100e+00   1.1949800e+00   1.1840200e+00   1.2009100e+00   1.2370200e+00   1.2889100e+00   1.3599300e+00   1.3957500e+00   1.4744300e+00   1.5628400e+00   1.6493900e+00   1.7709000e+00   1.8616000e+00   1.9763900e+00   2.1262700e+00   2.2673300e+00   2.3965400e+00   2.5354600e+00   2.8347400e+00   2.8770500e+00   3.0140900e+00];
an3=-698.575+[-8.9701400e-01  -9.1662000e-01  -9.8277300e-01  -1.0599800e+00  -1.1545000e+00  -1.2604900e+00  -1.3939900e+00  -1.4572500e+00  -1.5858800e+00  -1.7217300e+00  -1.8499600e+00  -2.0199600e+00  -2.1387000e+00  -2.2837700e+00  -2.4633000e+00  -2.6241500e+00  -2.7634400e+00  -2.9077800e+00  -3.2010300e+00  -3.2415100e+00  -3.3696700e+00];
% 9037
ao1=-7.50723+[4.2968700e-01   4.2696100e-01   3.4558300e-01   2.3267200e-01   8.7389600e-02  -8.6717400e-02  -3.1727500e-01  -4.2958100e-01  -6.6447800e-01  -9.1986200e-01  -1.1690500e+00  -1.5114800e+00  -1.7552800e+00  -2.0558800e+00  -2.4320000e+00  -2.7740300e+00  -3.0750200e+00  -3.3881300e+00  -4.0261900e+00  -4.1138400e+00  -4.3928100e+00];
ao2=444.719+[1.9664300e+00   1.9393700e+00   1.9441900e+00   1.9686300e+00   2.0058500e+00   2.0549500e+00   2.1239600e+00   2.1586500e+00   2.2333900e+00   2.3171000e+00   2.4004400e+00   2.5191600e+00   2.6087000e+00   2.7253700e+00   2.8795500e+00   3.0262600e+00   3.1619400e+00   3.3096500e+00   3.6359900e+00   3.6824400e+00   3.8341300e+00];
ao3=-690.512+[-1.1964600e+00  -1.2451100e+00  -1.3450500e+00  -1.4408500e+00  -1.5466500e+00  -1.6610500e+00  -1.8039800e+00  -1.8692600e+00  -1.9987000e+00  -2.1325800e+00  -2.2569900e+00  -2.4190600e+00  -2.5317000e+00  -2.6695100e+00  -2.8393100e+00  -2.9914500e+00  -3.1235800e+00  -3.2610900e+00  -3.5427700e+00  -3.5817300e+00  -3.7053800e+00];
% 21922
ap1=-12.9198+[1.6308400e-01   1.6323800e-01   1.2876000e-01   7.6063500e-02   3.2822700e-03  -8.6094800e-02  -2.0773100e-01  -2.6919200e-01  -4.0059000e-01  -5.4964700e-01  -7.0152400e-01  -9.1854200e-01  -1.0761400e+00  -1.2747800e+00  -1.5292400e+00  -1.7647700e+00  -1.9753100e+00  -2.1973000e+00  -2.6587300e+00  -2.7226400e+00  -2.9280400e+00];
ap2=450.785+[1.3985100e+00   1.3566600e+00   1.3457400e+00   1.3649800e+00   1.4051600e+00   1.4623000e+00   1.5402000e+00   1.5795700e+00   1.6665100e+00   1.7649000e+00   1.8617200e+00   1.9980800e+00   2.0993700e+00   2.2271600e+00   2.3932700e+00   2.5490300e+00   2.6910400e+00   2.8433600e+00   3.1700800e+00   3.2161600e+00   3.3652700e+00];
ap3=-694.998+[-1.0828400e+00  -1.1003800e+00  -1.1691400e+00  -1.2510200e+00  -1.3520400e+00  -1.4655100e+00  -1.6083700e+00  -1.6763200e+00  -1.8153200e+00  -1.9633400e+00  -2.1040300e+00  -2.2918100e+00  -2.4229100e+00  -2.5830700e+00  -2.7815700e+00  -2.9598600e+00  -3.1146100e+00  -3.2753900e+00  -3.6036300e+00  -3.6490200e+00  -3.7931100e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 4457
aq1=-9.37506+[-4.4029300e-01   4.0442600e-02  -6.9369900e-01  -1.2634600e+00  -2.0081500e+00  -2.6399000e+00  -3.3213200e+00  -3.8845400e+00  -4.5961900e+00  -5.0576600e+00  -5.4592600e+00  -5.9207200e+00  -6.2108600e+00  -6.5247200e+00  -6.8644000e+00  -7.0328100e+00  -7.2879700e+00  -7.5757300e+00  -7.7139900e+00  -8.0432600e+00  -8.0958100e+00];
aq2=448.144+[2.2729300e+00   6.6984800e-01   3.6486100e-01   5.7589200e-01   1.2085700e+00   1.9107700e+00   2.8316500e+00   3.7069300e+00   4.8896500e+00   5.6547400e+00   6.2955400e+00   7.0077000e+00   7.4296400e+00   7.8898000e+00   8.3969200e+00   8.6574400e+00   9.0618900e+00   9.5307400e+00   9.7620900e+00   1.0330400e+01   1.0423500e+01];
aq3=689.149+[-1.2343600e-01  -1.3723500e+00  -1.6431000e+00  -1.8932000e+00  -2.2692600e+00  -2.6075100e+00  -2.9999300e+00  -3.3610900e+00  -3.8573100e+00  -4.1971100e+00  -4.5065900e+00  -4.8740600e+00  -5.1070800e+00  -5.3687000e+00  -5.6664100e+00  -5.8203800e+00  -6.0621000e+00  -6.3461200e+00  -6.4870700e+00  -6.8355500e+00  -6.8931000e+00];
% 20101
ar1=-11.8681+[-4.2105700e-01   5.6494400e-03  -5.1417500e-01  -9.3486100e-01  -1.4909900e+00  -1.9730700e+00  -2.5014200e+00  -2.9385800e+00  -3.4915300e+00  -3.8501000e+00  -4.1602500e+00  -4.5164300e+00  -4.7402700e+00  -4.9829600e+00  -5.2469600e+00  -5.3782100e+00  -5.5769000e+00  -5.7998200e+00  -5.9065200e+00  -6.1592500e+00  -6.1994700e+00];
ar2=447.151+[1.4900500e+00   2.0829800e-01   1.6343700e-02   2.2525900e-01   7.7151800e-01   1.3619400e+00   2.1280000e+00   2.8546300e+00   3.8380500e+00   4.4703600e+00   4.9950400e+00   5.5728500e+00   5.9120400e+00   6.2802000e+00   6.6826800e+00   6.8893300e+00   7.2086600e+00   7.5797500e+00   7.7636800e+00   8.2173600e+00   8.2919500e+00];
ar3=-698.575+[6.5302800e-02  -9.9934400e-01  -1.2721800e+00  -1.5089800e+00  -1.8471300e+00  -2.1422300e+00  -2.4808600e+00  -2.7905800e+00  -3.2140400e+00  -3.4999300e+00  -3.7570200e+00  -4.0571400e+00  -4.2444400e+00  -4.4530300e+00  -4.6876100e+00  -4.8083100e+00  -4.9960600e+00  -5.2152500e+00  -5.3239900e+00  -5.5932500e+00  -5.6376700e+00];
% 9037
as1=-7.50723+[-3.8446300e-01   7.2789500e-02  -7.1589400e-01  -1.3223100e+00  -2.1126900e+00  -2.7797300e+00  -3.4981100e+00  -4.0937800e+00  -4.8494900e+00  -5.3399200e+00  -5.7676200e+00  -6.2608700e+00  -6.5719800e+00  -6.9100600e+00  -7.2778900e+00  -7.4610100e+00  -7.7389500e+00  -8.0528800e+00  -8.2039900e+00  -8.5644300e+00  -8.6221300e+00];
as2=444.719+[2.2354400e+00   6.7325900e-01   3.2995500e-01   5.0561600e-01   1.0859300e+00   1.7446500e+00   2.6189600e+00   3.4552700e+00   4.5902000e+00   5.3265000e+00   5.9434600e+00   6.6294700e+00   7.0357900e+00   7.4792100e+00   7.9684000e+00   8.2201400e+00   8.6116200e+00   9.0665700e+00   9.2914900e+00   9.8451800e+00   9.9361000e+00];
as3=-690.512+[5.8991400e-02  -1.3399100e+00  -1.5890400e+00  -1.7962700e+00  -2.0893100e+00  -2.3465300e+00  -2.6400600e+00  -2.9100800e+00  -3.2847200e+00  -3.5440500e+00  -3.7827300e+00  -4.0686900e+00  -4.2514400e+00  -4.4572500e+00  -4.6922600e+00  -4.8142200e+00  -5.0060600e+00  -5.2327900e+00  -5.3458500e+00  -5.6268000e+00  -5.6733900e+00];
% 21922
at1=-12.9198+[-4.7550300e-01  -1.8474700e-02  -5.4065200e-01  -9.6572400e-01  -1.5300200e+00  -2.0212200e+00  -2.5601700e+00  -3.0051500e+00  -3.5662500e+00  -3.9304700e+00  -4.2460600e+00  -4.6083500e+00  -4.8358400e+00  -5.0819400e+00  -5.3492600e+00  -5.4818500e+00  -5.6825600e+00  -5.9075600e+00  -6.0151800e+00  -6.2695100e+00  -6.3098500e+00];
at2=450.785+[1.6833300e+00   2.9079200e-01   8.3444300e-02   3.0954200e-01   9.0307500e-01   1.5426400e+00   2.3708200e+00   3.1558800e+00   4.2168900e+00   4.8988500e+00   5.4654500e+00   6.0890400e+00   6.4551500e+00   6.8526700e+00   7.2873800e+00   7.5105000e+00   7.8551200e+00   8.2552500e+00   8.4533500e+00   8.9415500e+00   9.0217500e+00];
at3=-694.998+[-1.5938200e-01  -1.0935100e+00  -1.3505200e+00  -1.6068500e+00  -1.9988100e+00  -2.3517800e+00  -2.7657800e+00  -3.1484100e+00  -3.6722000e+00  -4.0252400e+00  -4.3411200e+00  -4.7075500e+00  -4.9349500e+00  -5.1879600e+00  -5.4722800e+00  -5.6187600e+00  -5.8466700e+00  -6.1129400e+00  -6.2450400e+00  -6.5720900e+00  -6.6260300e+00];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 4457
au1=-9.37506+[3.3988300e-01   3.3780800e-01   2.9540100e-01   2.1948000e-01   1.8274900e-02  -1.4123200e-01  -2.4718700e-01  -3.9179900e-01  -7.0606600e-01  -8.4636000e-01  -1.1149700e+00  -1.2939800e+00  -1.5502900e+00  -1.9341700e+00  -2.1655900e+00  -2.4595100e+00  -2.8151300e+00  -3.0757700e+00  -3.4486300e+00  -3.7203700e+00  -3.9529400e+00];
au2=448.144+[1.9866000e+00   1.9630100e+00   1.9709800e+00   2.0021600e+00   2.0907300e+00   2.1630300e+00   2.2116800e+00   2.2777900e+00   2.4228700e+00   2.4880400e+00   2.6131300e+00   2.6973500e+00   2.8217600e+00   3.0162200e+00   3.1376000e+00   3.2958200e+00   3.4927000e+00   3.6428800e+00   3.8644000e+00   4.0323900e+00   4.1794600e+00];
au3=-689.149+[-1.2875100e+00  -1.3420000e+00  -1.4319000e+00  -1.5436700e+00  -1.7550000e+00  -1.8987600e+00  -1.9914800e+00  -2.1094900e+00  -2.3455500e+00  -2.4457600e+00  -2.6296800e+00  -2.7464100e+00  -2.9086300e+00  -3.1459600e+00  -3.2849000e+00  -3.4576500e+00  -3.6643500e+00  -3.8140600e+00  -4.0285100e+00  -4.1842400e+00  -4.3168300e+00];
% 20101
av1=-11.8681+[1.6997400e-01   1.7519900e-01   1.6779600e-01   1.4068300e-01   4.1615400e-02  -4.4531700e-02  -1.0302100e-01  -1.8636500e-01  -3.7778600e-01  -4.6699100e-01  -6.4452700e-01  -7.6713900e-01  -9.4755900e-01  -1.2263100e+00  -1.3984100e+00  -1.6195600e+00  -1.8893700e+00  -2.0894300e+00  -2.3767300e+00  -2.5877700e+00  -2.7696200e+00];
av2=447.151+[1.2432900e+00   1.2054500e+00   1.1917000e+00   1.1979700e+00   1.2545100e+00   1.3095800e+00   1.3461700e+00   1.3974200e+00   1.5159900e+00   1.5703400e+00   1.6743400e+00   1.7451600e+00   1.8508700e+00   2.0140200e+00   2.1166200e+00   2.2505200e+00   2.4175500e+00   2.5443200e+00   2.7302300e+00   2.8708400e+00   2.9937100e+00];
av3=-698.575+[-8.9375500e-01  -9.1407000e-01  -9.6327700e-01  -1.0308700e+00  -1.1809700e+00  -1.2887000e+00  -1.3580600e+00  -1.4494000e+00  -1.6393800e+00  -1.7218400e+00  -1.8749300e+00  -1.9737500e+00  -2.1126600e+00  -2.3168200e+00  -2.4374300e+00  -2.5879500e+00  -2.7681800e+00  -2.8984500e+00  -3.0843200e+00  -3.2191500e+00  -3.3338300e+00];
% 9037
aw1=-7.50723+[4.1513500e-01   4.1278300e-01   3.6563100e-01   2.8059800e-01   5.6422600e-02  -1.2134100e-01  -2.3949200e-01  -4.0031700e-01  -7.4924100e-01  -9.0471600e-01  -1.2015300e+00  -1.3988700e+00  -1.6813200e+00  -2.1035700e+00  -2.3570800e+00  -2.6780300e+00  -3.0657300e+00  -3.3485000e+00  -3.7518200e+00  -4.0443000e+00  -4.2940500e+00];
aw2=444.719+[1.9912800e+00   1.9650500e+00   1.9644300e+00   1.9826100e+00   2.0435600e+00   2.0961700e+00   2.1320800e+00   2.1818400e+00   2.2941000e+00   2.3455000e+00   2.4457500e+00   2.5144500e+00   2.6177200e+00   2.7825100e+00   2.8873400e+00   3.0258200e+00   3.2001100e+00   3.3349600e+00   3.5358100e+00   3.6898400e+00   3.8254800e+00];
aw3=-690.512+[-1.1941100e+00  -1.2426800e+00  -1.3172400e+00  -1.4079800e+00  -1.5780600e+00  -1.6937900e+00  -1.7683100e+00  -1.8630000e+00  -2.0527600e+00  -2.1333800e+00  -2.2813500e+00  -2.3755500e+00  -2.5072800e+00  -2.7011800e+00  -2.8151700e+00  -2.9574000e+00  -3.1283800e+00  -3.2526500e+00  -3.4313300e+00  -3.5612200e+00  -3.6718700e+00];
% 21922
ax1=-12.9198+[1.3890300e-01   1.3997600e-01   1.2582900e-01   9.2365800e-02  -1.6501500e-02  -1.0749300e-01  -1.6878500e-01  -2.5553600e-01  -4.5193600e-01  -5.4274800e-01  -7.2281000e-01  -8.4638600e-01  -1.0268500e+00  -1.3046600e+00  -1.4761800e+00  -1.6969800e+00  -1.9664100e+00  -2.1667900e+00  -2.4551200e+00  -2.6678300e+00  -2.8514400e+00];
ax2=450.785+[1.4125100e+00   1.3716300e+00   1.3574400e+00   1.3652500e+00   1.4283100e+00   1.4887100e+00   1.5286900e+00   1.5847300e+00   1.7156700e+00   1.7762600e+00   1.8926000e+00   1.9719100e+00   2.0897800e+00   2.2707500e+00   2.3841000e+00   2.5316000e+00   2.7150800e+00   2.8539000e+00   3.0570700e+00   3.2102400e+00   3.3438500e+00];
ax3=-694.998+[-1.0848600e+00  -1.1032800e+00  -1.1543900e+00  -1.2259200e+00  -1.3865900e+00  -1.5019600e+00  -1.5761100e+00  -1.6740400e+00  -1.8797600e+00  -1.9698900e+00  -2.1380800e+00  -2.2471200e+00  -2.4003200e+00  -2.6253000e+00  -2.7585600e+00  -2.9253100e+00  -3.1254100e+00  -3.2705600e+00  -3.4781300e+00  -3.6292700e+00  -3.7581200e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 4457
ay1=-9.37506+[-4.4025400e-01  -2.1261700e-01  -5.3940100e-01  -9.6417400e-01  -1.7997400e+00  -2.1568100e+00  -2.6461500e+00  -3.1979000e+00  -3.8678000e+00  -4.5816000e+00  -4.9205800e+00  -5.4939300e+00  -5.9043400e+00  -6.2285500e+00  -6.5523200e+00  -7.0314700e+00  -7.2350500e+00  -7.4275300e+00  -7.6116400e+00  -7.9603600e+00  -8.0043900e+00];
ay2=448.144+[2.2728400e+00   1.5103900e+00   1.3382500e+00   1.2802700e+00   1.5063100e+00   1.6839700e+00   2.0219400e+00   2.5205700e+00   3.2842100e+00   4.2541600e+00   4.7528600e+00   5.6630400e+00   6.3561800e+00   6.9187600e+00   7.4943600e+00   8.3404100e+00   8.6982100e+00   9.0370700e+00   9.3607600e+00   9.9786500e+00   1.0057500e+01];
ay3=-689.149+[-1.2469200e-01  -1.5297300e+00  -1.7050400e+00  -1.8921800e+00  -2.2849900e+00  -2.4619800e+00  -2.7116200e+00  -3.0084600e+00  -3.3946600e+00  -3.8426100e+00  -4.0663000e+00  -4.4739300e+00  -4.7913500e+00  -5.0530300e+00  -5.3318800e+00  -5.7725500e+00  -5.9688300e+00  -6.1589400e+00  -6.3448000e+00  -6.7079000e+00  -6.7548900e+00];
% 20101
az1=-11.8681+[-4.2103300e-01  -1.9569200e-01  -3.9965400e-01  -6.9882600e-01  -1.3128000e+00  -1.5801900e+00  -1.9526900e+00  -2.3784300e+00  -2.8986600e+00  -3.4547100e+00  -3.7196300e+00  -4.1676800e+00  -4.4869100e+00  -4.7398700e+00  -4.9933600e+00  -5.3679300e+00  -5.5264400e+00  -5.6759900e+00  -5.8184000e+00  -6.0864000e+00  -6.1200800e+00];
az2=447.151+[1.4902400e+00   8.8227600e-01   7.5929300e-01   7.4002400e-01   9.6965000e-01   1.1273900e+00   1.4161400e+00   1.8366600e+00   2.4795500e+00   3.2944500e+00   3.7127200e+00   4.4670000e+00   5.0320600e+00   5.4871000e+00   5.9493000e+00   6.6226700e+00   6.9060100e+00   7.1747100e+00   7.4323000e+00   7.9262000e+00   7.9894700e+00];
az3=-698.575+[6.4117900e-02  -1.1262300e+00  -1.2848200e+00  -1.4626300e+00  -1.8216300e+00  -1.9778300e+00  -2.1963400e+00  -2.4546600e+00  -2.7911100e+00  -3.1794700e+00  -3.3722100e+00  -3.7180400e+00  -3.9809200e+00  -4.1935700e+00  -4.4166500e+00  -4.7636100e+00  -4.9162300e+00  -5.0632000e+00  -5.2068700e+00  -5.4881000e+00  -5.5245200e+00];
% 9037
ba1=-7.50723+[-3.8442200e-01  -1.8113100e-01  -5.4255200e-01  -1.0019800e+00  -1.8968700e+00  -2.2779500e+00  -2.7981400e+00  -3.3827600e+00  -4.0909500e+00  -4.8464800e+00  -5.2058100e+00  -5.8144200e+00  -6.2511600e+00  -6.5968700e+00  -6.9442700e+00  -7.4623900e+00  -7.6835800e+00  -7.8930500e+00  -8.0937300e+00  -8.4741700e+00  -8.5222600e+00];
ba2=444.719+[2.2354000e+00   1.4852200e+00   1.2874500e+00   1.2026700e+00   1.3777900e+00   1.5334900e+00   1.8414000e+00   2.3063500e+00   3.0294800e+00   3.9564900e+00   4.4353200e+00   5.3121800e+00   5.9817600e+00   6.5263300e+00   7.0839200e+00   7.9038800e+00   8.2510800e+00   8.5802800e+00   8.8951100e+00   9.4973200e+00   9.5743300e+00];
ba3=-690.512+[5.7604800e-02  -1.4228200e+00  -1.5800100e+00  -1.7437600e+00  -2.0763400e+00  -2.2222500e+00  -2.4231400e+00  -2.6575600e+00  -2.9577600e+00  -3.3029700e+00  -3.4750800e+00  -3.7875500e+00  -4.0302200e+00  -4.2301800e+00  -4.4444300e+00  -4.7868200e+00  -4.9407700e+00  -5.0907800e+00  -5.2385100e+00  -5.5294800e+00  -5.5673500e+00];
% 21922
bb1=-12.9198+[-4.7547600e-01  -2.3234500e-01  -4.3586900e-01  -7.3630100e-01  -1.3550500e+00  -1.6253400e+00  -2.0033100e+00  -2.4363900e+00  -2.9669300e+00  -3.5331400e+00  -3.8023700e+00  -4.2578100e+00  -4.5825500e+00  -4.8397300e+00  -5.0968600e+00  -5.4759300e+00  -5.6360500e+00  -5.7869900e+00  -5.9306800e+00  -6.2009300e+00  -6.2348700e+00];
bb2=450.785+[1.6834100e+00   1.0270400e+00   8.9690300e-01   8.7729100e-01   1.1251800e+00   1.2956600e+00   1.6076100e+00   2.0618300e+00   2.7553200e+00   3.6339600e+00   4.0845800e+00   4.8978100e+00   5.5078600e+00   5.9991400e+00   6.4981300e+00   7.2253600e+00   7.5311800e+00   7.8210300e+00   8.0986500e+00   8.6301500e+00   8.6981500e+00];
bb3=-694.998+[-1.6044100e-01  -1.2918200e+00  -1.4422900e+00  -1.6200100e+00  -2.0007700e+00  -2.1722000e+00  -2.4188500e+00  -2.7185400e+00  -3.1185200e+00  -3.5888900e+00  -3.8242600e+00  -4.2500700e+00  -4.5761900e+00  -4.8412100e+00  -5.1186100e+00  -5.5475300e+00  -5.7352700e+00  -5.9158300e+00  -6.0917900e+00  -6.4351100e+00  -6.4794800e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 4457
bc1=-9.37506+[4.0951700e-01   4.0202900e-01   3.0427600e-01   1.7613000e-01   1.5105500e-02  -1.7552800e-01  -4.2648900e-01  -6.2861800e-01  -9.3236300e-01  -1.0752900e+00  -1.4532100e+00  -1.7031200e+00  -1.9963300e+00  -2.3436400e+00  -2.6559800e+00  -2.9962700e+00  -3.4023800e+00  -3.6601300e+00  -4.0187300e+00  -4.4930700e+00  -4.7145100e+00];
bc2=448.144+[2.2612600e+00   2.2269700e+00   2.2355900e+00   2.2702800e+00   2.3209400e+00   2.3838000e+00   2.4704100e+00   2.5438900e+00   2.6563500e+00   2.7096500e+00   2.8548100e+00   2.9552400e+00   3.0776300e+00   3.2318100e+00   3.3773600e+00   3.5463600e+00   3.7625100e+00   3.9104800e+00   4.1250400e+00   4.4316800e+00   4.5830200e+00];
bc3=-689.149+[-8.5921900e-01  -9.1562900e-01  -1.0402600e+00  -1.1633100e+00  -1.3007900e+00  -1.4484200e+00  -1.6339500e+00  -1.7751500e+00  -1.9780000e+00  -2.0690700e+00  -2.3037100e+00  -2.4549100e+00  -2.6289700e+00  -2.8301200e+00  -3.0095500e+00  -3.2049900e+00  -3.4350700e+00  -3.5801200e+00  -3.7833300e+00  -4.0542400e+00  -4.1822700e+00];
% 20101
bd1=-11.8681+[2.4412800e-01   2.4917600e-01   2.1159700e-01   1.4838800e-01   5.9658700e-02  -5.4621600e-02  -2.1186500e-01  -3.4499000e-01  -5.5064500e-01  -6.4963800e-01  -9.1748900e-01  -1.0981500e+00  -1.3121400e+00  -1.5701700e+00  -1.8050400e+00  -2.0651000e+00  -2.3796300e+00  -2.5805900e+00  -2.8610600e+00  -3.2346600e+00  -3.4099000e+00];
bd2=447.151+[1.4800000e+00   1.4335100e+00   1.4189100e+00   1.4337400e+00   1.4642600e+00   1.5072500e+00   1.5667100e+00   1.6187800e+00   1.7017100e+00   1.7427500e+00   1.8589600e+00   1.9416800e+00   2.0440400e+00   2.1741900e+00   2.2972900e+00   2.4388100e+00   2.6211700e+00   2.7462200e+00   2.9274800e+00   3.1871600e+00   3.3155300e+00];
bd3=-698.575+[-6.3160100e-01  -6.5466400e-01  -7.3030700e-01  -8.1470800e-01  -9.1266000e-01  -1.0220800e+00  -1.1597400e+00  -1.2659900e+00  -1.4229200e+00  -1.4954600e+00  -1.6867900e+00  -1.8127600e+00  -1.9594700e+00  -2.1315800e+00  -2.2867400e+00  -2.4555800e+00  -2.6556800e+00  -2.7820100e+00  -2.9587000e+00  -3.1940800e+00  -3.3050700e+00];
% 9037
be1=-7.50723+[4.8159700e-01   4.7329900e-01   3.6615700e-01   2.2519200e-01   4.7822700e-02  -1.6186400e-01  -4.3794700e-01  -6.5987400e-01  -9.9292100e-01  -1.1492900e+00  -1.5616700e+00  -1.8333200e+00  -2.1513500e+00  -2.5267700e+00  -2.8636900e+00  -3.2299000e+00  -3.6657400e+00  -3.9418100e+00  -4.3255700e+00  -4.8323000e+00  -5.0686900e+00];
be2=444.719+[2.2426500e+00   2.2054300e+00   2.2006400e+00   2.2199000e+00   2.2525600e+00   2.2958200e+00   2.3578100e+00   2.4126800e+00   2.4987900e+00   2.5404400e+00   2.6568900e+00   2.7398700e+00   2.8429900e+00   2.9760000e+00   3.1034800e+00   3.2538100e+00   3.4490600e+00   3.5844000e+00   3.7819800e+00   4.0673100e+00   4.2090500e+00];
be3=-690.512+[-7.0677700e-01  -7.5697100e-01  -8.5911700e-01  -9.5845000e-01  -1.0693800e+00  -1.1887600e+00  -1.3388300e+00  -1.4530700e+00  -1.6174700e+00  -1.6914400e+00  -1.8836000e+00  -2.0085200e+00  -2.1532600e+00  -2.3212900e+00  -2.4715000e+00  -2.6353600e+00  -2.8285300e+00  -2.9502600e+00  -3.1210500e+00  -3.3490100e+00  -3.4568500e+00];
% 21922
bf1=-12.9198+[2.1334200e-01   2.1416700e-01   1.6909400e-01   1.0023400e-01   6.4667400e-03  -1.1243700e-01  -2.7437200e-01  -4.0999200e-01  -6.1857200e-01  -7.1872000e-01  -9.8892900e-01  -1.1709300e+00  -1.3863600e+00  -1.6463500e+00  -1.8834400e+00  -2.1464000e+00  -2.4647400e+00  -2.6682500e+00  -2.9523600e+00  -3.3311800e+00  -3.5089800e+00];
bf2=450.785+[1.6817900e+00   1.6321300e+00   1.6182900e+00   1.6361100e+00   1.6707700e+00   1.7184300e+00   1.7837400e+00   1.8415500e+00   1.9342900e+00   1.9803100e+00   2.1101500e+00   2.2021400e+00   2.3153800e+00   2.4587400e+00   2.5938900e+00   2.7485100e+00   2.9471400e+00   3.0829700e+00   3.2794800e+00   3.5599800e+00   3.6983500e+00];
bf3=-694.998+[-8.5956700e-01  -8.8054800e-01  -9.5969900e-01  -1.0494300e+00  -1.1538400e+00  -1.2701900e+00  -1.4162200e+00  -1.5300100e+00  -1.6994100e+00  -1.7782000e+00  -1.9864900e+00  -2.1239900e+00  -2.2842700e+00  -2.4730400e+00  -2.6436600e+00  -2.8296300e+00  -3.0512600e+00  -3.1919900e+00  -3.3892500e+00  -3.6531600e+00  -3.7780200e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 4457
bg1=-9.37506+[-3.0019200e-01  -9.8493500e-02  -4.1535500e-01  -9.2671700e-01  -1.1807200e+00  -1.7929100e+00  -2.4225200e+00  -2.8773400e+00  -3.5205100e+00  -4.0651200e+00  -4.5186600e+00  -5.2919500e+00  -5.7730700e+00  -5.9115700e+00  -6.3325100e+00  -6.7849000e+00  -7.0088800e+00  -7.3348300e+00  -7.5355900e+00  -7.7918900e+00  -7.9752000e+00];
bg2=448.144+[2.4402900e+00   2.1094600e+00   1.8753900e+00   1.7950400e+00   1.8052400e+00   1.9650900e+00   2.2633200e+00   2.5771100e+00   3.1141000e+00   3.6703700e+00   4.2039400e+00   5.2631400e+00   5.9904400e+00   6.2044500e+00   6.8968700e+00   7.6840400e+00   8.0896700e+00   8.6968500e+00   9.0750400e+00   9.5544600e+00   9.8936400e+00];
bg3=-689.149+[-6.9515600e-01  -1.0488800e+00  -1.2380300e+00  -1.4766400e+00  -1.5961400e+00  -1.8906100e+00  -2.2104900e+00  -2.4535200e+00  -2.8057300e+00  -3.1234000e+00  -3.4073000e+00  -3.9382700e+00  -4.2952100e+00  -4.4020000e+00  -4.7499500e+00  -5.1474200e+00  -5.3571800e+00  -5.6834700e+00  -5.8951200e+00  -6.1727800e+00  -6.3755700e+00];
% 20101
bh1=-11.8681+[-2.9902300e-01  -1.1954200e-01  -3.0364900e-01  -6.5827100e-01  -8.4158000e-01  -1.2949300e+00  -1.7714500e+00  -2.1205500e+00  -2.6191100e+00  -3.0436200e+00  -3.3970600e+00  -3.9999200e+00  -4.3759400e+00  -4.4841100e+00  -4.8124600e+00  -5.1667400e+00  -5.3421300e+00  -5.5978300e+00  -5.7554200e+00  -5.9556600e+00  -6.0980900e+00];
bh2=447.151+[1.7507100e+00   1.3786900e+00   1.1941500e+00   1.1530100e+00   1.1725500e+00   1.3224800e+00   1.5723600e+00   1.8309600e+00   2.2786600e+00   2.7450900e+00   3.1916700e+00   4.0759200e+00   4.6810700e+00   4.8576800e+00   5.4234600e+00   6.0607900e+00   6.3874900e+00   6.8732800e+00   7.1755900e+00   7.5593300e+00   7.8318700e+00];
bh3=-698.575+[-5.5128000e-01  -8.1759600e-01  -9.7707000e-01  -1.1905300e+00  -1.2976900e+00  -1.5585600e+00  -1.8320800e+00  -2.0377600e+00  -2.3383700e+00  -2.6109600e+00  -2.8540200e+00  -3.3068500e+00  -3.6087200e+00  -3.6984000e+00  -3.9863500e+00  -4.3077100e+00  -4.4751000e+00  -4.7317800e+00  -4.8969600e+00  -5.1123300e+00  -5.2695400e+00];
% 9037
bi1=-7.50723+[-2.4777100e-01  -5.4075900e-02  -4.0686100e-01  -9.5999100e-01  -1.2331500e+00  -1.8875600e+00  -2.5568900e+00  -3.0374800e+00  -3.7167400e+00  -4.2922900e+00  -4.7728100e+00  -5.5946100e+00  -6.1072000e+00  -6.2549000e+00  -6.7050200e+00  -7.1898400e+00  -7.4310000e+00  -7.7843100e+00  -8.0031000e+00  -8.2830900e+00  -8.4834400e+00];
bi2=444.719+[2.4035900e+00   2.0668700e+00   1.8061200e+00   1.6935700e+00   1.6886100e+00   1.8126300e+00   2.0746700e+00   2.3631800e+00   2.8652600e+00   3.3919600e+00   3.9005300e+00   4.9170500e+00   5.6186700e+00   5.8254400e+00   6.4957100e+00   7.2600300e+00   7.6545300e+00   8.2454900e+00   8.6139200e+00   9.0814500e+00   9.4126600e+00];
bi3=-690.512+[-5.2198300e-01  -8.7266800e-01  -1.0419200e+00  -1.2508300e+00  -1.3543500e+00  -1.6028800e+00  -1.8663000e+00  -2.0627500e+00  -2.3452700e+00  -2.5977000e+00  -2.8220500e+00  -3.2403700e+00  -3.5218400e+00  -3.6059900e+00  -3.8796800e+00  -4.1918100e+00  -4.3570100e+00  -4.6152900e+00  -4.7842600e+00  -5.0075100e+00  -5.1719300e+00];
% 21922
bk1=-12.9198+[-3.4854100e-01  -1.5829700e-01  -3.4254000e-01  -6.9931600e-01  -8.8394300e-01  -1.3424000e+00  -1.8268000e+00  -2.1837800e+00  -2.6936100e+00  -3.1270500e+00  -3.4869600e+00  -4.0988400e+00  -4.4796100e+00  -4.5892100e+00  -4.9218100e+00  -5.2806700e+00  -5.4580600e+00  -5.7159400e+00  -5.8745100e+00  -6.0760600e+00  -6.2195200e+00];
bk2=450.785+[1.9490300e+00   1.5762100e+00   1.3818800e+00   1.3382000e+00   1.3593100e+00   1.5217300e+00   1.7920400e+00   2.0711200e+00   2.5530000e+00   3.0551700e+00   3.5362000e+00   4.4884300e+00   5.1395800e+00   5.3298500e+00   5.9399700e+00   6.6269300e+00   6.9789700e+00   7.5023700e+00   7.8279000e+00   8.2406500e+00   8.5333500e+00];
bk3=-694.998+[-7.8074900e-01  -1.0433300e+00  -1.1916300e+00  -1.4028400e+00  -1.5122300e+00  -1.7890400e+00  -2.0888700e+00  -2.3212900e+00  -2.6666000e+00  -2.9859800e+00  -3.2743900e+00  -3.8184500e+00  -4.1839500e+00  -4.2929300e+00  -4.6447300e+00  -5.0400200e+00  -5.2461000e+00  -5.5612700e+00  -5.7633200e+00  -6.0257700e+00  -6.2164600e+00];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (5N)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (5N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')