%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under flexion (4P)
% 36572,16215,31500,37435
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 36572,16215,31500,37435
%% model15_intact_TLC_4P
t15=[2 2.0575 2.1025 2.16719 2.21465 2.2716 2.32233 2.35879 2.40155 2.47973 2.51017 2.56326 2.61022 2.66193 2.70424 2.75779 2.80445 2.8546 2.90442 2.95797 3];

% 36572
aa1=12.3763+[0.111599 0.195503 0.21914 0.221679 0.22618 0.244388 0.2624 0.274709 0.287015 0.305946 0.312931 0.32445 0.333878 0.343313 0.350779 0.361297 0.37132 0.381771 0.391664 0.401832 0.409481];
aa2=446.738+[0.535552 0.00278413 -0.540777 -1.16254 -1.4941 -1.83954 -2.12986 -2.33351 -2.57016 -2.98998 -3.14964 -3.42315 -3.65863 -3.9132 -4.11723 -4.36825 -4.58163 -4.80518 -5.02285 -5.25136 -5.42703];
aa3=-714.659+[-0.774879 -0.790001 -0.756128 -0.761472 -0.791383 -0.837923 -0.88243 -0.915653 -0.955629 -1.02819 -1.05646 -1.10724 -1.15231 -1.20224 -1.24318 -1.29616 -1.34308 -1.39341 -1.44343 -1.49682 -1.53839];

% 16215
ab1=12.1679+[0.223784 0.353805 0.380462 0.380986 0.388614 0.414922 0.442109 0.461236 0.480969 0.512795 0.524786 0.544828 0.561406 0.578743 0.592802 0.611272 0.627704 0.644514 0.660508 0.676796 0.6889];
ab2=446.385+[0.866838 0.00585694 -0.82704 -1.78618 -2.30485 -2.85419 -3.31753 -3.64324 -4.02087 -4.69051 -4.94558 -5.38129 -5.75522 -6.15746 -6.47867 -6.87275 -7.20792 -7.56064 -7.90415 -8.26454 -8.5416];
ab3=-705.203+[-0.935817 -0.960292 -0.943126 -0.979011 -1.03053 -1.10411 -1.17486 -1.22797 -1.2927 -1.41368 -1.46225 -1.54961 -1.6282 -1.71649 -1.78965 -1.88231 -1.96344 -2.05098 -2.13888 -2.23369 -2.30831 ];

% 31500
ac1=9.70641+[0.238644 0.363527 0.38529 0.379775 0.383423 0.405021 0.427722 0.443488 0.459432 0.485239 0.49515 0.511659 0.525205 0.539136 0.550538 0.566037 0.580029 0.594259 0.607709 0.621364 0.631449];
ac2=444.062+[0.758958 -0.0435523 -0.815815 -1.70234 -2.17988 -2.68377 -3.10724 -3.40404 -3.7475 -4.35471 -4.58544 -4.97899 -5.31601 -5.67782 -5.96633 -6.31965 -6.61962 -6.93471 -7.24104 -7.56183 -7.80806];
ac3=-707.068+[-0.814455 -0.910412 -0.96335 -1.07718 -1.16962 -1.28613 -1.39259 -1.47062 -1.56414 -1.73639 -1.80445 -1.92461 -2.03095 -2.14847 -2.2446 -2.36529 -2.46996 -2.58185 -2.69302 -2.81181 -2.90454 ];

% 37435
ad1=16.2708+[0.132811 0.230821 0.258912 0.265947 0.27398 0.297537 0.320244 0.335687 0.351377 0.375513 0.384379 0.399391 0.411851 0.424571 0.434659 0.448534 0.461495 0.474961 0.487714 0.500772 0.51058 ];
ad2=449.059+[0.698641 0.0650499 -0.590634 -1.33548 -1.72952 -2.14157 -2.48881 -2.73284 -3.0169 -3.52216 -3.7147 -4.04491 -4.32969 -4.63789 -4.88519 -5.18981 -5.44901 -5.72081 -5.9858 -6.26428 -6.47853];
ad3=-710.186+[-0.884108 -0.855149 -0.765719 -0.713987 -0.71764 -0.738649 -0.762338 -0.781116 -0.804397 -0.847483 -0.864772 -0.897406 -0.927318 -0.961391 -0.990012 -1.02841 -1.06348 -1.10177 -1.14042 -1.18224 -1.21519];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4P
t1=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.32627 2.36846 2.42783 2.4542 2.50615 2.55076 2.60453 2.65273 2.70062 2.75176 2.80444 2.85837 2.91342 2.96196 3];
% 36572
ae1=12.3763+[-0.296363 -0.247029 -0.194822 -0.143469 -0.0786417 -0.0270335 0.0366481 0.070375 0.113683 0.131163 0.16239 0.187245 0.215836 0.238339 0.258239 0.276865 0.293647 0.309198 0.323755 0.33601 0.345124];
ae2=446.738+[0.797079 0.643528 0.627852 0.446551 0.126401 -0.189067 -0.672004 -1.00617 -1.46051 -1.65626 -2.03261 -2.34523 -2.71091 -3.02767 -3.33399 -3.65128 -3.96661 -4.27704 -4.57986 -4.83608 -5.02937];
ae3=-714.659+[-0.615151 -0.907806 -0.956803 -0.963068 -0.962402 -0.971728 -0.988314 -1.01789 -1.07819 -1.10692 -1.16627 -1.21927 -1.28322 -1.34042 -1.3977 -1.45974 -1.52523 -1.59252 -1.66021 -1.71885 -1.76384];

% 16215
af1=12.1679+[-0.324978 -0.208429 -0.0799929 0.0141588 0.12184 0.19601 0.286321 0.33581 0.397984 0.422097 0.464515 0.497892 0.534637 0.564167 0.590763 0.615961 0.639121 0.660899 0.681517 0.698923 0.711853 ];
af2=446.385+[1.47688 1.27622 0.948796 0.541781 -0.040864 -0.540419 -1.29458 -1.83374 -2.57648 -2.89838 -3.51774 -4.03114 -4.63048 -5.15053 -5.65298 -6.17311 -6.69075 -7.20147 -7.70214 -8.12729 -8.4499];
af3=-705.203+[-0.848839 -1.17717 -1.17773 -1.16744 -1.16153 -1.1682 -1.18459 -1.21365 -1.27452 -1.30474 -1.37103 -1.43426 -1.51455 -1.59121 -1.67195 -1.76309 -1.86194 -1.96675 -2.07563 -2.17262 -2.24875 ];

% 31500
ag1=9.70641+[-0.300144 -0.183931 -0.0553147 0.0381586 0.142613 0.214377 0.302919 0.350701 0.408932 0.431076 0.4692 0.498471 0.530611 0.556043 0.578522 0.599443 0.618363 0.635991 0.652567 0.666663 0.677167];
ag2=444.066+[1.35021 1.15119 0.861412 0.487914 -0.0500072 -0.516533 -1.22152 -1.72273 -2.40984 -2.70659 -3.27626 -3.74725 -4.29601 -4.77122 -5.22955 -5.70316 -6.17371 -6.6371 -7.09042 -7.47471 -7.76582];
ag3=-707.086+[-0.716544 -1.04699 -1.09827 -1.13068 -1.17645 -1.21973 -1.29068 -1.35956 -1.47447 -1.52798 -1.63818 -1.73682 -1.85786 -1.96909 -2.08239 -2.20652 -2.33747 -2.47327 -2.61194 -2.73379 -2.82858];

% 37435
ah1=16.2708+[-0.32538 -0.261177 -0.201849 -0.141743 -0.0648229 -0.00690279 0.0627471 0.100664 0.151438 0.172206 0.209861 0.240395 0.275428 0.303093 0.32791 0.351434 0.37306 0.393271 0.412236 0.428043 0.439703];
ah2=449.059+[0.940437 0.755545 0.720397 0.484473 0.0825608 -0.290592 -0.858966 -1.25384 -1.79243 -2.02521 -2.47354 -2.84693 -3.28452 -3.66413 -4.03187 -4.41362 -4.79356 -5.1683 -5.53453 -5.84478 -6.07911];
ah3=-710.186+[-0.667767 -0.956567 -1.00057 -0.984543 -0.951484 -0.937347 -0.917941 -0.923025 -0.95229 -0.967964 -1.00294 -1.03655 -1.07846 -1.117 -1.15683 -1.20127 -1.25002 -1.30144 -1.35425 -1.40076 -1.43683];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4P
t2=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.46846 2.52783 2.57002 2.60127 2.65098 2.70667 2.75577 2.81523 2.85038 2.90628 2.96349 3 ];

% 36572
ai1=12.3763+[-0.24139 -0.231039 -0.224247 -0.222861 -0.208682 -0.195101 -0.172907 -0.146167 -0.112543 -0.0863709 -0.0496099 -0.0255171 -0.00746373 0.0224642 0.0565502 0.086325 0.121363 0.141212 0.170943 0.198786 0.215114 ];
ai2=446.738+[0.905469 0.881618 0.946972 1.01556 1.00379 0.94584 0.843468 0.694597 0.477971 0.293092 0.010734 -0.213637 -0.386863 -0.675898 -1.00486 -1.30034 -1.66407 -1.88094 -2.22753 -2.5833 -2.81063];
ai3=-714.659+[-0.763679 -0.903273 -0.965059 -0.987263 -0.982534 -0.971239 -0.960569 -0.963302 -0.971469 -0.976157 -0.981667 -0.986068 -0.992563 -1.0147 -1.05401 -1.0939 -1.14547 -1.17721 -1.23013 -1.28823 -1.32693];

% 16215
aj1=12.1679+[-0.242242 -0.20647 -0.161727 -0.129416 -0.0876504 -0.055965 -0.0158418 0.0261103 0.0775503 0.11573 0.168623 0.203839 0.229929 0.272304 0.32017 0.36172 0.410267 0.437645 0.478844 0.517711 0.540887 ];
aj2=446.385+[1.74178 1.67388 1.56724 1.44762 1.25232 1.06185 0.799151 0.494853 0.092412 -0.231616 -0.719852 -1.09863 -1.38808 -1.86644 -2.41524 -2.90643 -3.50705 -3.86309 -4.42941 -5.00719 -5.37447];
aj3=-705.203+[-1.05161 -1.1931 -1.21688 -1.19737 -1.17253 -1.15293 -1.1319 -1.12147 -1.11702 -1.11498 -1.11306 -1.1155 -1.1212 -1.14328 -1.18656 -1.23478 -1.30263 -1.34707 -1.42456 -1.5131 -1.57404];

% 31500
ak1=9.70641+[-0.21745 -0.18155 -0.136166 -0.104034 -0.061804 -0.0311925 0.00905678 0.05141 0.102815 0.140892 0.193764 0.229031 0.254865 0.295661 0.34022 0.37819 0.422019 0.4465 0.482988 0.516855 0.536802];
ak2=444.066+[1.58819 1.52384 1.4365 1.34094 1.17229 1.00394 0.767188 0.487889 0.11644 -0.183576 -0.635598 -0.986601 -1.25463 -1.69662 -2.20133 -2.65204 -3.20233 -3.52819 -4.04598 -4.57359 -4.90869 ];
ak3=-707.086+[-0.881612 -1.02844 -1.07999 -1.093 -1.10432 -1.11204 -1.12403 -1.14491 -1.17751 -1.2033 -1.24226 -1.27515 -1.30339 -1.36137 -1.44494 -1.52808 -1.63726 -1.7055 -1.81984 -1.94464 -2.02796];

% 37435
al1=16.2708+[-0.262384 -0.246339 -0.237171 -0.235377 -0.218098 -0.199215 -0.17429 -0.145663 -0.108578 -0.0797872 -0.0396235 -0.0135673 0.00647856 0.0410147 0.0812828 0.11664 0.158396 0.182152 0.217973 0.25211 0.272361];
al2=449.059+[1.06927 1.03537 1.09922 1.16349 1.11606 1.01922 0.874648 0.689279 0.425295 0.202118 -0.137423 -0.405609 -0.611937 -0.95552 -1.34848 -1.70204 -2.1377 -2.39757 -2.81291 -3.23938 -3.51184];
al3=-710.186+[-0.835382 -0.974404 -1.03707 -1.05679 -1.03435 -1.00608 -0.975048 -0.960274 -0.947118 -0.934885 -0.915468 -0.900811 -0.893668 -0.895087 -0.911726 -0.931892 -0.959999 -0.97821 -1.01028 -1.04812 -1.0744];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4P
t3=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3];
% 36572
am1=12.3763+[-0.0625365 -0.0571366 -0.0598981 -0.0685636 -0.0696261 -0.0643498 -0.0547241 -0.0413041 -0.0228038 -0.0137775 0.00775658 0.0292394 0.0462723 0.0576326 0.073106 0.0951428 0.109857 0.129977 0.152028 0.174161 0.189422 ];
am2=446.738+[0.664822 0.678819 0.770332 0.871361 0.929433 0.927462 0.900368 0.838836 0.728532 0.666051 0.497059 0.303534 0.119591 -0.0233577 -0.2269 -0.51087 -0.695895 -0.948687 -1.23256 -1.53055 -1.74483];
am3=-714.659+[-1.00175 -1.03338 -1.06283 -1.07812 -1.0732 -1.05869 -1.03776 -1.03334 -1.03211 -1.03364 -1.03632 -1.03773 -1.03733 -1.03668 -1.04111 -1.057 -1.07327 -1.09975 -1.13225 -1.16878 -1.19636];
% 16215
an1=12.1679+[0.0741139 0.0901913 0.106678 0.117934 0.13445 0.150016 0.170638 0.193156 0.221383 0.234691 0.266043 0.297259 0.322989 0.340891 0.364196 0.396022 0.416836 0.445156 0.47591 0.506807 0.528103];
an2=446.385+[1.46322 1.43331 1.38047 1.31822 1.20855 1.0914 0.922484 0.722831 0.453122 0.3195 -0.0166563 -0.387291 -0.72746 -0.986203 -1.34401 -1.82735 -2.14145 -2.5702 -3.04754 -3.54427 -3.89905 ];
an3=-705.203+[-1.33312 -1.35416 -1.34588 -1.31949 -1.28614 -1.25999 -1.22797 -1.20698 -1.18837 -1.18264 -1.17138 -1.1612 -1.15465 -1.15155 -1.15348 -1.16987 -1.18857 -1.2215 -1.26583 -1.31931 -1.36163];
% 31500
ao1=9.70641+[0.100468 0.116497 0.132825 0.143291 0.15927 0.174126 0.194312 0.217023 0.245676 0.25904 0.290465 0.321916 0.347871 0.365772 0.388659 0.418744 0.437868 0.46345 0.490751 0.51776 0.536145];
ao2=444.066+[1.29841 1.27346 1.23863 1.19814 1.11358 1.01574 0.870988 0.693649 0.450181 0.328567 0.0211656 -0.31854 -0.630919 -0.868591 -1.19739 -1.6414 -1.9293 -2.32156 -2.75769 -3.21106 -3.53463 ];
ao3=-707.086+[-1.14938 -1.17753 -1.19444 -1.19694 -1.19683 -1.1953 -1.19395 -1.20131 -1.2155 -1.2243 -1.24708 -1.2726 -1.29721 -1.31697 -1.34911 -1.40377 -1.44656 -1.51164 -1.59058 -1.67881 -1.74516];
% 37435
ap1=16.2708+[-0.0527419 -0.045838 -0.0492899 -0.0595508 -0.0601274 -0.0525061 -0.0408287 -0.0273288 -0.00848196 0.00132279 0.0246548 0.0476498 0.0656583 0.0777966 0.0952985 0.121328 0.138876 0.163043 0.18972 0.216724 0.235504];
ap2=449.059+[0.808319 0.821128 0.914274 1.01684 1.05303 1.02145 0.955331 0.86577 0.720739 0.641522 0.430785 0.192166 -0.0327984 -0.206979 -0.453186 -0.794643 -1.01701 -1.32143 -1.66373 -2.02302 -2.2812];
ap3=-710.186+[-1.08969 -1.12186 -1.15123 -1.16557 -1.14822 -1.11904 -1.07836 -1.05899 -1.03981 -1.03331 -1.01628 -0.996606 -0.977155 -0.96235 -0.948678 -0.942004 -0.94429 -0.952123 -0.964334 -0.980491 -0.99406];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4P
t4=[2 2.05816 2.10161 2.16188 2.20417 2.26497 2.3108 2.35767 2.41039 2.46048 2.50857 2.57039 2.61266 2.65395 2.70851 2.75122 2.8056 2.85917 2.91124 2.95071 3];
% 36572
aq1=12.3763+[-0.215014 0.0675937 0.146677 0.168768 0.17647 0.188385 0.199349 0.213084 0.235441 0.256622 0.274414 0.292824 0.304381 0.315269 0.329007 0.339189 0.351059 0.362176 0.373678 0.382001 0.391941];
aq2=446.738+[0.808702 -0.136192 -0.808644 -1.41613 -1.7252 -2.1178 -2.39392 -2.66752 -2.9643 -3.24286 -3.50193 -3.81741 -4.02872 -4.23251 -4.49245 -4.68931 -4.93391 -5.16789 -5.38778 -5.55039 -5.74847];
aq3=-714.659+[0.194024 -1.02808 -1.03323 -1.06168 -1.09212 -1.14625 -1.19061 -1.23864 -1.29806 -1.35565 -1.40994 -1.47658 -1.52275 -1.56848 -1.62918 -1.67589 -1.73469 -1.7918 -1.84674 -1.88755 -1.93739];
% 16215
ar1=12.1679+[-0.403375 0.319789 0.443255 0.473762 0.485359 0.503136 0.518475 0.536404 0.565855 0.594075 0.6179 0.64184 0.656998 0.671739 0.691687 0.706677 0.72442 0.741321 0.758566 0.7712 0.786476];
ar2=446.385+[1.40349 0.00773081 -1.08683 -2.06102 -2.57063 -3.22826 -3.69729 -4.16677 -4.67872 -5.15581 -5.60049 -6.14527 -6.50913 -6.85922 -7.30792 -7.64821 -8.07094 -8.47584 -8.85768 -9.14094 -9.48883];
ar3=-705.203+[0.136572 -1.29877 -1.28591 -1.30602 -1.33533 -1.38973 -1.4363 -1.48826 -1.55611 -1.62653 -1.69689 -1.78698 -1.85219 -1.91911 -2.011 -2.08406 -2.1786 -2.27312 -2.3662 -2.43702 -2.52567];
% 31500
as1=9.70641+[-0.371109 0.341148 0.458521 0.482403 0.490285 0.503176 0.515016 0.52952 0.555026 0.579508 0.600196 0.621337 0.634664 0.647531 0.664645 0.677503 0.692532 0.706838 0.721604 0.732418 0.745451];
as2=444.066+[1.26279 -0.0592161 -1.07877 -1.98048 -2.4498 -3.05356 -3.48306 -3.91208 -4.37918 -4.81398 -5.21866 -5.71343 -6.04342 -6.36054 -6.76607 -7.07313 -7.454 -7.81821 -8.16109 -8.41504 -8.72627];
as3=-707.086+[0.278094 -1.24188 -1.31479 -1.41064 -1.47966 -1.5849 -1.66725 -1.75462 -1.86001 -1.96441 -2.06613 -2.19508 -2.28572 -2.37655 -2.4983 -2.59362 -2.71522 -2.83512 -2.95163 -3.03957 -3.14903];
% 37435
at1=16.2708+[-0.248265 0.096244 0.188317 0.215081 0.225225 0.241942 0.256832 0.274707 0.302488 0.328786 0.350694 0.373145 0.387271 0.400572 0.417649 0.430271 0.445149 0.459077 0.473289 0.483555 0.495784];
at2=449.059+[1.0122 -0.137032 -0.939557 -1.66316 -2.03313 -2.50492 -2.83738 -3.16708 -3.52524 -3.86173 -4.1752 -4.55808 -4.81496 -5.06297 -5.38001 -5.62043 -5.91938 -6.20558 -6.47484 -6.6741 -6.91699 ];
at3=-710.186+[0.112597 -1.05367 -1.00402 -0.981544 -0.986698 -1.01076 -1.0351 -1.06419 -1.10452 -1.14493 -1.18323 -1.23016 -1.26347 -1.29712 -1.34304 -1.37889 -1.42471 -1.46989 -1.51416 -1.54736 -1.58821 ];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4P
t5=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3];
% 36572
au1=12.3763+[-0.0645383 -0.0591998 -0.0617345 -0.0697565 -0.0717629 -0.0681619 -0.0545493 -0.039633 -0.0297497 -0.0043497 0.00701067 0.0309481 0.0413725 0.0530874 0.0696462 0.0879498 0.113715 0.125425 0.148547 0.163641 0.182388];
au2=446.738+[0.630243 0.643281 0.726084 0.823007 0.882729 0.901791 0.872915 0.807887 0.75541 0.584273 0.496465 0.266656 0.154737 0.015884 -0.20326 -0.444142 -0.776827 -0.927991 -1.23355 -1.44067 -1.7096];
au3=-714.659+[-0.996715 -1.02804 -1.05643 -1.07225 -1.07291 -1.06032 -1.03592 -1.0332 -1.0322 -1.0354 -1.03624 -1.03692 -1.03654 -1.03576 -1.03896 -1.05093 -1.07965 -1.0954 -1.12976 -1.15464 -1.18856 ];
% 16215
av1=12.1679+[0.0479822 0.0629259 0.0774361 0.0870994 0.100129 0.114052 0.141766 0.16419 0.178691 0.214031 0.230256 0.265766 0.281242 0.298784 0.323344 0.349477 0.385559 0.401862 0.433763 0.454614 0.48051];
av2=446.385+[1.48605 1.45725 1.40699 1.34712 1.25307 1.15057 0.920566 0.716265 0.578235 0.212997 0.0358493 -0.407233 -0.616851 -0.871706 -1.26139 -1.67481 -2.24201 -2.49931 -3.01528 -3.3623 -3.80982];
av3=-705.203+[-1.34535 -1.36591 -1.35809 -1.33074 -1.29736 -1.26816 -1.22124 -1.19893 -1.18714 -1.1687 -1.16161 -1.14829 -1.14315 -1.13841 -1.13793 -1.14907 -1.18174 -1.20133 -1.24781 -1.28382 -1.33526 ];
% 31500
aw1=9.70641+[0.0756118 0.0905274 0.104938 0.113777 0.125955 0.139266 0.165656 0.188082 0.202626 0.237786 0.253835 0.28904 0.304462 0.321915 0.345914 0.370507 0.403321 0.417874 0.445919 0.463993 0.486158];
aw2=444.066+[1.31678 1.29285 1.25998 1.22158 1.15032 1.06753 0.87187 0.690211 0.566248 0.234114 0.0724974 -0.333073 -0.525213 -0.758957 -1.11662 -1.49614 -2.0156 -2.25077 -2.7219 -3.03848 -3.44648];
aw3=-707.086+[-1.15639 -1.18399 -1.20064 -1.20193 -1.19844 -1.19475 -1.19068 -1.19686 -1.20248 -1.22371 -1.23466 -1.26388 -1.27813 -1.29634 -1.32925 -1.37353 -1.4498 -1.48868 -1.57271 -1.63315 -1.71516];
% 37435
ax1=16.2708+[-0.0552054 -0.0483829 -0.0515621 -0.0610204 -0.0630207 -0.0581296 -0.0410175 -0.0260084 -0.0160603 0.0111595 0.0233842 0.0487767 0.0598295 0.0723723 0.0909166 0.112521 0.143332 0.157444 0.185488 0.203937 0.227045];
ax2=449.059+[0.768975 0.780673 0.863458 0.961499 1.00756 1.00075 0.920062 0.827651 0.757499 0.540768 0.431013 0.147576 0.0104257 -0.159302 -0.425152 -0.715296 -1.11559 -1.29781 -1.66653 -1.91646 -2.24071];
ax3=-710.186+[-1.08139 -1.11315 -1.14057 -1.15535 -1.14789 -1.12176 -1.0719 -1.05469 -1.04446 -1.02569 -1.01616 -0.991521 -0.979456 -0.964665 -0.947782 -0.940212 -0.943584 -0.948133 -0.960497 -0.971038 -0.987103 ];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4P
t6=[2 2.06926 2.1039 2.16327 2.20546 2.25429 2.30079 2.35429 2.4315 2.46157 2.514 2.56038 2.60079 2.65194 2.70721 2.75135 2.80366 2.85454 2.91895 2.95814 3];
% 36572
ay1=12.3763+[-0.215017 -0.136433 -0.0664135 0.0494241 0.101979 0.146644 0.172514 0.192883 0.216327 0.227324 0.248037 0.264891 0.277696 0.2923 0.307057 0.318187 0.330699 0.341852 0.355891 0.36454 0.373334 ];
ay2=446.738+[0.808829 0.30903 0.123089 -0.476262 -0.935084 -1.40754 -1.79605 -2.18709 -2.68947 -2.87259 -3.17823 -3.43785 -3.65685 -3.92658 -4.21106 -4.4314 -4.68364 -4.92039 -5.20987 -5.38054 -5.55731];
ay3=-714.659+[0.193483 -0.959172 -0.981634 -0.996148 -1.01909 -1.06462 -1.11508 -1.1739 -1.2569 -1.29061 -1.34962 -1.40146 -1.44606 -1.50278 -1.56553 -1.61597 -1.6748 -1.73078 -1.80085 -1.84293 -1.88675];
% 16215
az1=12.1679+[-0.403358 -0.0171041 0.106363 0.283562 0.357622 0.417954 0.452552 0.478912 0.508441 0.522828 0.549531 0.571618 0.588681 0.60842 0.628863 0.644787 0.662794 0.67911 0.699661 0.712339 0.725417 ];
az2=446.385+[1.40391 0.760804 0.306266 -0.678302 -1.38999 -2.13944 -2.76716 -3.41133 -4.25766 -4.56948 -5.09103 -5.53492 -5.91007 -6.37143 -6.85681 -7.23331 -7.66546 -8.07191 -8.57034 -8.86532 -9.17342];
az3=-705.203+[0.135333 -1.2342 -1.22019 -1.22134 -1.241 -1.28235 -1.33143 -1.39069 -1.48092 -1.52068 -1.59339 -1.66112 -1.7222 -1.80317 -1.89608 -1.97312 -2.06581 -2.15689 -2.27414 -2.34625 -2.42317];
% 31500
ba1=9.70641+[-0.371091 0.00864884 0.130271 0.300512 0.369784 0.425459 0.455631 0.477168 0.500121 0.511972 0.534895 0.55395 0.56853 0.585269 0.602531 0.615869 0.630936 0.644478 0.661587 0.67223 0.68316];
ba2=444.066+[1.26326 0.659576 0.242807 -0.674579 -1.33797 -2.03374 -2.61355 -3.20581 -3.98008 -4.26465 -4.74006 -5.14402 -5.48491 -5.90353 -6.34334 -6.68388 -7.0741 -7.44043 -7.88885 -8.15376 -8.42984];
ba3=-707.086+[0.276778 -1.13736 -1.17046 -1.24658 -1.31718 -1.41306 -1.5081 -1.61475 -1.76712 -1.82925 -1.93914 -2.03806 -2.12513 -2.23751 -2.36262 -2.46406 -2.58429 -2.70079 -2.84845 -2.93822 -3.03342];
% 37435
bb1=16.2708+[-0.248256 -0.134566 -0.0547913 0.0800977 0.140039 0.191095 0.222394 0.248566 0.279243 0.293091 0.318476 0.339033 0.354724 0.372695 0.391008 0.405028 0.420727 0.434785 0.452414 0.463169 0.474097];
bb2=449.059+[1.01233 0.368974 0.140806 -0.580638 -1.12235 -1.68053 -2.14223 -2.60913 -3.21189 -3.43234 -3.80095 -4.11462 -4.37962 -4.70663 -5.05199 -5.31999 -5.62717 -5.91592 -6.26933 -6.47786 -6.69412];
bb3=-710.186+[0.11204 -0.993209 -1.00137 -0.969806 -0.959104 -0.970722 -0.993642 -1.02546 -1.07452 -1.09637 -1.13603 -1.17174 -1.20293 -1.24344 -1.28977 -1.32804 -1.37335 -1.41706 -1.4729 -1.50696 -1.54271];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4P
t13=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3];
% 36572
bc1=12.3763+[-0.00126366 0.00282179 0.000834033 -0.00732805 -0.0165577 -0.0222832 -0.0254121 -0.024472 -0.0203283 -0.0136079 -0.00529244 0.00375165 0.0151955 0.0237724 0.031559 0.0417296 0.0516169 0.0647346 0.0784432 0.0944296 0.104781];
bc2=446.738+[0.696855 0.705872 0.774284 0.858876 0.959009 1.01476 1.04161 1.05447 1.05428 1.03049 0.981667 0.913612 0.817681 0.73499 0.6544 0.535841 0.407116 0.2454 0.0758234 -0.121405 -0.248038];
bc3=-714.659+[-0.705812 -0.726346 -0.752305 -0.7689 -0.783898 -0.785785 -0.777799 -0.761067 -0.746413 -0.747522 -0.750749 -0.753014 -0.754307 -0.754306 -0.753369 -0.751076 -0.748363 -0.748853 -0.751907 -0.758097 -0.763486];
% 16215
bd1=12.1679+[0.129016 0.138568 0.147856 0.153172 0.158414 0.165355 0.17392 0.184016 0.19619 0.210019 0.225104 0.241297 0.261272 0.275921 0.289296 0.306867 0.323962 0.3452 0.366783 0.391426 0.407057];
bd2=446.385+[1.63099 1.61527 1.5929 1.56752 1.53222 1.47204 1.38719 1.2852 1.16454 1.02293 0.85916 0.674455 0.436585 0.249271 0.0721731 -0.175743 -0.431824 -0.741824 -1.05456 -1.40784 -1.6302];
bd3=-705.203+[-1.0531 -1.06521 -1.06023 -1.04225 -1.0133 -0.988442 -0.962125 -0.931628 -0.901001 -0.879491 -0.862468 -0.847264 -0.829714 -0.817716 -0.807153 -0.794607 -0.784365 -0.77767 -0.776985 -0.782492 -0.789042];
% 31500
be1=9.70641+[0.155694 0.165187 0.174221 0.179022 0.18363 0.18969 0.196987 0.207099 0.219714 0.233782 0.249008 0.265299 0.285475 0.300352 0.313957 0.331832 0.349134 0.37024 0.391229 0.414672 0.429302];
be2=444.066+[1.44871 1.4359 1.42513 1.41422 1.39707 1.35415 1.2876 1.2042 1.10269 0.979449 0.83403 0.668239 0.453658 0.283752 0.122885 -0.102938 -0.33673 -0.619948 -0.905917 -1.22906 -1.43246 ];
be3=-707.086+[-0.843245 -0.859679 -0.871173 -0.87317 -0.868879 -0.866754 -0.863641 -0.858081 -0.853148 -0.855453 -0.861658 -0.869878 -0.880651 -0.88948 -0.898021 -0.91097 -0.925755 -0.947947 -0.974842 -1.00994 -1.0344];
% 37435
bf1=16.2708+[0.00528751 0.0103056 0.00815981 -0.00141849 -0.011903 -0.0161099 -0.0161163 -0.0149356 -0.0107546 -0.00313283 0.00632609 0.0162709 0.0286589 0.037906 0.046177 0.0568397 0.0674601 0.0823506 0.0981902 0.11693 0.129238];
bf2=449.059+[0.880613 0.889586 0.961216 1.04998 1.15398 1.19711 1.20028 1.18676 1.16033 1.11733 1.04785 0.957177 0.832587 0.727553 0.625939 0.47802 0.318677 0.119907 -0.0872007 -0.32691 -0.480383];
bf3=-710.186+[-0.813393 -0.834644 -0.862016 -0.879472 -0.895264 -0.890705 -0.871572 -0.839908 -0.810427 -0.801656 -0.794603 -0.785471 -0.772394 -0.761305 -0.749936 -0.733127 -0.715725 -0.699542 -0.686382 -0.674966 -0.669656];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4P
t14=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3];
% 36572
bg1=12.3763+[-0.262546 -0.154284 -0.0268663 0.0381372 0.103171 0.133166 0.182336 0.204975 0.252828 0.259238 0.287259 0.303321 0.317382 0.333293 0.345916 0.35899 0.370454 0.384508 0.397257 0.412976 0.418115];
bg2=446.738+[0.872491 0.575924 0.365607 0.0837351 -0.421481 -0.769249 -1.36472 -1.61384 -2.16748 -2.24624 -2.62408 -2.87322 -3.1144 -3.41061 -3.65641 -3.92492 -4.1662 -4.44872 -4.70158 -5.01045 -5.11286];
bg3=-714.659+[-0.305877 -0.642998 -0.694981 -0.694589 -0.688607 -0.707033 -0.772267 -0.805899 -0.892186 -0.90515 -0.96996 -1.01343 -1.05684 -1.11223 -1.1596 -1.21287 -1.262 -1.32256 -1.37886 -1.44983 -1.47369];
% 16215
bh1=12.1679+[-0.293437 -0.0752895 0.158175 0.258958 0.356388 0.40309 0.475736 0.506664 0.572586 0.581567 0.620202 0.642609 0.662657 0.686057 0.704868 0.72467 0.742103 0.763485 0.783018 0.807191 0.815149];
bh2=446.385+[1.65142 1.30816 0.669527 0.182886 -0.626001 -1.18033 -2.14812 -2.56048 -3.49267 -3.6257 -4.26202 -4.68199 -5.08875 -5.5882 -6.00217 -6.45395 -6.86068 -7.33822 -7.76645 -8.29189 -8.46757];
bh3=-705.203+[-0.521951 -0.925463 -0.912242 -0.902889 -0.88966 -0.900103 -0.951686 -0.980489 -1.06466 -1.07867 -1.15201 -1.20517 -1.26095 -1.33585 -1.40304 -1.48148 -1.55642 -1.65096 -1.74128 -1.85858 -1.899];
% 31500
bi1=9.70641+[-0.263984 -0.049672 0.180407 0.278508 0.373383 0.418219 0.485004 0.512914 0.571652 0.57958 0.613405 0.632758 0.649855 0.669556 0.685294 0.7017 0.716092 0.733879 0.750147 0.77033 0.77695];
bi2=444.066+[1.50764 1.16631 0.583843 0.131162 -0.624037 -1.14133 -2.03904 -2.41963 -3.27645 -3.39845 -3.98103 -4.36476 -4.73588 -5.19085 -5.56742 -5.97775 -6.34656 -6.77884 -7.16579 -7.63952 -7.79756];
bi3=-707.086+[-0.371135 -0.772261 -0.830869 -0.862281 -0.912655 -0.964723 -1.088 -1.14729 -1.30006 -1.3237 -1.44294 -1.52597 -1.61023 -1.71937 -1.81433 -1.92246 -2.02367 -2.14843 -2.26526 -2.41445 -2.46544];
% 37435
bk1=16.2708+[-0.296601 -0.163932 -0.0178585 0.0568618 0.129755 0.164329 0.223658 0.251211 0.309249 0.317036 0.351542 0.371547 0.389362 0.409875 0.426217 0.443323 0.458338 0.47662 0.493152 0.513398 0.519991];
bk2=449.059+[1.06322 0.722159 0.4574 0.112115 -0.492959 -0.902339 -1.60526 -1.90083 -2.56056 -2.65467 -3.10731 -3.40655 -3.69662 -4.05348 -4.35002 -4.67438 -4.96631 -5.3086 -5.61541 -5.9909 -6.11557];
bk3=-710.186+[-0.380102 -0.7143 -0.751792 -0.725444 -0.674483 -0.66641 -0.689699 -0.706581 -0.755766 -0.763511 -0.803525 -0.830799 -0.8589 -0.896033 -0.928681 -0.966385 -1.00194 -1.04727 -1.09049 -1.14609 -1.16501];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of flexion (4P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C5-C6 Left Hand Foreman Narrowing/Widening Under 2 N-m of Flexion (4P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
