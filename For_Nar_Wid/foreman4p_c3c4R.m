%% foramen height and width narrowing/widening 
% for all models for the c3-c4 right hand side foramen 
% 4457,20101,9037,21922

% 4P!!

% Values for displacement and base coordinates have not yet been updated from copy paste.

k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 4457,20101,9037,21922
%% model15_intact_TLC_4P
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 4457
aa1=-9.37506+[5.0731200e-01   7.4153900e-01   7.9163500e-01   8.1802000e-01   8.4803800e-01   9.0551400e-01   9.6168400e-01   1.0005300e+00   1.0411500e+00   1.1057900e+00   1.1288700e+00   1.1681100e+00   1.2015800e+00   1.2368000e+00   1.2638600e+00   1.2971700e+00   1.3251000e+00   1.3530200e+00   1.3796600e+00   1.4065500e+00   1.4273400e+00];
aa2=448.144+[1.0306900e+00  -5.5269600e-01  -1.9415400e+00  -3.5610500e+00  -4.4633800e+00  -5.4438200e+00  -6.2782600e+00  -6.8653100e+00  -7.5464400e+00  -8.7645600e+00  -9.2308900e+00  -1.0028600e+01  -1.0715600e+01  -1.1452000e+01  -1.2039300e+01  -1.2763300e+01  -1.3378600e+01  -1.4024100e+01  -1.4651200e+01  -1.5308400e+01  -1.5815000e+01];
aa3=-689.149+[-6.7815900e-01  -5.0770600e-01  -4.3422000e-01  -4.2914100e-01  -4.6139600e-01  -5.1652100e-01  -5.7910700e-01  -6.3274200e-01  -7.0538900e-01  -8.5976400e-01  -9.2734900e-01  -1.0531500e+00  -1.1709500e+00  -1.3075800e+00  -1.4245100e+00  -1.5784900e+00  -1.7181500e+00  -1.8731100e+00  -2.0316800e+00  -2.2063900e+00  -2.3462500e+00];

% 20101
ab1=-11.8681+[3.3679400e-01   5.0847000e-01   5.4206000e-01   5.5041600e-01   5.6547700e-01   6.0302400e-01   6.4074000e-01   6.6704000e-01   6.9457100e-01   7.3895400e-01   7.5532900e-01   7.8303000e-01   8.0628800e-01   8.3069500e-01   8.5031100e-01   8.7537000e-01   8.9709200e-01   9.1900600e-01   9.3975900e-01   9.6084700e-01   9.7649500e-01];
ab2=447.151+[5.9687600e-01  -5.7296900e-01  -1.5969800e+00  -2.7723600e+00  -3.4136300e+00  -4.1037900e+00  -4.6868700e+00  -5.0952400e+00  -5.5695400e+00  -6.4193500e+00  -6.7455500e+00  -7.3045100e+00  -7.7860900e+00  -8.3028400e+00  -8.7165000e+00  -9.2280800e+00  -9.6638300e+00  -1.0121000e+01  -1.0565600e+01  -1.1032500e+01  -1.1391300e+01];
ab3=-698.575+[-5.1114300e-01  -3.8109800e-01  -3.3857800e-01  -3.5194300e-01  -3.8374200e-01  -4.2845600e-01  -4.7373700e-01  -5.1077500e-01  -5.5987300e-01  -6.6152300e-01  -7.0551400e-01  -7.8637200e-01  -8.6095600e-01  -9.4681300e-01  -1.0198100e+00  -1.1154500e+00  -1.2017500e+00  -1.2973500e+00  -1.3950500e+00  -1.5023700e+00  -1.5881000e+00];

% 9037
ac1=-7.50723+[5.6194400e-01   7.9466000e-01   8.3792000e-01   8.5535800e-01   8.7971900e-01   9.3076500e-01   9.8070600e-01   1.0147900e+00   1.0499500e+00   1.1055300e+00   1.1253400e+00   1.1590000e+00   1.1875700e+00   1.2173200e+00   1.2400700e+00   1.2684600e+00   1.2923000e+00   1.3159300e+00   1.3383900e+00   1.3609400e+00   1.3784600e+00];
ac2=444.719+[1.0471600e+00  -4.7060700e-01  -1.8047100e+00  -3.3529700e+00  -4.2104300e+00  -5.1378300e+00  -5.9242400e+00  -6.4760400e+00  -7.1148500e+00  -8.2531100e+00  -8.6875500e+00  -9.4290900e+00  -1.0065900e+01  -1.0746900e+01  -1.1288900e+01  -1.1955100e+01  -1.2519900e+01  -1.3111000e+01  -1.3684100e+01  -1.4283300e+01  -1.4744200e+01];
ac3=-690.512+[-6.4682200e-01  -6.3396200e-01  -6.8488300e-01  -8.2594700e-01  -9.4277900e-01  -1.0915200e+00  -1.2343100e+00  -1.3443000e+00  -1.4816500e+00  -1.7499200e+00  -1.8603400e+00  -2.0585300e+00  -2.2379700e+00  -2.4397800e+00  -2.6078400e+00  -2.8238800e+00  -3.0154700e+00  -3.2240400e+00  -3.4337700e+00  -3.6611200e+00  -3.8408800e+00];

% 21922
ad1=-12.9198+[3.2311600e-01   5.0673800e-01   5.4856300e-01   5.6733200e-01   5.8952000e-01   6.3576500e-01   6.8178100e-01   7.1424900e-01   7.4873500e-01   8.0426800e-01   8.2453000e-01   8.5884500e-01   8.8776100e-01   9.1844900e-01   9.4303100e-01   9.7374900e-01   1.0001200e+00   1.0268900e+00   1.0523800e+00   1.0783600e+00   1.0977400e+00];
ad2=450.785+[6.8449100e-01  -6.1448700e-01  -1.7501600e+00  -3.0573600e+00  -3.7734400e+00  -4.5474400e+00  -5.2036400e+00  -5.6644200e+00  -6.2006100e+00  -7.1643400e+00  -7.5351900e+00  -8.1715900e+00  -8.7210000e+00  -9.3115200e+00  -9.7849300e+00  -1.0371500e+01  -1.0871900e+01  -1.1397800e+01  -1.1910100e+01  -1.2448800e+01  -1.2863500e+01];
ad3=-694.998+[-6.0699400e-01  -3.3992100e-01  -1.8734900e-01  -7.8878700e-02  -4.4853400e-02  -1.8600700e-02  -4.2969600e-03   6.1637800e-05  -1.6583700e-03  -2.0276700e-02  -3.3108000e-02  -6.1603300e-02  -9.1984600e-02  -1.3141600e-01  -1.6813200e-01  -2.1991600e-01  -2.6975900e-01  -3.2799200e-01  -3.9021700e-01  -4.6124000e-01  -5.1975800e-01];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4P
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 4457
ae1=-9.37506+[-3.0640500e-01  -6.8329000e-02   1.9138200e-01   3.6469500e-01   5.5920600e-01   6.8057200e-01   8.2513000e-01   9.0623300e-01   1.0042700e+00   1.0408900e+00   1.1039000e+00   1.1519800e+00   1.2038200e+00   1.2452800e+00   1.2827700e+00   1.3184500e+00   1.3525400e+00   1.3856900e+00   1.4180900e+00   1.4442200e+00   1.4636500e+00];
ae2=448.144+[2.1859200e+00   1.6830700e+00   6.6479300e-01  -2.6589400e-01  -1.4461700e+00  -2.3439100e+00  -3.6745800e+00  -4.6250800e+00  -5.9141500e+00  -6.4674600e+00  -7.5212500e+00  -8.3851900e+00  -9.3931200e+00  -1.0263100e+01  -1.1099200e+01  -1.1962900e+01  -1.2822600e+01  -1.3671700e+01  -1.4507300e+01  -1.5216500e+01  -1.5756000e+01];
ae3=-689.149+[-1.1481100e+00  -1.3098300e+00  -1.0702700e+00  -9.2384800e-01  -7.9248600e-01  -7.4299200e-01  -7.1360500e-01  -7.2894400e-01  -7.9161000e-01  -8.3102900e-01  -9.2604500e-01  -1.0227700e+00  -1.1548600e+00  -1.2852700e+00  -1.4245300e+00  -1.5839900e+00  -1.7581100e+00  -1.9443200e+00  -2.1408100e+00  -2.3181700e+00  -2.4592100e+00];

% 20101
af1=-11.8681+[-3.2046100e-01  -1.5428200e-01   2.8751600e-02   1.5505100e-01   2.9743700e-01   3.8978100e-01   5.0044400e-01   5.6174400e-01   6.3793400e-01   6.6685800e-01   7.1736900e-01   7.5680500e-01   7.9962200e-01   8.3407500e-01   8.6531700e-01   8.9502800e-01   9.2267500e-01   9.4891700e-01   9.7391000e-01   9.9507000e-01   1.0108200e+00];
af2=447.151+[1.5394400e+00   1.1465000e+00   4.6985400e-01  -1.7471600e-01  -1.0104900e+00  -1.6685800e+00  -2.6575500e+00  -3.3568000e+00  -4.2993300e+00  -4.7021800e+00  -5.4684500e+00  -6.0959900e+00  -6.8282900e+00  -7.4620100e+00  -8.0725800e+00  -8.7040000e+00  -9.3332400e+00  -9.9555100e+00  -1.0567000e+01  -1.1088700e+01  -1.1486100e+01];
af3=-698.575+[-8.3785300e-01  -9.6878200e-01  -7.5718000e-01  -6.3297600e-01  -5.1482400e-01  -4.6816200e-01  -4.3375700e-01  -4.3929800e-01  -4.7812600e-01  -5.0374500e-01  -5.6600500e-01  -6.2885200e-01  -7.1409100e-01  -7.9777200e-01  -8.8691000e-01  -9.8921400e-01  -1.1010900e+00  -1.2206800e+00  -1.3461600e+00  -1.4592100e+00  -1.5490000e+00];

% 9037
ag1=-7.50723+[-2.5743400e-01  -1.0053800e-02   2.5813400e-01   4.3438600e-01   6.2778300e-01   7.4693300e-01   8.8961000e-01   9.6818500e-01   1.0600800e+00   1.0934800e+00   1.1493600e+00   1.1906800e+00   1.2347500e+00   1.2692600e+00   1.2999500e+00   1.3285500e+00   1.3556600e+00   1.3820000e+00   1.4078700e+00   1.4285600e+00   1.4439600e+00];
ag2=444.719+[2.1685800e+00   1.6963000e+00   7.4223500e-01  -1.3656100e-01  -1.2536700e+00  -2.1068500e+00  -3.3699700e+00  -4.2698100e+00  -5.4874900e+00  -6.0091000e+00  -7.0008600e+00  -7.8121500e+00  -8.7561300e+00  -9.5689300e+00  -1.0348300e+01  -1.1151500e+01  -1.1949100e+01  -1.2734800e+01  -1.3505800e+01  -1.4158700e+01  -1.4654300e+01];
ag3=-690.512+[-1.0346900e+00  -1.2630500e+00  -1.1665700e+00  -1.1291300e+00  -1.1242400e+00  -1.1587800e+00  -1.2462800e+00  -1.3443800e+00  -1.5184000e+00  -1.6050900e+00  -1.7890700e+00  -1.9578500e+00  -2.1726000e+00  -2.3731100e+00  -2.5786300e+00  -2.8053000e+00  -3.0450400e+00  -3.2948800e+00  -3.5528800e+00  -3.7814100e+00  -3.9608100e+00];

% 21922
ah1=-12.9198+[-3.6086200e-01  -1.8857900e-01  -1.2636200e-03   1.2959700e-01   2.8103000e-01   3.7923000e-01   4.9510800e-01   5.6052800e-01   6.4459700e-01   6.7716600e-01   7.3529800e-01   7.8180400e-01   8.3249800e-01   8.7395600e-01   9.1220900e-01   9.4916900e-01   9.8399400e-01   1.0172600e+00   1.0491200e+00   1.0759900e+00   1.0959400e+00];
ah2=450.785+[1.7083600e+00   1.2791000e+00   4.9472300e-01  -2.3358300e-01  -1.1704500e+00  -1.8984700e+00  -2.9917600e+00  -3.7678700e+00  -4.8172300e+00  -5.2668500e+00  -6.1234000e+00  -6.8262100e+00  -7.6479500e+00  -8.3604300e+00  -9.0479700e+00  -9.7602100e+00  -1.0471200e+01  -1.1175700e+01  -1.1869600e+01  -1.2462500e+01  -1.2915100e+01];
ah3=-694.998+[-1.0313900e+00  -1.1201100e+00  -7.9162400e-01  -5.8128300e-01  -3.6340300e-01  -2.5101000e-01  -1.2393000e-01  -6.4279500e-02  -1.6181900e-02  -5.1680300e-03   1.0190700e-03  -6.9364300e-03  -2.9743300e-02  -6.0737300e-02  -1.0033700e-01  -1.5269500e-01  -2.1610500e-01  -2.8902600e-01  -3.6982000e-01  -4.4579000e-01  -5.0791700e-01];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4P
t2=[2 2.05126 2.1153 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 4457
ai1=-9.37506+[-1.7017400e-01  -8.6745300e-02   2.1805900e-02   1.0866100e-01   2.0539100e-01   2.7658900e-01   3.5624600e-01   4.3179100e-01   5.2073800e-01   5.8227700e-01   6.6599500e-01   7.2162500e-01   7.6250700e-01   8.2870200e-01   9.0214400e-01   9.6424600e-01   1.0354000e+00   1.0756600e+00   1.1366200e+00   1.1954200e+00   1.2308200e+00];
ai2=448.144+[2.5984000e+00   2.3561400e+00   1.8619500e+00   1.3569100e+00   7.1423600e-01   2.0774900e-01  -4.3459400e-01  -1.1036200e+00  -1.9293000e+00  -2.5576800e+00  -3.4848600e+00  -4.1856200e+00  -4.7136100e+00  -5.5672200e+00  -6.5271900e+00  -7.3698900e+00  -8.3851500e+00  -8.9821200e+00  -9.9240000e+00  -1.0877700e+01  -1.1480300e+01];
ai3=-689.149+[-1.3210800e+00  -1.3932200e+00  -1.2901100e+00  -1.1623700e+00  -1.0337900e+00  -9.4846200e-01  -8.6865300e-01  -8.1434600e-01  -7.6973600e-01  -7.4896900e-01  -7.3300400e-01  -7.3498200e-01  -7.4372500e-01  -7.7605700e-01  -8.4124000e-01  -9.1781200e-01  -1.0306100e+00  -1.1063600e+00  -1.2403200e+00  -1.3940600e+00  -1.5003000e+00];

% 20101
aj1=-11.8681+[-2.1616900e-01  -1.6087800e-01  -9.0303100e-02  -3.6231500e-02   2.6370400e-02   7.3511900e-02   1.2808600e-01   1.8227100e-01   2.4800400e-01   2.9559900e-01   3.6084400e-01   4.0429100e-01   4.3659000e-01   4.8891400e-01   5.4716800e-01   5.9714200e-01   6.5504200e-01   6.8758100e-01   7.3653300e-01   7.8298200e-01   8.1085500e-01];
aj2=447.151+[1.8236600e+00   1.6671800e+00   1.3812600e+00   1.0914400e+00   7.0946900e-01   3.9215600e-01  -2.4995400e-02  -4.7491700e-01  -1.0460700e+00  -1.4927500e+00  -2.1593500e+00  -2.6698200e+00  -3.0554800e+00  -3.6784400e+00  -4.3759500e+00  -4.9905900e+00  -5.7347800e+00  -6.1731600e+00  -6.8674400e+00  -7.5719700e+00  -8.0185800e+00];
aj3=-698.575+[-9.6580700e-01  -1.0276000e+00  -9.4309500e-01  -8.3613300e-01  -7.3184800e-01  -6.5728000e-01  -5.8740900e-01  -5.3892500e-01  -4.9393400e-01  -4.6825200e-01  -4.4014300e-01  -4.2900600e-01  -4.2567700e-01  -4.3459200e-01  -4.6679600e-01  -5.0876700e-01  -5.7340200e-01  -6.1791700e-01  -6.9822700e-01  -7.9207700e-01  -8.5762600e-01];

% 9037
ak1=-7.50723+[-1.1656300e-01  -2.9354300e-02   8.3948700e-02   1.7340800e-01   2.7301200e-01   3.4409200e-01   4.2465500e-01   5.0088500e-01   5.8975200e-01   6.5084700e-01   7.3389500e-01   7.8899400e-01   8.2906900e-01   8.9243900e-01   9.6067300e-01   1.0171800e+00   1.0810200e+00   1.1167900e+00   1.1703600e+00   1.2215200e+00   1.2520800e+00];
ak2=444.719+[2.5710800e+00   2.3468300e+00   1.8887800e+00   1.4203500e+00   8.2240300e-01   3.4890600e-01  -2.5254700e-01  -8.8072900e-01  -1.6567500e+00  -2.2480100e+00  -3.1197900e+00  -3.7784900e+00  -4.2744300e+00  -5.0758300e+00  -5.9756800e+00  -6.7646300e+00  -7.7138000e+00  -8.2711400e+00  -9.1493300e+00  -1.0036900e+01  -1.0596900e+01];
ak3=-690.512+[-1.1726200e+00  -1.2877800e+00  -1.2709300e+00  -1.2276400e+00  -1.1950900e+00  -1.1788500e+00  -1.1786400e+00  -1.1995400e+00  -1.2419700e+00  -1.2832800e+00  -1.3551100e+00  -1.4202900e+00  -1.4757400e+00  -1.5823400e+00  -1.7302000e+00  -1.8776500e+00  -2.0734300e+00  -2.1968200e+00  -2.4042700e+00  -2.6304400e+00  -2.7813900e+00];

% 21922
al1=-12.9198+[-2.5352100e-01  -1.9632700e-01  -1.2491700e-01  -6.9078600e-02  -4.9018500e-03   4.5769800e-02   1.0192900e-01   1.5712700e-01   2.2484600e-01   2.7391500e-01   3.4091600e-01   3.8542600e-01   4.1899500e-01   4.7515400e-01   5.3991100e-01   5.9652000e-01   6.6291700e-01   7.0058000e-01   7.5777200e-01   8.1287900e-01   8.4633600e-01];
al2=450.785+[2.0291800e+00   1.8525800e+00   1.5117200e+00   1.1622300e+00   7.1434700e-01   3.4689400e-01  -1.3005400e-01  -6.3714500e-01  -1.2773900e+00  -1.7763800e+00  -2.5209400e+00  -3.0904500e+00  -3.5207500e+00  -4.2163100e+00  -4.9972100e+00  -5.6862300e+00  -6.5213400e+00  -7.0136900e+00  -7.7940900e+00  -8.5868800e+00  -9.0899100e+00];
al3=-694.998+[-1.2003100e+00  -1.2384500e+00  -1.0918000e+00  -9.1945600e-01  -7.4581300e-01  -6.1958100e-01  -4.9067900e-01  -3.8769700e-01  -2.7885100e-01  -2.0640500e-01  -1.1106600e-01  -5.0877700e-02  -1.1319000e-02   3.7391800e-02   6.9355700e-02   8.2599300e-02   8.2802400e-02   7.5408400e-02   5.2309800e-02   1.4593100e-02  -1.6398600e-02];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 4457
am1=-9.37506+[3.5697400e-01   3.9395700e-01   4.4771500e-01   4.9652200e-01   5.5232400e-01   5.9211300e-01   6.3990700e-01   6.8511800e-01   7.3668300e-01   7.5949900e-01   8.1067600e-01   8.6067500e-01   9.0167200e-01   9.3082200e-01   9.6891800e-01   1.0192900e+00   1.0510900e+00   1.0934300e+00   1.1392700e+00   1.1851300e+00   1.2168800e+00];
am2=448.144+[1.9618200e+00   1.8071300e+00   1.4509700e+00   1.0734000e+00   5.8475500e-01   1.9883800e-01  -2.9848400e-01  -8.1579800e-01  -1.4515500e+00  -1.7446200e+00  -2.4440600e+00  -3.1896500e+00  -3.8547400e+00  -4.3502700e+00  -5.0193600e+00  -5.8902000e+00  -6.4435300e+00  -7.1890200e+00  -8.0074900e+00  -8.8467200e+00  -9.4408200e+00];
am3=-689.149+[-1.2861900e+00  -1.2740300e+00  -1.1908800e+00  -1.0915200e+00  -9.8567200e-01  -9.1734600e-01  -8.4487800e-01  -7.9447500e-01  -7.5210000e-01  -7.3852700e-01  -7.1698700e-01  -7.0616300e-01  -7.0661300e-01  -7.1222700e-01  -7.2978600e-01  -7.7235000e-01  -8.1194100e-01  -8.7837200e-01  -9.6592900e-01  -1.0702500e+00  -1.1522400e+00];
% 20101
an1=-11.8681+[1.9195900e-01   2.1624400e-01   2.4743000e-01   2.7355300e-01   3.0376100e-01   3.2816500e-01   3.5811100e-01   3.8783800e-01   4.2370300e-01   4.4049200e-01   4.7938800e-01   5.1775700e-01   5.4952200e-01   5.7182800e-01   6.0099100e-01   6.4037400e-01   6.6563700e-01   6.9959000e-01   7.3606200e-01   7.7248700e-01   7.9755000e-01];
an2=447.151+[1.2337100e+00   1.1560900e+00   9.8200600e-01   7.9215900e-01   5.4134000e-01   3.2587900e-01   3.4333700e-02  -2.8112300e-01  -6.8577400e-01  -8.7872700e-01  -1.3523200e+00  -1.8678000e+00  -2.3353300e+00  -2.6868500e+00  -3.1648600e+00  -3.7924400e+00  -4.1923800e+00  -4.7322300e+00  -5.3261500e+00  -5.9384500e+00  -6.3729700e+00];
an3=-698.575+[-8.9701400e-01  -8.8692000e-01  -8.2176900e-01  -7.4022300e-01  -6.5824400e-01  -6.0237800e-01  -5.4084400e-01  -4.9913900e-01  -4.6126800e-01  -4.4749500e-01  -4.2115100e-01  -4.0044400e-01  -3.8782700e-01  -3.8167800e-01  -3.8090700e-01  -3.9492300e-01  -4.1369500e-01  -4.4859200e-01  -4.9739200e-01  -5.5757300e-01  -6.0573100e-01];
% 9037
ao1=-7.50723+[4.2968700e-01   4.6735400e-01   5.2197900e-01   5.7084100e-01   6.2650300e-01   6.6548100e-01   7.1249500e-01   7.5721700e-01   8.0824500e-01   8.3061300e-01   8.8060100e-01   9.2953600e-01   9.6961700e-01   9.9794800e-01   1.0345600e+00   1.0815100e+00   1.1103300e+00   1.1480000e+00   1.1881400e+00   1.2276900e+00   1.2548400e+00];
ao2=444.719+[1.9664300e+00   1.8250700e+00   1.4981400e+00   1.1511800e+00   7.0102900e-01   3.4349400e-01  -1.1815700e-01  -5.9985500e-01  -1.1927900e+00  -1.4665800e+00  -2.1208600e+00  -2.8182300e+00  -3.4400900e+00  -3.9032500e+00  -4.5285100e+00  -5.3425000e+00  -5.8594800e+00  -6.5553200e+00  -7.3184700e+00  -8.1001600e+00  -8.6528900e+00];
ao3=-690.512+[-1.1964600e+00  -1.2172500e+00  -1.2051600e+00  -1.1773700e+00  -1.1562400e+00  -1.1478200e+00  -1.1466900e+00  -1.1635200e+00  -1.1977200e+00  -1.2174900e+00  -1.2712100e+00  -1.3363700e+00  -1.4015700e+00  -1.4539600e+00  -1.5328100e+00  -1.6523900e+00  -1.7398300e+00  -1.8696000e+00  -2.0250000e+00  -2.1969100e+00  -2.3256300e+00];
% 21922
ap1=-12.9198+[1.6308400e-01   1.8817300e-01   2.2030400e-01   2.4836300e-01   2.8060900e-01   3.0720700e-01   3.3900500e-01   3.6945400e-01   4.0582000e-01   4.2307100e-01   4.6304500e-01   5.0217000e-01   5.3453900e-01   5.5755900e-01   5.8832000e-01   6.3155900e-01   6.6008600e-01   6.9906700e-01   7.4164300e-01   7.8479600e-01   8.1485600e-01];
ap2=450.785+[1.3985100e+00   1.3064200e+00   1.0890900e+00   8.4992600e-01   5.4313100e-01   2.8616400e-01  -5.7373200e-02  -4.2118900e-01  -8.8275300e-01  -1.1014100e+00  -1.6359500e+00  -2.2166300e+00  -2.7424200e+00  -3.1375600e+00  -3.6743500e+00  -4.3784000e+00  -4.8274800e+00  -5.4343900e+00  -6.1025900e+00  -6.7919200e+00  -7.2814200e+00];
ap3=-694.998+[-1.0828400e+00  -1.0561400e+00  -9.4274800e-01  -8.0753900e-01  -6.6665300e-01  -5.6820900e-01  -4.5497400e-01  -3.6675400e-01  -2.7581100e-01  -2.3854400e-01  -1.5780300e-01  -8.0893800e-02  -1.9677400e-02   2.1961400e-02   6.9490800e-02   1.1471400e-01   1.3302900e-01   1.4742400e-01   1.5146100e-01   1.4412800e-01   1.3245800e-01];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4P
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 4457
aq1=-9.37506+[-4.4029300e-01   8.1605900e-01   1.0242200e+00   1.0784800e+00   1.1027300e+00   1.1387900e+00   1.1665900e+00   1.1936100e+00   1.2363300e+00   1.2770700e+00   1.3108300e+00   1.3443700e+00   1.3655300e+00   1.3860600e+00   1.4149100e+00   1.4372300e+00   1.4642600e+00   1.4916000e+00   1.5176200e+00   1.5365300e+00   1.5599000e+00];
aq2=448.144+[2.2729300e+00  -8.1201400e-01  -2.6995000e+00  -4.3170100e+00  -5.1858100e+00  -6.3240400e+00  -7.1408300e+00  -7.9577400e+00  -8.8537400e+00  -9.6861300e+00  -1.0463100e+01  -1.1428500e+01  -1.2070400e+01  -1.2684600e+01  -1.3469800e+01  -1.4065500e+01  -1.4803300e+01  -1.5511500e+01  -1.6177300e+01  -1.6670800e+01  -1.7278100e+01];
aq3=689.149+[-1.2343600e-01  -8.5814800e-01  -7.1728700e-01  -7.2182500e-01  -7.5685900e-01  -8.2953000e-01  -8.9843700e-01  -9.8111300e-01  -1.0862100e+00  -1.1982500e+00  -1.3164700e+00  -1.4813200e+00  -1.6024800e+00  -1.7266800e+00  -1.8958300e+00  -2.0321200e+00  -2.2103000e+00  -2.3906600e+00  -2.5693000e+00  -2.7069100e+00  -2.8813000e+00];
% 20101
ar1=-11.8681+[-4.2105700e-01   5.2984000e-01   6.8730600e-01   7.2265600e-01   7.3652300e-01   7.5844700e-01   7.7686900e-01   7.9771200e-01   8.3229900e-01   8.6564100e-01   8.9371000e-01   9.2170400e-01   9.3946800e-01   9.5681300e-01   9.8074000e-01   9.9876700e-01   1.0202300e+00   1.0407500e+00   1.0617100e+00   1.0770600e+00   1.0957300e+00];
ar2=447.151+[1.4900500e+00  -8.6712200e-01  -2.2930600e+00  -3.4711200e+00  -4.0880000e+00  -4.8903100e+00  -5.4642700e+00  -6.0400200e+00  -6.6728500e+00  -7.2628600e+00  -7.8155600e+00  -8.5030500e+00  -8.9624300e+00  -9.4034200e+00  -9.9670200e+00  -1.0395200e+01  -1.0926500e+01  -1.1436200e+01  -1.1918300e+01  -1.2276500e+01  -1.2717600e+01];
ar3=-698.575+[6.5302800e-02  -5.3801800e-01  -4.2823000e-01  -4.4745000e-01  -4.7942000e-01  -5.3645200e-01  -5.8646500e-01  -6.4411700e-01  -7.1449300e-01  -7.8800200e-01  -8.6502300e-01  -9.7130600e-01  -1.0492500e+00  -1.1290700e+00  -1.2366600e+00  -1.3229900e+00  -1.4354900e+00  -1.5487900e+00  -1.6605300e+00  -1.7464100e+00  -1.8548800e+00];
% 9037
as1=-7.50723+[-3.8446300e-01   8.9401300e-01   1.0966500e+00   1.1403000e+00   1.1582000e+00   1.1858000e+00   1.2074100e+00   1.2282400e+00   1.2640300e+00   1.2982400e+00   1.3262800e+00   1.3540300e+00   1.3713400e+00   1.3880700e+00   1.4116000e+00   1.4299400e+00   1.4520400e+00   1.4748000e+00   1.4964200e+00   1.5120900e+00   1.5314900e+00];
as2=444.719+[2.2354400e+00  -6.8887000e-01  -2.4959900e+00  -4.0399500e+00  -4.8643100e+00  -5.9398800e+00  -6.7090700e+00  -7.4764200e+00  -8.3155300e+00  -9.0931600e+00  -9.8171300e+00  -1.0713200e+01  -1.1307700e+01  -1.1875500e+01  -1.2599700e+01  -1.3147900e+01  -1.3825500e+01  -1.4474300e+01  -1.5083000e+01  -1.5533400e+01  -1.6086500e+01];
as3=-690.512+[5.8991400e-02  -1.0423800e+00  -1.0680000e+00  -1.2141700e+00  -1.3282300e+00  -1.5049900e+00  -1.6480700e+00  -1.8039600e+00  -1.9887300e+00  -2.1734300e+00  -2.3582400e+00  -2.6044500e+00  -2.7786400e+00  -2.9527900e+00  -3.1852000e+00  -3.3686600e+00  -3.6041800e+00  -3.8385100e+00  -4.0669300e+00  -4.2407400e+00  -4.4590300e+00];
% 21922
at1=-12.9198+[-4.7550300e-01   5.1700500e-01   6.8719100e-01   7.3310400e-01   7.5287700e-01   7.8278000e-01   8.0697400e-01   8.3353000e-01   8.7488900e-01   9.1466900e-01   9.4815600e-01   9.8111100e-01   1.0021300e+00   1.0228200e+00   1.0517900e+00   1.0736100e+00   1.0998700e+00   1.1249600e+00   1.1503900e+00   1.1690200e+00   1.1917300e+00];
at2=450.785+[1.6833300e+00  -9.3789300e-01  -2.5173400e+00  -3.8235700e+00  -4.5108900e+00  -5.4079500e+00  -6.0514600e+00  -6.6983700e+00  -7.4108200e+00  -8.0759200e+00  -8.6999700e+00  -9.4782800e+00  -9.9991000e+00  -1.0499600e+01  -1.1140500e+01  -1.1628100e+01  -1.2234100e+01  -1.2816400e+01  -1.3368100e+01  -1.3778500e+01  -1.4285100e+01];
at3=-694.998+[-1.5938200e-01  -4.7131200e-01  -2.1351300e-01  -1.1815200e-01  -9.0311900e-02  -7.0247500e-02  -6.6044900e-02  -7.0262000e-02  -8.3005100e-02  -1.0423700e-01  -1.3354800e-01  -1.8200200e-01  -2.2234600e-01  -2.6681500e-01  -3.2992500e-01  -3.8322500e-01  -4.5569400e-01  -5.3161100e-01  -6.0887600e-01  -6.6970700e-01  -7.4784200e-01];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4P
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 4457
au1=-9.37506+[3.3988300e-01   3.7537400e-01   4.2699600e-01   4.7355800e-01   5.1934600e-01   5.5804000e-01   6.2284800e-01   6.6535500e-01   6.9119800e-01   7.4912000e-01   7.7494900e-01   8.3176700e-01   8.5631700e-01   8.8444600e-01   9.2475900e-01   9.6660200e-01   1.0221500e+00   1.0467000e+00   1.0947900e+00   1.1259800e+00   1.1650900e+00];
au2=448.144+[1.9866000e+00   1.8345200e+00   1.4855600e+00   1.1152000e+00   6.9781500e-01   3.1558300e-01  -3.6639900e-01  -8.8280000e-01  -1.2115800e+00  -1.9988300e+00  -2.3649400e+00  -3.2475300e+00  -3.6569800e+00  -4.1475100e+00  -4.8790700e+00  -5.6272800e+00  -6.6257200e+00  -7.0724600e+00  -7.9578400e+00  -8.5453200e+00  -9.2960400e+00];
au3=-689.149+[-1.2875100e+00  -1.2756900e+00  -1.1937600e+00  -1.0948200e+00  -1.0000200e+00  -9.2621500e-01  -8.2394500e-01  -7.7651100e-01  -7.5291800e-01  -7.1780200e-01  -7.0663500e-01  -6.9356200e-01  -6.9284800e-01  -6.9636000e-01  -7.1240900e-01  -7.4490000e-01  -8.1534900e-01  -8.5528500e-01  -9.4796500e-01  -1.0186900e+00  -1.1188900e+00];
% 20101
av1=-11.8681+[1.6997400e-01   1.9295000e-01   2.2203600e-01   2.4622400e-01   2.7084300e-01   2.9331700e-01   3.3349400e-01   3.6205500e-01   3.8009700e-01   4.2345400e-01   4.4330900e-01   4.8691500e-01   5.0592200e-01   5.2761400e-01   5.5834900e-01   5.9089300e-01   6.3488200e-01   6.5450600e-01   6.9257800e-01   7.1733300e-01   7.4800600e-01];
av2=447.151+[1.2432900e+00   1.1675200e+00   9.9819600e-01   8.1347500e-01   5.9935400e-01   3.9610600e-01   3.8680800e-03  -3.1124100e-01  -5.1728400e-01  -1.0361500e+00  -1.2829700e+00  -1.8917500e+00  -2.1780700e+00  -2.5240700e+00  -3.0444900e+00  -3.5818000e+00  -4.3022400e+00  -4.6252800e+00  -5.2667200e+00  -5.6945600e+00  -6.2427900e+00];
av3=-698.575+[-8.9375500e-01  -8.8396400e-01  -8.2009800e-01  -7.3915700e-01  -6.6459600e-01  -6.0643800e-01  -5.2031600e-01  -4.8111300e-01  -4.6052900e-01  -4.2458500e-01  -4.1064800e-01  -3.8543500e-01  -3.7675400e-01  -3.6901000e-01  -3.6544000e-01  -3.7398300e-01  -4.0635400e-01  -4.2702500e-01  -4.7770300e-01  -5.1776200e-01  -5.7578700e-01];
% 9037
aw1=-7.50723+[4.1513500e-01   4.5127900e-01   5.0377600e-01   5.5027900e-01   5.9544400e-01   6.3340400e-01   6.9602300e-01   7.3759100e-01   7.6285200e-01   8.1898900e-01   8.4386700e-01   8.9861300e-01   9.2231200e-01   9.4945300e-01   9.8796600e-01   1.0268200e+00   1.0767000e+00   1.0983100e+00   1.1400800e+00   1.1667900e+00   1.2000100e+00];
aw2=444.719+[1.9912800e+00   1.8523600e+00   1.5321400e+00   1.1918600e+00   8.0710200e-01   4.5412000e-01  -1.7868500e-01  -6.5978500e-01  -9.6628500e-01  -1.7022400e+00  -2.0446300e+00  -2.8703800e+00  -3.2531900e+00  -3.7116300e+00  -4.3952100e+00  -5.0945200e+00  -6.0271900e+00  -6.4440400e+00  -7.2694600e+00  -7.8166500e+00  -8.5151700e+00];
aw3=-690.512+[-1.1941100e+00  -1.2149100e+00  -1.2030200e+00  -1.1748500e+00  -1.1531900e+00  -1.1417400e+00  -1.1391500e+00  -1.1582100e+00  -1.1749500e+00  -1.2288800e+00  -1.2571900e+00  -1.3342700e+00  -1.3738100e+00  -1.4243100e+00  -1.5081400e+00  -1.6075300e+00  -1.7646800e+00  -1.8426400e+00  -2.0090600e+00  -2.1274600e+00  -2.2872200e+00];
% 21922
ax1=-12.9198+[1.3890300e-01   1.6262100e-01   1.9254100e-01   2.1871800e-01   2.4548800e-01   2.6997000e-01   3.1383500e-01   3.4335000e-01   3.6189600e-01   4.0688800e-01   4.2761900e-01   4.7301400e-01   4.9268700e-01   5.1520300e-01   5.4780900e-01   5.8372700e-01   6.3391600e-01   6.5670900e-01   7.0156400e-01   7.3112200e-01   7.6818000e-01];
ax2=450.785+[1.4125100e+00   1.3225300e+00   1.1112300e+00   8.7798500e-01   6.1430100e-01   3.6868800e-01  -9.5385800e-02  -4.5848700e-01  -6.9428300e-01  -1.2823500e+00  -1.5613200e+00  -2.2474800e+00  -2.5698500e+00  -2.9592100e+00  -3.5441300e+00  -4.1472600e+00  -4.9566800e+00  -5.3200700e+00  -6.0420600e+00  -6.5239000e+00  -7.1416200e+00];
ax3=-694.998+[-1.0848600e+00  -1.0587400e+00  -9.4788300e-01  -8.1393400e-01  -6.8681700e-01  -5.8494300e-01  -4.2697700e-01  -3.4176200e-01  -2.9327900e-01  -1.9406500e-01  -1.5149900e-01  -5.9409000e-02  -2.0517300e-02   2.2811600e-02   7.8049100e-02   1.2088700e-01   1.5574600e-01   1.6468100e-01   1.7145100e-01   1.6868000e-01   1.5719300e-01];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4P
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 4457
ay1=-9.37506+[-4.4025400e-01   2.9440900e-01   5.1655100e-01   8.1081100e-01   9.3166500e-01   1.0287000e+00   1.0857200e+00   1.1280600e+00   1.1710500e+00   1.1914600e+00   1.2287800e+00   1.2600300e+00   1.2844200e+00   1.3125100e+00   1.3419700e+00   1.3659900e+00   1.3935300e+00   1.4204000e+00   1.4522200e+00   1.4714900e+00   1.4918100e+00];
ay2=448.144+[2.2728400e+00   5.4473400e-01  -4.6379200e-01  -2.2419500e+00  -3.4419800e+00  -4.7105700e+00  -5.7713700e+00  -6.8622800e+00  -8.3022000e+00  -8.8357600e+00  -9.7374000e+00  -1.0508700e+01  -1.1160200e+01  -1.1959200e+01  -1.2797700e+01  -1.3448200e+01  -1.4194600e+01  -1.4899000e+01  -1.5759300e+01  -1.6268300e+01  -1.6801300e+01];
ay3=-689.149+[-1.2469200e-01  -1.0748800e+00  -8.9589800e-01  -7.2709500e-01  -6.9785700e-01  -7.1910400e-01  -7.7386500e-01  -8.5813900e-01  -1.0060700e+00  -1.0711100e+00  -1.1934600e+00  -1.3116300e+00  -1.4210900e+00  -1.5682300e+00  -1.7372500e+00  -1.8777300e+00  -2.0490100e+00  -2.2198700e+00  -2.4418500e+00  -2.5796600e+00  -2.7282700e+00];
% 20101
az1=-11.8681+[-4.2103300e-01   1.1097100e-01   2.7613500e-01   5.0119600e-01   5.9206900e-01   6.6467200e-01   7.0604600e-01   7.3713600e-01   7.7111600e-01   7.8788300e-01   8.1910400e-01   8.4508100e-01   8.6527600e-01   8.8872500e-01   9.1326600e-01   9.3264800e-01   9.5463200e-01   9.7461900e-01   9.9991500e-01   1.0155000e+00   1.0316800e+00];
az2=447.151+[1.4902400e+00   2.5045900e-01  -4.7474700e-01  -1.7954900e+00  -2.6870000e+00  -3.6189600e+00  -4.3873100e+00  -5.1700300e+00  -6.1960000e+00  -6.5760600e+00  -7.2201900e+00  -7.7714500e+00  -8.2382100e+00  -8.8126900e+00  -9.4177100e+00  -9.8873300e+00  -1.0427400e+01  -1.0935700e+01  -1.1560300e+01  -1.1931000e+01  -1.2319100e+01];
az3=-698.575+[6.4117900e-02  -7.4680100e-01  -5.8936300e-01  -4.4309500e-01  -4.1935500e-01  -4.3661700e-01  -4.7873900e-01  -5.3996600e-01  -6.4198400e-01  -6.8517200e-01  -7.6485800e-01  -8.4059100e-01  -9.1032600e-01  -1.0040800e+00  -1.1118200e+00  -1.2008700e+00  -1.3091000e+00  -1.4165700e+00  -1.5555400e+00  -1.6415700e+00  -1.7340100e+00];
% 9037
ba1=-7.50723+[-3.8442200e-01   3.6657300e-01   5.9141700e-01   8.8092300e-01   9.9584300e-01   1.0861200e+00   1.1360400e+00   1.1702100e+00   1.2016200e+00   1.2176200e+00   1.2481800e+00   1.2738900e+00   1.2936600e+00   1.3161300e+00   1.3397800e+00   1.3592100e+00   1.3815400e+00   1.4036500e+00   1.4295600e+00   1.4453300e+00   1.4619600e+00];
ba2=444.719+[2.2354000e+00   6.1337300e-01  -3.4242600e-01  -2.0384100e+00  -3.1835600e+00  -4.3901400e+00  -5.3957500e+00  -6.4261200e+00  -7.7800300e+00  -8.2799600e+00  -9.1223800e+00  -9.8408300e+00  -1.0446300e+01  -1.1187200e+01  -1.1962900e+01  -1.2563200e+01  -1.3250500e+01  -1.3897400e+01  -1.4685800e+01  -1.5151300e+01  -1.5637600e+01];
ba3=-690.512+[5.7604800e-02  -1.1445900e+00  -1.0792000e+00  -1.0792300e+00  -1.1548900e+00  -1.2859400e+00  -1.4327900e+00  -1.6120800e+00  -1.8852500e+00  -1.9963800e+00  -2.1957600e+00  -2.3790200e+00  -2.5426500e+00  -2.7551800e+00  -2.9914500e+00  -3.1833000e+00  -3.4125000e+00  -3.6370800e+00  -3.9232600e+00  -4.0983100e+00  -4.2854700e+00];
% 21922
bb1=-12.9198+[-4.7547600e-01   8.1520100e-02   2.5343400e-01   4.9460100e-01   5.9477500e-01   6.7599100e-01   7.2495900e-01   7.6409000e-01   8.0889500e-01   8.2991600e-01   8.6764100e-01   8.9888900e-01   9.2341300e-01   9.5210700e-01   9.8223500e-01   1.0061500e+00   1.0333000e+00   1.0580900e+00   1.0895000e+00   1.1087100e+00   1.1287100e+00];
bb2=450.785+[1.6834100e+00   2.8822500e-01  -5.3195600e-01  -1.9971600e+00  -2.9819100e+00  -4.0146900e+00  -4.8694100e+00  -5.7435300e+00  -6.8946600e+00  -7.3222200e+00  -8.0482300e+00  -8.6707300e+00  -9.1986300e+00  -9.8492700e+00  -1.0535500e+01  -1.1069000e+01  -1.1683600e+01  -1.2263100e+01  -1.2976400e+01  -1.3400500e+01  -1.3845500e+01];
bb3=-694.998+[-1.6044100e-01  -7.9437900e-01  -5.3830500e-01  -2.5021300e-01  -1.4093100e-01  -7.0665100e-02  -4.1306500e-02  -3.0288400e-02  -3.8768800e-02  -4.7944900e-02  -7.1095400e-02  -9.9598500e-02  -1.3018500e-01  -1.7687400e-01  -2.3642700e-01  -2.8888900e-01  -3.5599200e-01  -4.2567400e-01  -5.1954200e-01  -5.7947400e-01  -6.4496900e-01];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 4457
bc1=-9.37506+[4.0951700e-01   4.3116700e-01   4.6460800e-01   4.9578700e-01   5.2870100e-01   5.6232000e-01   5.9800000e-01   6.3039300e-01   6.6133200e-01   6.9313000e-01   7.2563700e-01   7.5810400e-01   7.9621500e-01   8.2310700e-01   8.4749200e-01   8.7949100e-01   9.1053600e-01   9.4754700e-01   9.8468800e-01   1.0260100e+00   1.0515900e+00];
bc2=448.144+[2.2612600e+00   2.1660800e+00   1.9390000e+00   1.6921800e+00   1.3983500e+00   1.0811700e+00   7.3987000e-01   3.6942400e-01  -2.6722400e-02  -4.3596500e-01  -8.6006500e-01  -1.3023800e+00  -1.8469100e+00  -2.2561100e+00  -2.6360900e+00  -3.1532700e+00  -3.6721900e+00  -4.2843200e+00  -4.8830700e+00  -5.5408700e+00  -5.9463000e+00];
bc3=-689.149+[-8.5921900e-01  -8.5333300e-01  -7.9950400e-01  -7.2879200e-01  -6.4385200e-01  -5.6515200e-01  -4.8936000e-01  -4.2132000e-01  -3.6134400e-01  -3.1426100e-01  -2.7738700e-01  -2.4748300e-01  -2.1838800e-01  -2.0220700e-01  -1.9031400e-01  -1.7980800e-01  -1.7484900e-01  -1.7743700e-01  -1.8946500e-01  -2.1317800e-01  -2.3292200e-01];
% 20101
bd1=-11.8681+[2.4412800e-01   2.5791600e-01   2.7578400e-01   2.9077600e-01   3.0614200e-01   3.2242600e-01   3.4057000e-01   3.5760500e-01   3.7559600e-01   3.9516200e-01   4.1566000e-01   4.3708500e-01   4.6309300e-01   4.8195500e-01   4.9909600e-01   5.2155300e-01   5.4355600e-01   5.7085700e-01   5.9832300e-01   6.2934200e-01   6.4887000e-01];
bd2=447.151+[1.4800000e+00   1.4385000e+00   1.3430400e+00   1.2327900e+00   1.0980000e+00   9.4749500e-01   7.7287300e-01   5.7100600e-01   3.4700700e-01   1.0905800e-01  -1.4789400e-01  -4.2607600e-01  -7.7778400e-01  -1.0494700e+00  -1.3043700e+00  -1.6564700e+00  -2.0153100e+00  -2.4431000e+00  -2.8656400e+00  -3.3334600e+00  -3.6236500e+00];
bd3=-698.575+[-6.3160100e-01  -6.2721900e-01  -5.8741600e-01  -5.3112000e-01  -4.6293200e-01  -4.0348000e-01  -3.4311200e-01  -2.8838400e-01  -2.3870700e-01  -1.9973500e-01  -1.6752600e-01  -1.3897800e-01  -1.0792600e-01  -8.7923200e-02  -7.1222900e-02  -5.2229200e-02  -3.6784000e-02  -2.4496000e-02  -1.9558100e-02  -2.1592400e-02  -2.6538600e-02];
% 9037
be1=-7.50723+[4.8159700e-01   5.0348700e-01   5.3722500e-01   5.6848900e-01   6.0126100e-01   6.3410100e-01   6.6837500e-01   7.0063200e-01   7.3182200e-01   7.6344100e-01   7.9549500e-01   8.2739100e-01   8.6474200e-01   8.9113700e-01   9.1507600e-01   9.4660100e-01   9.7712500e-01   1.0131600e+00   1.0486500e+00   1.0875700e+00   1.1113400e+00];
be2=444.719+[2.2426500e+00   2.1562200e+00   1.9485900e+00   1.7223500e+00   1.4529200e+00   1.1607400e+00   8.4530000e-01   5.0275900e-01   1.3625300e-01  -2.4317600e-01  -6.3726100e-01  -1.0489500e+00  -1.5558900e+00  -1.9372000e+00  -2.2911600e+00  -2.7729200e+00  -3.2563600e+00  -3.8264200e+00  -4.3840500e+00  -4.9966400e+00  -5.3741700e+00];
be3=-690.512+[-7.0677700e-01  -7.2370400e-01  -7.2053700e-01  -7.0188800e-01  -6.7630400e-01  -6.5634200e-01  -6.3930200e-01  -6.3009400e-01  -6.2936000e-01  -6.3974500e-01  -6.5862000e-01  -6.8345900e-01  -7.1876200e-01  -7.4845400e-01  -7.7803100e-01  -8.2194800e-01  -8.6952200e-01  -9.3232300e-01  -1.0014600e+00  -1.0859300e+00  -1.1422000e+00];
% 21922
bf1=-12.9198+[2.1334200e-01   2.2764900e-01   2.4625900e-01   2.6247500e-01   2.7925500e-01   2.9806700e-01   3.1954500e-01   3.3762900e-01   3.5596800e-01   3.7621600e-01   3.9749600e-01   4.1975300e-01   4.4658800e-01   4.6589900e-01   4.8339900e-01   5.0629100e-01   5.2885400e-01   5.5743500e-01   5.8682500e-01   6.2074800e-01   6.4244200e-01];
bf2=450.785+[1.6817900e+00   1.6321700e+00   1.5098900e+00   1.3670100e+00   1.1922300e+00   1.0045900e+00   7.9145900e-01   5.4879700e-01   2.8253800e-01   4.6729200e-03  -2.9175900e-01  -6.1033800e-01  -1.0117200e+00  -1.3205100e+00  -1.6099000e+00  -2.0087100e+00  -2.4143500e+00  -2.8975000e+00  -3.3740900e+00  -3.9012300e+00  -4.2280400e+00];
bf3=-694.998+[-8.5956700e-01  -8.4558300e-01  -7.7478500e-01  -6.8149400e-01  -5.6903700e-01  -4.6913600e-01  -3.6758400e-01  -2.7093800e-01  -1.7909200e-01  -1.0106900e-01  -3.1040900e-02   3.5355600e-02   1.1178300e-01   1.6485200e-01   2.1170400e-01   2.7067800e-01   3.2525800e-01   3.8277100e-01   4.3080400e-01   4.7493700e-01   4.9790600e-01];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4P
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 4457
bg1=-9.37506+[-3.0019200e-01   1.1960400e-01   5.4596600e-01   7.1595700e-01   8.7761200e-01   9.5872400e-01   1.0813100e+00   1.1310000e+00   1.2341400e+00   1.2481200e+00   1.3079000e+00   1.3425600e+00   1.3743200e+00   1.4121800e+00   1.4420100e+00   1.4729600e+00   1.4997000e+00   1.5321100e+00   1.5623000e+00   1.5997100e+00   1.6123400e+00];
bg2=448.144+[2.4402900e+00   1.7014100e+00   1.3256800e-01  -8.0070300e-01  -2.2374400e+00  -3.1987900e+00  -4.8549800e+00  -5.5610800e+00  -7.1621400e+00  -7.3904300e+00  -8.4841300e+00  -9.2057600e+00  -9.9048200e+00  -1.0762000e+01  -1.1471300e+01  -1.2243400e+01  -1.2938200e+01  -1.3754600e+01  -1.4487900e+01  -1.5388900e+01  -1.5691600e+01];
bg3=-689.149+[-6.9515600e-01  -8.1467000e-01  -4.6569000e-01  -3.4604100e-01  -2.4147800e-01  -2.1414600e-01  -2.3516300e-01  -2.6412400e-01  -3.7419600e-01  -3.9432200e-01  -5.0765100e-01  -5.9574400e-01  -6.9071900e-01  -8.2037200e-01  -9.3869600e-01  -1.0788800e+00  -1.2152500e+00  -1.3883200e+00  -1.5545900e+00  -1.7732000e+00  -1.8497000e+00];
% 20101
bh1=-11.8681+[-2.9902300e-01   9.3914100e-04   3.1455800e-01   4.4348000e-01   5.6594600e-01   6.2554200e-01   7.1602100e-01   7.5316700e-01   8.3148000e-01   8.4214300e-01   8.8801200e-01   9.1465000e-01   9.3869200e-01   9.6705200e-01   9.8992500e-01   1.0141300e+00   1.0354900e+00   1.0617300e+00   1.0857700e+00   1.1155500e+00   1.1253700e+00];
bh2=447.151+[1.7507100e+00   1.1475700e+00   4.7550300e-02  -6.3627300e-01  -1.7091600e+00  -2.4263100e+00  -3.6413700e+00  -4.1520900e+00  -5.3034200e+00  -5.4674600e+00  -6.2535100e+00  -6.7726700e+00  -7.2756100e+00  -7.8930100e+00  -8.4047500e+00  -8.9631100e+00  -9.4665100e+00  -1.0059000e+01  -1.0591200e+01  -1.1246100e+01  -1.1465600e+01];
bh3=-698.575+[-5.5128000e-01  -6.3615800e-01  -3.2655700e-01  -2.2338200e-01  -1.3541200e-01  -1.1301800e-01  -1.2741100e-01  -1.4656100e-01  -2.1866500e-01  -2.3171800e-01  -3.0511400e-01  -3.6175100e-01  -4.2250500e-01  -5.0500200e-01  -5.8008300e-01  -6.6867800e-01  -7.5436600e-01  -8.6276900e-01  -9.6681200e-01  -1.1033200e+00  -1.1508600e+00];
% 9037
bi1=-7.50723+[-2.4777100e-01   1.8275700e-01   6.1633800e-01   7.8588200e-01   9.4611300e-01   1.0252900e+00   1.1397900e+00   1.1849400e+00   1.2769100e+00   1.2892200e+00   1.3410800e+00   1.3705600e+00   1.3972200e+00   1.4286900e+00   1.4532000e+00   1.4783200e+00   1.4998100e+00   1.5260500e+00   1.5507800e+00   1.5814800e+00   1.5918800e+00];
bi2=444.719+[2.4035900e+00   1.7020700e+00   2.1644500e-01  -6.7371800e-01  -2.0460900e+00  -2.9631600e+00  -4.5387200e+00  -5.2079700e+00  -6.7197200e+00  -6.9347000e+00  -7.9625000e+00  -8.6388600e+00  -9.2926700e+00  -1.0092500e+01  -1.0752800e+01  -1.1470000e+01  -1.2113900e+01  -1.2868500e+01  -1.3544500e+01  -1.4372900e+01  -1.4650500e+01];
bi3=-690.512+[-5.2198300e-01  -7.2790000e-01  -5.7194100e-01  -5.4633300e-01  -5.7139700e-01  -6.2743900e-01  -7.9289400e-01  -8.8404100e-01  -1.1347900e+00  -1.1747800e+00  -1.3823400e+00  -1.5316000e+00  -1.6852200e+00  -1.8858600e+00  -2.0620200e+00  -2.2642300e+00  -2.4557000e+00  -2.6926400e+00  -2.9153200e+00  -3.2019700e+00  -3.3010800e+00];
% 21922
bk1=-12.9198+[-3.4854100e-01  -3.3713200e-02   2.9282800e-01   4.2919900e-01   5.5872500e-01   6.2289800e-01   7.2474100e-01   7.6735700e-01   8.5849800e-01   8.7103200e-01   9.2543000e-01   9.5745100e-01   9.8666800e-01   1.0214900e+00   1.0497700e+00   1.0799700e+00   1.1067100e+00   1.1393300e+00   1.1691700e+00   1.2060500e+00   1.2182500e+00];
bk2=450.785+[1.9490300e+00   1.2976200e+00   4.6916400e-02  -7.1430500e-01  -1.9016800e+00  -2.6945100e+00  -4.0425000e+00  -4.6113100e+00  -5.8984400e+00  -6.0822300e+00  -6.9644300e+00  -7.5482800e+00  -8.1147100e+00  -8.8111000e+00  -9.3891500e+00  -1.0020800e+01  -1.0591200e+01  -1.1263800e+01  -1.1869000e+01  -1.2615400e+01  -1.2866100e+01];
bk3=-694.998+[-7.8074900e-01  -8.0643100e-01  -3.3184900e-01  -1.4922000e-01   4.9091300e-02   1.4077600e-01   2.4249100e-01   2.7174400e-01   3.0727300e-01   3.0925800e-01   3.0683100e-01   2.9595100e-01   2.7865100e-01   2.4833800e-01   2.1545100e-01   1.7185700e-01   1.2584300e-01   6.3065700e-02  -1.0109000e-03  -8.9614100e-02  -1.2135000e-01];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')