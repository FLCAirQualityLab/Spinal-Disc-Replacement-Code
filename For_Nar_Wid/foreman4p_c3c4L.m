%% foreman height and width narrowing/widening 

% 4P!!
clear,clc
% for all models for the c3-c4 left hand side foreman under lateral bending (_n)
% 1297,16439,17116,14886

% Values for displacements have not been replaced. base coordinates have,
% but need checking. 
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 1297,16439,17116,14886
%% model15_intact_TLC_4P
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 1297
aa1=12.7746+[4.8745400e-01   7.1098000e-01   7.5894800e-01   7.8284700e-01   8.1055700e-01   8.6466900e-01   9.1772700e-01   9.5442400e-01   9.9266900e-01   1.0533800e+00   1.0750300e+00   1.1117600e+00   1.1430000e+00   1.1758400e+00   1.2010300e+00   1.2321200e+00   1.2582700e+00   1.2844500e+00   1.3094200e+00   1.3346200e+00   1.3540300e+00];
aa2=447.736+[1.5391800e+00   7.3117100e-02  -1.2879900e+00  -2.8774300e+00  -3.7581100e+00  -4.7082600e+00  -5.5177600e+00  -6.0889300e+00  -6.7514400e+00  -7.9321600e+00  -8.3829100e+00  -9.1527000e+00  -9.8147600e+00  -1.0525100e+01  -1.1091100e+01  -1.1786300e+01  -1.2376900e+01  -1.2996800e+01  -1.3598900e+01  -1.4229800e+01  -1.4714500e+01];
aa3=-690.116+[-1.1235400e+00  -1.0984800e+00  -1.0501600e+00  -1.0737400e+00  -1.1327100e+00  -1.2257600e+00  -1.3227900e+00  -1.3997200e+00  -1.4969100e+00  -1.6886600e+00  -1.7687100e+00  -1.9157100e+00  -2.0516100e+00  -2.2070600e+00  -2.3379800e+00  -2.5066500e+00  -2.6570300e+00  -2.8215900e+00  -2.9886000e+00  -3.1710600e+00  -3.3167800e+00];

% 16439
ab1=13.5613+[3.1910900e-01   4.8314600e-01   5.1638700e-01   5.2423200e-01   5.3838400e-01   5.7426200e-01   6.1039900e-01   6.3565800e-01   6.6204300e-01   7.0443000e-01   7.2006200e-01   7.4642700e-01   7.6849600e-01   7.9165700e-01   8.1024400e-01   8.3399100e-01   8.5463100e-01   8.7550300e-01   8.9527600e-01   9.1535900e-01   9.3026600e-01];
ab2=447.206+[1.0864800e+00   1.3108300e-02  -1.0086100e+00  -2.1850400e+00  -2.8240000e+00  -3.5050800e+00  -4.0815900e+00  -4.4876900e+00  -4.9591500e+00  -5.7980100e+00  -6.1183100e+00  -6.6657300e+00  -7.1362200e+00  -7.6424300e+00  -8.0467800e+00  -8.5437100e+00  -8.9666100e+00  -9.4116800e+00  -9.8452000e+00  -1.0300200e+01  -1.0650100e+01];
ab3=-699.132+[-9.9227400e-01  -9.9231100e-01  -9.5391000e-01  -9.7265800e-01  -1.0186800e+00  -1.0896000e+00  -1.1605400e+00  -1.2150100e+00  -1.2825500e+00  -1.4119200e+00  -1.4648700e+00  -1.5614200e+00  -1.6496300e+00  -1.7500100e+00  -1.8341100e+00  -1.9418500e+00  -2.0371800e+00  -2.1410000e+00  -2.2461400e+00  -2.3605600e+00  -2.4513100e+00];

% 17116
ac1=16.2684+[3.1756800e-01   4.9194000e-01   5.3138400e-01   5.4645000e-01   5.6556600e-01   6.0759700e-01   6.4963100e-01   6.7925800e-01   7.1052300e-01   7.6050600e-01   7.7871300e-01   8.0945400e-01   8.3528100e-01   8.6262600e-01   8.8443000e-01   9.1170300e-01   9.3518400e-01   9.5899600e-01   9.8161300e-01   1.0046100e+00   1.0217400e+00];
ac2=443.597+[1.2257500e+00   5.9939800e-02  -1.0529300e+00  -2.3371100e+00  -3.0367100e+00  -3.7847400e+00  -4.4197700e+00  -4.8681100e+00  -5.3893800e+00  -6.3190800e+00  -6.6747300e+00  -7.2832500e+00  -7.8071000e+00  -8.3715400e+00  -8.8228900e+00  -9.3783600e+00  -9.8517300e+00  -1.0350600e+01  -1.0837100e+01  -1.1348500e+01  -1.1742200e+01];
ac3=-706.266+[-1.1326600e+00  -1.0465100e+00  -9.2502300e-01  -8.5207800e-01  -8.5020900e-01  -8.7110300e-01  -9.0063000e-01  -9.2631500e-01  -9.6076000e-01  -1.0315700e+00  -1.0623800e+00  -1.1218600e+00  -1.1789000e+00  -1.2466500e+00  -1.3052500e+00  -1.3820200e+00  -1.4515400e+00  -1.5288000e+00  -1.6087400e+00  -1.6973800e+00  -1.7688100e+00];

% 14886
ad1=9.91704+[5.2208400e-01   7.4051400e-01   7.8165000e-01   7.9675600e-01   8.1873800e-01   8.6618600e-01   9.1289300e-01   9.4484100e-01   9.7771800e-01   1.0296100e+00   1.0481100e+00   1.0794700e+00   1.1060300e+00   1.1336900e+00   1.1548300e+00   1.1813200e+00   1.2036800e+00   1.2259200e+00   1.2470900e+00   1.2683500e+00   1.2848100e+00];
ad2=444.847+[1.4321600e+00   3.5929300e-02  -1.2518800e+00  -2.7480100e+00  -3.5722700e+00  -4.4582400e+00  -5.2101200e+00  -5.7389900e+00  -6.3512400e+00  -7.4392200e+00  -7.8536000e+00  -8.5601100e+00  -9.1663100e+00  -9.8152600e+00  -1.0331400e+01  -1.0964200e+01  -1.1500500e+01  -1.2062400e+01  -1.2607000e+01  -1.3176600e+01  -1.3613600e+01];
ad3=-691.954+[-1.0061900e+00  -1.0882900e+00  -1.1415000e+00  -1.2829500e+00  -1.4072900e+00  -1.5702900e+00  -1.7262500e+00  -1.8444100e+00  -1.9889900e+00  -2.2642800e+00  -2.3757000e+00  -2.5752100e+00  -2.7553100e+00  -2.9570300e+00  -3.1240000e+00  -3.3363700e+00  -3.5231600e+00  -3.7251500e+00  -3.9275400e+00  -4.1460800e+00  -4.3187800e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4P
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 1297
ae1=12.7746+[-3.0399900e-01  -7.5432800e-02   1.7124100e-01   3.3555600e-01   5.2012900e-01   6.3608500e-01   7.7414600e-01   8.5146400e-01   9.4529300e-01   9.8050100e-01   1.0412500e+00   1.0877300e+00   1.1378700e+00   1.1779500e+00   1.2141700e+00   1.2486200e+00   1.2814300e+00   1.3132300e+00   1.3442100e+00   1.3691800e+00   1.3877200e+00];
ae2=447.736+[2.4876100e+00   2.1333200e+00   1.3031900e+00   4.9049400e-01  -5.7909700e-01  -1.4160800e+00  -2.6571900e+00  -3.5536400e+00  -4.7884000e+00  -5.3235600e+00  -6.3504600e+00  -7.1985900e+00  -8.1879000e+00  -9.0433100e+00  -9.8663000e+00  -1.0717000e+01  -1.1562600e+01  -1.2396300e+01  -1.3214300e+01  -1.3908100e+01  -1.4435000e+01];
ae3=-690.116+[-1.1890200e+00  -1.5441500e+00  -1.5052000e+00  -1.4714800e+00  -1.4512800e+00  -1.4558700e+00  -1.4803200e+00  -1.5233000e+00  -1.6160100e+00  -1.6648600e+00  -1.7750100e+00  -1.8830100e+00  -2.0256600e+00  -2.1643200e+00  -2.3107800e+00  -2.4767200e+00  -2.6571400e+00  -2.8495800e+00  -3.0519100e+00  -3.2332900e+00  -3.3768400e+00];

% 16439
af1=13.5613+[-3.2124000e-01  -1.6303500e-01   9.5905500e-03   1.2867600e-01   2.6335500e-01   3.5166800e-01   4.5728400e-01   5.1578700e-01   5.8926400e-01   6.1745500e-01   6.6707100e-01   7.0612100e-01   7.4866500e-01   7.8295100e-01   8.1405200e-01   8.4366300e-01   8.7116700e-01   8.9720900e-01   9.2195500e-01   9.4280400e-01   9.5828000e-01];
af2=447.206+[1.8134300e+00   1.5675100e+00   1.0730500e+00   5.3485000e-01  -2.0687900e-01  -8.1640000e-01  -1.7312100e+00  -2.3881000e+00  -3.2941900e+00  -3.6872700e+00  -4.4433000e+00  -5.0697900e+00  -5.8015400e+00  -6.4366600e+00  -7.0502600e+00  -7.6856200e+00  -8.3182700e+00  -8.9429600e+00  -9.5560900e+00  -1.0077200e+01  -1.0473200e+01];
af3=-699.132+[-9.0469200e-01  -1.2342900e+00  -1.2170400e+00  -1.1938300e+00  -1.1754100e+00  -1.1748000e+00  -1.1828300e+00  -1.2079200e+00  -1.2667800e+00  -1.2972900e+00  -1.3663000e+00  -1.4340400e+00  -1.5220700e+00  -1.6077600e+00  -1.6992800e+00  -1.8037200e+00  -1.9180700e+00  -2.0404300e+00  -2.1687900e+00  -2.2841400e+00  -2.3753500e+00];

% 17116
ag1=16.2684+[-3.4470400e-01  -1.8110600e-01  -2.8080000e-03   1.1983000e-01   2.6099400e-01   3.5344800e-01   4.6249400e-01   5.2369400e-01   6.0257900e-01   6.3333500e-01   6.8845300e-01   7.3267800e-01   7.8096500e-01   8.2027700e-01   8.5633700e-01   8.9105400e-01   9.2361100e-01   9.5458600e-01   9.8411400e-01   1.0088400e+00   1.0271300e+00];
ag2=449.981+[1.9898500e+00   1.7346400e+00   1.1772800e+00   5.8534500e-01  -2.2589300e-01  -8.8573500e-01  -1.8753800e+00  -2.5890300e+00  -3.5769800e+00  -4.0067400e+00  -4.8346800e+00  -5.5221100e+00  -6.3263300e+00  -7.0254300e+00  -7.7017500e+00  -8.4030300e+00  -9.1022500e+00  -9.7937000e+00  -1.0473500e+01  -1.1052000e+01  -1.1492200e+01];
ag3=-696.273+[-1.0629800e+00  -1.3878200e+00  -1.3086600e+00  -1.2338100e+00  -1.1533300e+00  -1.1091600e+00  -1.0527300e+00  -1.0311700e+00  -1.0271200e+00  -1.0306700e+00  -1.0491200e+00  -1.0763400e+00  -1.1180000e+00  -1.1645800e+00  -1.2194700e+00  -1.2870200e+00  -1.3657300e+00  -1.4539300e+00  -1.5497000e+00  -1.6380400e+00  -1.7091300e+00];

% 14886
ah1=9.91704+[-2.6361700e-01  -3.2390600e-02   2.1627200e-01   3.8010000e-01   5.6064100e-01   6.7308300e-01   8.0776900e-01   8.8186500e-01   9.6914200e-01   1.0011100e+00   1.0549100e+00   1.0949800e+00   1.1378300e+00   1.1714800e+00   1.2014600e+00   1.2294700e+00   1.2559600e+00   1.2816300e+00   1.3067400e+00   1.3268400e+00   1.3417900e+00];
ah2=448.847+[2.3816500e+00   2.0363900e+00   1.2556700e+00   4.8951100e-01  -5.1738800e-01  -1.3071800e+00  -2.4780000e+00  -3.3198200e+00  -4.4739800e+00  -4.9725000e+00  -5.9265900e+00  -6.7121800e+00  -7.6263900e+00  -8.4150300e+00  -9.1721800e+00  -9.9532600e+00  -1.0728200e+01  -1.1490800e+01  -1.2237500e+01  -1.2869600e+01  -1.3348900e+01];
ah3=-691.954+[-1.0819800e+00  -1.4561000e+00  -1.5006100e+00  -1.5377100e+00  -1.6026100e+00  -1.6670700e+00  -1.7781600e+00  -1.8838800e+00  -2.0614200e+00  -2.1465800e+00  -2.3249400e+00  -2.4877400e+00  -2.6929800e+00  -2.8841900e+00  -3.0798400e+00  -3.2951900e+00  -3.5232000e+00  -3.7611000e+00  -4.0067200e+00  -4.2237200e+00  -4.3937200e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4P
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 1297
ai1=12.7746+[-1.7128900e-01  -8.8164100e-02   4.5072000e-03   8.9306500e-02   1.3015900e-01   1.8703300e-01   2.3213600e-01   2.7457000e-01   3.0187500e-01   3.1464600e-01   3.2275100e-01   3.1708800e-01   3.0058400e-01   2.6934100e-01   2.3010100e-01   1.7768100e-01   1.1919200e-01   5.1150900e-02  -3.0405800e-02  -1.0882200e-01  -2.0216700e-01];
ai2=447.736+[2.9455100e+00   2.9427700e+00   3.1435200e+00   3.4350500e+00   3.6115000e+00   3.9439200e+00   4.3446900e+00   4.9048300e+00   5.4995400e+00   5.9943200e+00   6.7456400e+00   7.4790400e+00   8.2577000e+00   9.1807600e+00   1.0063100e+01   1.1055400e+01   1.1992300e+01   1.2981100e+01   1.4046300e+01   1.4961500e+01   1.5978700e+01];
ai3=-690.116+[-1.4399000e+00  -1.6152200e+00  -1.7285100e+00  -1.8271600e+00  -1.8794400e+00  -1.9706400e+00  -2.0740100e+00  -2.2126500e+00  -2.3563800e+00  -2.4769300e+00  -2.6510600e+00  -2.7835500e+00  -2.9169900e+00  -3.0924700e+00  -3.2854000e+00  -3.5292100e+00  -3.7893600e+00  -4.0964600e+00  -4.4690100e+00  -4.8184500e+00  -5.2368300e+00];

% 16439
aj1=13.5613+[-2.2044400e-01  -1.6093200e-01  -9.1282300e-02  -2.6503500e-02   6.4047400e-03   5.6218300e-02   9.9823100e-02   1.4096200e-01   1.6905500e-01   1.8627100e-01   2.0360800e-01   2.0746200e-01   2.0321700e-01   1.9024500e-01   1.7006900e-01   1.4048700e-01   1.0417700e-01   5.8919900e-02   2.3127700e-04  -5.6368500e-02  -1.2613700e-01];
aj2=447.206+[2.1526800e+00   2.0836400e+00   2.1232800e+00   2.2403500e+00   2.3242400e+00   2.5024700e+00   2.7398600e+00   3.1042800e+00   3.5084500e+00   3.8468400e+00   4.3532000e+00   4.8300500e+00   5.3338500e+00   5.9338100e+00   6.5100800e+00   7.1646300e+00   7.7915400e+00   8.4618200e+00   9.2007100e+00   9.8512400e+00   1.0586300e+01];
aj3=-699.132+[-1.1264800e+00  -1.2958400e+00  -1.4034000e+00  -1.4939000e+00  -1.5402900e+00  -1.6179900e+00  -1.6982100e+00  -1.7976300e+00  -1.8971300e+00  -1.9758600e+00  -2.0744200e+00  -2.1187300e+00  -2.1471500e+00  -2.1825400e+00  -2.2245100e+00  -2.2821700e+00  -2.3524600e+00  -2.4427500e+00  -2.5678700e+00  -2.6960100e+00  -2.8577700e+00];

% 17116
ak1=16.2684+[-2.4201000e-01  -1.8086600e-01  -1.1116400e-01  -4.6880500e-02  -1.4139600e-02   3.5151000e-02   7.7525100e-02   1.1633000e-01   1.4190200e-01   1.5705100e-01   1.7143500e-01   1.7257200e-01   1.6503800e-01   1.4818900e-01   1.2448600e-01   9.1094500e-02   5.1492300e-02   3.0375700e-03  -5.8229900e-02  -1.1687600e-01  -1.8845700e-01];
ak2=449.981+[2.3669000e+00   2.3098600e+00   2.3817800e+00   2.5336300e+00   2.6360300e+00   2.8450200e+00   3.1159500e+00   3.5240300e+00   3.9709600e+00   4.3426300e+00   4.8992700e+00   5.4313700e+00   5.9948300e+00   6.6626000e+00   7.3002600e+00   8.0207300e+00   8.7059000e+00   9.4328800e+00   1.0225500e+01   1.0916700e+01   1.1691800e+01];
ak3=-696.273+[-1.3288600e+00  -1.5137500e+00  -1.6589700e+00  -1.7904900e+00  -1.8592900e+00  -1.9747100e+00  -2.0962200e+00  -2.2501000e+00  -2.4046300e+00  -2.5275000e+00  -2.6956400e+00  -2.8212300e+00  -2.9421400e+00  -3.0900100e+00  -3.2419400e+00  -3.4279000e+00  -3.6226000e+00  -3.8464000e+00  -4.1137700e+00  -4.3621100e+00  -4.6577900e+00];

% 14886
al1=9.91704+[-1.2909300e-01  -4.3783000e-02   5.2490000e-02   1.4108600e-01   1.8368200e-01   2.4347100e-01   2.9227100e-01   3.3957800e-01   3.7131800e-01   3.8741000e-01   3.9987600e-01   3.9782100e-01   3.8505000e-01   3.5776000e-01   3.2179400e-01   2.7238800e-01   2.1605800e-01   1.4965000e-01   6.8800000e-02  -9.3284500e-03  -1.0293900e-01];
al2=444.847+[2.8113300e+00   2.7900200e+00   2.9547100e+00   3.2095300e+00   3.3674000e+00   3.6701600e+00   4.0406400e+00   4.5656300e+00   5.1282600e+00   5.5988700e+00   6.3157500e+00   7.0155400e+00   7.7608300e+00   8.6489500e+00   9.5025800e+00   1.0468200e+01   1.1385500e+01   1.2359500e+01   1.3415700e+01   1.4328200e+01   1.5347800e+01];
al3=-691.954+[-1.2862800e+00  -1.4328900e+00  -1.4863300e+00  -1.5213500e+00  -1.5398100e+00  -1.5751100e+00  -1.6197300e+00  -1.6872800e+00  -1.7617300e+00  -1.8267000e+00  -1.9147600e+00  -1.9530100e+00  -1.9826000e+00  -2.0336100e+00  -2.1062300e+00  -2.2130000e+00  -2.3431000e+00  -2.5126200e+00  -2.7396400e+00  -2.9673700e+00  -3.2517300e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 1297
am1=12.7746+[3.3679900e-01   3.7099400e-01   4.1994800e-01   4.6404000e-01   5.1469800e-01   5.5121900e-01   5.9551100e-01   6.3772100e-01   6.8600600e-01   7.0741300e-01   7.5554000e-01   8.0253000e-01   8.4096500e-01   8.6824400e-01   9.0392800e-01   9.5149000e-01   9.8181700e-01   1.0224500e+00   1.0666600e+00   1.1110500e+00   1.1418100e+00];
am2=447.736+[2.5609300e+00   2.4377700e+00   2.1414800e+00   1.8203700e+00   1.3974000e+00   1.0530500e+00   6.0577000e-01   1.3683600e-01  -4.4316100e-01  -7.1289400e-01  -1.3604400e+00  -2.0518300e+00  -2.6696600e+00  -3.1312000e+00  -3.7575100e+00  -4.5834500e+00  -5.1145800e+00  -5.8353700e+00  -6.6314300e+00  -7.4517200e+00  -8.0335100e+00];
am3=-690.116+[-1.7303000e+00  -1.7548300e+00  -1.7315700e+00  -1.6873900e+00  -1.6369100e+00  -1.6013100e+00  -1.5604000e+00  -1.5336600e+00  -1.5136000e+00  -1.5090400e+00  -1.5049300e+00  -1.5081300e+00  -1.5185100e+00  -1.5306800e+00  -1.5560000e+00  -1.6082800e+00  -1.6530100e+00  -1.7252500e+00  -1.8182800e+00  -1.9276300e+00  -2.0129900e+00];
% 16439
an1=13.5613+[1.6922800e-01   1.9168100e-01   2.1977400e-01   2.4291700e-01   2.6989700e-01   2.9216900e-01   3.1968200e-01   3.4723600e-01   3.8064200e-01   3.9635000e-01   4.3289800e-01   4.6895600e-01   4.9875200e-01   5.1966300e-01   5.4711600e-01   5.8474900e-01   6.0923600e-01   6.4243700e-01   6.7839200e-01   7.1449500e-01   7.3941400e-01];
an2=447.206+[1.8377900e+00   1.7848100e+00   1.6603600e+00   1.5164400e+00   1.3147200e+00   1.1295500e+00   8.7650200e-01   5.9973300e-01   2.4047900e-01   6.6673300e-02  -3.6406700e-01  -8.3459400e-01  -1.2629100e+00  -1.5871700e+00  -2.0329400e+00  -2.6307700e+00  -3.0184800e+00  -3.5472900e+00  -4.1347500e+00  -4.7447000e+00  -5.1795000e+00];
an3=-699.132+[-1.4183800e+00  -1.4364400e+00  -1.4174900e+00  -1.3796700e+00  -1.3341000e+00  -1.2995800e+00  -1.2579400e+00  -1.2288500e+00  -1.2019100e+00  -1.1929000e+00  -1.1748600e+00  -1.1589700e+00  -1.1487000e+00  -1.1436500e+00  -1.1441200e+00  -1.1606200e+00  -1.1805200e+00  -1.2164800e+00  -1.2660200e+00  -1.3269200e+00  -1.3757400e+00];
% 17116
ao1=16.2684+[1.5435300e-01   1.7770300e-01   2.0773000e-01   2.3364900e-01   2.6245200e-01   2.8613400e-01   3.1468400e-01   3.4226400e-01   3.7537700e-01   3.9112100e-01   4.2780800e-01   4.6381000e-01   4.9355500e-01   5.1460500e-01   5.4271600e-01   5.8259900e-01   6.0918500e-01   6.4575200e-01   6.8591800e-01   7.2671200e-01   7.5511700e-01];
ao2=449.981+[2.0571100e+00   1.9957000e+00   1.8426500e+00   1.6647400e+00   1.4239600e+00   1.2090700e+00   9.1887800e-01   6.0798100e-01   2.0854900e-01   1.6426900e-02  -4.5808100e-01  -9.7553800e-01  -1.4458800e+00  -1.8018500e+00  -2.2909400e+00  -2.9468000e+00  -3.3727500e+00  -3.9545000e+00  -4.6013800e+00  -5.2735000e+00  -5.7529000e+00];
ao3=-696.273+[-1.6334300e+00  -1.6427300e+00  -1.5935000e+00  -1.5210600e+00  -1.4356300e+00  -1.3716300e+00  -1.2933500e+00  -1.2305600e+00  -1.1647100e+00  -1.1384700e+00  -1.0802200e+00  -1.0223200e+00  -9.7554600e-01  -9.4379200e-01  -9.0907900e-01  -8.8119900e-01  -8.7330200e-01  -8.7231800e-01  -8.8228200e-01  -9.0367500e-01  -9.2529700e-01];
% 14886
ap1=9.91704+[3.8729600e-01   4.2114800e-01   4.6927400e-01   5.1194300e-01   5.6091600e-01   5.9576400e-01   6.3838100e-01   6.7933700e-01   7.2631500e-01   7.4698000e-01   7.9333900e-01   8.3872400e-01   8.7580900e-01   9.0198200e-01   9.3586900e-01   9.7982400e-01   1.0071800e+00   1.0432900e+00   1.0820700e+00   1.1205300e+00   1.1470100e+00];
ap2=444.847+[2.4108500e+00   2.3004800e+00   2.0341200e+00   1.7451000e+00   1.3627300e+00   1.0493300e+00   6.4072100e-01   2.0999600e-01  -3.2439100e-01  -5.7344500e-01  -1.1725500e+00  -1.8128400e+00  -2.3852900e+00  -2.8129100e+00  -3.3930500e+00  -4.1574300e+00  -4.6481100e+00  -5.3128900e+00  -6.0460500e+00  -6.8006300e+00  -7.3353100e+00];
ap3=-691.954+[-1.5620500e+00  -1.6079300e+00  -1.6344400e+00  -1.6411000e+00  -1.6523600e+00  -1.6614100e+00  -1.6748200e+00  -1.7001300e+00  -1.7398300e+00  -1.7612800e+00  -1.8161100e+00  -1.8790000e+00  -1.9402300e+00  -1.9890000e+00  -2.0620900e+00  -2.1738400e+00  -2.2553700e+00  -2.3761000e+00  -2.5206500e+00  -2.6808300e+00  -2.8009800e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4P
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 1297
aq1=12.7746+[-4.3484900e-01   7.7115600e-01   9.6944200e-01   1.0219400e+00   1.0453500e+00   1.0799900e+00   1.1067800e+00   1.1328700e+00   1.1740100e+00   1.2131600e+00   1.2455100e+00   1.2774200e+00   1.2975000e+00   1.3169900e+00   1.3444000e+00   1.3655700e+00   1.3912100e+00   1.4171100e+00   1.4417900e+00   1.4597100e+00   1.4818000e+00];
aq2=447.736+[2.5760800e+00   6.7869600e-02  -1.7142600e+00  -3.3054200e+00  -4.1616200e+00  -5.2805600e+00  -6.0834400e+00  -6.8867600e+00  -7.7643400e+00  -8.5789300e+00  -9.3372400e+00  -1.0271600e+01  -1.0892900e+01  -1.1487600e+01  -1.2249300e+01  -1.2826200e+01  -1.3540600e+01  -1.4224100e+01  -1.4867100e+01  -1.5343500e+01  -1.5928700e+01];
aq3=-690.116+[-9.0088400e-02  -1.5935700e+00  -1.5460900e+00  -1.5639100e+00  -1.6050600e+00  -1.6880100e+00  -1.7638400e+00  -1.8520000e+00  -1.9680300e+00  -2.0909300e+00  -2.2171300e+00  -2.3868200e+00  -2.5105600e+00  -2.6371700e+00  -2.8108000e+00  -2.9501700e+00  -3.1315700e+00  -3.3148400e+00  -3.4960000e+00  -3.6348900e+00  -3.8108600e+00];
% 16439
ar1=13.5613+[-4.2097600e-01   4.8645600e-01   6.3670900e-01   6.7296500e-01   6.8741700e-01   7.0972300e-01   7.2834800e-01   7.4938700e-01   7.8368000e-01   8.1665900e-01   8.4440400e-01   8.7197500e-01   8.8945300e-01   9.0650000e-01   9.2995300e-01   9.4759400e-01   9.6859500e-01   9.8864900e-01   1.0090400e+00   1.0239700e+00   1.0421000e+00];
ar2=447.206+[1.7838300e+00   2.4788000e-03  -1.3394800e+00  -2.5238600e+00  -3.1468500e+00  -3.9539200e+00  -4.5307500e+00  -5.1089100e+00  -5.7401800e+00  -6.3281500e+00  -6.8765400e+00  -7.5504700e+00  -8.0005800e+00  -8.4334400e+00  -8.9887600e+00  -9.4101300e+00  -9.9336700e+00  -1.0435300e+01  -1.0908800e+01  -1.1260300e+01  -1.1692700e+01];
ar3=-699.132+[7.7023900e-02  -1.3386300e+00  -1.3044200e+00  -1.3100100e+00  -1.3344500e+00  -1.3858900e+00  -1.4326000e+00  -1.4865900e+00  -1.5593000e+00  -1.6364000e+00  -1.7147400e+00  -1.8169100e+00  -1.8917200e+00  -1.9690600e+00  -2.0762100e+00  -2.1621800e+00  -2.2743200e+00  -2.3874100e+00  -2.4996200e+00  -2.5856300e+00  -2.6942600e+00];
% 17116
as1=16.2684+[-4.5758100e-01   4.8659100e-01   6.4688500e-01   6.9095200e-01   7.0974200e-01   7.3787200e-01   7.6068200e-01   7.8581100e-01   8.2497900e-01   8.6262700e-01   8.9426100e-01   9.2525700e-01   9.4494400e-01   9.6421500e-01   9.9101900e-01   1.0111600e+00   1.0353300e+00   1.0584300e+00   1.0816900e+00   1.0987200e+00   1.1194600e+00];
as2=449.981+[1.9827400e+00   6.5555200e-02  -1.3903800e+00  -2.6802500e+00  -3.3614600e+00  -4.2463200e+00  -4.8801000e+00  -5.5163600e+00  -6.2119700e+00  -6.8604900e+00  -7.4660400e+00  -8.2115500e+00  -8.7100200e+00  -9.1898100e+00  -9.8063800e+00  -1.0274800e+01  -1.0857500e+01  -1.1416500e+01  -1.1944800e+01  -1.2337400e+01  -1.2821200e+01];
as3=-696.273+[-9.3101500e-02  -1.4002800e+00  -1.2641100e+00  -1.1809800e+00  -1.1591700e+00  -1.1516400e+00  -1.1570700e+00  -1.1703800e+00  -1.2001800e+00  -1.2386400e+00  -1.2815100e+00  -1.3400100e+00  -1.3864100e+00  -1.4371500e+00  -1.5112500e+00  -1.5727400e+00  -1.6552800e+00  -1.7408200e+00  -1.8277800e+00  -1.8954500e+00  -1.9819600e+00];
% 14886
at1=9.91704+[-3.8613900e-01   8.1893200e-01   1.0097000e+00   1.0519200e+00   1.0692500e+00   1.0958100e+00   1.1167400e+00   1.1370400e+00   1.1716400e+00   1.2046600e+00   1.2316700e+00   1.2581800e+00   1.2747000e+00   1.2906900e+00   1.3132300e+00   1.3307800e+00   1.3519300e+00   1.3736700e+00   1.3943600e+00   1.4093600e+00   1.4278900e+00];
at2=444.847+[2.4369800e+00   2.6297100e-02  -1.6665900e+00  -3.1621800e+00  -3.9613000e+00  -5.0017500e+00  -5.7459100e+00  -6.4887800e+00  -7.2985900e+00  -8.0488900e+00  -8.7460400e+00  -9.6029900e+00  -1.0171700e+01  -1.0715400e+01  -1.1409900e+01  -1.1935100e+01  -1.2584400e+01  -1.3204600e+01  -1.3787000e+01  -1.4217900e+01  -1.4746500e+01];
at3=-691.954+[6.2514600e-02  -1.6038700e+00  -1.6793400e+00  -1.8133500e+00  -1.9188100e+00  -2.0851400e+00  -2.2198000e+00  -2.3657700e+00  -2.5430400e+00  -2.7210000e+00  -2.8974800e+00  -3.1288000e+00  -3.2923200e+00  -3.4560400e+00  -3.6758300e+00  -3.8492500e+00  -4.0716200e+00  -4.2929100e+00  -4.5086400e+00  -4.6724500e+00  -4.8782300e+00];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4P
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 1297
au1=12.7746+[3.1852000e-01   3.5123300e-01   3.9800500e-01   4.3988000e-01   4.8137400e-01   5.1668400e-01   5.7683700e-01   6.1669800e-01   6.4097900e-01   6.9560900e-01   7.1997900e-01   7.7350000e-01   7.9657800e-01   8.2296900e-01   8.6075100e-01   9.0022000e-01   9.5320400e-01   9.7677300e-01   1.0231200e+00   1.0532800e+00   1.0911500e+00];
au2=447.736+[2.6057600e+00   2.4847200e+00   2.1953100e+00   1.8800600e+00   1.5153200e+00   1.1766900e+00   5.5689200e-01   8.4175100e-02  -2.1792800e-01  -9.4882100e-01  -1.2902900e+00  -2.1147700e+00  -2.4972000e+00  -2.9555400e+00  -3.6417200e+00  -4.3516800e+00  -5.3122200e+00  -5.7451900e+00  -6.6073200e+00  -7.1819100e+00  -7.9176200e+00];
au3=-690.116+[-1.7472500e+00  -1.7712400e+00  -1.7486000e+00  -1.7035800e+00  -1.6547200e+00  -1.6144800e+00  -1.5546800e+00  -1.5270500e+00  -1.5139500e+00  -1.4988300e+00  -1.4958700e+00  -1.4986900e+00  -1.5038500e+00  -1.5135800e+00  -1.5381000e+00  -1.5792300e+00  -1.6592800e+00  -1.7028200e+00  -1.8019600e+00  -1.8766500e+00  -1.9816000e+00];
% 16439
av1=13.5613+[1.4615900e-01   1.6730500e-01   1.9325700e-01   2.1450500e-01   2.3660600e-01   2.5695400e-01   2.9407300e-01   3.2077100e-01   3.3770200e-01   3.7861000e-01   3.9739400e-01   4.3857600e-01   4.5649000e-01   4.7689800e-01   5.0587100e-01   5.3694800e-01   5.7964400e-01   5.9886500e-01   6.3640200e-01   6.6092400e-01   6.9140800e-01];
av2=447.206+[1.8708400e+00   1.8193600e+00   1.6995600e+00   1.5591300e+00   1.3828000e+00   1.2105500e+00   8.6306500e-01   5.8181300e-01   3.9650300e-01  -7.7745500e-02  -3.0506900e-01  -8.6752500e-01  -1.1320600e+00  -1.4524400e+00  -1.9391100e+00  -2.4514300e+00  -3.1522200e+00  -3.4698200e+00  -4.1054600e+00  -4.5320600e+00  -5.0811200e+00];
av3=-699.132+[-1.4334300e+00  -1.4510100e+00  -1.4327400e+00  -1.3939100e+00  -1.3492600e+00  -1.3110900e+00  -1.2505800e+00  -1.2201500e+00  -1.2038100e+00  -1.1762900e+00  -1.1656800e+00  -1.1455700e+00  -1.1380500e+00  -1.1311200e+00  -1.1287300e+00  -1.1396400e+00  -1.1745400e+00  -1.1960900e+00  -1.2481900e+00  -1.2892200e+00  -1.3485900e+00];
% 17116
aw1=16.2684+[1.3041600e-01   1.5240100e-01   1.8018100e-01   2.0420500e-01   2.2848400e-01   2.5005500e-01   2.8936100e-01   3.1618200e-01   3.3311100e-01   3.7435400e-01   3.9342500e-01   4.3517100e-01   4.5324900e-01   4.7387500e-01   5.0365300e-01   5.3668400e-01   5.8339600e-01   6.0474700e-01   6.4695400e-01   6.7480800e-01   7.0974100e-01];
aw2=449.981+[2.0970500e+00   2.0372800e+00   1.8899100e+00   1.7159100e+00   1.5042300e+00   1.3015900e+00   9.0153700e-01   5.8576200e-01   3.7901500e-01  -1.4554900e-01  -3.9639700e-01  -1.0155300e+00  -1.3064400e+00  -1.6585800e+00  -2.1930400e+00  -2.7554100e+00  -3.5258000e+00  -3.8754500e+00  -4.5757100e+00  -5.0459700e+00  -5.6515000e+00];
aw3=-696.273+[-1.6551300e+00  -1.6640300e+00  -1.6163400e+00  -1.5431700e+00  -1.4626700e+00  -1.3939100e+00  -1.2821400e+00  -1.2178400e+00  -1.1808200e+00  -1.1062800e+00  -1.0743700e+00  -1.0041800e+00  -9.7390800e-01  -9.4013600e-01  -8.9882400e-01  -8.7125000e-01  -8.5580600e-01  -8.5520000e-01  -8.6434500e-01  -8.7755400e-01  -9.0226500e-01];
% 14886
ax1=9.91704+[3.7090600e-01   4.0327400e-01   4.4924700e-01   4.8963400e-01   5.2928600e-01   5.6295900e-01   6.1983100e-01   6.5813100e-01   6.8148900e-01   7.3371500e-01   7.5689300e-01   8.0782700e-01   8.2983400e-01   8.5498400e-01   8.9065600e-01   9.2698600e-01   9.7437300e-01   9.9511500e-01   1.0354800e+00   1.0614300e+00   1.0938200e+00];
ax2=444.847+[2.4504300e+00   2.3420500e+00   2.0819500e+00   1.7984300e+00   1.4690400e+00   1.1623000e+00   5.9755400e-01   1.6364800e-01  -1.1409500e-01  -7.8862500e-01  -1.1040900e+00  -1.8669700e+00  -2.2209100e+00  -2.6451600e+00  -3.2803400e+00  -3.9371300e+00  -4.8239800e+00  -5.2230200e+00  -6.0167200e+00  -6.5451500e+00  -7.2211900e+00];
ax3=-691.954+[-1.5725900e+00  -1.6178400e+00  -1.6442200e+00  -1.6496400e+00  -1.6545200e+00  -1.6609400e+00  -1.6773700e+00  -1.7018700e+00  -1.7205300e+00  -1.7756600e+00  -1.8037500e+00  -1.8775200e+00  -1.9143600e+00  -1.9609900e+00  -2.0384400e+00  -2.1312800e+00  -2.2779200e+00  -2.3505100e+00  -2.5055700e+00  -2.6160700e+00  -2.7653700e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4P
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 1297
ay1=12.7746+[-4.3481100e-01   2.7027800e-01   4.8117100e-01   7.6175300e-01   8.7768500e-01   9.7106700e-01   1.0261400e+00   1.0671800e+00   1.1089700e+00   1.1287200e+00   1.1646500e+00   1.1945900e+00   1.2178800e+00   1.2446500e+00   1.2726800e+00   1.2955000e+00   1.3216400e+00   1.3471100e+00   1.3772400e+00   1.3955100e+00   1.4147100e+00];
ay2=447.736+[2.5760400e+00   1.2282000e+00   3.4841400e-01  -1.2998700e+00  -2.4509700e+00  -3.6764200e+00  -4.7137400e+00  -5.7881600e+00  -7.2124500e+00  -7.7390500e+00  -8.6225300e+00  -9.3754100e+00  -1.0010700e+01  -1.0789600e+01  -1.1605800e+01  -1.2238400e+01  -1.2963300e+01  -1.3645300e+01  -1.4478800e+01  -1.4971700e+01  -1.5487000e+01];
ay3=-690.116+[-9.1370300e-02  -1.5649800e+00  -1.5202200e+00  -1.4964000e+00  -1.5136200e+00  -1.5654400e+00  -1.6354300e+00  -1.7287100e+00  -1.8835800e+00  -1.9531500e+00  -2.0835600e+00  -2.2085500e+00  -2.3231400e+00  -2.4756600e+00  -2.6497100e+00  -2.7947200e+00  -2.9705700e+00  -3.1455300e+00  -3.3718900e+00  -3.5120200e+00  -3.6631800e+00];
% 16439
az1=13.5613+[-4.2095300e-01   8.7092800e-02   2.4300400e-01   4.5766800e-01   5.4544000e-01   6.1607700e-01   6.5695400e-01   6.8820100e-01   7.2287800e-01   7.3970900e-01   7.7071300e-01   7.9641400e-01   8.1637000e-01   8.3951100e-01   8.6363600e-01   8.8263400e-01   9.0414200e-01   9.2370300e-01   9.4835000e-01   9.6350200e-01   9.7921600e-01];
az2=447.206+[1.7840500e+00   9.1511800e-01   3.1193000e-01  -9.0261000e-01  -1.7637900e+00  -2.6728200e+00  -3.4364800e+00  -4.2230200e+00  -5.2609300e+00  -5.6441100e+00  -6.2863200e+00  -6.8334600e+00  -7.2961600e+00  -7.8652800e+00  -8.4639600e+00  -8.9286800e+00  -9.4624200e+00  -9.9648200e+00  -1.0581200e+01  -1.0946400e+01  -1.1328500e+01];
az3=-699.132+[7.5821900e-02  -1.2819300e+00  -1.2538600e+00  -1.2375500e+00  -1.2479100e+00  -1.2823300e+00  -1.3281500e+00  -1.3868300e+00  -1.4811700e+00  -1.5241600e+00  -1.6042800e+00  -1.6802500e+00  -1.7496600e+00  -1.8426200e+00  -1.9502600e+00  -2.0403200e+00  -2.1496700e+00  -2.2580800e+00  -2.3988700e+00  -2.4861600e+00  -2.5800300e+00];
% 17116
ba1=16.2684+[-4.5755800e-01   7.5019200e-02   2.3720200e-01   4.6388800e-01   5.5838600e-01   6.3516800e-01   6.8154500e-01   7.1857100e-01   7.6099000e-01   7.8087600e-01   8.1649300e-01   8.4590500e-01   8.6886800e-01   8.9559000e-01   9.2345500e-01   9.4549900e-01   9.7045500e-01   9.9327400e-01   1.0219100e+00   1.0394200e+00   1.0576300e+00];
ba2=449.981+[1.9828700e+00   1.0384800e+00   3.7454900e-01  -9.4340300e-01  -1.8765300e+00  -2.8646300e+00  -3.6980200e+00  -4.5594700e+00  -5.7006800e+00  -6.1228200e+00  -6.8311200e+00  -7.4353700e+00  -7.9469800e+00  -8.5769300e+00  -9.2403200e+00  -9.7559900e+00  -1.0349000e+01  -1.0908000e+01  -1.1594800e+01  -1.2002100e+01  -1.2429100e+01];
ba3=-696.273+[-9.4209400e-02  -1.3938900e+00  -1.3088200e+00  -1.2026500e+00  -1.1527900e+00  -1.1232700e+00  -1.1155800e+00  -1.1194200e+00  -1.1423800e+00  -1.1598300e+00  -1.1976800e+00  -1.2384000e+00  -1.2785700e+00  -1.3363800e+00  -1.4081900e+00  -1.4712700e+00  -1.5503500e+00  -1.6310400e+00  -1.7388900e+00  -1.8072000e+00  -1.8815500e+00];
% 14886
bb1=9.91704+[-3.8609900e-01   3.1880300e-01   5.2861400e-01   8.0116400e-01   9.1041700e-01   9.9670200e-01   1.0448200e+00   1.0781500e+00   1.1092700e+00   1.1249500e+00   1.1546000e+00   1.1794000e+00   1.1984200e+00   1.2200300e+00   1.2427800e+00   1.2614100e+00   1.2828300e+00   1.3039700e+00   1.3287800e+00   1.3439000e+00   1.3597900e+00];
bb2=444.847+[2.4370000e+00   1.1557500e+00   3.2154000e-01  -1.2413700e+00  -2.3282100e+00  -3.4800000e+00  -4.4496000e+00  -5.4489800e+00  -6.7670200e+00  -7.2529400e+00  -8.0669300e+00  -8.7590300e+00  -9.3420200e+00  -1.0055500e+01  -1.0801600e+01  -1.1378900e+01  -1.2039300e+01  -1.2659500e+01  -1.3415900e+01  -1.3862400e+01  -1.4328600e+01];
bb3=-691.954+[6.1123100e-02  -1.5262700e+00  -1.5521700e+00  -1.6427700e+00  -1.7387900e+00  -1.8757400e+00  -2.0183600e+00  -2.1870600e+00  -2.4408700e+00  -2.5460300e+00  -2.7352500e+00  -2.9093600e+00  -3.0645200e+00  -3.2656200e+00  -3.4890900e+00  -3.6712300e+00  -3.8885200e+00  -4.1014100e+00  -4.3724600e+00  -4.5381600e+00  -4.7154400e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 1297
bc1=12.7746+[3.8812000e-01   4.0802100e-01   4.3826100e-01   4.6620200e-01   4.9560400e-01   5.2580300e-01   5.5808200e-01   5.8754100e-01   6.1577000e-01   6.4493100e-01   6.7493000e-01   7.0498900e-01   7.4034000e-01   7.6530600e-01   7.8793500e-01   8.1762000e-01   8.4639900e-01   8.8082100e-01   9.1552500e-01   9.5439500e-01   9.7857400e-01];
bc2=447.736+[2.8364000e+00   2.7600000e+00   2.5710600e+00   2.3628600e+00   2.1119100e+00   1.8342100e+00   1.5295900e+00   1.2023800e+00   8.5180300e-01   4.8505600e-01   1.0098600e-01  -3.0233600e-01  -8.0094200e-01  -1.1767600e+00  -1.5260100e+00  -2.0015200e+00  -2.4796900e+00  -3.0464500e+00  -3.6054900e+00  -4.2245400e+00  -4.6086900e+00];
bc3=-690.116+[-1.3218300e+00  -1.3379700e+00  -1.3241500e+00  -1.2925600e+00  -1.2478900e+00  -1.2073400e+00  -1.1681300e+00  -1.1272200e+00  -1.0891800e+00  -1.0623300e+00  -1.0432700e+00  -1.0289700e+00  -1.0158600e+00  -1.0094100e+00  -1.0056200e+00  -1.0042500e+00  -1.0071700e+00  -1.0182000e+00  -1.0385400e+00  -1.0702700e+00  -1.0944800e+00];
% 16439
bd1=13.5613+[2.2240800e-01   2.3519300e-01   2.5131600e-01   2.6440700e-01   2.7779900e-01   2.9190600e-01   3.0784100e-01   3.2285700e-01   3.3894200e-01   3.5664400e-01   3.7538800e-01   3.9511800e-01   4.1912700e-01   4.3654900e-01   4.5237900e-01   4.7311100e-01   4.9341300e-01   5.1876300e-01   5.4452500e-01   5.7392000e-01   5.9256100e-01];
bd2=447.206+[2.0702900e+00   2.0412000e+00   1.9731400e+00   1.8924400e+00   1.7896700e+00   1.6668800e+00   1.5174400e+00   1.3485500e+00   1.1595800e+00   9.5385100e-01   7.2709600e-01   4.7845200e-01   1.6278400e-01  -8.2041100e-02  -3.1220300e-01  -6.3143800e-01  -9.5836700e-01  -1.3516200e+00  -1.7453100e+00  -2.1871900e+00  -2.4641000e+00];
bd3=-699.132+[-1.1512300e+00  -1.1613400e+00  -1.1487100e+00  -1.1218400e+00  -1.0824200e+00  -1.0484700e+00  -1.0134700e+00  -9.7403600e-01  -9.3478400e-01  -9.0595200e-01  -8.8237000e-01  -8.6114000e-01  -8.3710700e-01  -8.2091100e-01  -8.0693300e-01  -7.9049800e-01  -7.7724100e-01  -7.6815200e-01  -7.6628200e-01  -7.7177500e-01  -7.7898300e-01];
% 17116
be1=16.2684+[2.0733300e-01   2.2050800e-01   2.3788300e-01   2.5271500e-01   2.6811900e-01   2.8377600e-01   3.0163600e-01   3.1680700e-01   3.3245300e-01   3.4987200e-01   3.6844800e-01   3.8807300e-01   4.1187700e-01   4.2905300e-01   4.4462100e-01   4.6496100e-01   4.8499100e-01   5.1048900e-01   5.3698300e-01   5.6785700e-01   5.8773200e-01];
be2=449.981+[2.3181800e+00   2.2841600e+00   2.1978800e+00   2.0945300e+00   1.9634400e+00   1.8140800e+00   1.6366400e+00   1.4388800e+00   1.2202100e+00   9.8637000e-01   7.3156500e-01   4.5404700e-01   1.0282300e-01  -1.6855500e-01  -4.2341900e-01  -7.7619500e-01  -1.1368400e+00  -1.5703700e+00  -2.0040200e+00  -2.4905700e+00  -2.7954200e+00];
be3=-696.273+[-1.3985200e+00  -1.4032500e+00  -1.3707700e+00  -1.3198500e+00  -1.2508200e+00  -1.1894500e+00  -1.1264800e+00  -1.0570700e+00  -9.8703600e-01  -9.2977900e-01  -8.7851200e-01  -8.2941500e-01  -7.7176600e-01  -7.3091700e-01  -6.9437300e-01  -6.4788600e-01  -6.0520600e-01  -5.6226000e-01  -5.2818100e-01  -4.9924500e-01  -4.8568700e-01];
% 14886
bf1=9.91704+[4.3791600e-01   4.5749500e-01   4.8698100e-01   5.1399500e-01   5.4222700e-01   5.7070200e-01   6.0074800e-01   6.2930200e-01   6.5707200e-01   6.8543300e-01   7.1445200e-01   7.4347700e-01   7.7757600e-01   8.0171800e-01   8.2361500e-01   8.5246100e-01   8.8038900e-01   9.1349700e-01   9.4630600e-01   9.8259200e-01   1.0049100e+00];
bf2=444.847+[2.6550600e+00   2.5878000e+00   2.4199300e+00   2.2340700e+00   2.0097600e+00   1.7599100e+00   1.4845800e+00   1.1874100e+00   8.6822500e-01   5.3332600e-01   1.8147800e-01  -1.8900000e-01  -6.4745900e-01  -9.9373000e-01  -1.3156000e+00  -1.7542300e+00  -2.1956800e+00  -2.7187100e+00  -3.2344200e+00  -3.8052400e+00  -4.1592700e+00];
bf3=-691.954+[-1.0947100e+00  -1.1264300e+00  -1.1489100e+00  -1.1548800e+00  -1.1536800e+00  -1.1562700e+00  -1.1602700e+00  -1.1643200e+00  -1.1723800e+00  -1.1901800e+00  -1.2145600e+00  -1.2430400e+00  -1.2804100e+00  -1.3100300e+00  -1.3388100e+00  -1.3802600e+00  -1.4244200e+00  -1.4825100e+00  -1.5470700e+00  -1.6256200e+00  -1.6778700e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4P
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 1297
bg1=12.7746+[-2.9740500e-01   1.0621500e-01   5.1226600e-01   6.7425800e-01   8.2812900e-01   9.0504900e-01   1.0220500e+00   1.0697900e+00   1.1690700e+00   1.1825300e+00   1.2400100e+00   1.2732700e+00   1.3036800e+00   1.3398700e+00   1.3683000e+00   1.3977900e+00   1.4232600e+00   1.4541300e+00   1.4828400e+00   1.5183800e+00   1.5303300e+00];
bg2=447.736+[2.7438700e+00   2.2053700e+00   8.7141000e-01   2.2056200e-02  -1.3156200e+00  -2.2208300e+00  -3.8123300e+00  -4.4976700e+00  -6.0571200e+00  -6.2798800e+00  -7.3471100e+00  -8.0512400e+00  -8.7334000e+00  -9.5699700e+00  -1.0262000e+01  -1.1015400e+01  -1.1693400e+01  -1.2489100e+01  -1.3202000e+01  -1.4076800e+01  -1.4370100e+01];
bg3=-690.116+[-7.2232400e-01  -1.1523700e+00  -1.0782400e+00  -1.0475600e+00  -1.0159400e+00  -1.0234200e+00  -1.0901500e+00  -1.1344800e+00  -1.2729600e+00  -1.2967300e+00  -1.4245400e+00  -1.5203600e+00  -1.6226100e+00  -1.7609000e+00  -1.8860200e+00  -2.0327000e+00  -2.1740200e+00  -2.3527000e+00  -2.5241600e+00  -2.7487100e+00  -2.8272100e+00];
% 16439
bh1=13.5613+[-2.9872300e-01  -1.1781600e-02   2.8534100e-01   4.0784800e-01   5.2425100e-01   5.8075900e-01   6.6801500e-01   7.0434400e-01   7.8132100e-01   7.9181600e-01   8.3700700e-01   8.6328500e-01   8.8699900e-01   9.1493400e-01   9.3742800e-01   9.6119300e-01   9.8213400e-01   1.0077900e+00   1.0312400e+00   1.0602300e+00   1.0698000e+00];
bh2=447.206+[2.0430200e+00   1.6393500e+00   7.6322700e-01   1.5266400e-01  -8.3870900e-01  -1.5125500e+00  -2.6905300e+00  -3.1940200e+00  -4.3359200e+00  -4.4990200e+00  -5.2801600e+00  -5.7961100e+00  -6.2959800e+00  -6.9099100e+00  -7.4187600e+00  -7.9741900e+00  -8.4745500e+00  -9.0625100e+00  -9.5901200e+00  -1.0238300e+01  -1.0455500e+01];
bh3=-699.132+[-5.8657500e-01  -9.9448000e-01  -9.5622000e-01  -9.3487900e-01  -9.0543000e-01  -9.0760700e-01  -9.4973600e-01  -9.7646900e-01  -1.0607300e+00  -1.0753300e+00  -1.1534000e+00  -1.2114800e+00  -1.2734700e+00  -1.3579900e+00  -1.4347900e+00  -1.5254400e+00  -1.6129500e+00  -1.7242600e+00  -1.8314800e+00  -1.9720100e+00  -2.0208800e+00];
% 17116
bi1=16.2684+[-3.2813800e-01  -2.8665300e-02   2.8014000e-01   4.0790400e-01   5.2887800e-01   5.8824700e-01   6.8324400e-01   7.2341100e-01   8.0934800e-01   8.2113900e-01   8.7221500e-01   9.0218400e-01   9.2946600e-01   9.6185500e-01   9.8800800e-01   1.0157500e+00   1.0402200e+00   1.0700600e+00   1.0972900e+00   1.1308900e+00   1.1420200e+00];
bi2=449.981+[2.2464200e+00   1.8308800e+00   8.6242300e-01   1.9864200e-01  -8.7502100e-01  -1.6046300e+00  -2.8858500e+00  -3.4356500e+00  -4.6866600e+00  -4.8656700e+00  -5.7241800e+00  -6.2921500e+00  -6.8430400e+00  -7.5204800e+00  -8.0825900e+00  -8.6968700e+00  -9.2509700e+00  -9.9029500e+00  -1.0488800e+01  -1.1209900e+01  -1.1451900e+01];
bi3=-696.273+[-7.6833000e-01  -1.1756500e+00  -1.0493400e+00  -9.7871500e-01  -8.7335300e-01  -8.2627200e-01  -7.8422400e-01  -7.7540500e-01  -7.8015200e-01  -7.8363800e-01  -8.0899200e-01  -8.3293000e-01  -8.6254300e-01  -9.0833400e-01  -9.5388100e-01  -1.0112800e+00  -1.0695400e+00  -1.1474100e+00  -1.2255000e+00  -1.3312500e+00  -1.3686700e+00];
% 14886
bk1=9.91704+[-2.5342700e-01   1.5110000e-01   5.5650100e-01   7.1582200e-01   8.6639700e-01   9.4053200e-01   1.0488400e+00   1.0920400e+00   1.1804000e+00   1.1922600e+00   1.2422100e+00   1.2706000e+00   1.2962400e+00   1.3264800e+00   1.3500000e+00   1.3741500e+00   1.3948500e+00   1.4201400e+00   1.4438900e+00   1.4733700e+00   1.4833200e+00];
bk2=444.847+[2.6061700e+00   2.0743400e+00   8.0757000e-01   6.6761700e-04  -1.2693300e+00  -2.1264400e+00  -3.6236700e+00  -4.2648100e+00  -5.7173300e+00  -5.9242500e+00  -6.9136700e+00  -7.5649500e+00  -8.1946900e+00  -8.9653800e+00  -9.6017200e+00  -1.0293200e+01  -1.0914100e+01  -1.1641200e+01  -1.2291400e+01  -1.3087500e+01  -1.3353900e+01];
bk3=-691.954+[-5.6563500e-01  -1.0084000e+00  -1.0463100e+00  -1.0784700e+00  -1.1425000e+00  -1.2132600e+00  -1.3911800e+00  -1.4836700e+00  -1.7310200e+00  -1.7700800e+00  -1.9704000e+00  -2.1130900e+00  -2.2598900e+00  -2.4515800e+00  -2.6197600e+00  -2.8122700e+00  -2.9939900e+00  -3.2189400e+00  -3.4306500e+00  -3.7030600e+00  -3.7972600e+00];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')