%% foramen height and width narrowing/widening 
% for all models for the c3-c4 right hand side foramen 
% 4457,20101,9037,21922

% 6P!!

% Values for displacement and base coordinates have not yet been updated from copy paste.

k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 4457,20101,9037,21922
%% model15_intact_TLC_6P
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 4457
aa1=-9.37506+[5.0731200e-01   1.1644500e+00   1.5506800e+00   1.9639900e+00   2.5077600e+00   2.8013800e+00   3.2607600e+00   3.6284200e+00   4.0456300e+00   4.3220300e+00   4.6224600e+00   4.9013300e+00   5.1402000e+00   5.3886800e+00   5.6410400e+00   5.8114200e+00   5.9624600e+00   6.1547600e+00   6.3126900e+00   6.4798900e+00   6.6315200e+00];
aa2=448.144+[1.0306900e+00  -1.5012900e-01  -6.1033700e-01  -9.3061500e-01  -1.1711500e+00  -1.2597500e+00  -1.3743200e+00  -1.4464000e+00  -1.5506500e+00  -1.6430600e+00  -1.7588200e+00  -1.8775300e+00  -1.9951700e+00  -2.1476400e+00  -2.3366700e+00  -2.4746100e+00  -2.6022700e+00  -2.7766000e+00  -2.9266400e+00  -3.0952800e+00  -3.2596600e+00];
aa3=-689.149+[-6.7815900e-01  -3.7975600e-01  -2.0962600e-01  -4.9592700e-02   1.1037900e-01   1.8674600e-01   2.8496300e-01   3.4870800e-01   4.1681400e-01   4.6069500e-01   5.0716900e-01   5.4779400e-01   5.8094500e-01   6.1575900e-01   6.5095500e-01   6.7372900e-01   6.9353500e-01   7.1799400e-01   7.3737400e-01   7.5789700e-01   7.7622800e-01];

% 20101
ab1=-11.8681+[3.3679400e-01   7.9844400e-01   1.0706900e+00   1.3706300e+00   1.7743600e+00   1.9939900e+00   2.3406300e+00   2.6185000e+00   2.9350500e+00   3.1452000e+00   3.3732800e+00   3.5833600e+00   3.7635300e+00   3.9515700e+00   4.1445900e+00   4.2740600e+00   4.3887800e+00   4.5350900e+00   4.6554700e+00   4.7840100e+00   4.8999200e+00];
ab2=447.151+[5.9687600e-01  -4.4498200e-01  -8.7930200e-01  -1.1992200e+00  -1.4597800e+00  -1.5634300e+00  -1.6997700e+00  -1.7891300e+00  -1.9071100e+00  -2.0045000e+00  -2.1244100e+00  -2.2455100e+00  -2.3639700e+00  -2.5129600e+00  -2.6935600e+00  -2.8236500e+00  -2.9430400e+00  -3.1045900e+00  -3.2430400e+00  -3.3983200e+00  -3.5476600e+00];
ab3=-698.575+[-5.1114300e-01  -2.2261900e-01  -5.6553600e-02   1.0054300e-01   2.6173400e-01   3.3903400e-01   4.4006300e-01   5.0769300e-01   5.7826400e-01   6.2226500e-01   6.6794100e-01   7.0825100e-01   7.4127200e-01   7.7497600e-01   8.0766900e-01   8.2868700e-01   8.4715500e-01   8.6979200e-01   8.8778600e-01   9.0623200e-01   9.2221800e-01];

% 9037
ac1=-7.50723+[5.6194400e-01   1.2935000e+00   1.7392700e+00   2.2144000e+00   2.8251600e+00   3.1514400e+00   3.6530500e+00   4.0483300e+00   4.4960200e+00   4.7928700e+00   5.1160900e+00   5.4162500e+00   5.6729900e+00   5.9403900e+00   6.2128800e+00   6.3968000e+00   6.5596200e+00   6.7668300e+00   6.9371300e+00   7.1177900e+00   7.2816400e+00];
ac2=444.719+[1.0471600e+00  -4.0639900e-02  -4.3855800e-01  -6.9521900e-01  -8.6407900e-01  -9.1611600e-01  -9.7960200e-01  -1.0151400e+00  -1.0763200e+00  -1.1381600e+00  -1.2185100e+00  -1.3027400e+00  -1.3898800e+00  -1.5081600e+00  -1.6591400e+00  -1.7704200e+00  -1.8739700e+00  -2.0165600e+00  -2.1395700e+00  -2.2781600e+00  -2.4141200e+00];
ac3=-690.512+[-6.4682200e-01  -4.6893600e-01  -3.5594100e-01  -2.4591900e-01  -1.3830300e-01  -8.7808300e-02  -2.7320400e-02   8.0186000e-03   4.1935600e-02   6.1346300e-02   7.9662000e-02   9.3050300e-02   1.0193600e-01   1.0928600e-01   1.1417600e-01   1.1584000e-01   1.1657500e-01   1.1599100e-01   1.1437700e-01   1.1197300e-01   1.0870700e-01];

% 21922
ad1=-12.9198+[3.2311600e-01   7.6024400e-01   1.0016700e+00   1.2671000e+00   1.6343500e+00   1.8364300e+00   2.1628000e+00   2.4299700e+00   2.7343800e+00   2.9359000e+00   3.1539400e+00   3.3541500e+00   3.5262200e+00   3.7052400e+00   3.8881000e+00   4.0104400e+00   4.1188300e+00   4.2569900e+00   4.3704600e+00   4.4913500e+00   4.6001400e+00];
ad2=450.785+[6.8449100e-01  -4.5623900e-01  -9.3953400e-01  -1.3023400e+00  -1.6050900e+00  -1.7286600e+00  -1.8918700e+00  -1.9989600e+00  -2.1393500e+00  -2.2542500e+00  -2.3950900e+00  -2.5369000e+00  -2.6745200e+00  -2.8466000e+00  -3.0545200e+00  -3.2041900e+00  -3.3415300e+00  -3.5272000e+00  -3.6862400e+00  -3.8646700e+00  -4.0363000e+00];
ad3=-694.998+[-6.0699400e-01  -2.2343400e-01  -1.8139700e-02   1.6972500e-01   3.5923800e-01   4.4942000e-01   5.6855700e-01   6.4876500e-01   7.3546800e-01   7.9219400e-01   8.5300200e-01   9.0809400e-01   9.5498900e-01   1.0055000e+00   1.0579600e+00   1.0929900e+00   1.1242400e+00   1.1639400e+00   1.1963300e+00   1.2307800e+00   1.2620300e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_6P
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 4457
ae1=-9.37506+[-3.0640500e-01   1.5620400e-02   4.4823400e-01   1.0086400e+00   1.5231800e+00   2.1534000e+00   2.8115300e+00   3.5176100e+00   3.9148100e+00   4.5314900e+00   4.9948200e+00   5.2662700e+00   5.6177100e+00   5.9545800e+00   6.2656500e+00   6.5806500e+00   6.7621200e+00   7.0867400e+00   7.2958300e+00   7.4382100e+00   7.6083900e+00];
ae2=448.144+[2.1859200e+00   1.7573300e+00   1.2549800e+00   6.2899200e-01   8.2902000e-02  -5.1353100e-01  -1.0735400e+00  -1.6002900e+00  -1.8759200e+00  -2.2692800e+00  -2.5467100e+00  -2.7046600e+00  -2.9064200e+00  -3.1021900e+00  -3.2891800e+00  -3.4908900e+00  -3.6140100e+00  -3.8497100e+00  -4.0145000e+00  -4.1295300e+00  -4.2748700e+00];
ae3=-689.149+[-1.1481100e+00  -1.2589600e+00  -1.0192500e+00  -7.0956600e-01  -4.6077600e-01  -2.2674900e-01  -4.4044000e-02   1.0339000e-01   1.7304700e-01   2.6894400e-01   3.3315500e-01   3.6852900e-01   4.1236800e-01   4.5249200e-01   4.8873600e-01   5.2416300e-01   5.4331100e-01   5.7625000e-01   5.9631200e-01   6.0956200e-01   6.2538400e-01];

% 20101
af1=-11.8681+[-3.2046100e-01  -1.1510000e-01   1.6562500e-01   5.4834400e-01   9.2096000e-01   1.4008400e+00   1.9129600e+00   2.4637900e+00   2.7751200e+00   3.2586400e+00   3.6204800e+00   3.8319000e+00   4.1053400e+00   4.3667900e+00   4.6096100e+00   4.8569800e+00   4.9999600e+00   5.2549400e+00   5.4186100e+00   5.5303700e+00   5.6639300e+00];
af2=447.151+[1.5394400e+00   1.0932500e+00   6.1646100e-01   3.6942200e-02  -4.5983600e-01  -1.0062500e+00  -1.5213300e+00  -2.0090900e+00  -2.2661000e+00  -2.6378500e+00  -2.9031600e+00  -3.0556100e+00  -3.2514800e+00  -3.4425000e+00  -3.6260300e+00  -3.8238200e+00  -3.9445000e+00  -4.1733300e+00  -4.3321700e+00  -4.4428800e+00  -4.5818300e+00];
af3=-698.575+[-8.3785300e-01  -9.2002400e-01  -6.8295200e-01  -3.7546200e-01  -1.3286700e-01   9.6263500e-02   2.7601000e-01   4.2398000e-01   4.9524100e-01   5.9521800e-01   6.6364500e-01   7.0148000e-01   7.4852100e-01   7.9100000e-01   8.2847100e-01   8.6434600e-01   8.8365900e-01   9.1568100e-01   9.3508000e-01   9.4813800e-01   9.6355400e-01];

% 9037
ag1=-7.50723+[-2.5743400e-01   1.0864800e-01   6.0187500e-01   1.2377600e+00   1.8143700e+00   2.5060500e+00   3.2161600e+00   3.9652100e+00   4.3844000e+00   5.0340300e+00   5.5218300e+00   5.8076100e+00   6.1775400e+00   6.5325000e+00   6.8607500e+00   7.1938600e+00   7.3861200e+00   7.7304700e+00   7.9525200e+00   8.1035500e+00   8.2841300e+00];
ag2=444.719+[2.1685800e+00   1.7794000e+00   1.3386200e+00   7.9720500e-01   3.2745800e-01  -1.8636100e-01  -6.6861100e-01  -1.1215500e+00  -1.3563800e+00  -1.6859100e+00  -1.9141300e+00  -2.0425300e+00  -2.2050300e+00  -2.3615400e+00  -2.5104600e+00  -2.6712800e+00  -2.7696500e+00  -2.9587100e+00  -3.0917400e+00  -3.1847900e+00  -3.3029600e+00];
ag3=-690.512+[-1.0346900e+00  -1.1854100e+00  -1.0121000e+00  -7.9137100e-01  -6.1973800e-01  -4.6619900e-01  -3.5792600e-01  -2.8208900e-01  -2.5136700e-01  -2.1427400e-01  -1.9353000e-01  -1.8348200e-01  -1.7262500e-01  -1.6446100e-01  -1.5828000e-01  -1.5413600e-01  -1.5342300e-01  -1.5458400e-01  -1.5731100e-01  -1.5974300e-01  -1.6313300e-01];

% 21922
ah1=-12.9198+[-3.6086200e-01  -1.6549900e-01   9.3603700e-02   4.4254700e-01   7.8345700e-01   1.2321900e+00   1.7198900e+00   2.2555200e+00   2.5599500e+00   3.0331900e+00   3.3868000e+00   3.5931600e+00   3.8600100e+00   4.1143300e+00   4.3498000e+00   4.5887800e+00   4.7264400e+00   4.9710500e+00   5.1275300e+00   5.2344800e+00   5.3620900e+00];
ah2=450.785+[1.7083600e+00   1.2389000e+00   7.1447500e-01   6.3450300e-02  -4.9979700e-01  -1.1167500e+00  -1.6964500e+00  -2.2428800e+00  -2.5316500e+00  -2.9506700e+00  -3.2510700e+00  -3.4243200e+00  -3.6475900e+00  -3.8658300e+00  -4.0758500e+00  -4.3022400e+00  -4.4403500e+00  -4.7024100e+00  -4.8843200e+00  -5.0111400e+00  -5.1702600e+00];
ah3=-694.998+[-1.0313900e+00  -1.0918700e+00  -8.1016700e-01  -4.3823600e-01  -1.3836700e-01   1.4972500e-01   3.8261700e-01   5.7934900e-01   6.7677700e-01   8.1477500e-01   9.1054900e-01   9.6428900e-01   1.0320000e+00   1.0944900e+00   1.1510000e+00   1.2069400e+00   1.2382500e+00   1.2927200e+00   1.3274300e+00   1.3511400e+00   1.3797700e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_6P
t2=[2 2.05126 2.1153 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 4457
ai1=-9.37506+[-1.7017400e-01  -6.1963300e-02   1.7788700e-01   3.5813800e-01   6.8007300e-01   9.9460100e-01   1.3920300e+00   1.7571700e+00   2.2384200e+00   2.6689500e+00   3.1880200e+00   3.7148500e+00   4.1834700e+00   4.7290500e+00   5.0538400e+00   5.6407100e+00   5.8791500e+00   6.2827100e+00   6.5548300e+00   6.8537100e+00   7.1098200e+00];
ai2=448.144+[2.5984000e+00   2.3762500e+00   2.0042700e+00   1.7494100e+00   1.3134800e+00   9.1361700e-01   4.6156900e-01   9.5424100e-02  -3.1779000e-01  -6.5195900e-01  -1.0303400e+00  -1.3976500e+00  -1.7190500e+00  -2.0880400e+00  -2.3062100e+00  -2.7020200e+00  -2.8642200e+00  -3.1416600e+00  -3.3337500e+00  -3.5510500e+00  -3.7419900e+00];
ai3=-689.149+[-1.3210800e+00  -1.3594900e+00  -1.1862100e+00  -1.0511600e+00  -8.1328200e-01  -5.9934100e-01  -3.7648900e-01  -2.1061400e-01  -4.0571200e-02   7.9117900e-02   2.0015400e-01   3.0329000e-01   3.8149900e-01   4.5969100e-01   5.0062300e-01   5.6383300e-01   5.8543100e-01   6.1668300e-01   6.3590900e-01   6.5543400e-01   6.7064500e-01];

% 20101
aj1=-11.8681+[-2.1616900e-01  -1.5284900e-01  -2.0854900e-02   8.2291000e-02   2.7697800e-01   4.8095400e-01   7.6019900e-01   1.0319600e+00   1.4005700e+00   1.7341300e+00   2.1420600e+00   2.5608900e+00   2.9347800e+00   3.3691600e+00   3.6272900e+00   4.0916900e+00   4.2806200e+00   4.6013300e+00   4.8174200e+00   5.0549700e+00   5.2589600e+00];
aj2=447.151+[1.8236600e+00   1.6164000e+00   1.2639900e+00   1.0223700e+00   6.1263800e-01   2.4585700e-01  -1.6280600e-01  -4.9612300e-01  -8.8040200e-01  -1.1952200e+00  -1.5560500e+00  -1.9104000e+00  -2.2182800e+00  -2.5689600e+00  -2.7754800e+00  -3.1480100e+00  -3.3004800e+00  -3.5623700e+00  -3.7440300e+00  -3.9497000e+00  -4.1305400e+00];
aj3=-698.575+[-9.6580700e-01  -1.0063900e+00  -8.5119300e-01  -7.2526100e-01  -4.9927900e-01  -2.9709600e-01  -8.9446500e-02   6.4989100e-02   2.2674000e-01   3.4390000e-01   4.6564900e-01   5.7336900e-01   6.5648200e-01   7.4118700e-01   7.8636700e-01   8.5738600e-01   8.8239700e-01   9.1992600e-01   9.4283600e-01   9.6618700e-01   9.8492400e-01];

% 9037
ak1=-7.50723+[-1.1656300e-01   1.6456200e-02   3.1160900e-01   5.3062000e-01   9.1762200e-01   1.2884000e+00   1.7444200e+00   2.1531100e+00   2.6782500e+00   3.1408700e+00   3.6931500e+00   4.2491100e+00   4.7411400e+00   5.3118100e+00   5.6507100e+00   6.2619800e+00   6.5101100e+00   6.9300700e+00   7.2135000e+00   7.5250700e+00   7.7920800e+00];
ak2=444.719+[2.5710800e+00   2.3710600e+00   2.0489100e+00   1.8310100e+00   1.4616300e+00   1.1247000e+00   7.4406900e-01   4.3508200e-01   8.4701100e-02  -1.9953700e-01  -5.2196700e-01  -8.3545800e-01  -1.1093100e+00  -1.4226000e+00  -1.6071700e+00  -1.9406100e+00  -2.0767500e+00  -2.3089000e+00  -2.4690600e+00  -2.6497700e+00  -2.8082000e+00];
ak3=-690.512+[-1.1726200e+00  -1.2347000e+00  -1.1102400e+00  -1.0109000e+00  -8.3683700e-01  -6.8300300e-01  -5.2746700e-01  -4.1426300e-01  -3.0220900e-01  -2.2855000e-01  -1.5902200e-01  -1.0558600e-01  -7.1539300e-02  -4.4892200e-02  -3.4752400e-02  -2.7873600e-02  -2.9316700e-02  -3.7144100e-02  -4.4626800e-02  -5.4969800e-02  -6.5800900e-02];

% 21922
al1=-12.9198+[-2.5352100e-01  -1.9904400e-01  -9.1009000e-02  -6.5726400e-03   1.5333600e-01   3.2507500e-01   5.7035200e-01   8.1733700e-01   1.1641300e+00   1.4832300e+00   1.8777600e+00   2.2867800e+00   2.6537900e+00   3.0811400e+00   3.3353600e+00   3.7928200e+00   3.9789000e+00   4.2944700e+00   4.5065800e+00   4.7393600e+00   4.9391300e+00];
al2=450.785+[2.0291800e+00   1.8065300e+00   1.4200500e+00   1.1513100e+00   6.8914800e-01   2.7007700e-01  -1.9825300e-01  -5.7866200e-01  -1.0126100e+00  -1.3660200e+00  -1.7691800e+00  -2.1643500e+00  -2.5088700e+00  -2.9028400e+00  -3.1355500e+00  -3.5565300e+00  -3.7292200e+00  -4.0261100e+00  -4.2322500e+00  -4.4659700e+00  -4.6717700e+00];
al3=-694.998+[-1.2003100e+00  -1.2267900e+00  -1.0417600e+00  -8.9230400e-01  -6.2145100e-01  -3.7526000e-01  -1.1838900e-01   7.4203400e-02   2.7638600e-01   4.2496700e-01   5.8120700e-01   7.2250900e-01   8.3581300e-01   9.5580700e-01   1.0220800e+00   1.1314500e+00   1.1721800e+00   1.2364200e+00   1.2775700e+00   1.3214300e+00   1.3581600e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_6P
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 4457
am1=-9.37506+[3.5697400e-01   3.8670400e-01   4.6608900e-01   5.6448900e-01   6.5145900e-01   7.8669400e-01   9.9214000e-01   1.1411800e+00   1.3982400e+00   1.6509100e+00   1.8529900e+00   2.2081800e+00   2.5807200e+00   2.8269600e+00   3.2296200e+00   3.5265500e+00   3.8876000e+00   4.3153100e+00   4.5411700e+00   4.9326300e+00   5.2365500e+00];
am2=448.144+[1.9618200e+00   1.8663800e+00   1.6750800e+00   1.4845300e+00   1.3254600e+00   1.0917400e+00   7.5907800e-01   5.3416500e-01   1.7855600e-01  -1.2642500e-01  -3.4309600e-01  -6.8093200e-01  -9.8808700e-01  -1.1735400e+00  -1.4626100e+00  -1.6661800e+00  -1.9081300e+00  -2.1877900e+00  -2.3332600e+00  -2.5821400e+00  -2.7728800e+00];
am3=-689.149+[-1.2861900e+00  -1.2605200e+00  -1.1629300e+00  -1.0552200e+00  -9.6482200e-01  -8.3099800e-01  -6.4152400e-01  -5.1663700e-01  -3.2882400e-01  -1.7628500e-01  -7.3473800e-02   7.7957300e-02   2.0480200e-01   2.7548700e-01   3.7835100e-01   4.4458100e-01   5.1832700e-01   5.9316200e-01   6.2866100e-01   6.8264700e-01   7.1878700e-01];
% 20101
an1=-11.8681+[1.9195900e-01   2.0780600e-01   2.4338400e-01   2.8770800e-01   3.2820500e-01   3.9380500e-01   5.0364500e-01   5.9089300e-01   7.5549500e-01   9.2690100e-01   1.0696300e+00   1.3351900e+00   1.6228900e+00   1.8147200e+00   2.1302800e+00   2.3642100e+00   2.6502500e+00   2.9911300e+00   3.1716300e+00   3.4855100e+00   3.7292400e+00];
an2=447.151+[1.2337100e+00   1.1559100e+00   9.8703800e-01   8.1221900e-01   6.6330500e-01   4.4300300e-01   1.3125600e-01  -7.6784100e-02  -4.0455700e-01  -6.8133800e-01  -8.7894200e-01  -1.1944500e+00  -1.4896600e+00  -1.6706900e+00  -1.9547300e+00  -2.1549800e+00  -2.3925600e+00  -2.6663000e+00  -2.8086000e+00  -3.0517900e+00  -3.2374900e+00];
an3=-698.575+[-8.9701400e-01  -8.8752600e-01  -8.1923300e-01  -7.3130700e-01  -6.5432900e-01  -5.3609500e-01  -3.6413000e-01  -2.5141600e-01  -8.3827500e-02   4.9598300e-02   1.4056600e-01   2.7689200e-01   3.9463200e-01   4.6220200e-01   5.6251600e-01   6.2879300e-01   7.0376400e-01   7.8218800e-01   8.2028200e-01   8.7979700e-01   9.2055100e-01];
% 9037
ao1=-7.50723+[4.2968700e-01   4.7274900e-01   5.8626100e-01   7.1979900e-01   8.3600700e-01   1.0135100e+00   1.2766100e+00   1.4628100e+00   1.7755200e+00   2.0722100e+00   2.3037400e+00   2.7023200e+00   3.1115900e+00   3.3784300e+00   3.8113000e+00   4.1277700e+00   4.5107500e+00   4.9619200e+00   5.1993700e+00   5.6097200e+00   5.9272700e+00];
ao2=444.719+[1.9664300e+00   1.8823000e+00   1.7201900e+00   1.5610200e+00   1.4289600e+00   1.2359400e+00   9.6263700e-01   7.7841100e-01   4.8757900e-01   2.3797700e-01   6.0541500e-02  -2.1639200e-01  -4.6889700e-01  -6.2192600e-01  -8.6076000e-01  -1.0292700e+00  -1.2292700e+00  -1.4603600e+00  -1.5804100e+00  -1.7855600e+00  -1.9425700e+00];
ao3=-690.512+[-1.1964600e+00  -1.1812200e+00  -1.1089100e+00  -1.0283400e+00  -9.6104700e-01  -8.6181300e-01  -7.2286100e-01  -6.3241300e-01  -4.9879100e-01  -3.9263100e-01  -3.2249100e-01  -2.2094200e-01  -1.3796800e-01  -9.3289800e-02  -3.0650000e-02   7.0650800e-03   4.6459700e-02   8.1250900e-02   9.5828800e-02   1.1392000e-01   1.2237700e-01];
% 21922
ap1=-12.9198+[1.6308400e-01   1.7252300e-01   1.9040100e-01   2.1571000e-01   2.3960900e-01   2.7996600e-01   3.5398300e-01   4.1763900e-01   5.4652400e-01   6.8999800e-01   8.1448200e-01   1.0545200e+00   1.3221300e+00   1.5033500e+00   1.8038200e+00   2.0286100e+00   2.3048200e+00   2.6357700e+00   2.8114900e+00   3.1177100e+00   3.3560500e+00];
ap2=450.785+[1.3985100e+00   1.3131500e+00   1.1260300e+00   9.3031300e-01   7.6267900e-01   5.1288500e-01   1.5544900e-01  -8.4284900e-02  -4.6349100e-01  -7.8347200e-01  -1.0113100e+00  -1.3728000e+00  -1.7077700e+00  -1.9121200e+00  -2.2319900e+00  -2.4574200e+00  -2.7253300e+00  -3.0347300e+00  -3.1957800e+00  -3.4712200e+00  -3.6816900e+00];
ap3=-694.998+[-1.0828400e+00  -1.0672800e+00  -9.8505900e-01  -8.8082000e-01  -7.8923100e-01  -6.4808500e-01  -4.4052400e-01  -3.0345000e-01  -9.6648500e-02   6.9243900e-02   1.8277200e-01   3.5326100e-01   5.0035000e-01   5.8517700e-01   7.1198300e-01   7.9712000e-01   8.9491800e-01   1.0003000e+00   1.0525100e+00   1.1361800e+00   1.1953800e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_6P
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 4457
aq1=-9.37506+[-4.4029300e-01   1.2335600e+00   2.1379500e+00   2.7176900e+00   3.1343200e+00   3.5653900e+00   4.0409200e+00   4.5400100e+00   4.8773500e+00   5.2257500e+00   5.5868300e+00   5.9352900e+00   6.1102600e+00   6.4491800e+00   6.6270500e+00   6.8776000e+00   7.0756000e+00   7.2098600e+00   7.3949100e+00   7.5810400e+00   7.7518500e+00];
aq2=448.144+[2.2729300e+00   1.3383200e-01  -9.2857000e-01  -1.5071100e+00  -1.7955700e+00  -1.9832100e+00  -2.1411400e+00  -2.2859400e+00  -2.3979600e+00  -2.5390400e+00  -2.7205300e+00  -2.9185800e+00  -3.0290800e+00  -3.2684500e+00  -3.4051800e+00  -3.6175100e+00  -3.7930700e+00  -3.9170500e+00  -4.0956900e+00  -4.2812500e+00  -4.4649000e+00];
aq3=689.149+[-1.2343600e-01  -8.2256500e-01  -4.6433400e-01  -2.5312000e-01  -1.2804200e-01  -2.2815400e-02   7.8648000e-02   1.6440800e-01   2.1933200e-01   2.7589400e-01   3.3368000e-01   3.8716500e-01   4.1250400e-01   4.6000900e-01   4.8392000e-01   5.1647100e-01   5.4044600e-01   5.5604700e-01   5.7636500e-01   5.9556000e-01   6.1230300e-01];
% 20101
ar1=-11.8681+[-4.2105700e-01   8.1373400e-01   1.4764600e+00   1.9090600e+00   2.2261400e+00   2.5568500e+00   2.9218800e+00   3.3033900e+00   3.5616600e+00   3.8297900e+00   4.1075100e+00   4.3732200e+00   4.5069500e+00   4.7651100e+00   4.9020900e+00   5.0969200e+00   5.2513600e+00   5.3558800e+00   5.5002100e+00   5.6450700e+00   5.7779500e+00];
ar2=447.151+[1.4900500e+00  -3.3856900e-01  -1.2826700e+00  -1.8077000e+00  -2.0862000e+00  -2.2832400e+00  -2.4574800e+00  -2.6200800e+00  -2.7422100e+00  -2.8904800e+00  -3.0739500e+00  -3.2699900e+00  -3.3783000e+00  -3.6093900e+00  -3.7408300e+00  -3.9436500e+00  -4.1109900e+00  -4.2285900e+00  -4.3975800e+00  -4.5722200e+00  -4.7433800e+00];
ar3=-698.575+[6.5302800e-02  -4.5262300e-01  -9.1396700e-02   1.1289400e-01   2.3370000e-01   3.3800600e-01   4.3977100e-01   5.2964100e-01   5.8718200e-01   6.4491100e-01   7.0246300e-01   7.5524100e-01   7.7984700e-01   8.2449200e-01   8.4643100e-01   8.7502100e-01   8.9573500e-01   9.0882900e-01   9.2616200e-01   9.4310600e-01   9.5739500e-01];
% 9037
as1=-7.50723+[-3.8446300e-01   1.3827200e+00   2.3700800e+00   3.0140700e+00   3.4763500e+00   3.9487000e+00   4.4646100e+00   4.9969500e+00   5.3559400e+00   5.7270700e+00   6.1125700e+00   6.4844600e+00   6.6711200e+00   7.0326800e+00   7.2225200e+00   7.4907200e+00   7.7028200e+00   7.8466800e+00   8.0448200e+00   8.2435000e+00   8.4259300e+00];
as2=444.719+[2.2354400e+00   2.5832500e-01  -6.8877400e-01  -1.1828500e+00  -1.4135300e+00  -1.5486700e+00  -1.6525400e+00  -1.7471500e+00  -1.8242100e+00  -1.9265800e+00  -2.0642300e+00  -2.2176400e+00  -2.3048700e+00  -2.4969700e+00  -2.6077400e+00  -2.7810000e+00  -2.9244700e+00  -3.0260200e+00  -3.1730400e+00  -3.3265800e+00  -3.4794300e+00];
as3=-690.512+[5.8991400e-02  -9.1777600e-01  -6.9334500e-01  -5.6143400e-01  -4.8259800e-01  -4.1603100e-01  -3.5363900e-01  -3.0665100e-01  -2.7900100e-01  -2.5273000e-01  -2.2903400e-01  -2.1010900e-01  -2.0270400e-01  -1.9138000e-01  -1.8705700e-01  -1.8331500e-01  -1.8251400e-01  -1.8293000e-01  -1.8502800e-01  -1.8857300e-01  -1.9350900e-01];
% 21922
at1=-12.9198+[-4.7550300e-01   7.7169400e-01   1.4052900e+00   1.8039900e+00   2.0951100e+00   2.4033900e+00   2.7477200e+00   3.1161500e+00   3.3659300e+00   3.6246400e+00   3.8913100e+00   4.1458900e+00   4.2740400e+00   4.5206200e+00   4.6512700e+00   4.8363300e+00   4.9826900e+00   5.0815300e+00   5.2180600e+00   5.3554500e+00   5.4811900e+00];
at2=450.785+[1.6833300e+00  -3.2396600e-01  -1.3792300e+00  -1.9757300e+00  -2.2957700e+00  -2.5246000e+00  -2.7291300e+00  -2.9181700e+00  -3.0595600e+00  -3.2305100e+00  -3.4413400e+00  -3.6665000e+00  -3.7905600e+00  -4.0547000e+00  -4.2047500e+00  -4.4361300e+00  -4.6271000e+00  -4.7613300e+00  -4.9541000e+00  -5.1532100e+00  -5.3484200e+00];
at3=-694.998+[-1.5938200e-01  -4.8175700e-01  -1.8735800e-02   2.4282600e-01   3.9366500e-01   5.1944100e-01   6.4130400e-01   7.4990200e-01   8.2121400e-01   8.9518900e-01   9.7215000e-01   1.0454700e+00   1.0811600e+00   1.1488300e+00   1.1836000e+00   1.2315900e+00   1.2681100e+00   1.2922000e+00   1.3251600e+00   1.3581500e+00   1.3880700e+00];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_6P
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 4457
au1=-9.37506+[3.3988300e-01   3.6824000e-01   4.4399900e-01   5.3849600e-01   6.2222500e-01   7.5267700e-01   9.5131500e-01   1.0957700e+00   1.3126300e+00   1.5392500e+00   1.7937800e+00   2.0975600e+00   2.3807300e+00   2.7448500e+00   3.1638700e+00   3.3790400e+00   3.7277300e+00   4.0835300e+00   4.7608600e+00   4.8497700e+00   5.1202300e+00];
au2=448.144+[1.9866000e+00   1.8932700e+00   1.7051800e+00   1.5175000e+00   1.3609000e+00   1.1308400e+00   8.0403600e-01   5.8254700e-01   2.7546300e-01  -1.0025200e-02  -2.9126500e-01  -5.8965700e-01  -8.3591100e-01  -1.1205200e+00  -1.4234900e+00  -1.5734500e+00  -1.8101700e+00  -2.0453200e+00  -2.4816100e+00  -2.5380500e+00  -2.7085200e+00];
au3=-689.149+[-1.2875100e+00  -1.2626700e+00  -1.1673700e+00  -1.0620600e+00  -9.7362900e-01  -8.4273500e-01  -6.5654800e-01  -5.3283300e-01  -3.6816300e-01  -2.2168100e-01  -8.5381500e-02   5.1253000e-02   1.5691400e-01   2.6948100e-01   3.7844900e-01   4.2906000e-01   5.0400300e-01   5.7043900e-01   6.7489000e-01   6.8702700e-01   7.2066400e-01];
% 20101
av1=-11.8681+[1.6997400e-01   1.8485900e-01   2.1799000e-01   2.5999700e-01   2.9864100e-01   3.6140600e-01   4.6692300e-01   5.5079200e-01   6.8779900e-01   8.3934600e-01   1.0173300e+00   1.2425100e+00   1.4598400e+00   1.7421600e+00   2.0703900e+00   2.2397200e+00   2.5153900e+00   2.7985800e+00   3.3407400e+00   3.4120300e+00   3.6289900e+00];
av2=447.151+[1.2432900e+00   1.1672300e+00   1.0019200e+00   8.3100500e-01   6.8560100e-01   4.7003500e-01   1.6450500e-01  -4.0326500e-02  -3.2347400e-01  -5.8275600e-01  -8.3859200e-01  -1.1158900e+00  -1.3498900e+00  -1.6255500e+00  -1.9226100e+00  -2.0701300e+00  -2.3021500e+00  -2.5320600e+00  -2.9584600e+00  -3.0135300e+00  -3.1795200e+00];
av3=-698.575+[-8.9375500e-01  -8.8514600e-01  -8.1977800e-01  -7.3511200e-01  -6.6075200e-01  -5.4609800e-01  -3.7775700e-01  -2.6604700e-01  -1.1896100e-01   9.6228100e-03   1.2996200e-01   2.5257000e-01   3.4916400e-01   4.5530300e-01   5.6121600e-01   6.1143400e-01   6.8676400e-01   7.5528000e-01   8.6770500e-01   8.8101900e-01   9.1852500e-01];
% 9037
aw1=-7.50723+[4.1513500e-01   4.5658700e-01   5.6567000e-01   6.9438500e-01   8.0663100e-01   9.7857900e-01   1.2340700e+00   1.4154100e+00   1.6810400e+00   1.9498300e+00   2.2432200e+00   2.5859000e+00   2.8993300e+00   3.2960600e+00   3.7469200e+00   3.9768900e+00   4.3475500e+00   4.7236800e+00   5.4356700e+00   5.5288100e+00   5.8116600e+00];
aw2=444.719+[1.9912800e+00   1.9090200e+00   1.7494800e+00   1.5924600e+00   1.4622900e+00   1.2721500e+00   1.0036400e+00   8.2229000e-01   5.7134100e-01   3.3791300e-01   1.0779900e-01  -1.3646400e-01  -3.3849300e-01  -5.7274100e-01  -8.2298100e-01  -9.4687900e-01  -1.1424000e+00  -1.3366300e+00  -1.6964700e+00  -1.7429200e+00  -1.8831600e+00];
aw3=-690.512+[-1.1941100e+00  -1.1794000e+00  -1.1089800e+00  -1.0305000e+00  -9.6491100e-01  -8.6811200e-01  -7.3158800e-01  -6.4182900e-01  -5.2415500e-01  -4.2133100e-01  -3.2768200e-01  -2.3550400e-01  -1.6551000e-01  -9.3265600e-02  -2.6553100e-02   3.0497900e-03   4.4356000e-02   7.7160000e-02   1.1885400e-01   1.2283100e-01   1.3175500e-01];
% 21922
ax1=-12.9198+[1.3890300e-01   1.4750100e-01   1.6357300e-01   1.8729100e-01   2.0984700e-01   2.4769000e-01   3.1765100e-01   3.7788600e-01   4.8330700e-01   6.0774400e-01   7.6132000e-01   9.6317900e-01   1.1634000e+00   1.4283700e+00   1.7405400e+00   1.9027300e+00   2.1682700e+00   2.4425500e+00   2.9702200e+00   3.0397500e+00   3.2517000e+00];
ax2=450.785+[1.4125100e+00   1.3290800e+00   1.1457300e+00   9.5405600e-01   7.9012300e-01   5.4551000e-01   1.9516800e-01  -4.0849000e-02  -3.6847800e-01  -6.6869800e-01  -9.6401600e-01  -1.2825500e+00  -1.5492400e+00  -1.8613900e+00  -2.1961800e+00  -2.3624300e+00  -2.6242800e+00  -2.8841500e+00  -3.3670100e+00  -3.4294200e+00  -3.6176200e+00];
ax3=-694.998+[-1.0848600e+00  -1.0703600e+00  -9.9111000e-01  -8.9008700e-01  -8.0115300e-01  -6.6387700e-01  -4.6059700e-01  -3.2490500e-01  -1.4382500e-01   1.5687500e-02   1.6555100e-01   3.1886400e-01   4.3962100e-01   5.7268900e-01   7.0651600e-01   7.7068600e-01   8.6841400e-01   9.5953100e-01   1.1143700e+00   1.1331500e+00   1.1871500e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_6P
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 4457
ay1=-9.37506+[-4.4025400e-01   5.5523000e-03   5.2324200e-01   1.1010200e+00   1.7560200e+00   2.2247200e+00   2.8714200e+00   3.5998300e+00   4.0106200e+00   4.5397500e+00   4.9218500e+00   5.3274000e+00   5.6429300e+00   5.9677100e+00   6.2414500e+00   6.5680300e+00   6.8455700e+00   7.0010100e+00   7.2553600e+00   7.4560900e+00   7.6230300e+00];
ay2=448.144+[2.2728400e+00   1.5936200e+00   1.0372600e+00   4.2488900e-01  -2.2774600e-01  -6.5194000e-01  -1.1903100e+00  -1.7165700e+00  -1.9845300e+00  -2.3011100e+00  -2.5165500e+00  -2.7388100e+00  -2.9099700e+00  -3.0902400e+00  -3.2489200e+00  -3.4523900e+00  -3.6353400e+00  -3.7429000e+00  -3.9341200e+00  -4.0948500e+00  -4.2380200e+00];
ay3=-689.149+[-1.2469200e-01  -1.2063800e+00  -9.5689800e-01  -6.5834200e-01  -3.7329700e-01  -2.1383200e-01  -3.7615400e-02   1.1277300e-01   1.8371400e-01   2.6623300e-01   3.2116200e-01   3.7596000e-01   4.1673700e-01   4.5714100e-01   4.9024900e-01   5.2801100e-01   5.5608000e-01   5.7134800e-01   5.9576000e-01   6.1456000e-01   6.3023000e-01];
% 20101
az1=-11.8681+[-4.2103300e-01  -1.3202200e-01   2.1245700e-01   6.1594300e-01   1.1011600e+00   1.4600200e+00   1.9632200e+00   2.5307900e+00   2.8519200e+00   3.2663600e+00   3.5644600e+00   3.8796000e+00   4.1247200e+00   4.3765100e+00   4.5903000e+00   4.8476300e+00   5.0696200e+00   5.1925400e+00   5.3925700e+00   5.5504000e+00   5.6815500e+00];
az2=447.151+[1.4902400e+00   9.5706800e-01   4.2487400e-01  -1.4384400e-01  -7.4126900e-01  -1.1299700e+00  -1.6238400e+00  -2.1090600e+00  -2.3602400e+00  -2.6627600e+00  -2.8712600e+00  -3.0879900e+00  -3.2565000e+00  -3.4342700e+00  -3.5912200e+00  -3.7915200e+00  -3.9699700e+00  -4.0745100e+00  -4.2594000e+00  -4.4141100e+00  -4.5507600e+00];
az3=-698.575+[6.4117900e-02  -8.7588100e-01  -6.2444500e-01  -3.2616600e-01  -4.6548700e-02   1.1074600e-01   2.8467100e-01   4.3543000e-01   5.0820400e-01   5.9462900e-01   6.5295000e-01   7.1133700e-01   7.5477800e-01   7.9724700e-01   8.3130400e-01   8.6911700e-01   8.9626500e-01   9.1110600e-01   9.3473900e-01   9.5304200e-01   9.6814900e-01];
% 9037
ba1=-7.50723+[-3.8442200e-01   1.0565900e-01   6.9018200e-01   1.3410300e+00   2.0684800e+00   2.5797300e+00   3.2766400e+00   4.0493800e+00   4.4831700e+00   5.0410500e+00   5.4440000e+00   5.8717400e+00   6.2045700e+00   6.5473700e+00   6.8366000e+00   7.1823300e+00   7.4764200e+00   7.6410700e+00   7.9110100e+00   8.1240100e+00   8.3012200e+00];
ba2=444.719+[2.2354000e+00   1.6249000e+00   1.1375400e+00   6.0852400e-01   4.6949600e-02  -3.1821800e-01  -7.8059800e-01  -1.2302500e+00  -1.4559500e+00  -1.7178200e+00  -1.8925500e+00  -2.0703100e+00  -2.2057400e+00  -2.3477900e+00  -2.4728300e+00  -2.6338500e+00  -2.7793800e+00  -2.8652200e+00  -3.0187500e+00  -3.1485500e+00  -3.2649200e+00];
ba3=-690.512+[5.7604800e-02  -1.1463000e+00  -9.7069600e-01  -7.5890400e-01  -5.6444400e-01  -4.6261800e-01  -3.5925200e-01  -2.8285600e-01  -2.5146600e-01  -2.1841400e-01  -1.9882700e-01  -1.8145100e-01  -1.6995100e-01  -1.6010900e-01  -1.5322100e-01  -1.4758600e-01  -1.4695300e-01  -1.4755800e-01  -1.5026800e-01  -1.5348400e-01  -1.5674300e-01];
% 21922
bb1=-12.9198+[-4.7547600e-01  -1.8788100e-01   1.3343600e-01   5.0393400e-01   9.5216200e-01   1.2901500e+00   1.7699400e+00   2.3216500e+00   2.6352700e+00   3.0404600e+00   3.3312800e+00   3.6381400e+00   3.8766900e+00   4.1210300e+00   4.3279600e+00   4.5761400e+00   4.7895200e+00   4.9076300e+00   5.0991000e+00   5.2500300e+00   5.3752900e+00];
bb2=450.785+[1.6834100e+00   1.0906000e+00   5.0482400e-01  -1.3413300e-01  -8.0972300e-01  -1.2486200e+00  -1.8057000e+00  -2.3515600e+00  -2.6346700e+00  -2.9765100e+00  -3.2132200e+00  -3.4604000e+00  -3.6531600e+00  -3.8569400e+00  -4.0369900e+00  -4.2668300e+00  -4.4720000e+00  -4.5919900e+00  -4.8041100e+00  -4.9814700e+00  -5.1381200e+00];
bb3=-694.998+[-1.6044100e-01  -1.0358000e+00  -7.3435100e-01  -3.7332300e-01  -2.7130000e-02   1.7214900e-01   3.9805600e-01   5.9898700e-01   6.9774200e-01   8.1548300e-01   8.9559300e-01   9.7695600e-01   1.0383900e+00   1.0997400e+00   1.1502700e+00   1.2086600e+00   1.2539700e+00   1.2792500e+00   1.3210300e+00   1.3542900e+00   1.3824900e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_6P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 4457
bc1=-9.37506+[4.0951700e-01   4.4637200e-01   5.4441800e-01   6.6274400e-01   8.1481600e-01   9.4770600e-01   1.1720400e+00   1.3959900e+00   1.6965300e+00   1.9904800e+00   2.3181100e+00   2.6055700e+00   2.9803500e+00   3.2736600e+00   3.8543500e+00   4.0842800e+00   4.5019500e+00   4.7540400e+00   5.1671800e+00   5.4668000e+00   5.7646400e+00];
bc2=448.144+[2.2612600e+00   2.1464700e+00   1.9186400e+00   1.6915900e+00   1.4295100e+00   1.2161200e+00   8.8615000e-01   5.8997300e-01   2.3732300e-01  -6.3229700e-02  -3.5761200e-01  -5.9656000e-01  -8.8297100e-01  -1.0924300e+00  -1.4857700e+00  -1.6365700e+00  -1.9054700e+00  -2.0652900e+00  -2.3237100e+00  -2.5090900e+00  -2.6920000e+00];
bc3=-689.149+[-8.5921900e-01  -8.2703800e-01  -7.1608600e-01  -5.9362100e-01  -4.4771900e-01  -3.2897500e-01  -1.4969600e-01   3.6006300e-03   1.7586400e-01   3.1087000e-01   4.3113900e-01   5.2209100e-01   6.2243800e-01   6.8928500e-01   8.0012100e-01   8.3821600e-01   8.9982900e-01   9.3278300e-01   9.7878500e-01   1.0062100e+00   1.0296700e+00];
% 20101
bd1=-11.8681+[2.4412800e-01   2.6561300e-01   3.1490200e-01   3.7621200e-01   4.5864500e-01   5.3291700e-01   6.6650500e-01   8.0981300e-01   1.0162400e+00   1.2284800e+00   1.4730500e+00   1.6924200e+00   1.9849900e+00   2.2142900e+00   2.6704700e+00   2.8522900e+00   3.1853400e+00   3.3865100e+00   3.7166400e+00   3.9565700e+00   4.1953900e+00];
bd2=447.151+[1.4800000e+00   1.3814200e+00   1.1694500e+00   9.5372700e-01   7.0528700e-01   5.0398800e-01   1.9798700e-01  -7.4211400e-02  -3.9744700e-01  -6.7532500e-01  -9.5135300e-01  -1.1790400e+00  -1.4581200e+00  -1.6632500e+00  -2.0471500e+00  -2.1945200e+00  -2.4576900e+00  -2.6135600e+00  -2.8648600e+00  -3.0451800e+00  -3.2234200e+00];
bd3=-698.575+[-6.3160100e-01  -6.1477500e-01  -5.2605800e-01  -4.1728300e-01  -2.8230900e-01  -1.7097700e-01  -3.9193400e-03   1.3685100e-01   2.9365400e-01   4.1657300e-01   5.2802600e-01   6.1393600e-01   7.1206400e-01   7.7962000e-01   8.9541800e-01   9.3677100e-01   1.0056900e+00   1.0435800e+00   1.0984900e+00   1.1332600e+00   1.1647300e+00];
% 9037
be1=-7.50723+[4.8159700e-01   5.3389100e-01   6.7203400e-01   8.3161000e-01   1.0301000e+00   1.1994900e+00   1.4776900e+00   1.7476600e+00   2.0996300e+00   2.4344500e+00   2.7993500e+00   3.1155800e+00   3.5226700e+00   3.8379000e+00   4.4564500e+00   4.6999900e+00   5.1408300e+00   5.4060300e+00   5.8394400e+00   6.1529600e+00   6.4639900e+00];
be2=444.719+[2.2426500e+00   2.1407400e+00   1.9465000e+00   1.7558200e+00   1.5371800e+00   1.3599000e+00   1.0868800e+00   8.4249200e-01   5.5172400e-01   3.0379200e-01   6.0555100e-02  -1.3679800e-01  -3.7373300e-01  -5.4719900e-01  -8.7251800e-01  -9.9694900e-01  -1.2184100e+00  -1.3497400e+00  -1.5614500e+00  -1.7128500e+00  -1.8619200e+00];
be3=-690.512+[-7.0677700e-01  -6.8678800e-01  -6.0526300e-01  -5.1476800e-01  -4.0744700e-01  -3.2094200e-01  -1.9283800e-01  -8.5333000e-02   3.2844100e-02   1.2235200e-01   1.9866500e-01   2.5429700e-01   3.1285000e-01   3.4898800e-01   4.0099300e-01   4.1625200e-01   4.3691600e-01   4.4533200e-01   4.5130700e-01   4.4985900e-01   4.4479800e-01];
% 21922
bf1=-12.9198+[2.1334200e-01   2.2715100e-01   2.5467400e-01   2.9260500e-01   3.4791000e-01   4.0058100e-01   5.0130300e-01   6.1572200e-01   7.9029500e-01   9.7819600e-01   1.2016600e+00   1.4054900e+00   1.6820700e+00   1.9012100e+00   2.3409000e+00   2.5170100e+00   2.8406600e+00   3.0366500e+00   3.3589300e+00   3.5936100e+00   3.8275600e+00];
bf2=450.785+[1.6817900e+00   1.5741100e+00   1.3390800e+00   1.0971600e+00   8.1604200e-01   5.8692100e-01   2.3572500e-01  -7.7512800e-02  -4.4943200e-01  -7.6782100e-01  -1.0825000e+00  -1.3410400e+00  -1.6565800e+00  -1.8879300e+00  -2.3217200e+00  -2.4886800e+00  -2.7873600e+00  -2.9645300e+00  -3.2504200e+00  -3.4557600e+00  -3.6588200e+00];
bf3=-694.998+[-8.5956700e-01  -8.3520400e-01  -7.2814900e-01  -5.9832500e-01  -4.3690900e-01  -3.0307400e-01  -9.9631600e-02   7.3481800e-02   2.6815000e-01   4.2230100e-01   5.6344200e-01   6.7294100e-01   7.9921000e-01   8.8711600e-01   1.0418900e+00   1.0985400e+00   1.1951300e+00   1.2495100e+00   1.3310000e+00   1.3848400e+00   1.4350800e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_6P
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 4457
bg1=-9.37506+[-3.0019200e-01  -2.3709800e-01  -1.2655300e-01  -7.8967400e-03   1.6274800e-01   2.5167600e-01   4.4913800e-01   6.7178000e-01   9.2937200e-01   1.2079400e+00   1.6601800e+00   1.8111000e+00   2.3258300e+00   2.5105000e+00   2.9878100e+00   3.2514500e+00   3.7247600e+00   3.9882900e+00   4.4106100e+00   4.7604400e+00   5.0919000e+00];
bg2=448.144+[2.4402900e+00   2.3282200e+00   2.1335300e+00   1.9386500e+00   1.6755800e+00   1.5458200e+00   1.2710700e+00   9.8144000e-01   6.7442700e-01   3.7400300e-01  -4.8431100e-02  -1.7775400e-01  -5.7933600e-01  -7.1265200e-01  -1.0398500e+00  -1.2142300e+00  -1.5189200e+00  -1.6853900e+00  -1.9478500e+00  -2.1617100e+00  -2.3620700e+00];
bg3=-689.149+[-6.9515600e-01  -8.2088400e-01  -7.9559800e-01  -7.0980600e-01  -5.7481300e-01  -5.0327100e-01  -3.4743100e-01  -1.8396300e-01  -1.7415200e-02   1.3642500e-01   3.3464100e-01   3.9205400e-01   5.5466700e-01   6.0458300e-01   7.1717700e-01   7.7185700e-01   8.5680300e-01   8.9891800e-01   9.5838600e-01   1.0000200e+00   1.0333900e+00];
% 20101
bh1=-11.8681+[-2.9902300e-01  -2.6530200e-01  -2.0781500e-01  -1.4531000e-01  -5.3295600e-02  -4.0113200e-03   1.1027100e-01   2.4486800e-01   4.1138600e-01   6.0220300e-01   9.3220700e-01   1.0459000e+00   1.4432500e+00   1.5870400e+00   1.9616900e+00   2.1706200e+00   2.5471200e+00   2.7574400e+00   3.0952200e+00   3.3761000e+00   3.6430300e+00];
bh2=447.151+[1.7507100e+00   1.6454900e+00   1.4422000e+00   1.2419300e+00   9.7785200e-01   8.5080100e-01   5.8697300e-01   3.1511700e-01   3.0927200e-02  -2.4640400e-01  -6.4341700e-01  -7.6691500e-01  -1.1586700e+00  -1.2901500e+00  -1.6148700e+00  -1.7881700e+00  -2.0894400e+00  -2.2534300e+00  -2.5105400e+00  -2.7198500e+00  -2.9159500e+00];
bh3=-698.575+[-5.5128000e-01  -6.7032500e-01  -6.5551400e-01  -5.7827600e-01  -4.5300800e-01  -3.8567400e-01  -2.3738200e-01  -8.4050400e-02   7.0251400e-02   2.1120500e-01   3.9509300e-01   4.4908800e-01   6.0615700e-01   6.5593900e-01   7.7132900e-01   8.2887700e-01   9.2129500e-01   9.6841000e-01   1.0369300e+00   1.0870100e+00   1.1291500e+00];
% 9037
bi1=-7.50723+[-2.4777100e-01  -1.7087000e-01  -2.1975100e-02   1.3597700e-01   3.5784100e-01   4.7096100e-01   7.1728600e-01   9.8858200e-01   1.2946200e+00   1.6179000e+00   2.1286700e+00   2.2965800e+00   2.8610200e+00   3.0610100e+00   3.5734200e+00   3.8544400e+00   4.3559600e+00   4.6340400e+00   5.0780900e+00   5.4447000e+00   5.7911100e+00];
bi2=444.719+[2.4035900e+00   2.3034500e+00   2.1376600e+00   1.9744400e+00   1.7556000e+00   1.6481100e+00   1.4212200e+00   1.1828100e+00   9.3053500e-01   6.8392300e-01   3.3673700e-01   2.3047700e-01  -1.0008400e-01  -2.1000600e-01  -4.8028400e-01  -6.2438900e-01  -8.7608900e-01  -1.0133300e+00  -1.2292800e+00  -1.4048100e+00  -1.5689300e+00];
bi3=-690.512+[-5.2198300e-01  -6.6058500e-01  -6.5622300e-01  -5.9498800e-01  -4.9605400e-01  -4.4347800e-01  -3.2968700e-01  -2.1175400e-01  -9.3911700e-02   1.2664200e-02   1.4642000e-01   1.8434200e-01   2.8770300e-01   3.1803000e-01   3.8268200e-01   4.1165400e-01   4.5103100e-01   4.6794700e-01   4.8726500e-01   4.9599800e-01   4.9839300e-01];
% 21922
bk1=-12.9198+[-3.4854100e-01  -3.1802900e-01  -2.7916500e-01  -2.3738800e-01  -1.7348800e-01  -1.3783800e-01  -5.1652700e-02   5.4126600e-02   1.9197400e-01   3.5644600e-01   6.5286700e-01   7.5716800e-01   1.1286900e+00   1.2649900e+00   1.6233100e+00   1.8245800e+00   2.1892600e+00   2.3936900e+00   2.7229500e+00   2.9974500e+00   3.2589200e+00];
bk2=450.785+[1.9490300e+00   1.8390700e+00   1.6210600e+00   1.4014100e+00   1.1076900e+00   9.6462200e-01   6.6445300e-01   3.5293800e-01   2.6064200e-02  -2.9267800e-01  -7.4632400e-01  -8.8691600e-01  -1.3305000e+00  -1.4788400e+00  -1.8443100e+00  -2.0395500e+00  -2.3799200e+00  -2.5656000e+00  -2.8571800e+00  -3.0947400e+00  -3.3175300e+00];
bk3=-694.998+[-7.8074900e-01  -8.9592500e-01  -8.7140300e-01  -7.7992000e-01  -6.3192300e-01  -5.5195200e-01  -3.7444500e-01  -1.8939200e-01  -1.1642600e-03   1.7221300e-01   3.9964500e-01   4.6670600e-01   6.6339500e-01   7.2612100e-01   8.7294200e-01   9.4754700e-01   1.0705600e+00   1.1346100e+00   1.2299500e+00   1.3018500e+00   1.3645100e+00];
  
xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (6P)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (6P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')