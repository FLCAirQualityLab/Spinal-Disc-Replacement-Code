%% foreman height and width narrowing/widening 

% 4N!!

% for all models for the c3-c4 left hand side foreman under lateral bending (_n)
% 1297,16439,17116,14886

% Values for displacements have not been replaced. base coordinates have,
% but need checking. 
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 1297,16439,17116,14886
%% model15_intact_TLC_4N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 1297
aa1=12.7746+[4.8745400e-01   5.8675100e-01   6.2998300e-01   6.4856900e-01   6.5775400e-01   6.5996500e-01   6.5997500e-01   6.5002100e-01   6.3675200e-01   6.1751200e-01   5.9422900e-01   5.6819100e-01   5.6079800e-01   5.8772100e-01   6.2021700e-01   6.3125900e-01   6.2683700e-01   5.8468700e-01   5.1659400e-01   4.5422900e-01   3.9182000e-01];
aa2=447.736+[1.5391800e+00   1.5667300e+00   1.9870700e+00   2.7076600e+00   3.6601600e+00   4.8026900e+00   6.1363900e+00   7.5417900e+00   8.9454600e+00   1.0393600e+01   1.1814600e+01   1.3288000e+01   1.4732100e+01   1.6201800e+01   1.7470100e+01   1.8737000e+01   1.9869800e+01   2.0859800e+01   2.1770800e+01   2.2511300e+01   2.3233200e+01];
aa3=-690.116+[-1.1235400e+00  -1.1748700e+00  -1.2322000e+00  -1.3155400e+00  -1.4341100e+00  -1.5950700e+00  -1.8252100e+00  -2.1161800e+00  -2.4450500e+00  -2.8210700e+00  -3.2359800e+00  -3.7160600e+00  -4.2409800e+00  -4.8383600e+00  -5.4163500e+00  -6.0458200e+00  -6.6548500e+00  -7.2189400e+00  -7.7642900e+00  -8.2298800e+00  -8.7020800e+00];

% 16439
ab1=13.5613+[3.1910900e-01   4.0347900e-01   4.4405300e-01   4.6240300e-01   4.7200100e-01   4.7788700e-01   4.8632300e-01   4.8834600e-01   4.8947900e-01   4.8832600e-01   4.8448800e-01   4.7992100e-01   4.9006400e-01   5.2886100e-01   5.6673400e-01   5.8882300e-01   5.9750400e-01   5.7187300e-01   5.1977600e-01   4.7169800e-01   4.2302900e-01];
ab2=447.206+[1.0864800e+00   1.0267900e+00   1.2840400e+00   1.7906300e+00   2.5018100e+00   3.3789500e+00   4.4120600e+00   5.5074000e+00   6.6097800e+00   7.7515500e+00   8.8728800e+00   1.0040800e+01   1.1197200e+01   1.2381900e+01   1.3402700e+01   1.4415500e+01   1.5314800e+01   1.6094600e+01   1.6807900e+01   1.7382700e+01   1.7941900e+01];
ab3=-699.132+[-9.9227400e-01  -1.0435600e+00  -1.0914900e+00  -1.1559200e+00  -1.2434500e+00  -1.3599900e+00  -1.5278200e+00  -1.7388700e+00  -1.9768600e+00  -2.2480100e+00  -2.5460100e+00  -2.8927800e+00  -3.2805200e+00  -3.7286200e+00  -4.1638800e+00  -4.6303400e+00  -5.0770300e+00  -5.4827500e+00  -5.8672100e+00  -6.1892600e+00  -6.5122700e+00];

% 17116
ac1=16.2684+[3.1756800e-01   4.0304100e-01   4.4254800e-01   4.5811700e-01   4.6348300e-01   4.6436800e-01   4.6779900e-01   4.6466000e-01   4.6092300e-01   4.5527300e-01   4.4688800e-01   4.3705500e-01   4.4228200e-01   4.7496900e-01   5.0774300e-01   5.2437600e-01   5.2828500e-01   4.9865300e-01   4.4227900e-01   3.9050200e-01   3.3801100e-01];
ac2=443.597+[1.2257500e+00   1.1810200e+00   1.4724500e+00   2.0267500e+00   2.7960600e+00   3.7386700e+00   4.8442300e+00   6.0122800e+00   7.1829700e+00   8.3902500e+00   9.5722000e+00   1.0799800e+01   1.2012300e+01   1.3253200e+01   1.4321700e+01   1.5379800e+01   1.6318100e+01   1.7130100e+01   1.7872200e+01   1.8469800e+01   1.9050500e+01];
ac3=-706.266+[-1.1326600e+00  -1.2015100e+00  -1.2863000e+00  -1.4023700e+00  -1.5544800e+00  -1.7470500e+00  -2.0045600e+00  -2.3113500e+00  -2.6453200e+00  -3.0150900e+00  -3.4101500e+00  -3.8582600e+00  -4.3481600e+00  -4.9052600e+00  -5.4401300e+00  -6.0084100e+00  -6.5496800e+00  -7.0400600e+00  -7.5041100e+00  -7.8928800e+00  -8.2828200e+00];

% 14886
ad1=9.91704+[5.2208400e-01   6.2303000e-01   6.6862400e-01   6.9107000e-01   7.0543700e-01   7.1343800e-01   7.1920400e-01   7.1491200e-01   7.0636300e-01   6.9076700e-01   6.7122500e-01   6.4959700e-01   6.4649700e-01   6.8016800e-01   7.1940900e-01   7.3732700e-01   7.3840200e-01   6.9986100e-01   6.3535000e-01   5.7606400e-01   5.1711400e-01];
ad2=444.847+[1.4321600e+00   1.4392400e+00   1.8275700e+00   2.5074900e+00   3.4148900e+00   4.5100800e+00   5.7941500e+00   7.1520700e+00   8.5138200e+00   9.9242900e+00   1.1312000e+01   1.2754500e+01   1.4172000e+01   1.5616100e+01   1.6864000e+01   1.8113600e+01   1.9234100e+01   2.0216400e+01   2.1122200e+01   2.1860000e+01   2.2580400e+01];
ad3=-691.954+[-1.0061900e+00  -1.0254200e+00  -1.0297300e+00  -1.0436600e+00  -1.0818900e+00  -1.1525700e+00  -1.2786700e+00  -1.4600800e+00  -1.6807900e+00  -1.9465100e+00  -2.2525400e+00  -2.6198200e+00  -3.0337300e+00  -3.5141000e+00  -3.9854200e+00  -4.5047500e+00  -5.0116700e+00  -5.4841500e+00  -5.9421600e+00  -6.3335800e+00  -6.7307500e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 1297
ae1=12.7746+[-3.0399900e-01  -2.1365700e-01  -1.1385600e-01  -2.2127500e-02   2.2280600e-02   8.6838200e-02   1.4440500e-01   1.8970400e-01   2.2976300e-01   2.5163400e-01   2.6423100e-01   2.6615900e-01   2.6107500e-01   2.4140800e-01   2.1325100e-01   1.7367000e-01   1.2563800e-01   7.9914500e-02   1.0545900e-02  -5.5386800e-02  -1.3278600e-01];
ae2=447.736+[2.4876100e+00   2.5082800e+00   2.7304000e+00   3.0334000e+00   3.2115000e+00   3.5421200e+00   3.9693500e+00   4.4511200e+00   5.0902100e+00   5.6890900e+00   6.3867100e+00   7.0106200e+00   7.7138600e+00   8.6196600e+00   9.4158200e+00   1.0296800e+01   1.1200200e+01   1.1968200e+01   1.3003700e+01   1.3870900e+01   1.4851200e+01];
ae3=-690.116+[-1.1890200e+00  -1.4710600e+00  -1.6165900e+00  -1.7256700e+00  -1.7792000e+00  -1.8692700e+00  -1.9775400e+00  -2.0954400e+00  -2.2481400e+00  -2.3935100e+00  -2.5685500e+00  -2.7292100e+00  -2.9165400e+00  -3.1628000e+00  -3.3909400e+00  -3.6539100e+00  -3.9371200e+00  -4.1923000e+00  -4.5643700e+00  -4.8977900e+00  -5.2936500e+00];

% 16439
af1=13.5613+[-3.2124000e-01  -2.5850000e-01  -1.8330700e-01  -1.1429200e-01  -7.8923900e-02  -2.3628000e-02   2.9947900e-02   7.2033400e-02   1.1056100e-01   1.3541300e-01   1.5513800e-01   1.6573400e-01   1.7121500e-01   1.6747400e-01   1.5622900e-01   1.3693300e-01   1.1069500e-01   8.2157600e-02   3.5511300e-02  -9.4938100e-03  -6.3799500e-02];
af2=447.206+[1.8134300e+00   1.7480200e+00   1.7939200e+00   1.9151800e+00   2.0002700e+00   2.1764700e+00   2.4308700e+00   2.7445500e+00   3.1788800e+00   3.5900700e+00   4.0700600e+00   4.5093500e+00   5.0137500e+00   5.6640300e+00   6.2391400e+00   6.8862800e+00   7.5605400e+00   8.1394100e+00   8.9260200e+00   9.5898400e+00   1.0345900e+01];
af3=-699.132+[-9.0469200e-01  -1.1688900e+00  -1.3059600e+00  -1.4068100e+00  -1.4552100e+00  -1.5330600e+00  -1.6190300e+00  -1.7053400e+00  -1.8133300e+00  -1.9105200e+00  -2.0215100e+00  -2.1229500e+00  -2.2409700e+00  -2.3863400e+00  -2.5158800e+00  -2.6644500e+00  -2.8259300e+00  -2.9721000e+00  -3.1890500e+00  -3.3851300e+00  -3.6190000e+00];

% 17116
ag1=16.2684+[-3.4470400e-01  -2.7918100e-01  -2.0296000e-01  -1.3388000e-01  -9.8554300e-02  -4.3377800e-02   9.2481600e-03   4.9454100e-02   8.5397100e-02   1.0785700e-01   1.2474500e-01   1.3278600e-01   1.3549500e-01   1.2826400e-01   1.1385100e-01   9.0859700e-02   6.1053200e-02   2.9646400e-02  -2.0646800e-02  -6.8719300e-02  -1.2638300e-01];
ag2=449.981+[1.9898500e+00   1.9402100e+00   2.0218000e+00   2.1797700e+00   2.2840100e+00   2.4914200e+00   2.7815300e+00   3.1330600e+00   3.6139100e+00   4.0654000e+00   4.5894000e+00   5.0667000e+00   5.6126800e+00   6.3153300e+00   6.9341900e+00   7.6275900e+00   8.3465900e+00   8.9615900e+00   9.7944900e+00   1.0495100e+01   1.1290400e+01];
ag3=-696.273+[-1.0629800e+00  -1.3477300e+00  -1.5264300e+00  -1.6701800e+00  -1.7413900e+00  -1.8571000e+00  -1.9865700e+00  -2.1192600e+00  -2.2859200e+00  -2.4356700e+00  -2.6060000e+00  -2.7605500e+00  -2.9389200e+00  -3.1642100e+00  -3.3636300e+00  -3.5894200e+00  -3.8297500e+00  -4.0429700e+00  -4.3508700e+00  -4.6235700e+00  -4.9440300e+00];

% 14886
ah1=9.91704+[-2.6361700e-01  -1.7208500e-01  -6.9625500e-02   2.5471800e-02   7.1536100e-02   1.3871700e-01   1.9992300e-01   2.4944200e-01   2.9440100e-01   3.2037800e-01   3.3741000e-01   3.4280000e-01   3.4108200e-01   3.2527400e-01   3.0035600e-01   2.6395400e-01   2.1851300e-01   1.7454500e-01   1.0699100e-01   4.2400400e-02  -3.3675600e-02];
ah2=448.847+[2.3816500e+00   2.3813500e+00   2.5648500e+00   2.8293600e+00   2.9883500e+00   3.2886900e+00   3.6831700e+00   4.1337700e+00   4.7370600e+00   5.3059900e+00   5.9718700e+00   6.5702800e+00   7.2475100e+00   8.1225000e+00   8.8943200e+00   9.7517200e+00   1.0634400e+01   1.1387200e+01   1.2405300e+01   1.3260400e+01   1.4229700e+01];
ah3=-691.954+[-1.0819800e+00  -1.3306000e+00  -1.4119900e+00  -1.4552300e+00  -1.4747100e+00  -1.5087800e+00  -1.5547100e+00  -1.6114500e+00  -1.6895400e+00  -1.7680900e+00  -1.8672800e+00  -1.9623400e+00  -2.0774500e+00  -2.2295100e+00  -2.3756700e+00  -2.5502300e+00  -2.7450000e+00  -2.9258500e+00  -3.1981400e+00  -3.4483900e+00  -3.7507500e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4N
t2=[2 2.05126 2.11533 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 1297
ai1=12.7746+[-1.7128900e-01  -8.8164100e-02   4.5072000e-03   8.9306500e-02   1.3015900e-01   1.8703300e-01   2.3213600e-01   2.7457000e-01   3.0187500e-01   3.1464600e-01   3.2275100e-01   3.1708800e-01   3.0058400e-01   2.6934100e-01   2.3010100e-01   1.7768100e-01   1.1919200e-01   5.1150900e-02  -3.0405800e-02  -1.0882200e-01  -2.0216700e-01];
ai2=447.736+[2.9455100e+00   2.9427700e+00   3.1435200e+00   3.4350500e+00   3.6115000e+00   3.9439200e+00   4.3446900e+00   4.9048300e+00   5.4995400e+00   5.9943200e+00   6.7456400e+00   7.4790400e+00   8.2577000e+00   9.1807600e+00   1.0063100e+01   1.1055400e+01   1.1992300e+01   1.2981100e+01   1.4046300e+01   1.4961500e+01   1.5978700e+01];
ai3=-690.116+[-1.4399000e+00  -1.6152200e+00  -1.7285100e+00  -1.8271600e+00  -1.8794400e+00  -1.9706400e+00  -2.0740100e+00  -2.2126500e+00  -2.3563800e+00  -2.4769300e+00  -2.6510600e+00  -2.7835500e+00  -2.9169900e+00  -3.0924700e+00  -3.2854000e+00  -3.5292100e+00  -3.7893600e+00  -4.0964600e+00  -4.4690100e+00  -4.8184500e+00  -5.2368300e+00];

% 16439
aj1=13.5613+[-2.2044400e-01  -1.6093200e-01  -9.1282300e-02  -2.6503500e-02   6.4047400e-03   5.6218300e-02   9.9823100e-02   1.4096200e-01   1.6905500e-01   1.8627100e-01   2.0360800e-01   2.0746200e-01   2.0321700e-01   1.9024500e-01   1.7006900e-01   1.4048700e-01   1.0417700e-01   5.8919900e-02   2.3127700e-04  -5.6368500e-02  -1.2613700e-01];
aj2=447.206+[2.1526800e+00   2.0836400e+00   2.1232800e+00   2.2403500e+00   2.3242400e+00   2.5024700e+00   2.7398600e+00   3.1042800e+00   3.5084500e+00   3.8468400e+00   4.3532000e+00   4.8300500e+00   5.3338500e+00   5.9338100e+00   6.5100800e+00   7.1646300e+00   7.7915400e+00   8.4618200e+00   9.2007100e+00   9.8512400e+00   1.0586300e+01];
aj3=-699.132+[-1.1264800e+00  -1.2958400e+00  -1.4034000e+00  -1.4939000e+00  -1.5402900e+00  -1.6179900e+00  -1.6982100e+00  -1.7976300e+00  -1.8971300e+00  -1.9758600e+00  -2.0744200e+00  -2.1187300e+00  -2.1471500e+00  -2.1825400e+00  -2.2245100e+00  -2.2821700e+00  -2.3524600e+00  -2.4427500e+00  -2.5678700e+00  -2.6960100e+00  -2.8577700e+00];

% 17116
ak1=16.2684+[-2.4201000e-01  -1.8086600e-01  -1.1116400e-01  -4.6880500e-02  -1.4139600e-02   3.5151000e-02   7.7525100e-02   1.1633000e-01   1.4190200e-01   1.5705100e-01   1.7143500e-01   1.7257200e-01   1.6503800e-01   1.4818900e-01   1.2448600e-01   9.1094500e-02   5.1492300e-02   3.0375700e-03  -5.8229900e-02  -1.1687600e-01  -1.8845700e-01];
ak2=449.981+[2.3669000e+00   2.3098600e+00   2.3817800e+00   2.5336300e+00   2.6360300e+00   2.8450200e+00   3.1159500e+00   3.5240300e+00   3.9709600e+00   4.3426300e+00   4.8992700e+00   5.4313700e+00   5.9948300e+00   6.6626000e+00   7.3002600e+00   8.0207300e+00   8.7059000e+00   9.4328800e+00   1.0225500e+01   1.0916700e+01   1.1691800e+01];
ak3=-696.273+[-1.3288600e+00  -1.5137500e+00  -1.6589700e+00  -1.7904900e+00  -1.8592900e+00  -1.9747100e+00  -2.0962200e+00  -2.2501000e+00  -2.4046300e+00  -2.5275000e+00  -2.6956400e+00  -2.8212300e+00  -2.9421400e+00  -3.0900100e+00  -3.2419400e+00  -3.4279000e+00  -3.6226000e+00  -3.8464000e+00  -4.1137700e+00  -4.3621100e+00  -4.6577900e+00];

% 14886
al1=9.91704+[-1.2909300e-01  -4.3783000e-02   5.2490000e-02   1.4108600e-01   1.8368200e-01   2.4347100e-01   2.9227100e-01   3.3957800e-01   3.7131800e-01   3.8741000e-01   3.9987600e-01   3.9782100e-01   3.8505000e-01   3.5776000e-01   3.2179400e-01   2.7238800e-01   2.1605800e-01   1.4965000e-01   6.8800000e-02  -9.3284500e-03  -1.0293900e-01];
al2=444.847+[2.8113300e+00   2.7900200e+00   2.9547100e+00   3.2095300e+00   3.3674000e+00   3.6701600e+00   4.0406400e+00   4.5656300e+00   5.1282600e+00   5.5988700e+00   6.3157500e+00   7.0155400e+00   7.7608300e+00   8.6489500e+00   9.5025800e+00   1.0468200e+01   1.1385500e+01   1.2359500e+01   1.3415700e+01   1.4328200e+01   1.5347800e+01];
al3=-691.954+[-1.2862800e+00  -1.4328900e+00  -1.4863300e+00  -1.5213500e+00  -1.5398100e+00  -1.5751100e+00  -1.6197300e+00  -1.6872800e+00  -1.7617300e+00  -1.8267000e+00  -1.9147600e+00  -1.9530100e+00  -1.9826000e+00  -2.0336100e+00  -2.1062300e+00  -2.2130000e+00  -2.3431000e+00  -2.5126200e+00  -2.7396400e+00  -2.9673700e+00  -3.2517300e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 1297
am1=12.7746+[3.3679900e-01   3.6246200e-01   3.8931700e-01   4.1074100e-01   4.2745600e-01   4.4602600e-01   4.5849500e-01   4.6517600e-01   4.7009300e-01   4.7189100e-01   4.6909900e-01   4.6131000e-01   4.5199900e-01   4.3868300e-01   4.1723300e-01   3.8582900e-01   3.5294900e-01   3.1412700e-01   2.6336400e-01   2.1364400e-01   1.7270000e-01];
am2=447.736+[2.5609300e+00   2.5672600e+00   2.6989900e+00   2.8726700e+00   3.0246800e+00   3.2517600e+00   3.5425500e+00   3.8471700e+00   4.2003000e+00   4.6448500e+00   5.0707000e+00   5.6029500e+00   6.0650100e+00   6.5774600e+00   7.1591800e+00   7.8195400e+00   8.4292400e+00   9.0760900e+00   9.8773900e+00   1.0603000e+01   1.1154900e+01];
am3=-690.116+[-1.7303000e+00  -1.7499000e+00  -1.7844900e+00  -1.8227000e+00  -1.8562900e+00  -1.9075000e+00  -1.9738000e+00  -2.0458500e+00  -2.1265600e+00  -2.2270600e+00  -2.3253300e+00  -2.4506800e+00  -2.5614400e+00  -2.6847500e+00  -2.8280600e+00  -3.0003800e+00  -3.1675000e+00  -3.3537000e+00  -3.5992200e+00  -3.8360300e+00  -4.0255800e+00];
% 16439
an1=13.5613+[1.6922800e-01   1.8986900e-01   2.1398500e-01   2.3122300e-01   2.4448600e-01   2.6159300e-01   2.7891400e-01   2.8993500e-01   2.9946600e-01   3.0709800e-01   3.1206300e-01   3.1661100e-01   3.1793800e-01   3.1572900e-01   3.0799700e-01   2.9501300e-01   2.7895400e-01   2.5927500e-01   2.3004000e-01   1.9896200e-01   1.7251600e-01];
an2=447.206+[1.8377900e+00   1.8013500e+00   1.8113800e+00   1.8615800e+00   1.9146500e+00   2.0072500e+00   2.1462400e+00   2.3144000e+00   2.5258900e+00   2.8032600e+00   3.0713000e+00   3.4124200e+00   3.7205200e+00   4.0670500e+00   4.4623700e+00   4.9156400e+00   5.3419900e+00   5.8000000e+00   6.3730700e+00   6.8975800e+00   7.2999300e+00];
an3=-699.132+[-1.4183800e+00  -1.4455600e+00  -1.4828900e+00  -1.5198300e+00  -1.5521800e+00  -1.5985800e+00  -1.6534400e+00  -1.7045400e+00  -1.7599900e+00  -1.8261800e+00  -1.8864900e+00  -1.9599000e+00  -2.0253900e+00  -2.0956000e+00  -2.1718100e+00  -2.2600800e+00  -2.3460700e+00  -2.4422100e+00  -2.5679700e+00  -2.6907700e+00  -2.7904800e+00];
% 17116
ao1=16.2684+[1.5435300e-01   1.7513600e-01   1.9841900e-01   2.1489700e-01   2.2758600e-01   2.4391200e-01   2.5994300e-01   2.6937700e-01   2.7716400e-01   2.8275100e-01   2.8589600e-01   2.8809000e-01   2.8733200e-01   2.8304200e-01   2.7306900e-01   2.5756300e-01   2.3912500e-01   2.1692100e-01   1.8488700e-01   1.5136200e-01   1.2298900e-01];
ao2=449.981+[2.0571100e+00   2.0251300e+00   2.0543600e+00   2.1253100e+00   2.1958300e+00   2.3125000e+00   2.4789300e+00   2.6737800e+00   2.9145500e+00   3.2260200e+00   3.5241800e+00   3.9010800e+00   4.2395200e+00   4.6193900e+00   5.0514500e+00   5.5446600e+00   6.0070000e+00   6.5018800e+00   7.1184100e+00   7.6806900e+00   8.1109000e+00];
ao3=-696.273+[-1.6334300e+00  -1.6659900e+00  -1.7248700e+00  -1.7854100e+00  -1.8379800e+00  -1.9128500e+00  -2.0003900e+00  -2.0834100e+00  -2.1745600e+00  -2.2834100e+00  -2.3824100e+00  -2.5029200e+00  -2.6094400e+00  -2.7264500e+00  -2.8560700e+00  -3.0045700e+00  -3.1468100e+00  -3.3027900e+00  -3.5025900e+00  -3.6929700e+00  -3.8444500e+00];
% 14886
ap1=9.91704+[3.8729600e-01   4.1429500e-01   4.4337800e-01   4.6692800e-01   4.8535200e-01   5.0609000e-01   5.2131300e-01   5.3087600e-01   5.3877900e-01   5.4381000e-01   5.4388700e-01   5.3954300e-01   5.3288300e-01   5.2201300e-01   5.0297600e-01   4.7413000e-01   4.4333000e-01   4.0630700e-01   3.5702600e-01   3.0833700e-01   2.6817900e-01];
ap2=444.847+[2.4108500e+00   2.4057700e+00   2.5125900e+00   2.6623100e+00   2.7950800e+00   2.9970300e+00   3.2605000e+00   3.5411800e+00   3.8699700e+00   4.2874100e+00   4.6895800e+00   5.1947300e+00   5.6355300e+00   6.1260600e+00   6.6846800e+00   7.3211300e+00   7.9108700e+00   8.5387200e+00   9.3194000e+00   1.0028600e+01   1.0569200e+01];
ap3=-691.954+[-1.5620500e+00  -1.5641800e+00  -1.5575000e+00  -1.5546000e+00  -1.5542500e+00  -1.5594700e+00  -1.5742800e+00  -1.6001600e+00  -1.6320100e+00  -1.6751600e+00  -1.7207100e+00  -1.7825000e+00  -1.8404800e+00  -1.9055700e+00  -1.9829300e+00  -2.0816400e+00  -2.1820400e+00  -2.2985500e+00  -2.4586900e+00  -2.6186700e+00  -2.7500100e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 1297
aq1=12.7746+[-4.3484900e-01   6.8773500e-01   7.8461100e-01   7.8240600e-01   7.5804900e-01   7.2282300e-01   6.6002300e-01   5.9106800e-01   5.3234500e-01   4.4989200e-01   3.4633400e-01   2.6839700e-01   1.9040300e-01   1.1735300e-01   2.2308600e-02  -6.5317800e-02  -1.4974400e-01  -2.3090600e-01  -2.9971800e-01  -3.5961600e-01  -4.1647300e-01];
aq2=447.736+[2.5760800e+00   2.2434500e+00   3.5356600e+00   4.9426900e+00   6.6638400e+00   8.4136800e+00   1.0446600e+01   1.2270200e+01   1.3955800e+01   1.5670500e+01   1.7328000e+01   1.8625200e+01   2.0152900e+01   2.1508600e+01   2.2772800e+01   2.3894000e+01   2.5026700e+01   2.6253000e+01   2.7124600e+01   2.8143800e+01   2.9006000e+01];
aq3=-690.116+[-9.0088400e-02  -1.8768500e+00  -2.1075400e+00  -2.3409000e+00  -2.6710800e+00  -3.0626800e+00  -3.6057000e+00  -4.1720100e+00  -4.7595500e+00  -5.3283700e+00  -5.9310500e+00  -6.4653500e+00  -7.1706100e+00  -7.8624400e+00  -8.5537000e+00  -9.2261600e+00  -9.9668400e+00  -1.0838500e+01  -1.1505100e+01  -1.2345600e+01  -1.3076300e+01];
% 16439
ar1=13.5613+[-4.2097600e-01   4.4886100e-01   5.2593800e-01   5.2795000e-01   5.1816300e-01   5.0589600e-01   4.7128000e-01   4.3288100e-01   4.0495900e-01   3.5541800e-01   2.8789400e-01   2.3725000e-01   1.9296400e-01   1.4992300e-01   8.5511200e-02   2.6941300e-02  -2.9742700e-02  -7.9779700e-02  -1.2425600e-01  -1.6373600e-01  -1.9760300e-01];
ar2=447.206+[1.7838300e+00   1.4560400e+00   2.4033200e+00   3.4725700e+00   4.7986300e+00   6.1481300e+00   7.7287400e+00   9.1490200e+00   1.0459200e+01   1.1725800e+01   1.2931600e+01   1.3872400e+01   1.4976500e+01   1.5972800e+01   1.6915400e+01   1.7764300e+01   1.8631700e+01   1.9581800e+01   2.0252900e+01   2.1045900e+01   2.1711200e+01];
ar3=-699.132+[7.7023900e-02  -1.5741700e+00  -1.7650700e+00  -1.9443300e+00  -2.1903000e+00  -2.4728500e+00  -2.8616400e+00  -3.2629900e+00  -3.6734400e+00  -4.0015000e+00  -4.3259200e+00  -4.6112200e+00  -4.9796600e+00  -5.3482100e+00  -5.7146300e+00  -6.0796400e+00  -6.4884100e+00  -6.9742600e+00  -7.3299500e+00  -7.7822900e+00  -8.1341400e+00];
% 17116
as1=16.2684+[-4.5758100e-01   4.3780300e-01   5.0812900e-01   5.0313200e-01   4.8542500e-01   4.6558300e-01   4.2281800e-01   3.7757300e-01   3.4268500e-01   2.8552900e-01   2.1035600e-01   1.5314600e-01   1.0034200e-01   4.9142800e-02  -2.2460800e-02  -8.7126600e-02  -1.4919500e-01  -2.0675900e-01  -2.5698900e-01  -3.0210200e-01  -3.4001200e-01];
as2=449.981+[1.9827400e+00   1.6904100e+00   2.7294700e+00   3.8826400e+00   5.3047300e+00   6.7461800e+00   8.4271100e+00   9.9309200e+00   1.1313300e+01   1.2663000e+01   1.3947500e+01   1.4946500e+01   1.6113900e+01   1.7158900e+01   1.8138800e+01   1.9014400e+01   1.9902400e+01   2.0868800e+01   2.1546600e+01   2.2339900e+01   2.2997400e+01];
as3=-696.273+[-9.3101500e-02  -1.8108000e+00  -2.1041700e+00  -2.3831100e+00  -2.7519600e+00  -3.1624900e+00  -3.7049500e+00  -4.2478400e+00  -4.7914200e+00  -5.2920400e+00  -5.8035800e+00  -6.2470700e+00  -6.8151400e+00  -7.3672600e+00  -7.9075200e+00  -8.4285300e+00  -9.0003200e+00  -9.6710900e+00  -1.0172000e+01  -1.0803200e+01  -1.1324900e+01];
% 14886
at1=9.91704+[-3.8613900e-01   7.4465100e-01   8.5255200e-01   8.5836700e-01   8.4278400e-01   8.1591200e-01   7.6074000e-01   6.9728600e-01   6.4412100e-01   5.6784200e-01   4.7019900e-01   3.9799500e-01   3.2753000e-01   2.6173500e-01   1.7228600e-01   8.9170900e-02   8.9662700e-03  -6.5516600e-02  -1.2933500e-01  -1.8327900e-01  -2.3696500e-01];
at2=444.847+[2.4369800e+00   2.0634100e+00   3.2820200e+00   4.6273000e+00   6.2824800e+00   7.9727100e+00   9.9474600e+00   1.1727600e+01   1.3378600e+01   1.5059600e+01   1.6692300e+01   1.7976200e+01   1.9497500e+01   2.0856700e+01   2.2133300e+01   2.3272700e+01   2.4431200e+01   2.5693400e+01   2.6599000e+01   2.7667600e+01   2.8584900e+01];
at3=-691.954+[6.2514600e-02  -1.6656200e+00  -1.7716100e+00  -1.8865600e+00  -2.0748700e+00  -2.3203600e+00  -2.6944200e+00  -3.1077400e+00  -3.5510600e+00  -3.9385000e+00  -4.3487500e+00  -4.7225000e+00  -5.2275700e+00  -5.7390200e+00  -6.2621100e+00  -6.7851000e+00  -7.3712600e+00  -8.0700600e+00  -8.6032300e+00  -9.2810500e+00  -9.8618000e+00];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 1297
au1=12.7746+[3.1852000e-01   3.4307200e-01   3.6901700e-01   3.9417400e-01   4.0686500e-01   4.2772600e-01   4.4197900e-01   4.5265600e-01   4.5983700e-01   4.6345200e-01   4.6192800e-01   4.5540400e-01   4.4457300e-01   4.3273800e-01   4.1127000e-01   3.8206500e-01   3.5255900e-01   3.1298100e-01   2.6868600e-01   2.2376000e-01   1.7597300e-01];
au2=447.736+[2.6057600e+00   2.6122400e+00   2.7383400e+00   2.9217300e+00   3.0319900e+00   3.2782300e+00   3.5458000e+00   3.8363200e+00   4.1795600e+00   4.5732200e+00   5.0171900e+00   5.5025500e+00   6.0607200e+00   6.5217100e+00   7.1165200e+00   7.7466600e+00   8.3055200e+00   8.9794300e+00   9.6937600e+00   1.0371500e+01   1.1031700e+01];
au3=-690.116+[-1.7472500e+00  -1.7664800e+00  -1.7996100e+00  -1.8385300e+00  -1.8607200e+00  -1.9107900e+00  -1.9666700e+00  -2.0331600e+00  -2.1119900e+00  -2.2019700e+00  -2.3054200e+00  -2.4210300e+00  -2.5566600e+00  -2.6680700e+00  -2.8146400e+00  -2.9787900e+00  -3.1313600e+00  -3.3242500e+00  -3.5411300e+00  -3.7593200e+00  -3.9836800e+00];
% 16439
av1=13.5613+[1.4615900e-01   1.6608100e-01   1.9011700e-01   2.1137300e-01   2.2256200e-01   2.4469100e-01   2.6623400e-01   2.8124000e-01   2.9226800e-01   3.0070400e-01   3.0668100e-01   3.1100200e-01   3.1265400e-01   3.1070800e-01   3.0321600e-01   2.9156600e-01   2.7741000e-01   2.5758900e-01   2.3260000e-01   2.0491000e-01   1.7443500e-01];
av2=447.206+[1.8708400e+00   1.8346100e+00   1.8394900e+00   1.8816000e+00   1.9176900e+00   2.0181800e+00   2.1468400e+00   2.3055600e+00   2.5093700e+00   2.7531400e+00   3.0312300e+00   3.3405500e+00   3.7111900e+00   4.0222600e+00   4.4256100e+00   4.8569800e+00   5.2467100e+00   5.7227300e+00   6.2322300e+00   6.7204500e+00   7.2004000e+00];
av3=-699.132+[-1.4334300e+00  -1.4601400e+00  -1.4955400e+00  -1.5331900e+00  -1.5546100e+00  -1.6001600e+00  -1.6454800e+00  -1.6921700e+00  -1.7466100e+00  -1.8063300e+00  -1.8706300e+00  -1.9390400e+00  -2.0199800e+00  -2.0833600e+00  -2.1612300e+00  -2.2450600e+00  -2.3233600e+00  -2.4227100e+00  -2.5333500e+00  -2.6458000e+00  -2.7630500e+00];
% 17116
aw1=16.2684+[1.3041600e-01   1.5049700e-01   1.7372100e-01   1.9416300e-01   2.0493000e-01   2.2624700e-01   2.4655800e-01   2.6030500e-01   2.6994900e-01   2.7668300e-01   2.8084000e-01   2.8308400e-01   2.8223100e-01   2.7839700e-01   2.6858200e-01   2.5452200e-01   2.3818700e-01   2.1573900e-01   1.8822100e-01   1.5828100e-01   1.2552100e-01];
aw2=449.981+[2.0970500e+00   2.0652500e+00   2.0881700e+00   2.1514800e+00   2.1995600e+00   2.3251700e+00   2.4792200e+00   2.6636800e+00   2.8962200e+00   3.1706100e+00   3.4804200e+00   3.8225100e+00   4.2299900e+00   4.5712300e+00   5.0123500e+00   5.4820700e+00   5.9050000e+00   6.4197500e+00   6.9683800e+00   7.4922900e+00   8.0059100e+00];
aw3=-696.273+[-1.6551300e+00  -1.6872200e+00  -1.7430400e+00  -1.8052000e+00  -1.8406900e+00  -1.9160500e+00  -1.9914100e+00  -2.0690900e+00  -2.1588500e+00  -2.2569100e+00  -2.3619100e+00  -2.4733300e+00  -2.6039800e+00  -2.7096400e+00  -2.8422600e+00  -2.9837500e+00  -3.1136900e+00  -3.2755200e+00  -3.4523100e+00  -3.6279000e+00  -3.8071300e+00];
% 14886
ax1=9.91704+[3.7090600e-01   3.9678500e-01   4.2474000e-01   4.5190400e-01   4.6560400e-01   4.8843600e-01   5.0512300e-01   5.1823600e-01   5.2804000e-01   5.3444100e-01   5.3587600e-01   5.3252700e-01   5.2501200e-01   5.1542300e-01   4.9648800e-01   4.6977500e-01   4.4222500e-01   4.0458300e-01   3.6170000e-01   3.1774700e-01   2.7090300e-01];
ax2=444.847+[2.4504300e+00   2.4456000e+00   2.5475000e+00   2.7044800e+00   2.8009200e+00   3.0206800e+00   3.2635200e+00   3.5312700e+00   3.8507300e+00   4.2199900e+00   4.6389200e+00   5.0991800e+00   5.6312600e+00   6.0723600e+00   6.6433000e+00   7.2503500e+00   7.7906200e+00   8.4443700e+00   9.1398600e+00   9.8017500e+00   1.0448200e+01];
ax3=-691.954+[-1.5725900e+00  -1.5744100e+00  -1.5670400e+00  -1.5599000e+00  -1.5572900e+00  -1.5582600e+00  -1.5673700e+00  -1.5893800e+00  -1.6199900e+00  -1.6584200e+00  -1.7063300e+00  -1.7635200e+00  -1.8348700e+00  -1.8936400e+00  -1.9724900e+00  -2.0660200e+00  -2.1571600e+00  -2.2770900e+00  -2.4174900e+00  -2.5636200e+00  -2.7180900e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 1297
ay1=12.7746+[-4.3481100e-01  -4.6465300e-02   1.9078200e-01   3.4376100e-01   4.6938000e-01   5.3356800e-01   5.6002100e-01   5.5073800e-01   5.2048200e-01   4.8057300e-01   4.1527600e-01   3.2813200e-01   2.3104900e-01   1.0019500e-01  -1.3610000e-02  -1.3513800e-01  -2.7913600e-01  -4.0715900e-01  -5.3790400e-01  -6.5931500e-01  -7.5990500e-01];
ay2=447.736+[2.5760400e+00   2.4255500e+00   2.7754100e+00   3.2521100e+00   3.9710300e+00   4.8006400e+00   5.9481800e+00   7.1731100e+00   8.3406100e+00   9.6378500e+00   1.1195900e+01   1.2722200e+01   1.4146600e+01   1.5845700e+01   1.7207600e+01   1.8564500e+01   2.0067300e+01   2.1323400e+01   2.2632600e+01   2.3940800e+01   2.5195100e+01];
ay3=-690.116+[-9.1370300e-02  -1.6278900e+00  -1.7911100e+00  -1.9173300e+00  -2.0789800e+00  -2.2568900e+00  -2.5054800e+00  -2.7812300e+00  -3.0612800e+00  -3.3981600e+00  -3.7699800e+00  -4.1733800e+00  -4.6043400e+00  -5.1870700e+00  -5.7153200e+00  -6.2936000e+00  -7.0042700e+00  -7.6583800e+00  -8.4023200e+00  -9.2082200e+00  -1.0052600e+01];
% 16439
az1=13.5613+[-4.2095300e-01  -1.3691600e-01   5.3152100e-02   1.7656600e-01   2.8204900e-01   3.4080500e-01   3.7133000e-01   3.7136100e-01   3.5780800e-01   3.3943200e-01   3.0170600e-01   2.4611600e-01   1.8239300e-01   9.2709400e-02   1.1635400e-02  -7.9035200e-02  -1.9116300e-01  -2.9137900e-01  -3.9595800e-01  -4.8989200e-01  -5.6767700e-01];
az2=447.206+[1.7840500e+00   1.6154100e+00   1.7875300e+00   2.0908100e+00   2.5834400e+00   3.1754600e+00   4.0174600e+00   4.9418300e+00   5.8294800e+00   6.8160500e+00   7.9476000e+00   9.0429700e+00   1.0067200e+01   1.1287600e+01   1.2276400e+01   1.3276800e+01   1.4409600e+01   1.5373100e+01   1.6393600e+01   1.7422800e+01   1.8408900e+01];
az3=-699.132+[7.5821900e-02  -1.3159800e+00  -1.4692400e+00  -1.5833500e+00  -1.7194100e+00  -1.8593200e+00  -2.0388900e+00  -2.2308300e+00  -2.4198500e+00  -2.6410100e+00  -2.8302600e+00  -3.0204400e+00  -3.2228100e+00  -3.4893700e+00  -3.7369400e+00  -4.0136900e+00  -4.3710400e+00  -4.7128900e+00  -5.1152000e+00  -5.5538800e+00  -6.0059300e+00];
% 17116
ba1=16.2684+[-4.5755800e-01  -1.5568800e-01   3.5543400e-02   1.5833300e-01   2.6135000e-01   3.1644100e-01   3.4155100e-01   3.3582600e-01   3.1713100e-01   2.9309800e-01   2.4890400e-01   1.8670100e-01   1.1753600e-01   2.2008200e-02  -6.3108300e-02  -1.5677900e-01  -2.7109500e-01  -3.7299900e-01  -4.7921800e-01  -5.7560900e-01  -6.5603400e-01];
ba2=449.981+[1.9828700e+00   1.8274000e+00   2.0424600e+00   2.3876600e+00   2.9356000e+00   3.5856000e+00   4.5000900e+00   5.4954200e+00   6.4454200e+00   7.4969600e+00   8.7172200e+00   9.8988700e+00   1.0997400e+01   1.2299900e+01   1.3347800e+01   1.4399200e+01   1.5578100e+01   1.6573500e+01   1.7620600e+01   1.8670500e+01   1.9670200e+01];
ba3=-696.273+[-9.4209400e-02  -1.5188400e+00  -1.7231900e+00  -1.8868100e+00  -2.0886000e+00  -2.2991900e+00  -2.5711200e+00  -2.8588600e+00  -3.1374000e+00  -3.4576300e+00  -3.7963500e+00  -4.1480800e+00  -4.5071800e+00  -4.9723700e+00  -5.3867700e+00  -5.8325800e+00  -6.3763000e+00  -6.8758200e+00  -7.4456000e+00  -8.0586000e+00  -8.6949500e+00];
% 14886
bb1=9.91704+[-3.8609900e-01  -4.3134700e-04   2.4189000e-01   3.9979600e-01   5.3222300e-01   6.0361700e-01   6.3840600e-01   6.3617300e-01   6.1127300e-01   5.7680400e-01   5.1706500e-01   4.3481200e-01   3.4103500e-01   2.1306000e-01   1.0061800e-01  -2.0690600e-02  -1.6563200e-01  -2.9472800e-01  -4.2610100e-01  -5.4732500e-01  -6.4698100e-01];
bb2=444.847+[2.4370000e+00   2.2779700e+00   2.5836400e+00   3.0208900e+00   3.6920200e+00   4.4754200e+00   5.5699800e+00   6.7481700e+00   7.8773900e+00   9.1368700e+00   1.0649900e+01   1.2138400e+01   1.3535900e+01   1.5213300e+01   1.6567100e+01   1.7924600e+01   1.9438000e+01   2.0710300e+01   2.2043100e+01   2.3382700e+01   2.4677500e+01];
bb3=-691.954+[6.1123100e-02  -1.4579700e+00  -1.5486700e+00  -1.6071200e+00  -1.6825900e+00  -1.7714500e+00  -1.9080500e+00  -2.0732300e+00  -2.2512700e+00  -2.4753300e+00  -2.6848400e+00  -2.9175900e+00  -3.1852300e+00  -3.5643200e+00  -3.9256300e+00  -4.3372300e+00  -4.8663300e+00  -5.3692900e+00  -5.9548200e+00  -6.5983100e+00  -7.2743900e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 1297
bc1=12.7746+[3.8812000e-01   4.1846800e-01   4.4615400e-01   4.6376000e-01   4.8345300e-01   4.9119600e-01   5.0568500e-01   5.1074800e-01   5.1279300e-01   5.0966100e-01   5.0137300e-01   4.9016400e-01   4.7594600e-01   4.5180100e-01   4.2570300e-01   3.9554300e-01   3.5849900e-01   3.1684800e-01   2.6923400e-01   2.1429800e-01   1.5608700e-01];
bc2=447.736+[2.8364000e+00   2.8396900e+00   2.9814100e+00   3.1673300e+00   3.4397200e+00   3.5828600e+00   4.0142900e+00   4.2801900e+00   4.6833100e+00   5.1870600e+00   5.7295400e+00   6.2633500e+00   6.8136500e+00   7.5333800e+00   8.1623700e+00   8.8173100e+00   9.5412900e+00   1.0292300e+01   1.1041800e+01   1.1821400e+01   1.2592300e+01];
bc3=-690.116+[-1.3218300e+00  -1.3490200e+00  -1.4024300e+00  -1.4567300e+00  -1.5346100e+00  -1.5736900e+00  -1.6843800e+00  -1.7502200e+00  -1.8488300e+00  -1.9714900e+00  -2.1041200e+00  -2.2373400e+00  -2.3802900e+00  -2.5682400e+00  -2.7360900e+00  -2.9183600e+00  -3.1281300e+00  -3.3580100e+00  -3.6042000e+00  -3.8765900e+00  -4.1603100e+00];
% 16439
bd1=13.5613+[2.2240800e-01   2.4780900e-01   2.7619700e-01   2.9504100e-01   3.1457300e-01   3.2199000e-01   3.3788100e-01   3.4528100e-01   3.5228500e-01   3.5538400e-01   3.5532500e-01   3.5264100e-01   3.4904900e-01   3.3904300e-01   3.2517500e-01   3.0737600e-01   2.8532500e-01   2.5986800e-01   2.3081900e-01   1.9682600e-01   1.5793200e-01];
bd2=447.206+[2.0702900e+00   2.0270400e+00   2.0411400e+00   2.1024700e+00   2.2225500e+00   2.2967200e+00   2.5439000e+00   2.7065900e+00   2.9636800e+00   3.2990700e+00   3.6688800e+00   4.0379600e+00   4.4190000e+00   4.9198700e+00   5.3635500e+00   5.8306000e+00   6.3522500e+00   6.8976700e+00   7.4464000e+00   8.0209900e+00   8.5929200e+00];
bd3=-699.132+[-1.1512300e+00  -1.1826500e+00  -1.2314900e+00  -1.2776500e+00  -1.3407400e+00  -1.3719500e+00  -1.4579200e+00  -1.5072800e+00  -1.5776200e+00  -1.6618200e+00  -1.7505400e+00  -1.8372200e+00  -1.9270300e+00  -2.0395300e+00  -2.1377100e+00  -2.2434200e+00  -2.3637500e+00  -2.4947500e+00  -2.6355600e+00  -2.7915200e+00  -2.9541400e+00];
% 17116
be1=16.2684+[2.0733300e-01   2.3302100e-01   2.6069600e-01   2.7875600e-01   2.9724300e-01   3.0417700e-01   3.1849600e-01   3.2481100e-01   3.3007300e-01   3.3089500e-01   3.2831500e-01   3.2304200e-01   3.1686600e-01   3.0353100e-01   2.8665900e-01   2.6574900e-01   2.4033200e-01   2.1159300e-01   1.7934000e-01   1.4202200e-01   9.9964700e-02];
be2=449.981+[2.3181800e+00   2.2806000e+00   2.3146600e+00   2.3955000e+00   2.5423400e+00   2.6300100e+00   2.9150800e+00   3.0998000e+00   3.3882200e+00   3.7602700e+00   4.1673000e+00   4.5711500e+00   4.9863300e+00   5.5313900e+00   6.0129200e+00   6.5180300e+00   7.0798400e+00   7.6646900e+00   8.2508200e+00   8.8625700e+00   9.4695200e+00];
be3=-696.273+[-1.3985200e+00  -1.4369600e+00  -1.5090700e+00  -1.5782400e+00  -1.6733400e+00  -1.7208700e+00  -1.8531000e+00  -1.9297500e+00  -2.0395800e+00  -2.1710200e+00  -2.3090400e+00  -2.4430200e+00  -2.5807500e+00  -2.7578900e+00  -2.9136000e+00  -3.0793700e+00  -3.2657600e+00  -3.4647100e+00  -3.6730100e+00  -3.8992000e+00  -4.1313800e+00];
% 14886
bf1=9.91704+[4.3791600e-01   4.6948100e-01   4.9889900e-01   5.1798700e-01   5.3961400e-01   5.4829300e-01   5.6585900e-01   5.7294700e-01   5.7799100e-01   5.7833700e-01   5.7358700e-01   5.6566100e-01   5.5464200e-01   5.3433000e-01   5.1144800e-01   4.8439800e-01   4.5041700e-01   4.1150000e-01   3.6629500e-01   3.1359400e-01   2.5720800e-01];
bf2=444.847+[2.6550600e+00   2.6470200e+00   2.7651200e+00   2.9295700e+00   3.1759000e+00   3.3072000e+00   3.7072200e+00   3.9557100e+00   4.3347500e+00   4.8116000e+00   5.3278700e+00   5.8380700e+00   6.3657700e+00   7.0580000e+00   7.6648100e+00   8.2986200e+00   9.0015600e+00   9.7331600e+00   1.0465500e+01   1.1229500e+01   1.1987100e+01];
bf3=-691.954+[-1.0947100e+00  -1.1035500e+00  -1.1153400e+00  -1.1304200e+00  -1.1593100e+00  -1.1755200e+00  -1.2242800e+00  -1.2548200e+00  -1.3030500e+00  -1.3667700e+00  -1.4388600e+00  -1.5144400e+00  -1.5988900e+00  -1.7101100e+00  -1.8113400e+00  -1.9250100e+00  -2.0601200e+00  -2.2134900e+00  -2.3841400e+00  -2.5784000e+00  -2.7850800e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 1297
bg1=12.7746+[-2.9740500e-01  -1.1573700e-01   5.3182500e-02   1.8162900e-01   2.3037200e-01   3.1518300e-01   3.6514400e-01   4.0659100e-01   4.2815100e-01   4.3206200e-01   4.2231500e-01   4.0306900e-01   3.6279600e-01   3.0443300e-01   2.4010500e-01   1.5772700e-01   6.8069600e-02  -4.3864400e-02  -1.4104600e-01  -2.6138200e-01  -3.7106400e-01];
bg2=447.736+[2.7438700e+00   2.7706900e+00   3.0431500e+00   3.4363000e+00   3.6569500e+00   4.2273300e+00   4.7704800e+00   5.5250400e+00   6.4946800e+00   7.1033100e+00   8.2636700e+00   9.0692000e+00   1.0167100e+01   1.1359100e+01   1.2475600e+01   1.3689900e+01   1.4866000e+01   1.6177900e+01   1.7226600e+01   1.8451100e+01   1.9560300e+01];
bg3=-690.116+[-7.2232400e-01  -1.1430200e+00  -1.3058000e+00  -1.4420500e+00  -1.5082400e+00  -1.6630800e+00  -1.8014300e+00  -1.9883100e+00  -2.2280200e+00  -2.3801400e+00  -2.6383700e+00  -2.7957900e+00  -3.0309900e+00  -3.3230400e+00  -3.6285000e+00  -4.0034100e+00  -4.4101500e+00  -4.9187900e+00  -5.3654300e+00  -5.9234500e+00  -6.4663000e+00];
% 16439
bh1=13.5613+[-2.9872300e-01  -1.7106900e-01  -3.0170700e-02   7.6170900e-02   1.1558600e-01   1.8370600e-01   2.2557000e-01   2.6368900e-01   2.8705400e-01   2.9555500e-01   2.9604300e-01   2.8698000e-01   2.6524100e-01   2.2912000e-01   1.8715700e-01   1.3093200e-01   6.8266600e-02  -1.1485300e-02  -8.3577000e-02  -1.7546000e-01  -2.6586000e-01];
bh2=447.206+[2.0430200e+00   1.9473700e+00   2.0303900e+00   2.2396800e+00   2.3759300e+00   2.7536100e+00   3.1274200e+00   3.6629300e+00   4.3705800e+00   4.8210500e+00   5.6589200e+00   6.2140100e+00   6.9621300e+00   7.7814800e+00   8.5524200e+00   9.3951000e+00   1.0216800e+01   1.1151500e+01   1.1915900e+01   1.2820600e+01   1.3653400e+01];
bh3=-699.132+[-5.8657500e-01  -9.7346700e-01  -1.1187300e+00  -1.2385100e+00  -1.2942500e+00  -1.4205800e+00  -1.5280800e+00  -1.6668900e+00  -1.8369200e+00  -1.9421700e+00  -2.0924600e+00  -2.1545000e+00  -2.2403200e+00  -2.3527600e+00  -2.4710800e+00  -2.6199300e+00  -2.7842400e+00  -3.0018600e+00  -3.2052700e+00  -3.4627100e+00  -3.7196400e+00];
% 17116
bi1=16.2684+[-3.2813800e-01  -1.9210300e-01  -4.9154200e-02   5.7461700e-02   9.6587800e-02   1.6316400e-01   2.0293800e-01   2.3751300e-01   2.5602900e-01   2.6136500e-01   2.5617700e-01   2.4317200e-01   2.1606600e-01   1.7432300e-01   1.2720200e-01   6.5798900e-02  -9.7406300e-04  -8.4584600e-02  -1.5888600e-01  -2.5237200e-01  -3.4184500e-01];
bi2=449.981+[2.2464200e+00   2.1773600e+00   2.2979600e+00   2.5449500e+00   2.7005300e+00   3.1252500e+00   3.5404800e+00   4.1292800e+00   4.8997200e+00   5.3872600e+00   6.2990400e+00   6.9088700e+00   7.7298300e+00   8.6239800e+00   9.4611200e+00   1.0370400e+01   1.1250200e+01   1.2240800e+01   1.3043100e+01   1.3985800e+01   1.4845900e+01];
bi3=-696.273+[-7.6833000e-01  -1.1941400e+00  -1.3859000e+00  -1.5517300e+00  -1.6310100e+00  -1.8148600e+00  -1.9739400e+00  -2.1808300e+00  -2.4344400e+00  -2.5909800e+00  -2.8503000e+00  -2.9990900e+00  -3.2088100e+00  -3.4606200e+00  -3.7149400e+00  -4.0164100e+00  -4.3315400e+00  -4.7164200e+00  -5.0519800e+00  -5.4652000e+00  -5.8630300e+00];
% 14886
bk1=9.91704+[-2.5342700e-01  -7.3074300e-02   9.7983200e-02   2.2972900e-01   2.8036400e-01   3.7015700e-01   4.2501100e-01   4.7298200e-01   5.0204800e-01   5.1025000e-01   5.0753500e-01   4.9277800e-01   4.5800500e-01   4.0473600e-01   3.4435100e-01   2.6533700e-01   1.7771500e-01   6.7225600e-02  -2.9748900e-02  -1.5139900e-01  -2.6432400e-01];
bk2=444.847+[2.6061700e+00   2.6047900e+00   2.8385100e+00   3.1949000e+00   3.3986900e+00   3.9312000e+00   4.4426500e+00   5.1583200e+00   6.0848200e+00   6.6693000e+00   7.7854700e+00   8.5608200e+00   9.6218000e+00   1.0780500e+01   1.1871900e+01   1.3065900e+01   1.4229900e+01   1.5536600e+01   1.6587500e+01   1.7821900e+01   1.8947100e+01];
bk3=-691.954+[-5.6563500e-01  -9.3389700e-01  -1.0276600e+00  -1.0973600e+00  -1.1324300e+00  -1.2154200e+00  -1.2911500e+00  -1.3969700e+00  -1.5392600e+00  -1.6325700e+00  -1.7697800e+00  -1.8324800e+00  -1.9341800e+00  -2.0796300e+00  -2.2450400e+00  -2.4650700e+00  -2.7201200e+00  -3.0617200e+00  -3.3778500e+00  -3.7841600e+00  -4.1906900e+00];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')



%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')

%% Percent change individual bar plots compared to intact
% Model 1
figure(3)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

PC=[pc15;pc1];
bar(PC)
xticklabels({'Intact','Model 1'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

% Model 2
figure(4)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

PC=[pc15;pc2];
bar(PC)
xticklabels({'Intact','Model 2'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

% Model 3
figure(5)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

PC=[pc15;pc3];
bar(PC)
xticklabels({'Intact','Model 3'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

% Model 4
figure(6)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

PC=[pc15;pc4];
bar(PC)
xticklabels({'Intact','Model 4'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

% Model 5
figure(7)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

PC=[pc15;pc5];
bar(PC)
xticklabels({'Intact','Model 5'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

% Model 6
figure(8)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

PC=[pc15;pc6];
bar(PC)
xticklabels({'Intact','Model 6'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

% Model 13
figure(9)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];

PC=[pc15;pc13];
bar(PC)
xticklabels({'Intact','Model 13'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

% Model 14
figure(10)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc14];
bar(PC)
xticklabels({'Intact','Model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')



