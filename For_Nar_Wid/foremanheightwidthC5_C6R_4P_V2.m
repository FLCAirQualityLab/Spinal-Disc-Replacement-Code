%% This code finds c5-c6 foreman width/height narrowig/widening during flexion (4P)
clf
clear all

mag15y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag15x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width15=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height15=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag14y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag14x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width14=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height14=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag13y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag13x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width13=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height13=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag6y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag6x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width6=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height6=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag5y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag5x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width5=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height5=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag4y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag4x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width4=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height4=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag3y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag3x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width3=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height3=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];


mag2y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag2x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width2=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height2=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag1y=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
mag1x=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
width1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
height1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

%% model15_intact_TLC_4P
t15=[2,2.0675,2.10046,2.15118,2.21847,2.28879,2.30129,2.3542,2.41761,2.47111,2.51624,2.55771,2.60433,2.65123,2.70673,2.75718,2.81828,2.8513,2.91654,2.95737,3];
%40182U
aa1=-13.5191+[0.114695,0.12862,0.130879,0.132019,0.142268,0.162758,0.166182,0.179125,0.190877,0.199834,0.207004,0.213112,0.219346,0.225052,0.231681,0.239064,0.2483,0.253123,0.262234,0.267797,0.273511];
aa2=448.04+[-0.461887,-0.766747,-0.968269,-1.21003,-1.4934,-1.77986,-1.83009,-2.04093,-2.2877,-2.49195,-2.66102,-2.81251,-2.97816,-3.14152,-3.33053,-3.49849,-3.69781,-3.8033,-4.00771,-4.13301,-4.26181];
aa3=-720.839+[-0.393063,-0.368692,-0.366788,-0.377073,-0.397206,-0.41821,-0.422232,-0.442512,-0.470186,-0.494052,-0.514374,-0.532815,-0.553568,-0.574558,-0.599526,-0.621999,-0.649423,-0.664304,-0.694065,-0.712646,-0.732033];
%62515L
ab1=-13.5397+[0.0355486,0.0426771,0.0454908,0.0451308,0.0490847,0.0582406,0.0597963,0.0657695,0.0701845,0.0733084,0.0758239,0.0776821,0.0795132,0.0810758,0.082815,0.0850891,0.0880648,0.0896186,0.0925216,0.0942269,0.0960063];
ab2=448.593+[-0.272229,-0.351631,-0.429113,-0.53595,-0.664336,-0.796553,-0.819857,-0.917978,-1.03269,-1.12775,-1.20658,-1.27696,-1.35414,-1.43034,-1.51841,-1.59689,-1.6906,-1.74024,-1.83648,-1.89559,-1.9562];
ab3=-730.72+[-0.167408,-0.165618,-0.163312,-0.16748,-0.171543,-0.174479,-0.175169,-0.178871,-0.184779,-0.18988,-0.194392,-0.198663,-0.203576,-0.208557,-0.214618,-0.220042,-0.226804,-0.230474,-0.237765,-0.24226,-0.246974];
%45869
ac1=-9.75965+[0.0870308,0.0984253,0.100489,0.098478,0.104192,0.118945,0.121439,0.130734,0.138856,0.145126,0.150113,0.154076,0.157946,0.161253,0.165157,0.169958,0.176171,0.179429,0.185598,0.189428,0.193396];
ac2=445.175+[-0.42166,-0.649716,-0.806512,-0.999225,-1.22711,-1.45568,-1.49557,-1.66271,-1.85683,-2.01652,-2.1483,-2.26608,-2.39456,-2.52113,-2.66723,-2.79664,-2.94993,-3.0309,-3.18739,-3.2831,-3.38139];
ac3=-723.489+[-0.447382,-0.46689,-0.48814,-0.526347,-0.57818,-0.632192,-0.64188,-0.685344,-0.739255,-0.784202,-0.821604,-0.855282,-0.892433,-0.92929,-0.972163,-1.01038,-1.05595,-1.08019,-1.12762,-1.15669,-1.18659];
%65936R
ad1=-15.4024+[0.0922672,0.101523,0.104626,0.10385,0.109899,0.124311,0.126776,0.136271,0.143989,0.149528,0.15396,0.157496,0.161105,0.164371,0.168034,0.172413,0.177901,0.180733,0.186012,0.189109,0.192253];
ad2=450.021+[-0.356624,-0.475995,-0.588558,-0.743225,-0.928359,-1.11913,-1.1528,-1.29464,-1.46101,-1.59889,-1.71323,-1.81566,-1.92812,-2.03925,-2.16773,-2.28222,-2.41892,-2.49136,-2.63181,-2.71804,-2.80649];
ad3=-723.647+[-0.136441,-0.126541,-0.11776,-0.11362,-0.107614,-0.0998667,-0.0987217,-0.0949388,-0.0925737,-0.0911888,-0.0905387,-0.0903207,-0.090476,-0.0909366,-0.091993,-0.0930561,-0.0948504,-0.0960056,-0.0986528,-0.10045,-0.102518];

ya1=[aa1-ab1]
ya2=[aa2-ab2]
ya3=[aa3-ab3]
xa1=[ad1-ac1]
xa2=[ad2-ac2]
xa3=[ad3-ac3]
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];
k=21;
for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end



%% model1_slideslide_tether
t1=[2,2.05126,2.11533,2.16533,2.2247,2.25107,2.30644,2.35622,2.40972,2.46023,2.50711,2.55164,2.60232,2.65142,2.72191,2.77012,2.80437,2.86374,2.90593,2.9903,3];
% 40182U
ae1=-13.5191+[-0.256354,-0.239411,-0.206278,-0.172415,-0.12579,-0.083513,-0.0308849,-0.00427845,0.0289597,0.0425099,0.0667343,0.0860921,0.108798,0.126735,0.142498,0.157219,0.170172,0.182072,0.193211,0.202641,0.209668];
ae2=447.04+[0.598699,0.426355,0.387711,0.241018,0.0114823,-0.233587,-0.625596,-0.892169,-1.24172,-1.38866,-1.66648,-1.89216,-2.15484,-2.38292,-2.60254,-2.82902,-3.05457,-3.27692,-3.49411,-3.6792,-3.81967];
ae3=-720.839+[-0.786172,-0.945656,-0.915588,-0.846964,-0.765284,-0.731267,-0.694596,-0.688336,-0.695448,-0.702012,-0.719361,-0.736779,-0.759458,-0.781741,-0.804856,-0.831487,-0.86048,-0.890845,-0.921721,-0.948685,-0.969516];
% 62515L
af1=-13.5397+[-0.143816,-0.147571,-0.130356,-0.115994,-0.0964654,-0.0710675,-0.0455335,-0.0345393,-0.0208981,-0.0154093,-0.00493098,0.00379596,0.0145412,0.0229661,0.0301012,0.0366768,0.0420295,0.0467537,0.051173,0.0549478,0.0577216];
af2=448.593+[0.352057,0.24398,0.276096,0.263817,0.176067,0.038851,-0.184827,-0.312771,-0.474629,-0.542894,-0.672369,-0.777409,-0.901181,-1.00975,-1.11439,-1.22226,-1.3301,-1.4366,-1.54093,-1.63012,-1.6981];
af3=-730.72+[-0.413777,-0.496221,-0.496778,-0.484505,-0.451588,-0.405816,-0.348154,-0.32959,-0.318413,-0.315921,-0.313359,-0.312902,-0.312466,-0.312943,-0.314116,-0.316701,-0.320995,-0.325988,-0.331461,-0.336389,-0.340285];
% 45869
ag1=-9.44941+[-0.235181,-0.229165,-0.201071,-0.173166,-0.135394,-0.0980735,-0.0501518,-0.0268607,0.000401619,0.011292,0.0302888,0.0450203,0.0624799,0.0762218,0.087986,0.098719,0.107744,0.115864,0.123429,0.129982,0.13495];
ag2=445.055+[0.48731,0.359288,0.354536,0.264321,0.105113,-0.092576,-0.410176,-0.62489,-0.906495,-1.02465,-1.24795,-1.42908,-1.63938,-1.82143,-1.99627,-2.17589,-2.35422,-2.52934,-2.69975,-2.84451,-2.95403];
ag3=-724.288+[-0.693663,-0.893817,-0.890366,-0.861339,-0.828804,-0.825628,-0.832061,-0.854667,-0.899963,-0.922347,-0.969085,-1.01015,-1.05954,-1.1041,-1.14813,-1.19577,-1.24513,-1.29504,-1.34445,-1.38666,-1.41873];
% 65936R
ah1=-15.4024+[-0.16872,-0.1589,-0.132212,-0.11024,-0.0803886,-0.0452477,-0.0123201,0.00241399,0.0222293,0.0301852,0.0458966,0.0592405,0.0755049,0.088501,0.0997932,0.110232,0.119089,0.127224,0.134824,0.14117,0.145789];
ah2=450.021+[0.476683,0.306447,0.346773,0.325567,0.198066,0.000415912,-0.319281,-0.501296,-0.73145,-0.828992,-1.014,-1.16419,-1.34112,-1.49636,-1.64624,-1.80086,-1.9557,-2.10906,-2.2594,-2.38789,-2.48581];
ah3=-723.647+[-0.447071,-0.5126,-0.512288,-0.495996,-0.451944,-0.391382,-0.313455,-0.284239,-0.259886,-0.252002,-0.239417,-0.23105,-0.221657,-0.214676,-0.208992,-0.204902,-0.202895,-0.201939,-0.201915,-0.202419,-0.203118];

xb1=[ah1-ag1];
xb2=[ah2-ag2];
xb3=[ah3-ag3];
yb1=[ae1-af1];
yb2=[ae2-af2];
yb3=[ae3-af3];
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end


%% model2_slideslide_notether
t2=[2,2.05126,2.11533,2.16533,2.2247,2.26689,2.31689,2.36689,2.42627,2.46846,2.52783,2.57002,2.60127,2.65098,2.70667,2.75577,2.81523,2.85038,2.90628,2.96349,3];
% 40182U
ai1=-13.5191+[-0.218725,-0.221254,-0.222604,-0.224213,-0.216864,-0.210677,-0.194192,-0.173027,-0.147645,-0.127716,-0.0996831,-0.0812957,-0.06781,-0.0456062,-0.0198396,0.00312997,0.0305659,0.0462067,0.0696609,0.0913814,0.104043];
ai2=447.04+[0.645159,0.608444,0.650959,0.713663,0.729799,0.719275,0.658774,0.541162,0.365468,0.214076,-0.0199752,-0.20732,-0.350362,-0.579929,-0.828272,-1.04717,-1.31408,-1.47263,-1.72541,-1.98377,-2.14879];
ai3=-720.839+[-0.863984,-0.950442,-0.978805,-0.988901,-0.955203,-0.912066,-0.876148,-0.854373,-0.826094,-0.802783,-0.768548,-0.746372,-0.731343,-0.716043,-0.712804,-0.715844,-0.723568,-0.72964,-0.742041,-0.75795,-0.769774];
% 62515L
aj1=-13.5397+[-0.131943,-0.137426,-0.137372,-0.13624,-0.132126,-0.132149,-0.125204,-0.114608,-0.102415,-0.092828,-0.0816711,-0.0748979,-0.0690228,-0.0580304,-0.046117,-0.0355964,-0.0230718,-0.0160325,-0.0055438,0.00391761,0.00928369];
aj2=448.593+[0.342167,0.317668,0.367649,0.436111,0.515436,0.551067,0.543858,0.484092,0.390922,0.30919,0.180583,0.0772282,0.00033165,-0.113243,-0.22617,-0.325606,-0.446764,-0.519151,-0.635529,-0.755925,-0.833969];
aj3=-730.72+[-0.44604,-0.494961,-0.523259,-0.545092,-0.563333,-0.574555,-0.567861,-0.544841,-0.511427,-0.481535,-0.437357,-0.407165,-0.386199,-0.362799,-0.349862,-0.341512,-0.33331,-0.329155,-0.323854,-0.319874,-0.318343];
% 45869
ak1=-9.44941+[-0.203613,-0.210266,-0.213214,-0.214987,-0.209307,-0.206731,-0.192064,-0.17229,-0.149447,-0.131464,-0.106,-0.0891084,-0.0771589,-0.0585825,-0.0377607,-0.0192744,0.00277781,0.0152922,0.0338678,0.0505498,0.0600655];
ak2=445.055+[0.528085,0.507927,0.561122,0.632318,0.683635,0.705101,0.682371,0.599411,0.468476,0.353036,0.173064,0.0270515,-0.0855421,-0.268296,-0.465593,-0.639558,-0.851769,-0.977901,-1.17923,-1.38522,-1.51697];
ak3=-724.288+[-0.77523,-0.87716,-0.914344,-0.930067,-0.91951,-0.899544,-0.887476,-0.886819,-0.885956,-0.883989,-0.880521,-0.880608,-0.882088,-0.892957,-0.918458,-0.946158,-0.982853,-1.00554,-1.04348,-1.08457,-1.11186];
% 65936R
al1=-15.4024+[-0.146192,-0.148656,-0.147388,-0.146329,-0.140446,-0.140381,-0.129446,-0.113737,-0.0972077,-0.0848027,-0.0705525,-0.0624076,-0.0541953,-0.0379345,-0.0201544,-0.00447358,0.0142209,0.0248024,0.0407521,0.0553466,0.0636842];
al2=450.021+[0.458229,0.41232,0.474173,0.563204,0.665374,0.70919,0.692849,0.60288,0.462361,0.338728,0.145147,-0.00806869,-0.120427,-0.283585,-0.446579,-0.590636,-0.765912,-0.870436,-1.03811,-1.21114,-1.32288];
al3=-723.647+[-0.474687,-0.518203,-0.548715,-0.575019,-0.597762,-0.610736,-0.600793,-0.569578,-0.524644,-0.485133,-0.426905,-0.386627,-0.35837,-0.324597,-0.30143,-0.284295,-0.265858,-0.255862,-0.241601,-0.228945,-0.222147];

xc1=[al1-ak1];
xc2=[al2-ak2];
xc3=[al3-ak3];
yd1=[ai1-aj1];
yd2=[ai2-aj2];
yd3=[ai3-aj3];
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end


%% model3_APslide_tether/s2_4P
t3=[2,2.05126,2.11533,2.16533,2.2247,2.26689,2.31689,2.36689,2.42627,2.45263,2.51196,2.57134,2.62143,2.65745,2.70443,2.7639,2.80111,2.85094,2.90531,2.96081,3];
% 40182U
am1=-13.5191+[-0.110556,-0.108662,-0.111165,-0.117466,-0.11838,-0.115254,-0.107594,-0.09544,-0.0794291,-0.0723314,-0.055643,-0.0391779,-0.0262474,-0.0178611,-0.0068482,0.00924188,0.0203663,0.0357993,0.052991,0.0703882,0.0824023];
am2=447.04+[0.266464,0.273517,0.361022,0.464253,0.552408,0.591561,0.614775,0.583082,0.506265,0.459911,0.329559,0.175013,0.0254807,-0.0903789,-0.251391,-0.466874,-0.603588,-0.787217,-0.990552,-1.20246,-1.3545];
am3=-720.839+[-0.802588,-0.81909,-0.850022,-0.876062,-0.872238,-0.84852,-0.818652,-0.808421,-0.795942,-0.788813,-0.769571,-0.747981,-0.728461,-0.713738,-0.696702,-0.682729,-0.68008,-0.680698,-0.684587,-0.691215,-0.697081];
% 62515L
an1=-13.5397+[-0.0925811,-0.0919221,-0.0908825,-0.0914353,-0.0895261,-0.0892198,-0.0867217,-0.0801018,-0.0710529,-0.0670582,-0.059365,-0.0537515,-0.0497709,-0.0474443,-0.0429426,-0.0343543,-0.0288315,-0.0214166,-0.0132684,-0.00510437,0.000478931];
an2=448.593+[0.118554,0.122796,0.192094,0.273816,0.380345,0.444266,0.498149,0.493613,0.458139,0.435767,0.369826,0.288804,0.209863,0.150468,0.0693453,-0.0361656,-0.0978998,-0.179085,-0.268081,-0.361243,-0.428764];
an3=-730.72+[-0.401242,-0.409732,-0.434711,-0.461198,-0.488143,-0.505623,-0.518304,-0.512135,-0.496279,-0.487392,-0.462433,-0.434542,-0.408611,-0.389012,-0.36573,-0.343302,-0.335285,-0.327368,-0.32075,-0.315112,-0.311582];
% 45869
ao1=-9.44941+[-0.118033,-0.11725,-0.119204,-0.124304,-0.125159,-0.123483,-0.116992,-0.104892,-0.089145,-0.0826145,-0.0672688,-0.0519549,-0.0397643,-0.031971,-0.0225417,-0.00961889,-0.000766186,0.0114197,0.0249163,0.038422,0.0476262];
ao2=445.055+[0.221553,0.232684,0.320379,0.421937,0.527559,0.589389,0.64339,0.636265,0.591047,0.559926,0.468008,0.355802,0.245053,0.158359,0.0352766,-0.133008,-0.240418,-0.384471,-0.543987,-0.710667,-0.830627];
ao3=-724.288+[-0.784873,-0.805214,-0.83587,-0.859752,-0.866142,-0.857296,-0.846279,-0.849891,-0.855122,-0.856893,-0.859602,-0.861181,-0.861962,-0.862195,-0.865096,-0.876577,-0.889671,-0.91127,-0.937855,-0.967305,-0.988992];
% 65936R
ap1=-15.4024+[-0.0732179,-0.0713393,-0.0709566,-0.073324,-0.0713006,-0.0712675,-0.0676935,-0.0588465,-0.0472584,-0.0426451,-0.0341975,-0.0284366,-0.0246747,-0.0223494,-0.0160615,-0.00380686,0.00428898,0.0151851,0.0270927,0.0391197,0.047404];
ap2=450.021+[0.151083,0.154284,0.244029,0.351274,0.49095,0.573538,0.641329,0.626966,0.567009,0.530275,0.424016,0.296354,0.173197,0.0802566,-0.043067,-0.199489,-0.289974,-0.40967,-0.541223,-0.678697,-0.777995];
ap3=-723.647+[-0.403272,-0.411219,-0.44058,-0.472897,-0.506867,-0.528459,-0.543842,-0.534756,-0.512709,-0.500488,-0.466621,-0.428932,-0.39412,-0.367952,-0.336185,-0.303495,-0.289736,-0.274312,-0.259676,-0.245989,-0.236881];

xe1=[ap1-ao1];
xe2=[ap2-ao2];
xe3=[ap3-ao3];
yf1=[am1-an1];
yf2=[am2-an2];
yf3=[am3-an3];
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end

%% model4_APslide_notether
t4=[2,2.05816,2.10161,2.16188,2.20417,2.26497,2.3108,2.35767,2.41039,2.46048,2.50857,2.57039,2.61266,2.65395,2.70851,2.75122,2.8056,2.85917,2.91124,2.95071,3];
% 40182U
aq1=-13.5191+[-0.188182,-0.0130894,0.0491503,0.0723014,0.0806355,0.0908956,0.0995819,0.110332,0.127716,0.144219,0.158178,0.172457,0.181398,0.18984,0.200237,0.207974,0.21694,0.225337,0.234128,0.240507,0.248137];
aq2=447.04+[0.406264,-0.386631,-0.897556,-1.31042,-1.5159,-1.77891,-1.96694,-2.15622,-2.36595,-2.56321,-2.74872,-2.97852,-3.13259,-3.28143,-3.47082,-3.61453,-3.79262,-3.9635,-4.12488,-4.24438,-4.39011];
aq3=-720.839+[0.0767894,-0.686805,-0.612562,-0.63484,-0.659895,-0.693591,-0.717145,-0.740268,-0.763926,-0.786573,-0.809933,-0.840716,-0.862782,-0.885052,-0.913753,-0.936009,-0.964111,-0.991373,-1.01697,-1.03595,-1.05898];
% 62515L
ar1=-13.5397+[-0.103791,-0.0425424,-0.0123615,0.00140143,0.00601515,0.0105788,0.0141415,0.0185372,0.0259635,0.0332555,0.0392607,0.044974,0.0485114,0.0519174,0.0557336,0.0586065,0.0619956,0.0651218,0.0685619,0.0710483,0.0739574];
ar2=448.593+[0.221109,-0.147457,-0.344145,-0.533331,-0.626799,-0.747051,-0.833909,-0.92279,-1.02188,-1.11539,-1.20347,-1.3129,-1.38653,-1.45792,-1.54782,-1.61635,-1.70157,-1.78345,-1.86095,-1.91834,-1.98818];
ar3=-730.72+[0.0456747,-0.323474,-0.283983,-0.277299,-0.281399,-0.289208,-0.294597,-0.298843,-0.301507,-0.303981,-0.306705,-0.311327,-0.315139,-0.319279,-0.324852,-0.329291,-0.335043,-0.340707,-0.345856,-0.349692,-0.354287];
% 45869
as1=-9.44941+[-0.161595,-0.0350296,0.0174217,0.0367614,0.0430074,0.0493278,0.0548196,0.0621865,0.0751702,0.0875101,0.0981153,0.109091,0.11593,0.122409,0.130115,0.135889,0.142434,0.148574,0.155198,0.160021,0.165809];
as2=445.055+[0.29466,-0.300095,-0.704835,-1.04082,-1.20656,-1.41647,-1.56548,-1.71488,-1.87939,-2.03387,-2.17846,-2.35599,-2.47461,-2.58896,-2.73383,-2.84346,-2.97924,-3.10935,-3.23193,-3.32261,-3.43304];
as3=-724.288+[0.177227,-0.76056,-0.752388,-0.816237,-0.862162,-0.924124,-0.968158,-1.01181,-1.05872,-1.10273,-1.1453,-1.19881,-1.23566,-1.27186,-1.31818,-1.35343,-1.39718,-1.43895,-1.47795,-1.50656,-1.54102];
% 65936R
at1=-15.4024+[-0.125943,0.00381846,0.0449347,0.0621861,0.0682261,0.0741141,0.0787867,0.0850497,0.0962536,0.107095,0.116252,0.125339,0.131008,0.136377,0.142618,0.147236,0.152676,0.157718,0.163118,0.167,0.171567];
at2=450.021+[0.376253,-0.220201,-0.498135,-0.769704,-0.904991,-1.07993,-1.20632,-1.33537,-1.47866,-1.61366,-1.74103,-1.89952,-2.00621,-2.10969,-2.2407,-2.34056,-2.46472,-2.58394,-2.69672,-2.78023,-2.88185];
at3=-723.647+[0.0069737,-0.297416,-0.239958,-0.218047,-0.214897,-0.213736,-0.212869,-0.210802,-0.206353,-0.202404,-0.199328,-0.197153,-0.196614,-0.196705,-0.197327,-0.198177,-0.199691,-0.201503,-0.203153,-0.204525,-0.206261];

xg1=[at1-as1];
xg2=[at2-as2];
xg3=[at3-as3];
yh1=[aq1-ar1];
yh2=[aq2-ar2];
yh3=[aq3-ar3];
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end


%% model5_latslide_tether/S2_4P
t5=[2,2.05126,2.11533,2.16533,2.21533,2.25908,2.32939,2.37939,2.41064,2.48096,2.51221,2.58252,2.61377,2.65013,2.70227,2.75401,2.82172,2.85179,2.91104,2.95017,3];
% 40182U
au1=-13.5191+[-0.111617,-0.109703,-0.111884,-0.117853,-0.119673,-0.117413,-0.107558,-0.0941697,-0.0854947,-0.0650474,-0.0561111,-0.0376093,-0.0296467,-0.0208541,-0.00887458,0.00443753,0.0239565,0.0329699,0.0510062,0.0628696,0.0776293];
au2=447.04+[0.243025,0.249784,0.33166,0.430536,0.507769,0.559019,0.596697,0.559178,0.523069,0.395289,0.327744,0.144503,0.0543027,-0.0570841,-0.2296,-0.412061,-0.656313,-0.76536,-0.983317,-1.13008,-1.32023];
au3=-720.839+[-0.80168,-0.818249,-0.84858,-0.873818,-0.875727,-0.857343,-0.8161,-0.806415,-0.799944,-0.78083,-0.770646,-0.746268,-0.734379,-0.719765,-0.70086,-0.687818,-0.683247,-0.683842,-0.687948,-0.692354,-0.69954];
% 62515L
av1=-13.5397+[-0.093022,-0.0924268,-0.0913537,-0.0918863,-0.0904158,-0.0891302,-0.0865988,-0.0794051,-0.0747375,-0.0634141,-0.0594393,-0.0533368,-0.0508839,-0.0483478,-0.0437166,-0.0365953,-0.0267577,-0.0224195,-0.0138343,-0.00824861,-0.00136015];
av2=448.593+[0.105483,0.109382,0.17645,0.255626,0.342782,0.416291,0.49239,0.48177,0.465412,0.40262,0.368615,0.27246,0.224664,0.16731,0.0804053,-0.00982352,-0.120318,-0.168327,-0.263497,-0.327758,-0.411807];
av3=-730.72+[-0.399117,-0.40754,-0.43212,-0.458153,-0.48101,-0.499572,-0.51739,-0.509295,-0.50142,-0.476276,-0.46297,-0.430531,-0.414859,-0.395339,-0.3695,-0.349122,-0.334476,-0.329952,-0.322847,-0.318892,-0.314452];
% 45869
aw1=-9.44941+[-0.118942,-0.118137,-0.119799,-0.124663,-0.126181,-0.124541,-0.116866,-0.103549,-0.0949183,-0.0758124,-0.0675187,-0.0501016,-0.0426118,-0.0344504,-0.0240161,-0.0133145,0.00216511,0.00925435,0.023363,0.0325498,0.0438306];
aw2=445.055+[0.200788,0.211586,0.294652,0.39239,0.481237,0.5536,0.63222,0.619209,0.599383,0.513178,0.465816,0.332796,0.266233,0.183432,0.052398,-0.0895347,-0.281096,-0.366527,-0.537321,-0.652577,-0.802398];
aw3=-724.288+[-0.785507,-0.805885,-0.836565,-0.860089,-0.868539,-0.863134,-0.847682,-0.851763,-0.854311,-0.859161,-0.860362,-0.863074,-0.863579,-0.86376,-0.866541,-0.875353,-0.89904,-0.912108,-0.940631,-0.960979,-0.988143];
% 65936R
ax1=-15.4024+[-0.0737235,-0.0719298,-0.0714584,-0.073801,-0.0724712,-0.0709435,-0.0673711,-0.0578457,-0.0519436,-0.0386344,-0.0343159,-0.0284444,-0.0262142,-0.0236901,-0.017615,-0.00751378,0.00679249,0.0131504,0.0256833,0.0338988,0.044117];
ax2=450.021+[0.133004,0.135746,0.222374,0.326117,0.440566,0.536333,0.631721,0.608834,0.580506,0.478098,0.422842,0.271198,0.196524,0.106164,-0.0272219,-0.161781,-0.32442,-0.395395,-0.536356,-0.631417,-0.755338];
ax3=-723.647+[-0.40013,-0.407992,-0.436738,-0.468374,-0.497045,-0.52033,-0.541988,-0.530421,-0.519513,-0.485138,-0.467183,-0.423231,-0.402179,-0.376152,-0.341053,-0.311736,-0.286725,-0.277753,-0.262033,-0.252464,-0.240983];

xi1=[ax1-aw1];
xi2=[ax2-aw2];
xi3=[ax3-aw3];
yj1=[au1-av1];
yj2=[au2-av2];
yj3=[au3-av3];
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4P
t6=[2,2.06926,2.1039,2.16327,2.20546,2.25429,2.30079,2.35429,2.4315,2.46157,2.514,2.56038,2.60079,2.65194,2.70721,2.75135,2.80366,2.85454,2.91895,2.95814,3];
% 40182U
ay1=-13.5191+[-0.188188,-0.165123,-0.114962,-0.0269859,0.0178655,0.056151,0.0777312,0.0939077,0.112172,0.120724,0.136998,0.150242,0.16025,0.171635,0.182987,0.191387,0.20088,0.209347,0.220025,0.226657,0.233413];
ay2=447.04+[0.40647,0.0833898,-0.0869705,-0.551316,-0.891722,-1.24121,-1.51907,-1.79396,-2.14578,-2.27585,-2.49624,-2.68471,-2.84402,-3.04016,-3.24748,-3.40768,-3.59152,-3.76382,-3.97521,-4.10033,-4.22979];
ay3=-720.839+[0.0762568,-0.844194,-0.781217,-0.669397,-0.651914,-0.660186,-0.681309,-0.708303,-0.747521,-0.761964,-0.786492,-0.808883,-0.829073,-0.85578,-0.885741,-0.909417,-0.937288,-0.963949,-0.996799,-1.01629,-1.03646];
% 62515L
az1=-13.5397+[-0.103792,-0.115235,-0.0907475,-0.0469348,-0.0241508,-0.00514165,0.0049664,0.0118574,0.019385,0.0230196,0.0303131,0.0360103,0.0400237,0.0445181,0.0489158,0.0519609,0.0554438,0.0585574,0.0626277,0.0652172,0.0678696];
az2=448.593+[0.221206,0.0909726,0.0447668,-0.150892,-0.325619,-0.490512,-0.619185,-0.746834,-0.911271,-0.972689,-1.07749,-1.16726,-1.24309,-1.33662,-1.43595,-1.51236,-1.60022,-1.68289,-1.78457,-1.84477,-1.9071];
az3=-730.72+[0.045403,-0.434506,-0.406968,-0.342137,-0.310108,-0.295081,-0.294313,-0.298178,-0.304489,-0.306166,-0.30821,-0.310258,-0.31288,-0.316967,-0.322374,-0.326862,-0.332284,-0.337593,-0.344084,-0.347902,-0.351899];
% 45869
ba1=-9.44941+[-0.161611,-0.166726,-0.123789,-0.0501085,-0.0111472,0.0218843,0.0390232,0.0504609,0.062793,0.0690215,0.0814915,0.091725,0.0993855,0.108035,0.116513,0.122584,0.129513,0.135646,0.143445,0.148387,0.153425];
ba2=445.055+[0.294828,0.0858075,-0.0363787,-0.395545,-0.674064,-0.9598,-1.1854,-1.40693,-1.68744,-1.79013,-1.96312,-2.11037,-2.23444,-2.38657,-2.54693,-2.67043,-2.81178,-2.94391,-3.10573,-3.20136,-3.30007];
ba3=-724.288+[0.176706,-0.847701,-0.820481,-0.781124,-0.801352,-0.846094,-0.896168,-0.951961,-1.02772,-1.05579,-1.10309,-1.14439,-1.18008,-1.22539,-1.27451,-1.31278,-1.35692,-1.3984,-1.44889,-1.47853,-1.50898];
% 65936R
bb1=-15.4024+[-0.125938,-0.104558,-0.0682355,-0.00629,0.0241447,0.0500532,0.0641403,0.0737009,0.0849706,0.0907104,0.10186,0.110737,0.117127,0.124346,0.131434,0.136537,0.142292,0.147417,0.154036,0.158181,0.162387];
bb2=450.021+[0.376348,0.0993064,0.0339645,-0.243534,-0.491219,-0.724898,-0.90851,-1.09197,-1.32939,-1.41801,-1.56898,-1.69852,-1.80805,-1.94326,-2.08697,-2.19788,-2.3255,-2.44564,-2.59329,-2.68066,-2.77118];
bb3=-723.647+[0.00670368,-0.433773,-0.399185,-0.313586,-0.266145,-0.237444,-0.226662,-0.221146,-0.215798,-0.213145,-0.208007,-0.204151,-0.202027,-0.200519,-0.20029,-0.200601,-0.20144,-0.202663,-0.204393,-0.205523,-0.206855];

xk1=[bb1-ba1];
xk2=[bb2-ba2];
xk3=[bb3-ba3];
yl1=[ay1-az1];
yl2=[ay2-az2];
yl3=[ay3-az3];
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_tether 
t13=[2,2.05126,2.11533,2.16533,2.21533,2.26533,2.31533,2.36533,2.41533,2.46533,2.51533,2.56533,2.62471,2.66689,2.70517,2.75527,2.80337,2.85848,2.91062,2.96632,3];
% 40182U
bc1=-13.5191+[-0.0411102,-0.0390694,-0.0411979,-0.0474489,-0.0553353,-0.0624179,-0.0684937,-0.0674649,-0.0639692,-0.0597975,-0.0544517,-0.0484104,-0.0407717,-0.0351313,-0.0299147,-0.0230135,-0.0164974,-0.00792338,0.00147678,0.0128618,0.0203627];
bc2=447.04+[0.270434,0.275289,0.338747,0.419498,0.514097,0.585408,0.646762,0.690512,0.714411,0.706771,0.675767,0.625953,0.551421,0.48487,0.419171,0.321624,0.216667,0.0882099,-0.0430362,-0.192404,-0.286832];
bc3=-720.839+[-0.541578,-0.553365,-0.578917,-0.60401,-0.62503,-0.621265,-0.600892,-0.584306,-0.566483,-0.556529,-0.546853,-0.536023,-0.520655,-0.507749,-0.495461,-0.478646,-0.460839,-0.440787,-0.42395,-0.408317,-0.399842];
% 62515L
bd1=-13.5397+[-0.0347915,-0.0340591,-0.0350132,-0.0383502,-0.0431807,-0.0494824,-0.057309,-0.0570058,-0.0548407,-0.0527558,-0.0500948,-0.04862,-0.0479188,-0.0478377,-0.0476414,-0.047274,-0.0467106,-0.0440739,-0.040327,-0.034847,-0.0310585];
bd2=448.593+[0.0984263,0.0979359,0.139832,0.196284,0.266325,0.343244,0.417799,0.480145,0.528419,0.542817,0.537692,0.517657,0.483443,0.451292,0.419202,0.370507,0.319114,0.257819,0.194969,0.123669,0.0785349];
bd3=-730.72+[-0.26728,-0.272479,-0.290803,-0.312446,-0.337258,-0.362188,-0.387804,-0.400974,-0.410046,-0.410001,-0.405491,-0.397613,-0.384404,-0.37208,-0.359644,-0.34174,-0.321504,-0.298397,-0.278117,-0.258705,-0.247792];
% 45869
be1=-9.44941+[-0.0464034,-0.0450567,-0.0470625,-0.0522428,-0.0591625,-0.0669325,-0.0750179,-0.0737656,-0.0698342,-0.0662298,-0.0616798,-0.0562626,-0.049285,-0.0441161,-0.0392281,-0.032649,-0.0266486,-0.0194126,-0.0116566,-0.0024153,0.00356036];
be2=445.055+[0.186149,0.192525,0.254104,0.331495,0.423813,0.505654,0.584506,0.649825,0.697407,0.708075,0.696523,0.668422,0.621949,0.57744,0.532558,0.463976,0.388567,0.294349,0.19614,0.0825726,0.010049];
be3=-724.288+[-0.49762,-0.511269,-0.53578,-0.557783,-0.576476,-0.579897,-0.572506,-0.568362,-0.56378,-0.565123,-0.56754,-0.569717,-0.570716,-0.570397,-0.569689,-0.568566,-0.566671,-0.565518,-0.566914,-0.571001,-0.5746];
% 65936R
bf1=-15.4024+[-0.0118342,-0.0102948,-0.0115998,-0.0165087,-0.0233388,-0.0322219,-0.0429424,-0.0409665,-0.0371378,-0.0349013,-0.031953,-0.0306622,-0.0302673,-0.0302401,-0.0300435,-0.029835,-0.0286749,-0.0236054,-0.0174375,-0.0091549,-0.00366363];
bf2=450.021+[0.151438,0.149112,0.202937,0.277471,0.370589,0.471718,0.568931,0.649459,0.710215,0.721533,0.705636,0.66886,0.609828,0.556279,0.503441,0.424624,0.340856,0.2432,0.144995,0.0358117,-0.0327098];
bf3=-723.647+[-0.272538,-0.27714,-0.298046,-0.323923,-0.354204,-0.385058,-0.416428,-0.433149,-0.444524,-0.443614,-0.436465,-0.424749,-0.405979,-0.388902,-0.371912,-0.347562,-0.320377,-0.289198,-0.261249,-0.233781,-0.218011];

xm1=[bf1-be1];
xm2=[bf2-be2];
xm3=[bf3-be3];
yn1=[bc1-bd1];
yn2=[bc2-bd2];
yn3=[bc3-bd3];
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end

%% figures
figure(1)

plot(t15,-1*height15,'b')
hold on
plot(t15,-1*width15,'k')
hold on

plot(t1,-1*height1,'-.b')
hold on
plot(t1,-1*width1,'-.k')
hold on

plot(t2,-1*height2,'-.bo')
hold on
plot(t2,-1*width2,'-.ko')
hold on

plot(t3,-1*height3,'-.b*')
hold on
plot(t3,-1*width3,'-.k*')
hold on

plot(t4,-1*height4,'-.bx')
hold on
plot(t4,-1*width4,'-.kx')
hold on

plot(t5,-1*height5,'-.b+')
hold on
plot(t5,-1*width5,'-.k+')
hold on

plot(t6,-1*height6,'-.bs')
hold on
plot(t6,-1*width6,'-.ks')
hold on

plot(t13,-1*height13,'-.b^')
hold on
plot(t13,-1*width13,'-.k^')

xlabel('time (s)')
ylabel({'Narrowing/Widening (mm)';'Positive is Widening, Negative is Narrowing'})
title('C5-C6 Right Hand Foreman Narrowing/Widening Under Flexion (4P)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','location','northwest')



%% Percent Change 
% bar plot 
figure(2)

pc15x=100-mag15x(21)/mag15x(1)*100;
pc15y=100-mag15y(21)/mag15y(1)*100;
pc15=[pc15y,pc15x];

pc1x=100-mag1x(21)/mag1x(1)*100;
pc1y=100-mag1y(21)/mag1y(1)*100;
pc1=[pc1y,pc1x];

pc2x=100-mag2x(21)/mag2x(1)*100;
pc2y=100-mag2y(21)/mag2y(1)*100;
pc2=[pc2y,pc2x];

pc3x=100-mag3x(21)/mag3x(1)*100;
pc3y=100-mag3y(21)/mag3y(1)*100;
pc3=[pc3y,pc3x];

pc4x=100-mag4x(21)/mag4x(1)*100;
pc4y=100-mag4y(21)/mag4y(1)*100;
pc4=[pc4y,pc4x];

pc5x=100-mag5x(21)/mag5x(1)*100;
pc5y=100-mag5y(21)/mag5y(1)*100;
pc5=[pc5y,pc5x];

pc6x=100-mag6x(21)/mag6x(1)*100;
pc6y=100-mag6y(21)/mag6y(1)*100;
pc6=[pc6y,pc6x];

pc13x=100-mag13x(21)/mag13x(1)*100;
pc13y=100-mag13y(21)/mag13y(1)*100;
pc13=[pc13y,pc13x];

% pc14x=100-mag14x(21)/mag14x(1)*100;
% pc14y=100-mag14y(21)/mag14y(1)*100;
% pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13];
bar(PC)
ylabel({'Percent Change';'Positive is Narrowing, Negative is Widening'})
xticklabels({'intact','Model 1','Model 2','Model 3','Model 4','Model 5','Model 6', 'Model 13'})
legend('height','width','location','southwest')
title('Spine Foraminal Size Constriction/Widening of Under 2 N-m of Flexion (4P)')