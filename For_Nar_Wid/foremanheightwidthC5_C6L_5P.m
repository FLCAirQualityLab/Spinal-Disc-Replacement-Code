%% this code finds c5-c6 left handed side foreman height and width narrowing/widening under lateral bending (5P)
clf
clear all
k=21;
%% model15_intact/TLC_5P
t15=[2,2.0575,2.12605,2.15275,2.21233,2.25121,2.30204,2.36312,2.40096,2.45209,2.50097,2.55317,2.60321,2.65826,2.70492,2.75514,2.80039,2.85766,2.90816,2.95077,3];
%52253I
aa1=8.79613+[0.0773793,0.154871,0.305451,0.371965,0.529018,0.631256,0.754604,0.898919,0.98146,1.07812,1.15081,1.2039,1.2513,1.30973,1.35701,1.40259,1.44063,1.48776,1.52812,1.56028,1.59611];
aa2=445.506+[-0.182232,0.00581274,0.390036,0.576967,1.04246,1.35557,1.72074,2.14046,2.37992,2.65741,2.86609,3.01893,3.15329,3.27577,3.37411,3.47545,3.56668,3.68253,3.7827,3.86603,3.9607,];
aa3=-724.269+[-0.731418,-0.920016,-1.17425,-1.27664,-1.51274,-1.66901,-1.86005,-2.07933,-2.2079,-2.36159,-2.47399,-2.56177,-2.63706,-2.7005,-2.75083,-2.79926,-2.84081,-2.89321,-2.93798,-2.97512,-3.01742];
%58363R
ab1=15.2185+[0.071198,0.131007,0.240589,0.288178,0.401345,0.475495,0.568497,0.673487,0.735743,0.812,0.868649,0.915033,0.957036,1.00068,1.03594,1.06913,1.09745,1.1326,1.16211,1.1857,1.21235];
ab2=451.452+[-0.206034,-0.106209,0.196456,0.353751,0.749381,1.01539,1.3223,1.68158,1.8807,2.10138,2.26246,2.36738,2.45842,2.55455,2.63187,2.7112,2.78216,2.87159,2.94986,3.01549,3.08989];
ab3=-725.54+[-0.393421,-0.510726,-0.742966,-0.851646,-1.12066,-1.30239,-1.52915,-1.79758,-1.95144,-2.1269,-2.25236,-2.33797,-2.41113,-2.48636,-2.54659,-2.60467,-2.65482,-2.71768,-2.77221,-2.81753,-2.86901];
%36619U
ac1=13.469+[0.091201,0.181436,0.341743,0.410348,0.569835,0.671661,0.793497,0.933511,1.01328,1.10659,1.17628,1.22682,1.27169,1.32977,1.37691,1.42193,1.4592,1.50519,1.54441,1.57531,1.60967];
ac2=448.169+[-0.108023,0.162928,0.671749,0.911722,1.49896,1.89008,2.34513,2.86446,3.1595,3.50121,3.7581,3.94917,4.11673,4.26595,4.38511,4.50756,4.61736,4.7562,4.87574,4.9751,5.08761];
ac3=-721.068+[-0.814338,-1.09706,-1.48783,-1.64858,-2.02316,-2.2714,-2.57365,-2.92094,-3.1251,-3.37071,-3.55473,-3.70132,-3.82892,-3.93952,-4.02794,-4.11493,-4.19049,-4.28571,-4.36712,-4.43445,-4.51099];
%57675L
ad1=12.0806+[0.0350013,0.0746185,0.15247,0.186908,0.269595,0.324205,0.392042,0.46848,0.514301,0.571297,0.614132,0.64963,0.681893,0.715693,0.743057,0.76888,0.791011,0.818557,0.841731,0.860319,0.881358];
ad2=448.924+[-0.164776,-0.0854672,0.154453,0.278971,0.591557,0.802434,1.04542,1.32957,1.48638,1.6598,1.78647,1.86887,1.94053,2.01597,2.07657,2.13858,2.19397,2.26376,2.32481,2.37594,2.43391];
ad3=-730.705+[-0.390943,-0.485491,-0.666286,-0.749688,-0.954812,-1.09325,-1.26677,-1.47135,-1.58804,-1.72037,-1.81385,-1.87678,-1.92997,-1.98414,-2.02726,-2.06811,-2.103,-2.14659,-2.18433,-2.21569,-2.25128];
%(R-I),(U-L)
xa1=[ab1-aa1];
xa2=[ab2-aa2];
xa3=[ab3-aa3];
ya1=[ac1-ad1];
ya2=[ac2-ad2];
ya3=[ac3-ad3];
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end
figure(1)
plot(t15,-1*width15,'k')
hold on
plot(t15,-1*height15,'b')


%% Percent change
figure(2)
pc15x=100-mag15x(21)/mag15x(1)*100;
pc15y=100-mag15y(21)/mag15y(1)*100;
pc15=[pc15y,pc15x];
b=bar(pc15);


