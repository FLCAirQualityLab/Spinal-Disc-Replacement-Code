%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under lateral bending (5P)
% 36572,16215,31500,37435
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 36572,16215,31500,37435
%% model15_intact_TLC_5P
t15=[2 2.05 2.10719 2.15841 2.20749 2.25204 2.30359 2.36468 2.40251 2.45207 2.50137 2.56422 2.60772 2.65475 2.70141 2.75163 2.81747 2.85415 2.90465 2.96581 3 ];

% 36572
aa1=12.3763+[0.111599 0.327732 0.574809 0.807352 1.03686 1.25138 1.49479 1.76168 1.92151 2.11276 2.27032 2.40922 2.48882 2.5741 2.65552 2.73546 2.83091 2.88256 2.95166 3.03026 3.07286];
aa2=446.738+[0.535552 0.314825 0.470831 0.821415 1.27722 1.76089 2.3542 3.01643 3.41901 3.89003 4.29243 4.64998 4.84573 5.02119 5.17709 5.33458 5.5354 5.64691 5.7987 5.97843 6.07689];
aa3=-714.659+[-0.774879 -0.98822 -1.24189 -1.48942 -1.74254 -1.98735 -2.27913 -2.61568 -2.82237 -3.0759 -3.29221 -3.48695 -3.59862 -3.69616 -3.78533 -3.8732 -3.98176 -4.04183 -4.12329 -4.21931 -4.27225];

% 16215
ab1=12.1679+[0.223784 0.598338 1.00215 1.37194 1.73144 2.06193 2.4314 2.83412 3.07515 3.36479 3.60565 3.82087 3.94436 4.06973 4.18795 4.30336 4.44101 4.51499 4.61242 4.72237 4.78204];
ab2=446.385+[0.866838 0.580264 0.82014 1.31418 1.94446 2.60426 3.41046 4.31212 4.85232 5.4926 6.04307 6.55584 6.84089 7.09875 7.3269 7.55691 7.84807 8.00902 8.22814 8.48744 8.62893];
ab3=-705.203+[-0.935817 -1.22226 -1.56065 -1.8821 -2.20754 -2.51952 -2.89077 -3.32087 -3.58353 -3.90904 -4.19355 -4.46903 -4.6317 -4.77985 -4.91583 -5.05223 -5.22241 -5.3163 -5.4436 -5.59428 -5.67739];

% 31500
ac1=9.70641+[0.238644 0.61598 1.02905 1.41058 1.78282 2.12606 2.51224 2.93448 3.18735 3.48978 3.74209 3.96884 4.09951 4.23052 4.35362 4.47423 4.61884 4.6968 4.79983 4.9167 4.98014 ];
ac2=444.062+[0.758958 0.45656 0.649544 1.08876 1.66152 2.26757 3.01208 3.84839 4.35193 4.95083 5.46689 5.94703 6.2136 6.45574 6.67034 6.88692 7.16147 7.31343 7.52049 7.76577 7.89983];
ac3=-707.068+[-0.814455 -1.08256 -1.36613 -1.62077 -1.8715 -2.10943 -2.39163 -2.72052 -2.92279 -3.17364 -3.39265 -3.60252 -3.72711 -3.84025 -3.94482 -4.0496 -4.18018 -4.25225 -4.34985 -4.4655 -4.52954];

% 37435
ad1=16.2708+[0.132811 0.390497 0.674891 0.937175 1.19292 1.42985 1.69596 1.98591 2.15805 2.36488 2.53461 2.68459 2.77057 2.86276 2.9511 3.03763 3.14067 3.19636 3.27063 3.35475 3.4004 ];
ad2=449.059+[0.698641 0.469952 0.68001 1.10958 1.65745 2.23284 2.93589 3.71859 4.19263 4.7469 5.22006 5.64235 5.87414 6.07968 6.26178 6.44555 6.67943 6.80904 6.98529 7.19377 7.3077];
ad3=-710.186+[-0.884108 -1.13087 -1.45109 -1.7755 -2.11378 -2.4436 -2.83815 -3.2925 -3.57119 -3.91375 -4.20783 -4.47671 -4.63121 -4.76737 -4.89189 -5.01541 -5.16875 -5.25361 -5.36862 -5.50404 -5.5786 ];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5P
t1=[2 2.05126 2.10091 2.15165 2.20195 2.26309 2.30825 2.35242 2.40115 2.45206 2.50453 2.55201 2.60315 2.66299 2.70555 2.75188 2.8058 2.85226 2.9048 2.95124 3 ];
% 36572
ae1=12.3763+[-0.296363 -0.267433 -0.20909 -0.102477 0.0636972 0.32499 0.541316 0.759618 0.994543 1.23191 1.46559 1.66479 1.87431 2.10679 2.25629 2.40514 2.55237 2.65548 2.75142 2.82946 2.90549 ];
ae2=446.738+[0.797079 0.566578 0.540575 0.59837 0.694593 0.857625 1.01139 1.19549 1.44035 1.74376 2.09812 2.44815 2.85209 3.33656 3.67941 4.02112 4.37929 4.65987 4.94658 5.18443 5.42152];
ae3=-714.659+[-0.615151 -0.938859 -1.08508 -1.25112 -1.43259 -1.67875 -1.86502 -2.04505 -2.24605 -2.45748 -2.6779 -2.88354 -3.10088 -3.35097 -3.51559 -3.66265 -3.8044 -3.90994 -4.01497 -4.10251 -4.19153];

% 16215
af1=12.1679+[-0.324978 -0.180333 0.0337621 0.313768 0.644782 1.09319 1.43684 1.77097 2.12547 2.47899 2.824 3.1182 3.42119 3.75382 3.96694 4.17287 4.37596 4.51992 4.66044 4.77216 4.87792];
af2=446.385+[1.47688 1.363 1.40651 1.51349 1.65446 1.87805 2.08543 2.32941 2.65057 3.04751 3.51476 3.97999 4.5181 5.17327 5.64429 6.12806 6.64557 7.05523 7.48082 7.83023 8.17466];
af3=-705.203+[-0.848839 -1.29957 -1.55134 -1.8177 -2.08791 -2.42511 -2.67278 -2.91099 -3.17463 -3.45168 -3.74173 -4.01246 -4.30234 -4.64214 -4.87474 -5.09926 -5.33047 -5.50984 -5.69738 -5.854 -6.01112];

% 31500
ag1=9.70641+[-0.300144 -0.155695 0.0645896 0.354695 0.698487 1.16337 1.51955 1.86644 2.23509 2.60433 2.96591 3.27521 3.59469 3.94604 4.17246 4.39085 4.60661 4.76008 4.90994 5.02984 5.14443 ];
ag2=444.066+[1.35021 1.21012 1.2208 1.29093 1.39386 1.5706 1.74355 1.95404 2.2383 2.59577 3.02183 3.44956 3.94804 4.55833 4.9988 5.45319 5.94095 6.32857 6.73256 7.06456 7.39193 ];
ag3=-707.086+[-0.716544 -1.13042 -1.34294 -1.56785 -1.79676 -2.08143 -2.289 -2.48719 -2.70452 -2.93005 -3.16297 -3.37807 -3.60591 -3.86939 -4.04696 -4.21402 -4.38252 -4.5121 -4.64722 -4.76061 -4.87511];

% 37435
ah1=16.2708+[-0.32538 -0.26962 -0.182647 -0.0456881 0.148479 0.443683 0.684149 0.923819 1.18067 1.43847 1.69142 1.90712 2.13228 2.38158 2.54086 2.69882 2.85471 2.96344 3.06471 3.14705 3.22691];
ah2=449.059+[0.940437 0.682399 0.675366 0.768808 0.909453 1.13325 1.33431 1.56701 1.86918 2.23757 2.66331 3.08177 3.5604 4.13312 4.53723 4.93764 5.35645 5.68398 6.01817 6.29471 6.57028];
ah3=-710.186+[-0.667767 -1.00091 -1.18343 -1.39745 -1.63092 -1.94606 -2.18535 -2.4179 -2.67928 -2.95684 -3.24923 -3.52424 -3.81769 -4.15986 -4.38897 -4.59975 -4.80877 -4.96662 -5.12548 -5.25807 -5.39246];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5P
t2=[2 2.05126 2.11533 2.17471 2.20404 2.25438 2.33159 2.3549 2.4016 2.46738 2.50746 2.55002 2.60679 2.65835 2.71084 2.76368 2.81124 2.86007 2.90407 2.95108 3];

% 36572
ai1=12.3763+[-0.24139 -0.249557 -0.27432 -0.281855 -0.274894 -0.235064 -0.0861768 -0.0258612 0.114381 0.346337 0.498583 0.664832 0.888485 1.09264 1.30282 1.51164 1.69491 1.88256 2.05157 2.22459 2.39326];
ai2=446.738+[0.905469 0.815386 0.772465 0.788288 0.811807 0.873112 0.988986 1.02812 1.11576 1.26235 1.36955 1.50075 1.70547 1.91554 2.14881 2.40525 2.65553 2.92153 3.1681 3.43418 3.71201];
ai3=-714.659+[-0.763679 -0.908902 -1.0165 -1.12431 -1.18327 -1.29526 -1.4949 -1.55971 -1.69666 -1.89679 -2.02449 -2.16532 -2.36061 -2.54276 -2.72735 -2.91516 -3.08505 -3.25769 -3.4056 -3.55381 -3.69671];

% 16215
aj1=12.1679+[-0.242242 -0.202692 -0.115545 0.004186 0.0776908 0.233818 0.555018 0.665517 0.904734 1.27177 1.50488 1.75548 2.08901 2.3895 2.69303 2.9917 3.25288 3.51692 3.75088 3.98926 4.22058 ];
aj2=446.385+[1.74178 1.68689 1.72241 1.80641 1.8603 1.96985 2.159 2.21984 2.34937 2.56099 2.70844 2.88559 3.15575 3.43117 3.73729 4.07483 4.40484 4.75608 5.08421 5.44264 5.82205];
aj3=-705.203+[-1.05161 -1.25042 -1.4569 -1.66365 -1.77032 -1.96069 -2.26441 -2.3575 -2.5476 -2.82163 -2.99286 -3.17971 -3.43612 -3.67437 -3.91751 -4.16545 -4.39093 -4.62246 -4.82566 -5.03522 -5.24444];

% 31500
ak1=9.70641+[-0.21745 -0.179666 -0.0899364 0.0357545 0.113426 0.278373 0.615313 0.730968 0.98087 1.36395 1.60733 1.86924 2.2185 2.53398 2.85255 3.16552 3.4393 3.71632 3.96096 4.21 4.45205];
ak2=444.066+[1.58819 1.52581 1.53722 1.59301 1.63151 1.71301 1.85712 1.90428 2.00651 2.17913 2.3028 2.45445 2.69031 2.93433 3.20918 3.51604 3.81874 4.14264 4.44738 4.78185 5.1373];
ak3=-707.086+[-0.881612 -1.0671 -1.24173 -1.41424 -1.50305 -1.66183 -1.91481 -1.99247 -2.15151 -2.3803 -2.52341 -2.67944 -2.89327 -3.09138 -3.29254 -3.49612 -3.67972 -3.86764 -4.03074 -4.19643 -4.3595];

% 37435
al1=16.2708+[-0.262384 -0.258394 -0.263254 -0.250163 -0.23235 -0.174055 0.00500309 0.074543 0.233479 0.491001 0.658463 0.840513 1.08428 1.30566 1.53253 1.75798 1.95553 2.15706 2.33818 2.52322 2.70292];
al2=449.059+[1.06927 0.964586 0.928087 0.963788 1.00104 1.09194 1.26093 1.31692 1.43929 1.63712 1.77738 1.94558 2.20286 2.46301 2.74758 3.05662 3.35572 3.67138 3.96147 4.27367 4.59866];
al3=-710.186+[-0.835382 -0.983714 -1.11304 -1.25099 -1.32784 -1.47427 -1.73413 -1.81805 -1.99464 -2.25267 -2.41733 -2.5991 -2.85154 -3.08762 -3.32798 -3.5741 -3.79841 -4.02723 -4.22568 -4.42791 -4.62608];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5P
t3=[2 2.05126 2.11533 2.17471 2.20107 2.25991 2.30337 2.35035 2.40609 2.45257 2.51312 2.55394 2.60039 2.6528 2.7013 2.75933 2.80608 2.85863 2.92741 2.95108 3 ];
% 36572
am1=12.3763+[-0.0625365 -0.0706226 -0.108543 -0.153228 -0.17396 -0.216074 -0.239952 -0.250263 -0.240547 -0.209836 -0.142057 -0.0800312 0.00109353 0.105287 0.212971 0.354114 0.477666 0.626017 0.829994 0.901451 1.05124];
am2=446.738+[0.664822 0.637731 0.612283 0.606705 0.611077 0.636027 0.668749 0.714954 0.777004 0.8308 0.904702 0.957704 1.0222 1.10394 1.1903 1.30689 1.40775 1.53235 1.71487 1.78196 1.93027 ];
am3=-714.659+[-1.00175 -1.02319 -1.05535 -1.09433 -1.115 -1.17099 -1.22097 -1.28455 -1.37183 -1.45209 -1.56473 -1.64397 -1.73781 -1.84982 -1.95865 -2.09411 -2.20412 -2.33066 -2.50273 -2.56319 -2.69045];
% 16215
an1=12.1679+[0.0741139 0.084999 0.102309 0.126647 0.141025 0.18353 0.226671 0.289252 0.38434 0.48461 0.641088 0.761749 0.908855 1.08693 1.26243 1.4838 1.67025 1.88814 2.18177 2.28384 2.49652];
an2=446.385+[1.46322 1.44133 1.45726 1.50377 1.533 1.61601 1.69054 1.78056 1.89341 1.98937 2.12018 2.21354 2.32432 2.45804 2.59214 2.76679 2.9163 3.09632 3.35211 3.44469 3.64654];
an3=-705.203+[-1.33312 -1.37131 -1.45955 -1.56682 -1.62094 -1.75414 -1.86188 -1.98524 -2.13685 -2.26655 -2.44092 -2.56106 -2.7005 -2.8625 -3.01647 -3.20518 -3.35904 -3.53454 -3.76968 -3.85188 -4.02442];
% 31500
ao1=9.70641+[0.100468 0.109258 0.124881 0.149626 0.164856 0.211129 0.258585 0.327259 0.430822 0.538774 0.706105 0.834535 0.990819 1.17973 1.36574 1.60032 1.79767 2.0278 2.33743 2.44503 2.66908];
ao2=444.066+[1.29841 1.27611 1.2839 1.31754 1.33966 1.40363 1.46188 1.53263 1.62133 1.69664 1.79966 1.87387 1.96278 2.07164 2.18257 2.3293 2.45651 2.61192 2.83604 2.91786 3.0977];
ao3=-707.086+[-1.14938 -1.18389 -1.2577 -1.34633 -1.39096 -1.50048 -1.58916 -1.69093 -1.81598 -1.92296 -2.06656 -2.16526 -2.27997 -2.41351 -2.54065 -2.69666 -2.82397 -2.96932 -3.16425 -3.23244 -3.37557];
% 37435
ap1=16.2708+[-0.0527419 -0.0563488 -0.0852545 -0.119845 -0.135777 -0.165829 -0.180544 -0.180678 -0.157733 -0.115412 -0.0321129 0.0403669 0.13345 0.251274 0.371587 0.527668 0.662838 0.82419 1.04519 1.1224 1.28393 ];
ap2=449.059+[0.808319 0.776263 0.748356 0.746179 0.754152 0.791963 0.839096 0.905104 0.994129 1.07188 1.17847 1.25448 1.34582 1.45931 1.57656 1.73168 1.86358 2.02325 2.25296 2.33659 2.51963 ];
ap3=-710.186+[-1.08969 -1.11262 -1.1519 -1.20221 -1.22941 -1.30396 -1.37077 -1.45534 -1.5708 -1.67624 -1.82346 -1.92693 -2.04921 -2.19486 -2.3363 -2.51241 -2.65538 -2.81974 -3.04335 -3.12197 -3.28756];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5P
t4=[2 2.05816 2.1053 2.16112 2.20014 2.26066 2.3058 2.3555 2.40111 2.45779 2.5144 2.55097 2.6021 2.65706 2.70343 2.76727 2.80028 2.85535 2.90823 2.95284 3];
% 36572
aq1=12.3763+[-0.215014 0.184159 0.441102 0.715768 0.905788 1.21178 1.44464 1.68135 1.88281 2.08637 2.23338 2.30575 2.40244 2.4971 2.57219 2.6666 2.71436 2.79243 2.86562 2.92432 2.98397];
aq2=446.738+[0.808702 0.211839 0.350946 0.720272 1.08784 1.78105 2.33123 2.91032 3.40948 3.93853 4.34967 4.54961 4.77352 4.98595 5.15623 5.38235 5.49732 5.68687 5.8664 6.01669 6.17111];
aq3=-714.659+[0.194024 -1.26022 -1.50208 -1.77288 -1.9708 -2.29048 -2.53789 -2.80987 -3.05335 -3.31385 -3.51212 -3.61011 -3.71621 -3.81917 -3.9005 -4.0052 -4.05863 -4.14599 -4.2289 -4.29816 -4.37061];
% 16215
ar1=12.1679+[-0.403375 0.621277 1.09372 1.56227 1.8725 2.34757 2.69648 3.04913 3.34634 3.64655 3.86497 3.97334 4.11164 4.24693 4.35372 4.48879 4.55727 4.66953 4.77416 4.85857 4.94555];
ar2=446.385+[1.40349 0.850661 1.02799 1.53634 2.0394 2.97406 3.71589 4.49985 5.18081 5.91445 6.50215 6.7974 7.13563 7.45865 7.71695 8.05857 8.23177 8.51427 8.77941 9.00067 9.22945 ];
ar3=-705.203+[0.136572 -1.72159 -2.07043 -2.44522 -2.71196 -3.13789 -3.46773 -3.83174 -4.16128 -4.52434 -4.8187 -4.9733 -5.15262 -5.33012 -5.47263 -5.6599 -5.75602 -5.9131 -6.06102 -6.18457 -6.31407];
% 31500
as1=9.70641+[-0.371109 0.656658 1.14401 1.62969 1.95288 2.45034 2.81664 3.18865 3.50365 3.82289 4.05856 4.1765 4.32518 4.47103 4.58643 4.7329 4.80696 4.92802 5.04109 5.1328 5.22751];
as2=444.066+[1.26279 0.670916 0.802879 1.24986 1.70543 2.56411 3.25077 3.97874 4.61273 5.29812 5.84717 6.12258 6.43893 6.74113 6.98317 7.30406 7.46717 7.7339 7.98466 8.19415 8.41098];
as3=-707.086+[0.278094 -1.52862 -1.83031 -2.13257 -2.3385 -2.66098 -2.90972 -3.1865 -3.43854 -3.71538 -3.93797 -4.0546 -4.18924 -4.32319 -4.43066 -4.57161 -4.64413 -4.7629 -4.87502 -4.96878 -5.06731 ];
% 37435
at1=16.2708+[-0.248265 0.249683 0.542853 0.851515 1.06284 1.39795 1.65051 1.90624 2.12277 2.34161 2.49852 2.57569 2.67895 2.78013 2.86029 2.96087 3.01172 3.09482 3.17259 3.23464 3.29751];
at2=449.059+[1.0122 0.321336 0.513782 0.972928 1.41861 2.24589 2.8981 3.58359 4.174 4.79935 5.28689 5.52498 5.78955 6.04044 6.24122 6.50725 6.64214 6.86385 7.0735 7.24903 7.42939];
at3=-710.186+[0.112597 -1.37958 -1.68537 -2.04212 -2.30987 -2.7483 -3.0891 -3.46226 -3.79582 -4.1556 -4.43385 -4.57297 -4.72578 -4.87435 -4.99252 -5.14586 -5.22408 -5.35215 -5.47377 -5.57534 -5.68122 ];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5P
t5=[2 2.05126 2.11533 2.17471 2.20107 2.25991 2.30337 2.35035 2.40415 2.45064 2.51269 2.558 2.61911 2.66482 2.70279 2.77248 2.82013 2.86034 2.91837 2.95368 3];
% 36572
au1=12.3763+[-0.0645383 -0.071181 -0.106926 -0.149235 -0.169055 -0.210102 -0.233741 -0.245225 -0.237986 -0.210078 -0.145785 -0.0799479 0.025764 0.116382 0.198853 0.365114 0.490401 0.601697 0.769325 0.873854 1.01326];
au2=446.738+[0.630243 0.603928 0.582691 0.582051 0.588572 0.617359 0.650782 0.696696 0.7564 0.810548 0.887309 0.946923 1.03527 1.10929 1.17743 1.31651 1.42007 1.51398 1.66209 1.75911 1.89627];
au3=-714.659+[-0.996715 -1.01809 -1.05122 -1.09189 -1.11322 -1.16978 -1.21949 -1.28169 -1.36415 -1.44281 -1.55606 -1.64275 -1.76608 -1.86348 -1.94778 -2.10806 -2.21893 -2.31434 -2.45633 -2.54492 -2.66388];
% 16215
av1=12.1679+[0.0479822 0.0566322 0.0712015 0.093351 0.106798 0.146896 0.187966 0.247573 0.335409 0.431523 0.585537 0.715565 0.906891 1.06103 1.19603 1.45764 1.64632 1.81039 2.05343 2.20348 2.4024 ];
av2=446.385+[1.48605 1.46412 1.47729 1.51998 1.54735 1.62654 1.6985 1.78635 1.89381 1.98875 2.12149 2.22441 2.37073 2.48836 2.59285 2.80048 2.95294 3.08856 3.29729 3.43149 3.618];
av3=-705.203+[-1.34535 -1.38334 -1.46982 -1.57402 -1.62652 -1.75592 -1.86085 -1.98143 -2.12487 -2.25222 -2.42763 -2.55895 -2.74022 -2.8801 -2.99912 -3.22285 -3.37787 -3.51032 -3.70504 -3.82564 -3.98673];
% 31500
aw1=9.70641+[0.0756118 0.0820532 0.0946398 0.11687 0.130993 0.17439 0.219446 0.284763 0.380458 0.484051 0.64891 0.787426 0.99074 1.15432 1.29746 1.57469 1.7743 1.94764 2.20404 2.3622 2.57172];
aw2=444.066+[1.31678 1.29451 1.30007 1.33069 1.35138 1.41258 1.46894 1.53825 1.62303 1.69775 1.80262 1.88461 2.00259 2.09881 2.18538 2.35993 2.49003 2.60702 2.78928 2.90761 3.0735];
aw3=-707.086+[-1.15639 -1.19064 -1.26309 -1.34939 -1.39279 -1.49941 -1.58584 -1.68537 -1.80369 -1.90873 -2.05323 -2.16111 -2.31032 -2.42566 -2.52393 -2.7088 -2.837 -2.94665 -3.108 -3.20799 -3.34162 ];
% 37435
ax1=16.2708+[-0.0552054 -0.0573254 -0.0838607 -0.115779 -0.130717 -0.159716 -0.174165 -0.175709 -0.155936 -0.116591 -0.0367199 0.0405503 0.161794 0.264103 0.356321 0.540186 0.677133 0.798209 0.9799 1.09296 1.24337];
ax2=449.059+[0.768975 0.737857 0.715 0.718671 0.729155 0.771347 0.818941 0.884196 0.969482 1.04733 1.15744 1.24247 1.36655 1.46848 1.56073 1.74559 1.88047 2.00095 2.18826 2.30956 2.47928];
ax3=-710.186+[-1.08139 -1.10441 -1.1453 -1.19809 -1.22624 -1.30165 -1.36807 -1.45078 -1.55994 -1.66341 -1.81165 -1.92496 -2.08583 -2.21261 -2.32226 -2.53073 -2.67488 -2.79888 -2.98342 -3.09864 -3.25343];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5P
t6=[2 2.06926 2.11039 2.16205 2.20253 2.25469 2.30237 2.35235 2.40447 2.45402 2.50951 2.55995 2.60457 2.66104 2.70282 2.76219 2.80057 2.85371 2.90136 2.95138 3];
% 36572
ay1=12.3763+[-0.215017 -0.10019 0.084598 0.348773 0.561944 0.824868 1.05559 1.2928 1.53218 1.75144 1.98044 2.16778 2.3003 2.4339 2.51712 2.62048 2.68082 2.75943 2.82827 2.89735 2.96097];
ay2=446.738+[0.808829 0.384392 0.425642 0.56281 0.724307 1.01377 1.35088 1.77368 2.26975 2.76735 3.33538 3.81913 4.20027 4.57342 4.80392 5.08706 5.25444 5.46799 5.64742 5.82933 5.99979];
ay3=-714.659+[0.193483 -1.10738 -1.29991 -1.54367 -1.7345 -1.97621 -2.18978 -2.41728 -2.66486 -2.90713 -3.18169 -3.40823 -3.57669 -3.72508 -3.81718 -3.93229 -4.00062 -4.0906 -4.16882 -4.24903 -4.32521];
% 16215
az1=12.1679+[-0.403358 0.160366 0.535843 1.00726 1.36079 1.78124 2.13784 2.4967 2.85503 3.17929 3.51664 3.78805 3.9831 4.17869 4.30121 4.44938 4.53584 4.64846 4.74651 4.84557 4.93864];
az2=446.385+[1.40391 1.19998 1.26335 1.44159 1.65534 2.04181 2.48964 3.05012 3.70773 4.37425 5.13992 5.80354 6.3383 6.88241 7.22061 7.63509 7.88085 8.19524 8.45885 8.72514 8.97704];
az3=-705.203+[0.135333 -1.55664 -1.84179 -2.18537 -2.4426 -2.76327 -3.04631 -3.34782 -3.67517 -3.99852 -4.3681 -4.68405 -4.93308 -5.17916 -5.33736 -5.53788 -5.65958 -5.8208 -5.9601 -6.10255 -6.23888];
% 31500
ba1=9.70641+[-0.371091 0.192185 0.577627 1.06431 1.42971 1.86566 2.23694 2.61239 2.98854 3.33061 3.6884 3.97688 4.18682 4.39642 4.52804 4.68818 4.78207 4.90449 5.01087 5.11853 5.21966];
ba2=444.066+[1.26326 1.02047 1.04806 1.18113 1.35897 1.69781 2.10149 2.61386 3.22077 3.83916 4.55281 5.17418 5.67542 6.18738 6.50596 6.89654 7.12828 7.42492 7.67401 7.92598 8.16481];
ba3=-707.086+[0.276778 -1.35853 -1.60401 -1.89894 -2.11509 -2.37777 -2.60397 -2.84015 -3.09357 -3.34219 -3.62535 -3.86494 -4.0509 -4.23069 -4.34672 -4.49468 -4.58473 -4.70481 -4.8093 -4.91655 -5.01927];
% 37435
bb1=16.2708+[-0.248256 -0.0672435 0.152569 0.452496 0.691114 0.983043 1.23626 1.49425 1.75366 1.98992 2.23569 2.43589 2.57617 2.71759 2.80586 2.91552 2.9795 3.0628 3.13582 3.20885 3.27601];
bb2=449.059+[1.01233 0.500561 0.57708 0.769599 0.980653 1.34212 1.75164 2.25831 2.84812 3.43769 4.10935 4.67935 5.12938 5.56684 5.83659 6.16769 6.36328 6.61275 6.82206 7.03426 7.23302];
bb3=-710.186+[0.11204 -1.20085 -1.44522 -1.75458 -1.99955 -2.31465 -2.5981 -2.90443 -3.24087 -3.57183 -3.94893 -4.26408 -4.50355 -4.72165 -4.85798 -5.02872 -5.13048 -5.26399 -5.3795 -5.4978 -5.60995];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5P
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35451 2.40116 2.45302 2.50151 2.55488 2.60159 2.66574 2.70148 2.76497 2.80618 2.85814 2.90512 2.97561 3];
% 36572
bc1=12.3763+[-0.00126366 -0.00933834 -0.0412122 -0.066158 -0.0892162 -0.0947255 -0.0874905 -0.0707253 -0.0307038 0.0329589 0.111122 0.214744 0.319061 0.481896 0.578699 0.758765 0.878247 1.0352 1.18232 1.40713 1.48521];
bc2=446.738+[0.696855 0.661302 0.635418 0.640335 0.663737 0.680995 0.741381 0.781882 0.838674 0.906707 0.973632 1.05394 1.13258 1.25946 1.33985 1.50355 1.61918 1.77373 1.92609 2.18073 2.27449 ];
bc3=-714.659+[-0.705812 -0.727242 -0.763685 -0.806893 -0.870101 -0.90276 -1.00242 -1.06753 -1.16 -1.27164 -1.38073 -1.50494 -1.61659 -1.77582 -1.86808 -2.03956 -2.15431 -2.29948 -2.43201 -2.63593 -2.70759];
% 16215
bd1=12.1679+[0.129016 0.143812 0.176668 0.219801 0.284858 0.320491 0.433999 0.510971 0.625925 0.772671 0.927423 1.11415 1.29004 1.54941 1.69967 1.97403 2.15427 2.38562 2.59889 2.92201 3.03364 ];
bd2=446.385+[1.63099 1.60242 1.61585 1.66038 1.7347 1.77545 1.89337 1.96594 2.06124 2.17481 2.28657 2.41834 2.54436 2.73498 2.85097 3.08021 3.23922 3.45223 3.65805 3.99389 4.11642];
bd3=-705.203+[-1.0531 -1.09679 -1.19825 -1.3046 -1.44653 -1.5151 -1.69979 -1.80953 -1.95175 -2.11689 -2.27561 -2.4541 -2.61347 -2.83559 -2.96216 -3.19419 -3.34838 -3.54495 -3.72384 -3.99689 -4.09262];
% 31500
be1=9.70641+[0.155694 0.168287 0.199681 0.243819 0.312099 0.350078 0.471386 0.553751 0.67603 0.831612 0.995142 1.19207 1.37742 1.65026 1.80831 2.09687 2.28652 2.52959 2.75311 3.09131 3.20819];
be2=444.066+[1.44871 1.41935 1.42354 1.45572 1.51203 1.54351 1.63548 1.69218 1.76686 1.85646 1.94531 2.05152 2.15482 2.31448 2.41323 2.61165 2.75077 2.93913 3.12332 3.42738 3.53901];
be3=-707.086+[-0.843245 -0.882485 -0.967942 -1.0569 -1.17554 -1.23295 -1.38754 -1.47933 -1.59818 -1.73582 -1.86794 -2.01638 -2.14877 -2.33349 -2.43892 -2.63212 -2.7606 -2.92419 -3.0729 -3.29951 -3.37879 ];
% 37435
bf1=16.2708+[0.00528751 0.00199242 -0.0198875 -0.0350279 -0.0454542 -0.0454923 -0.0231049 0.00300437 0.0559299 0.134604 0.22695 0.346073 0.463753 0.644851 0.751819 0.950085 1.08129 1.2529 1.41309 1.6569 1.74136];
bf2=449.059+[0.880613 0.839307 0.811689 0.821986 0.85718 0.882119 0.968109 1.02551 1.10608 1.20281 1.29758 1.40958 1.517 1.6853 1.78974 1.99827 2.14383 2.33553 2.52167 2.82904 2.94157];
bf3=-710.186+[-0.813393 -0.836107 -0.880953 -0.936373 -1.01817 -1.06045 -1.18935 -1.27332 -1.3923 -1.53586 -1.67599 -1.83552 -1.97906 -2.18405 -2.30288 -2.52405 -2.6722 -2.85979 -3.0314 -3.29634 -3.38974];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5P
t14=[2 2.05026 2.12154 2.15397 2.21175 2.26507 2.30594 2.35377 2.40753 2.45988 2.50332 2.56615 2.60113 2.66023 2.70008 2.7573 2.80337 2.85729 2.91233 2.96086 3];
% 36572
bg1=12.3763+[-0.262546 -0.147891 0.101679 0.23609 0.495482 0.745363 0.932556 1.14549 1.37908 1.60141 1.78186 2.03517 2.17337 2.38517 2.49754 2.62917 2.71504 2.79959 2.8757 2.93953 2.9878];
bg2=446.738+[0.872491 0.530449 0.553099 0.615607 0.770693 0.978343 1.18449 1.47512 1.87291 2.30303 2.68451 3.27069 3.5993 4.1299 4.45039 4.82616 5.08406 5.34479 5.57997 5.7697 5.91258];
bg3=-714.659+[-0.305877 -0.68639 -0.963397 -1.10038 -1.3513 -1.58842 -1.76853 -1.9784 -2.21601 -2.453 -2.65846 -2.96513 -3.13491 -3.40125 -3.55093 -3.70851 -3.81523 -3.92326 -4.02448 -4.10901 -4.17474];
% 16215
bh1=12.1679+[-0.293437 0.00152209 0.535317 0.789666 1.24042 1.64667 1.94239 2.27255 2.62671 2.95868 3.22578 3.59675 3.79589 4.09792 4.2581 4.43868 4.5574 4.67506 4.78226 4.87274 4.94396];
bh2=446.385+[1.65142 1.4478 1.51277 1.60132 1.81571 2.09476 2.36954 2.75725 3.28338 3.85412 4.36114 5.13971 5.58057 6.30242 6.75065 7.28958 7.65961 8.03788 8.3804 8.65742 8.86804];
bh3=-705.203+[-0.521951 -1.08059 -1.51198 -1.71175 -2.05946 -2.37429 -2.61124 -2.88779 -3.20103 -3.51516 -3.7865 -4.19262 -4.42122 -4.7902 -5.01118 -5.26537 -5.44249 -5.62876 -5.80454 -5.95145 -6.0665];
% 31500
bi1=9.70641+[-0.263984 0.0279497 0.573475 0.835464 1.30093 1.72108 2.02755 2.37076 2.74093 3.0896 3.37068 3.76372 3.97453 4.29559 4.46861 4.66302 4.79141 4.91976 5.03728 5.13636 5.21424];
bi2=444.066+[1.50764 1.2719 1.28716 1.35072 1.51993 1.75696 1.99921 2.34786 2.82852 3.35428 3.82426 4.54934 4.96199 5.63971 6.06091 6.56974 6.91983 7.27775 7.60197 7.86451 8.06432];
bi3=-707.086+[-0.371135 -0.879743 -1.25252 -1.42398 -1.71966 -1.9835 -2.17886 -2.40302 -2.65259 -2.90037 -3.1134 -3.43139 -3.60941 -3.89425 -4.06176 -4.25045 -4.38209 -4.52089 -4.65298 -4.7642 -4.85175];
% 37435
bk1=16.2708+[-0.296601 -0.14441 0.15603 0.311186 0.605608 0.885566 1.09378 1.32904 1.58435 1.82573 2.02134 2.2938 2.44239 2.66913 2.7881 2.92767 3.01866 3.10818 3.18874 3.25622 3.30717 ];
bk2=449.059+[1.06322 0.686117 0.749126 0.839962 1.05056 1.31639 1.57162 1.92516 2.40157 2.91279 3.36423 4.05531 4.44104 5.06267 5.43901 5.87628 6.17572 6.47826 6.75122 6.9713 7.13714];
bk3=-710.186+[-0.380102 -0.775397 -1.12189 -1.29487 -1.61268 -1.91561 -2.14849 -2.42333 -2.73873 -3.05589 -3.33188 -3.74539 -3.97594 -4.34142 -4.55153 -4.779 -4.93408 -5.09189 -5.23914 -5.3615 -5.45613];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C5-C6 Left Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
