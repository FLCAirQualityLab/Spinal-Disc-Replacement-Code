%% foreman height and witdth narrowing/widening 
% for all models for the c5-c6 left hand side foreman under lateral bending (5n)
% 20212,40296,25651,42160
k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 20212,40296,25651,42160
%% model15_intact_TLC_5N
t15=[2 2.0675 2.10125 2.16062 2.21688 2.26697 2.30924 2.35429 2.40779 2.45293 2.51808 2.55698 2.61406 2.65527 2.70375 2.75725 2.8064 2.86587 2.90654 2.96524 3];

% 20212
aa1=-10.8616+[0.237303 0.0143228 -0.22327 -0.596985 -0.980833 -1.35269 -1.67927 -2.02521 -2.39984 -2.69198 -3.05436 -3.23459 -3.46907 -3.62381 -3.78835 -3.95489 -4.0983 -4.25811 -4.36148 -4.50397 -4.58336];
aa2=446.379+[0.413703 -0.066002 -0.0489469 0.202036 0.622369 1.10868 1.59096 2.15487 2.82525 3.35799 4.01143 4.33202 4.73815 4.99426 5.25596 5.51598 5.74517 6.01333 6.19069 6.43854 6.58104];
aa3=-704.985+[-0.501412 -0.689926 -0.839722 -1.11006 -1.3832 -1.63958 -1.86733 -2.12017 -2.42371 -2.6756 -2.99963 -3.16611 -3.38769 -3.52867 -3.67748 -3.83009 -3.96523 -4.12339 -4.22707 -4.37268 -4.45726];

% 40296
ab1=-12.2381+[0.123435 0.0160773 -0.124909 -0.355757 -0.602594 -0.850586 -1.07114 -1.30417 -1.55266 -1.74593 -1.98663 -2.1062 -2.26159 -2.36626 -2.47768 -2.58999 -2.68678 -2.79556 -2.866 -2.96318 -3.01751];
ab2=446.122+[0.252332 -0.107053 -0.0888753 0.0958447 0.403992 0.765849 1.1278 1.55224 2.05396 2.44968 2.925 3.15427 3.44154 3.62016 3.80132 3.9794 4.13602 4.31775 4.43843 4.60772 4.70542];
ab3=-714.556+[-0.468917 -0.593334 -0.705874 -0.91164 -1.1299 -1.33987 -1.52905 -1.73929 -1.98959 -2.19481 -2.45056 -2.57784 -2.74404 -2.84593 -2.95088 -3.05653 -3.14886 -3.25475 -3.3234 -3.41892 -3.47406];

% 25651
ac1=-9.36067+[0.270513 0.0232547 -0.230258 -0.627904 -1.03077 -1.41812 -1.7573 -2.11749 -2.51059 -2.81784 -3.19874 -3.38871 -3.63639 -3.79913 -3.97215 -4.14761 -4.29918 -4.46901 -4.57896 -4.73087 -4.81602];
ac2=443.597+[0.404337 -0.0804823 -0.0780495 0.143537 0.53281 0.990284 1.44758 1.98439 2.62372 3.13276 3.75826 4.06534 4.45454 4.70049 4.95193 5.20183 5.42232 5.68047 5.85147 6.09068 6.22823];
ac3=-706.266+[-0.440591 -0.64764 -0.783701 -1.01483 -1.23572 -1.43736 -1.61336 -1.80694 -2.0398 -2.23436 -2.4854 -2.61494 -2.78872 -2.89922 -3.01638 -3.13707 -3.24411 -3.36925 -3.45133 -3.56688 -3.63419];

% 42160
ad1=-14.6392+[0.138744 0.0110556 -0.147926 -0.40536 -0.681974 -0.958686 -1.2037 -1.4616 -1.73563 -1.94861 -2.21352 -2.34489 -2.51533 -2.6298 -2.75155 -2.87416 -2.97962 -3.09798 -3.17445 -3.27967 -3.33828 ];
ad2=448.856+[0.338222 -0.0661737 -0.0405624 0.182686 0.544863 0.964646 1.38246 1.87152 2.45056 2.90729 3.45627 3.72145 4.05414 4.26015 4.46876 4.67388 4.85399 5.06273 5.20114 5.39505 5.50704];
ad3=-710.316+[-0.51616 -0.622313 -0.750281 -0.997839 -1.27159 -1.54089 -1.78702 -2.06312 -2.39249 -2.66224 -2.99933 -3.1676 -3.38704 -3.5223 -3.66171 -3.802 -3.92473 -4.06586 -4.15775 -4.2857 -4.3596];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_5N
t1=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.30644 2.35622 2.40972 2.46023 2.50711 2.55164 2.60232 2.65142 2.72191 2.77012 2.80437 2.86374 2.90593 2.9903 3];
% 20212
ae1=-10.8616+[-0.322039 -0.220267 -0.253602 -0.401537 -0.649054 -0.779052 -1.07876 -1.36918 -1.69677 -2.01436 -2.31404 -2.60134 -2.92312 -3.22122 -3.6161 -3.8558 -4.00847 -4.24743 -4.39515 -4.658 -4.68643];
ae2=446.379+[1.21324 0.971408 0.897736 0.918705 0.982434 1.02812 1.1653 1.33372 1.57285 1.85961 2.16538 2.48296 2.88214 3.30218 3.90794 4.30315 4.57221 5.01888 5.3156 5.86876 5.93022];
ae3=-704.985+[-0.790441 -1.05593 -1.21721 -1.38068 -1.59155 -1.69222 -1.90934 -2.10906 -2.32902 -2.54335 -2.74738 -2.94308 -3.16804 -3.38824 -3.69234 -3.8829 -4.0113 -4.22482 -4.36747 -4.6359 -4.66609];

% 40296
af1=-12.2381+[-0.296706 -0.202847 -0.129529 -0.154935 -0.251038 -0.313661 -0.475449 -0.645721 -0.847572 -1.04865 -1.24133 -1.42946 -1.64176 -1.83858 -2.10292 -2.26516 -2.36831 -2.52912 -2.62802 -2.80419 -2.82325];
af2=446.122+[0.803328 0.499895 0.396197 0.406862 0.458854 0.498174 0.616938 0.7556 0.945091 1.16945 1.40517 1.64694 1.94958 2.2645 2.6983 2.97324 3.15815 3.46226 3.66176 4.03 4.07084];
af3=-714.556+[-0.751604 -0.933811 -1.00384 -1.10964 -1.25923 -1.33311 -1.50015 -1.65749 -1.83258 -2.00394 -2.16622 -2.31977 -2.49449 -2.66276 -2.8804 -3.00775 -3.09048 -3.22386 -3.30939 -3.46331 -3.48027];

% 25651
ag1=-9.36067+[-0.292646 -0.191698 -0.238802 -0.402118 -0.669625 -0.808754 -1.12655 -1.4317 -1.77334 -2.10271 -2.41237 -2.70869 -3.04121 -3.35033 -3.75964 -4.0079 -4.16648 -4.41581 -4.57077 -4.84749 -4.87751 ];
ag2=443.677+[1.15065 0.907956 0.821658 0.827494 0.871126 0.907501 1.0248 1.17448 1.39252 1.65861 1.94467 2.2433 2.62017 3.01798 3.59292 3.96903 4.2254 4.65143 4.93471 5.46377 5.52263];
ag3=-706.563+[-0.648179 -0.913504 -1.06439 -1.21388 -1.40512 -1.49633 -1.6912 -1.86685 -2.05609 -2.23691 -2.40636 -2.56685 -2.74874 -2.9242 -3.16107 -3.3067 -3.40414 -3.56573 -3.67334 -3.87598 -3.89882];

% 42160
ah1=-14.6392+[-0.323489 -0.223566 -0.159477 -0.19906 -0.313921 -0.384892 -0.566113 -0.755066 -0.977954 -1.19984 -1.41259 -1.61972 -1.85226 -2.06723 -2.35573 -2.53241 -2.64463 -2.81925 -2.92658 -3.1173 -3.13789];
ah2=448.856+[0.94052 0.588543 0.476743 0.497935 0.57096 0.62193 0.768539 0.935644 1.16054 1.42347 1.69807 1.97819 2.3281 2.6921 3.19422 3.51212 3.72585 4.07757 4.30829 4.73349 4.78061];
ah3=-710.316+[-0.858051 -1.00385 -1.07366 -1.19479 -1.36976 -1.45667 -1.65499 -1.84417 -2.05821 -2.27156 -2.47654 -2.67266 -2.89901 -3.12036 -3.41363 -3.58955 -3.70511 -3.89303 -4.01467 -4.23556 -4.25999];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_5N
t2=[2 2.05026 2.11433 2.16433 2.21433 2.27371 2.30007 2.35578 2.40928 2.45979 2.52161 2.5572 2.60603 2.68118 2.71243 2.7511 2.82625 2.8575 2.91199 2.97132 3];

% 20212
ai1=-10.8616+[-0.237609 -0.197884 -0.18476 -0.222457 -0.299427 -0.427424 -0.498964 -0.680745 -0.887715 -1.10546 -1.39138 -1.56693 -1.81383 -2.21425 -2.38466 -2.59719 -3.01007 -3.17949 -3.46843 -3.76614 -3.9029];
ai2=446.379+[1.42477 1.31813 1.28004 1.29718 1.33778 1.40361 1.43818 1.52333 1.62811 1.74764 1.91466 2.02632 2.18918 2.476 2.60763 2.78282 3.16091 3.32909 3.63692 3.98148 4.15084];
ai3=-704.985+[-0.908536 -1.02994 -1.15233 -1.26943 -1.39946 -1.56263 -1.63873 -1.80589 -1.97676 -2.14611 -2.35692 -2.48031 -2.64963 -2.91306 -3.02373 -3.16329 -3.43842 -3.55205 -3.74914 -3.95816 -4.05756];

% 40296
aj1=-12.2381+[-0.2408 -0.203646 -0.128539 -0.0861041 -0.0697785 -0.0827249 -0.102863 -0.17506 -0.277416 -0.397301 -0.565871 -0.674515 -0.830892 -1.09356 -1.20719 -1.35019 -1.62961 -1.74499 -1.94235 -2.14578 -2.23917];
aj2=446.122+[0.873877 0.755017 0.67731 0.66521 0.684053 0.728128 0.752653 0.816735 0.900495 0.995935 1.12876 1.2169 1.34545 1.56916 1.67144 1.80546 2.0907 2.21603 2.4422 2.6864 2.80513];
aj3=-714.556+[-0.83035 -0.915431 -0.962804 -1.01913 -1.09613 -1.20198 -1.25303 -1.37218 -1.49911 -1.62848 -1.79232 -1.88893 -2.02133 -2.2281 -2.31522 -2.42447 -2.63604 -2.72098 -2.86513 -3.01016 -3.07732];

% 25651
ak1=-9.36067+[-0.206337 -0.16466 -0.156816 -0.20305 -0.290501 -0.43311 -0.511701 -0.708984 -0.932026 -1.16465 -1.46786 -1.65241 -1.91085 -2.32614 -2.50239 -2.722 -3.1488 -3.32413 -3.62319 -3.93122 -4.07295];
ak2=443.677+[1.3488 1.24451 1.19894 1.20585 1.23438 1.28429 1.3113 1.37966 1.46726 1.57026 1.71737 1.81778 1.96566 2.23019 2.35257 2.51606 2.87084 3.02927 3.32006 3.64631 3.80695];
ak3=-706.563+[-0.738806 -0.86294 -0.976055 -1.08155 -1.19812 -1.34397 -1.41178 -1.56008 -1.71133 -1.8606 -2.04567 -2.15321 -2.30038 -2.52685 -2.62128 -2.7395 -2.97016 -3.06459 -3.22671 -3.39568 -3.47534];

% 42160
al1=-14.6392+[-0.261043 -0.223453 -0.155126 -0.121296 -0.116166 -0.143133 -0.169612 -0.25674 -0.372911 -0.506478 -0.692565 -0.812064 -0.983682 -1.27252 -1.39725 -1.55435 -1.86 -1.98562 -2.2001 -2.42089 -2.52216];
al2=448.856+[1.02138 0.879888 0.791889 0.781799 0.809665 0.869981 0.903124 0.987701 1.09428 1.21284 1.37488 1.48062 1.63357 1.89573 2.0149 2.17059 2.50118 2.64597 2.90747 3.19048 3.32805];
al3=-710.316+[-0.940231 -1.00972 -1.05408 -1.1168 -1.20654 -1.33191 -1.39275 -1.53536 -1.68717 -1.84188 -2.03838 -2.15514 -2.31601 -2.56988 -2.6778 -2.81398 -3.08085 -3.18928 -3.37571 -3.56718 -3.65687];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_5N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 20212
am1=-10.8616+[0.090966 0.101133 0.105091 0.095967 0.0745196 0.0401491 -0.014068 -0.0442703 -0.114868 -0.20245 -0.298093 -0.444272 -0.556342 -0.702194 -0.893481 -1.07357 -1.23691 -1.41049 -1.7737 -1.82412 -1.98684 ];
am2=446.379+[0.899489 0.86614 0.858179 0.875463 0.910242 0.959581 1.02676 1.06002 1.13127 1.20892 1.28302 1.38477 1.46066 1.55662 1.68202 1.80006 1.90857 2.02533 2.27748 2.31317 2.42876];
am3=-704.985+[-0.86313 -0.882788 -0.94493 -1.01653 -1.10365 -1.20089 -1.3228 -1.3803 -1.49672 -1.61894 -1.73365 -1.88492 -1.99047 -2.11929 -2.27824 -2.42011 -2.54259 -2.66913 -2.92491 -2.9601 -3.07124];
% 40296
an1=-12.2381+[-0.0539516 -0.0353027 0.0151292 0.0627889 0.109847 0.150965 0.189213 0.201184 0.2114 0.202735 0.178218 0.122541 0.071381 -0.00268889 -0.108754 -0.214704 -0.315428 -0.425959 -0.664484 -0.698008 -0.808041];
an2=446.122+[0.432532 0.398641 0.362552 0.349867 0.352271 0.371986 0.409581 0.430398 0.476845 0.528974 0.579742 0.649124 0.701725 0.769884 0.860596 0.9465 1.02665 1.11273 1.29684 1.32275 1.40576];
an3=-714.556+[-0.79231 -0.799988 -0.814069 -0.83642 -0.870876 -0.916331 -0.982852 -1.0171 -1.08825 -1.16824 -1.24693 -1.35324 -1.42887 -1.52317 -1.64104 -1.74696 -1.83936 -1.93527 -2.12917 -2.15578 -2.23882];
% 25651
ao1=-9.36067+[0.130737 0.142998 0.14727 0.135977 0.110494 0.0703115 0.00775751 -0.0266135 -0.106276 -0.203849 -0.308988 -0.468073 -0.589817 -0.747647 -0.95352 -1.14637 -1.32035 -1.50449 -1.88694 -1.9399 -2.1103];
ao2=443.677+[0.851766 0.819999 0.809173 0.821007 0.848205 0.88841 0.943793 0.971339 1.03056 1.09515 1.15679 1.24177 1.30591 1.38778 1.49622 1.59948 1.69557 1.79985 2.02802 2.0605 2.16612];
ao3=-706.563+[-0.739154 -0.759582 -0.815848 -0.87918 -0.955735 -1.04111 -1.14829 -1.19871 -1.30035 -1.40639 -1.50533 -1.63512 -1.72599 -1.83723 -1.97452 -2.09695 -2.20253 -2.31146 -2.53084 -2.56099 -2.65596];
% 42160
ap1=-14.6392+[-0.0493544 -0.0325878 0.0119422 0.0529332 0.0917113 0.124024 0.150405 0.15641 0.155203 0.134219 0.0978191 0.0273644 -0.0326252 -0.116861 -0.234914 -0.351682 -0.462006 -0.582996 -0.844189 -0.88088 -1.00107];
ap2=448.856+[0.511745 0.471283 0.427449 0.411497 0.41405 0.438454 0.485523 0.51165 0.570973 0.638696 0.704583 0.794522 0.862246 0.94912 1.06322 1.16999 1.26833 1.37281 1.5935 1.62441 1.72279];
ap3=-710.316+[-0.841263 -0.845795 -0.858258 -0.882344 -0.92172 -0.975409 -1.05516 -1.09645 -1.183 -1.28091 -1.37714 -1.50683 -1.59864 -1.71268 -1.85508 -1.98325 -2.09536 -2.21187 -2.44865 -2.48124 -2.5831];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_5N
t4=[2 2.05499 2.11058 2.15172 2.20834 2.25612 2.30683 2.35072 2.41079 2.45523 2.50106 2.56286 2.60735 2.66025 2.72359 2.75684 2.81029 2.87442 2.90649 2.98666 3];
% 20212
aq1=-10.8616+[-0.401806 -0.0106626 -0.389532 -0.711645 -1.1423 -1.5238 -1.94762 -2.29812 -2.74146 -3.02956 -3.27719 -3.56078 -3.739 -3.93165 -4.14039 -4.24398 -4.4004 -4.57531 -4.65875 -4.85586 -4.88718];
aq2=446.379+[1.11968 0.0446053 -0.0968447 0.0935963 0.566643 1.07473 1.73179 2.35271 3.19207 3.72993 4.17352 4.66145 4.94712 5.25634 5.59336 5.76619 6.03319 6.34341 6.49734 6.87711 6.93955];
aq3=704.985+[0.123842 -0.98014 -1.23674 -1.45266 -1.75433 -2.01368 -2.30772 -2.57432 -2.93604 -3.17862 -3.39581 -3.64828 -3.80516 -3.97918 -4.17404 -4.27396 -4.42894 -4.60926 -4.69853 -4.91911 -4.95545];
% 40296
ar1=-12.2381+[-0.211763 -0.0232812 -0.183485 -0.354818 -0.595807 -0.826549 -1.09386 -1.31438 -1.59451 -1.77912 -1.93631 -2.1168 -2.23204 -2.35679 -2.49172 -2.55895 -2.66055 -2.77418 -2.82835 -2.95649 -2.97693];
ar2=446.122+[0.668103 -0.194211 -0.283423 -0.129221 0.228345 0.612465 1.10897 1.57405 2.20003 2.5928 2.90838 3.25158 3.44782 3.6573 3.8824 3.9973 4.17385 4.37795 4.47886 4.7282 4.76922 ];
ar3=-714.556+[0.114342 -0.854365 -1.0327 -1.19449 -1.42714 -1.63197 -1.86667 -2.07756 -2.35817 -2.53811 -2.69265 -2.86646 -2.96884 -3.07856 -3.19732 -3.25702 -3.34762 -3.45008 -3.49993 -3.62129 -3.64105];
% 25651
as1=-9.36067+[-0.36511 0.00941387 -0.39494 -0.733219 -1.18277 -1.57777 -2.0153 -2.37829 -2.83928 -3.13861 -3.396 -3.69137 -3.87724 -4.07882 -4.2979 -4.40697 -4.57189 -4.75673 -4.84511 -5.05469 -5.08814 ];
as2=443.677+[1.04913 0.0164381 -0.141771 0.0260239 0.460826 0.93504 1.55352 2.14029 2.93598 3.4469 3.86808 4.3316 4.60288 4.89654 5.21672 5.38108 5.63533 5.93122 6.07827 6.44161 6.5014];
as3=-706.563+[0.290135 -0.911785 -1.16252 -1.35215 -1.59905 -1.80374 -2.02983 -2.23255 -2.50779 -2.69309 -2.86021 -3.05618 -3.17881 -3.31502 -3.46775 -3.54597 -3.66732 -3.80846 -3.8784 -4.05141 -4.07996 ];
% 42160
at1=-14.6392+[-0.24874 -0.0265892 -0.213014 -0.405044 -0.676138 -0.934251 -1.23118 -1.4757 -1.78454 -1.98729 -2.1603 -2.35862 -2.4849 -2.62137 -2.7689 -2.84227 -2.9531 -3.07695 -3.13586 -3.27474 -3.29678];
at2=448.856+[0.825379 -0.203449 -0.296322 -0.109847 0.314535 0.7633 1.33957 1.87862 2.60285 3.05663 3.42288 3.82121 4.04869 4.2915 4.55257 4.68572 4.89 5.1257 5.24219 5.52967 5.57696];
at3=-710.316+[-0.0104733 -0.849593 -1.0404 -1.23514 -1.53033 -1.79679 -2.10794 -2.39036 -2.76837 -3.01177 -3.22124 -3.45711 -3.59625 -3.74594 -3.9087 -3.99089 -4.11608 -4.25844 -4.32801 -4.49774 -4.52542];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_5N
t5=[2 2.05126 2.10091 2.15137 2.23246 2.28246 2.31371 2.35238 2.42753 2.45878 2.51533 2.551 2.6001 2.67059 2.71118 2.76118 2.82055 2.86274 2.92212 2.9643 3];
% 20212
au1=-10.8616+[0.0660434 0.0778855 0.0933222 0.0989699 0.072516 0.0377278 0.0122081 -0.0282218 -0.133973 -0.187209 -0.29944 -0.381362 -0.507201 -0.709541 -0.838152 -1.00619 -1.21399 -1.37036 -1.59646 -1.76394 -1.90922 ];
au2=446.379+[0.900609 0.86799 0.856711 0.863928 0.918286 0.970752 1.00566 1.05384 1.16093 1.20834 1.29729 1.35699 1.44607 1.58368 1.67016 1.78297 1.92361 2.03047 2.18713 2.30588 2.40975];
au3=-704.985+[-0.858817 -0.879097 -0.925423 -0.988299 -1.12658 -1.22525 -1.28857 -1.37163 -1.54321 -1.61718 -1.75387 -1.84176 -1.96521 -2.14636 -2.25305 -2.38579 -2.54416 -2.65827 -2.8205 -2.93778 -3.03723];
% 40296
av1=-12.2381+[-0.0560071 -0.0402633 -0.015825 0.0221519 0.0970064 0.136165 0.157697 0.177422 0.187281 0.180659 0.151688 0.122358 0.0681418 -0.032759 -0.103585 -0.201335 -0.327241 -0.426203 -0.572633 -0.683015 -0.780412];
av2=446.122+[0.402313 0.368975 0.337536 0.315394 0.31689 0.341733 0.361952 0.392725 0.464753 0.497335 0.559412 0.601579 0.664993 0.765722 0.829894 0.913665 1.01864 1.09825 1.21411 1.30083 1.37587];
av3=-714.556+[-0.792025 -0.800569 -0.813592 -0.831455 -0.886485 -0.935465 -0.969869 -1.01908 -1.1262 -1.17509 -1.26869 -1.32997 -1.41779 -1.55017 -1.6294 -1.72861 -1.84749 -1.93399 -2.05701 -2.1456 -2.21986];
% 25651
aw1=-9.36067+[0.107468 0.121557 0.138429 0.143151 0.110708 0.0699338 0.0402569 -0.00590909 -0.124833 -0.184064 -0.307575 -0.39705 -0.534125 -0.753288 -0.891662 -1.07152 -1.29327 -1.45908 -1.69811 -1.87413 -2.02632];
aw2=443.677+[0.85269 0.821631 0.808877 0.811975 0.854442 0.897544 0.926372 0.966409 1.05563 1.09503 1.16899 1.2189 1.29421 1.4121 1.48722 1.58621 1.71067 1.80628 1.94738 2.05534 2.15025];
aw3=-706.563+[-0.73196 -0.752821 -0.79484 -0.850658 -0.971943 -1.05845 -1.11409 -1.18691 -1.33625 -1.40015 -1.51774 -1.59315 -1.6994 -1.85596 -1.94814 -2.06266 -2.19919 -2.29735 -2.43671 -2.53717 -2.62218];
% 42160
ax1=-14.6392+[-0.0511071 -0.0374598 -0.0183614 0.0133334 0.0751024 0.105256 0.120703 0.131754 0.124396 0.110116 0.066837 0.029052 -0.0357061 -0.150836 -0.229768 -0.337803 -0.475955 -0.584377 -0.744662 -0.865594 -0.972027];
ax2=448.856+[0.478028 0.438206 0.39995 0.372582 0.37416 0.405182 0.430541 0.469056 0.561087 0.603225 0.683408 0.73783 0.819195 0.946897 1.0271 1.13075 1.25945 1.35587 1.49532 1.59882 1.6878];
ax3=-710.316+[-0.838366 -0.843963 -0.85571 -0.873803 -0.936478 -0.994788 -1.03616 -1.09561 -1.22639 -1.28636 -1.40103 -1.47602 -1.58301 -1.74356 -1.83954 -1.95989 -2.10427 -2.20953 -2.35956 -2.46806 -2.55923];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_5N
t6=[2 2.06926 2.11544 2.15658 2.22964 2.26089 2.30352 2.35172 2.40991 2.47326 2.50451 2.56164 2.6091 2.65161 2.70076 2.78645 2.82704 2.86763 2.90822 2.98941 3];
% 20212
ay1=-10.8616+[-0.401788 -0.177604 -0.300536 -0.514113 -0.980377 -1.1877 -1.48088 -1.82013 -2.23653 -2.6837 -2.89775 -3.25975 -3.51689 -3.72114 -3.92474 -4.22291 -4.34822 -4.46621 -4.57819 -4.78793 -4.81422];
ay2=446.379+[1.12007 0.606076 0.510269 0.504429 0.718447 0.85866 1.11105 1.47476 2.02831 2.72666 3.08449 3.72629 4.20362 4.58687 4.97534 5.53905 5.77602 6.00066 6.21624 6.63023 6.68334];
ay3=-704.985+[0.122619 -1.0841 -1.23354 -1.39801 -1.72497 -1.86525 -2.05947 -2.28672 -2.57925 -2.91301 -3.07727 -3.36974 -3.59001 -3.76685 -3.95165 -4.23791 -4.36344 -4.48401 -4.6018 -4.83205 -4.86184];
% 40296
az1=-12.2381+[-0.211769 -0.133124 -0.147384 -0.234428 -0.480182 -0.59918 -0.775221 -0.986015 -1.24918 -1.53556 -1.67462 -1.91032 -2.0778 -2.21397 -2.3491 -2.54567 -2.62792 -2.70542 -2.77889 -2.91603 -2.9332];
az2=446.122+[0.66834 0.164721 0.0851686 0.09193 0.279681 0.396801 0.599477 0.883644 1.30858 1.83675 2.10477 2.57559 2.91453 3.1799 3.4458 3.82427 3.98207 4.13109 4.27338 4.54626 4.58128];
az3=-714.556+[0.113813 -0.935977 -1.02585 -1.14492 -1.39267 -1.50256 -1.65667 -1.83826 -2.07207 -2.33428 -2.46011 -2.6773 -2.8325 -2.94932 -3.06702 -3.24078 -3.31456 -3.38379 -3.4503 -3.57793 -3.59423];
% 25651
ba1=-9.36067+[-0.365092 -0.154507 -0.293353 -0.522834 -1.01497 -1.23231 -1.53774 -1.88957 -2.32025 -2.78337 -3.00537 -3.38104 -3.64802 -3.86014 -4.07244 -4.38497 -4.51692 -4.64138 -4.75973 -4.98197 -5.00988];
ba2=443.677+[1.04957 0.549584 0.443036 0.423363 0.606786 0.732787 0.964391 1.3028 1.82313 2.48339 2.82279 3.43263 3.88678 4.25196 4.6223 5.15965 5.38567 5.60011 5.80611 6.20235 6.25325];
ba3=-706.563+[0.28882 -0.959636 -1.10463 -1.25851 -1.55156 -1.67346 -1.83756 -2.02416 -2.25787 -2.51881 -2.64598 -2.87008 -3.03714 -3.17035 -3.31008 -3.52844 -3.62491 -3.71777 -3.80896 -3.98822 -4.0115];
% 42160
bb1=-14.6392+[-0.248732 -0.151271 -0.177252 -0.280112 -0.556049 -0.689128 -0.884949 -1.11855 -1.41011 -1.72601 -1.87848 -2.13662 -2.32009 -2.46884 -2.61617 -2.83055 -2.9202 -3.00458 -3.08445 -3.23321 -3.25176];
bb2=448.856+[0.825649 0.210603 0.127101 0.144553 0.374883 0.514549 0.753263 1.08542 1.5795 2.19094 2.50016 3.04421 3.43714 3.74374 4.05105 4.48892 4.67139 4.84355 5.00777 5.32241 5.36278];
bb3=-710.316+[-0.0110182 -0.975664 -1.06959 -1.20489 -1.49927 -1.63321 -1.8248 -2.05523 -2.35879 -2.70546 -2.87376 -3.16786 -3.38145 -3.54437 -3.7092 -3.95282 -4.05635 -4.15383 -4.2474 -4.42711 -4.45008 ];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_5N
t13=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.32471 2.36689 2.42627 2.45263 2.51864 2.55993 2.60692 2.66037 2.70735 2.75754 2.81624 2.85281 2.9034 2.9694 3];
% 20212
bc1=-10.8616+[0.14562 0.158612 0.156837 0.134122 0.0922884 0.029877 -0.0631449 -0.14898 -0.286997 -0.355536 -0.546832 -0.679447 -0.838926 -1.03487 -1.21521 -1.41728 -1.66488 -1.82454 -2.04822 -2.34816 -2.48943 ];
bc2=446.379+[1.07675 1.03606 1.02402 1.03881 1.06833 1.11007 1.16752 1.21533 1.2887 1.32415 1.42361 1.49402 1.5813 1.69212 1.79683 1.91764 2.07329 2.1801 2.33505 2.55779 2.66811];
bc3=-704.985+[-0.585003 -0.607993 -0.678841 -0.757034 -0.847293 -0.947764 -1.07365 -1.17029 -1.31216 -1.37743 -1.54924 -1.66208 -1.79316 -1.94637 -2.08402 -2.23335 -2.40951 -2.52021 -2.67453 -2.87917 -2.97533];
% 40296
bd1=-12.2381+[0.00596392 0.0300561 0.082353 0.120968 0.150049 0.164601 0.164505 0.144468 0.0970023 0.0687749 -0.0195975 -0.0874005 -0.173195 -0.284358 -0.39035 -0.512691 -0.668624 -0.772083 -0.918466 -1.11782 -1.21276];
bd2=446.122+[0.498484 0.454367 0.406171 0.38508 0.381277 0.396806 0.430228 0.461098 0.510223 0.534519 0.605687 0.657112 0.721651 0.804521 0.883758 0.97562 1.09336 1.17368 1.29013 1.4578 1.54129 ];
bd3=-714.556+[-0.522187 -0.528248 -0.540359 -0.561127 -0.594109 -0.642863 -0.713256 -0.772581 -0.866038 -0.910512 -1.0323 -1.11569 -1.21402 -1.33058 -1.43672 -1.55238 -1.68894 -1.77455 -1.89365 -2.05101 -2.1249];
% 25651
be1=-9.36067+[0.185688 0.200701 0.198437 0.172669 0.126026 0.057337 -0.044467 -0.137652 -0.286861 -0.36064 -0.565672 -0.707133 -0.87688 -1.08444 -1.27475 -1.48707 -1.74633 -1.91314 -2.14667 -2.4592 -2.60623];
be2=443.677+[1.01382 0.97457 0.958722 0.967316 0.988919 1.02153 1.06731 1.10566 1.16473 1.19349 1.27559 1.33488 1.40947 1.50578 1.59783 1.70539 1.84563 1.94281 2.08452 2.29007 2.39245];
be3=-706.563+[-0.430726 -0.454278 -0.517991 -0.587063 -0.666559 -0.755303 -0.866815 -0.951921 -1.07611 -1.13297 -1.28278 -1.38122 -1.49569 -1.62923 -1.74908 -1.87908 -2.03177 -2.12724 -2.26015 -2.43577 -2.51808];
% 42160
bf1=-14.6392+[0.0086072 0.0308651 0.0774429 0.110199 0.132107 0.137657 0.125823 0.0967079 0.034992 0.000222137 -0.104348 -0.182587 -0.280006 -0.404759 -0.523173 -0.659233 -0.831656 -0.945595 -1.10648 -1.32479 -1.42852];
bf2=448.856+[0.623689 0.572033 0.515539 0.491304 0.488219 0.508638 0.55158 0.591791 0.655718 0.687176 0.778667 0.844105 0.925572 1.02873 1.12642 1.23802 1.37927 1.47458 1.61231 1.80912 1.90662];
bf3=-710.316+[-0.603201 -0.605283 -0.61507 -0.637072 -0.674648 -0.73191 -0.815666 -0.886766 -0.998971 -1.0524 -1.1984 -1.29825 -1.41609 -1.55613 -1.68392 -1.82331 -1.98859 -2.09272 -2.23813 -2.43147 -2.5227];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_5N
t14=[2 2.05026 2.11433 2.17371 2.20007 2.2594 2.31877 2.36096 2.42034 2.47043 2.5127 2.58779 2.63779 2.65263 2.70273 2.76565 2.80142 2.8609 2.90157 2.95756 3 ];
% 20212
bg1=-10.8616+[-0.290584 -0.127023 -0.228033 -0.481252 -0.618083 -0.96566 -1.33906 -1.6163 -2.01544 -2.35678 -2.64113 -3.12699 -3.43104 -3.5184 -3.78274 -4.06841 -4.20918 -4.413 -4.53777 -4.69557 -4.80728];
bg2=446.379+[1.36888 0.997673 0.846362 0.825531 0.848468 0.987548 1.20874 1.43412 1.82357 2.22655 2.61042 3.3673 3.88406 4.03408 4.51235 5.0498 5.32477 5.73291 5.98671 6.30921 6.53874];
bg3=-704.985+[-0.492421 -0.761406 -0.9132 -1.11208 -1.21096 -1.44843 -1.69406 -1.87669 -2.1412 -2.37872 -2.58895 -2.9774 -3.23426 -3.31018 -3.55283 -3.82122 -3.96034 -4.17312 -4.30979 -4.48772 -4.61756];
% 40296
bh1=-12.2381+[-0.262043 -0.123025 -0.0968169 -0.195821 -0.262475 -0.453825 -0.675091 -0.846044 -1.09834 -1.31701 -1.49938 -1.81301 -2.01208 -2.0694 -2.24252 -2.43305 -2.52693 -2.6622 -2.74442 -2.84825 -2.92132];
bh2=446.122+[0.846901 0.418341 0.271387 0.262367 0.28624 0.407729 0.589236 0.76598 1.07091 1.38319 1.67657 2.24683 2.63083 2.73953 3.07871 3.45131 3.63969 3.9163 4.08746 4.30301 4.45595];
bh3=-714.556+[-0.447652 -0.633279 -0.698058 -0.829389 -0.900151 -1.08026 -1.27299 -1.41768 -1.62894 -1.81909 -1.98568 -2.28815 -2.48281 -2.53862 -2.71108 -2.88889 -2.97735 -3.10834 -3.19042 -3.29434 -3.36858];
% 25651
bi1=-9.36067+[-0.2566 -0.0975699 -0.214292 -0.48556 -0.630523 -0.995396 -1.38377 -1.66975 -2.08118 -2.4335 -2.72797 -3.23296 -3.54971 -3.64073 -3.91654 -4.21454 -4.36189 -4.57633 -4.7082 -4.87527 -4.9937];
bi2=443.677+[1.29559 0.923665 0.762748 0.72686 0.74188 0.86002 1.05844 1.26637 1.62984 2.00863 2.3707 3.08764 3.57891 3.72159 4.17686 4.68975 4.95247 5.34259 5.58531 5.89409 6.11416];
bi3=-706.563+[-0.323524 -0.596563 -0.745609 -0.933226 -1.02467 -1.2375 -1.45137 -1.60586 -1.82591 -2.01947 -2.18847 -2.49672 -2.69892 -2.75842 -2.94735 -3.15437 -3.26161 -3.4263 -3.53273 -3.67207 -3.77448];
% 42160
bk1=-14.6392+[-0.294117 -0.139668 -0.122247 -0.238148 -0.313369 -0.528388 -0.775719 -0.966495 -1.24659 -1.48851 -1.68967 -2.03367 -2.25068 -2.31324 -2.50218 -2.70927 -2.81117 -2.95776 -3.04678 -3.15912 -3.23796];
bk2=448.856+[1.02023 0.536267 0.374894 0.374182 0.406167 0.554708 0.77065 0.977654 1.33166 1.69306 2.03225 2.69073 3.1331 3.25863 3.65078 4.07989 4.29659 4.6147 4.81136 5.05873 5.23411];
bk3=-710.316+[-0.582165 -0.720494 -0.780301 -0.927131 -1.00854 -1.22171 -1.45491 -1.63399 -1.89957 -2.14263 -2.35794 -2.75381 -3.01136 -3.08574 -3.31735 -3.56011 -3.68172 -3.862 -3.97488 -4.11789 -4.21998 ];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')
