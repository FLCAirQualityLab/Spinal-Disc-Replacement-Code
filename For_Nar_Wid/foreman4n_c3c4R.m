%% foramen height and width narrowing/widening 
% for all models for the c3-c4 right hand side foramen 
% 4457,20101,9037,21922

% 4N!!

% Values for displacement and base coordinates have not yet been updated from copy paste.

k=21;
zero1=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];

mag15y=zero1;
mag15x=zero1;
width15=zero1;
height15=zero1;

mag14y=zero1;
mag14x=zero1;
width14=zero1;
height14=zero1;

mag13y=zero1;
mag13x=zero1;
width13=zero1;
height13=zero1;

mag6y=zero1;
mag6x=zero1;
width6=zero1;
height6=zero1;

mag5y=zero1;
mag5x=zero1;
width5=zero1;
height5=zero1;

mag4y=zero1;
mag4x=zero1;
width4=zero1;
height4=zero1;

mag3y=zero1;
mag3x=zero1;
width3=zero1;
height3=zero1;


mag2y=zero1;
mag2x=zero1;
width2=zero1;
height2=zero1;

mag1y=zero1;
mag1x=zero1;
width1=zero1;
height1=zero1;
% 4457,20101,9037,21922
%% model15_intact_TLC_4N
t15=[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3];

% 4457
aa1=-9.37506+[5.0731200e-01   6.0871500e-01   6.5144700e-01   6.6789600e-01   6.7419400e-01   6.7331000e-01   6.7000600e-01   6.5697200e-01   6.4041900e-01   6.1724700e-01   5.9035800e-01   5.6061400e-01   5.5007100e-01   5.7495800e-01   6.0660000e-01   6.1662700e-01   6.1082100e-01   5.6671800e-01   4.9665100e-01   4.3261900e-01   3.6881600e-01];
aa2=448.144+[1.0306900e+00   1.0413900e+00   1.4740900e+00   2.2159300e+00   3.1888500e+00   4.3518100e+00   5.7108800e+00   7.1395000e+00   8.5708200e+00   1.0055800e+01   1.1507100e+01   1.3004300e+01   1.4465600e+01   1.5928900e+01   1.7181500e+01   1.8432900e+01   1.9557200e+01   2.0547700e+01   2.1456200e+01   2.2192700e+01   2.2906600e+01];
aa3=-689.149+[-6.7815900e-01  -6.9604700e-01  -7.5784300e-01  -8.6772900e-01  -1.0235400e+00  -1.2268100e+00  -1.5043200e+00  -1.8405400e+00  -2.2211000e+00  -2.6653200e+00  -3.1478400e+00  -3.7027400e+00  -4.2949800e+00  -4.9322000e+00  -5.5208800e+00  -6.1656300e+00  -6.8012400e+00  -7.4095400e+00  -8.0006000e+00  -8.5065100e+00  -9.0116600e+00];

% 20101
ab1=-11.8681+[3.3679400e-01   4.2432300e-01   4.6626000e-01   4.8559500e-01   4.9617600e-01   5.0287900e-01   5.1175800e-01   5.1373300e-01   5.1400400e-01   5.1117700e-01   5.0585600e-01   4.9991200e-01   5.0922800e-01   5.4903100e-01   5.8897300e-01   6.1266900e-01   6.2200300e-01   5.9555300e-01   5.4230700e-01   4.9312000e-01   4.4364700e-01];
ab2=447.151+[5.9687600e-01   5.0579700e-01   7.5589000e-01   1.2529100e+00   1.9488100e+00   2.8125900e+00   3.8423800e+00   4.9414900e+00   6.0583900e+00   7.2262300e+00   8.3697800e+00   9.5548400e+00   1.0723500e+01   1.1897000e+01   1.2901400e+01   1.3903100e+01   1.4801500e+01   1.5591800e+01   1.6313300e+01   1.6894500e+01   1.7457000e+01];
ab3=-698.575+[-5.1114300e-01  -5.0837300e-01  -5.3377300e-01  -5.8186400e-01  -6.5375700e-01  -7.5659600e-01  -9.1321100e-01  -1.1193900e+00  -1.3646300e+00  -1.6560600e+00  -1.9738100e+00  -2.3418400e+00  -2.7409600e+00  -3.1694500e+00  -3.5648400e+00  -4.0014500e+00  -4.4348200e+00  -4.8534200e+00  -5.2585800e+00  -5.6017400e+00  -5.9407800e+00];

% 9037
ac1=-7.50723+[5.6194400e-01   6.6609400e-01   7.1127300e-01   7.3131900e-01   7.4245300e-01   7.4689100e-01   7.4869000e-01   7.4069400e-01   7.2795200e-01   7.0695800e-01   6.8235500e-01   6.5538700e-01   6.4764600e-01   6.7866300e-01   7.1718700e-01   7.3404500e-01   7.3325300e-01   6.9167600e-01   6.2404900e-01   5.6205500e-01   5.0086300e-01];
ac2=444.719+[1.0471600e+00   1.0476700e+00   1.4583400e+00   2.1721000e+00   3.1155800e+00   4.2492500e+00   5.5789300e+00   6.9819200e+00   8.3920600e+00   9.8590900e+00   1.1297900e+01   1.2787500e+01   1.4246200e+01   1.5713500e+01   1.6974200e+01   1.8237500e+01   1.9375700e+01   2.0381000e+01   2.1306300e+01   2.2059200e+01   2.2791600e+01];
ac3=-690.512+[-6.4682200e-01  -6.3572100e-01  -6.3602700e-01  -6.6109200e-01  -7.1788600e-01  -8.1062800e-01  -9.6214100e-01  -1.1678700e+00  -1.4191200e+00  -1.7291000e+00  -2.0801300e+00  -2.4988300e+00  -2.9594900e+00  -3.4659200e+00  -3.9418400e+00  -4.4700800e+00  -4.9957600e+00  -5.5016900e+00  -5.9949700e+00  -6.4179900e+00  -6.8413700e+00];

% 21922
ad1=-12.9198+[3.2311600e-01   4.1325100e-01   4.5513500e-01   4.7159500e-01   4.7695800e-01   4.7729400e-01   4.7970000e-01   4.7484400e-01   4.6861200e-01   4.5987700e-01   4.4873000e-01   4.3617500e-01   4.3935000e-01   4.7156000e-01   5.0523000e-01   5.2243600e-01   5.2622600e-01   4.9523800e-01   4.3695700e-01   3.8343500e-01   3.2947900e-01];
ad2=450.785+[6.8449100e-01   6.0642200e-01   8.9695700e-01   1.4503900e+00   2.2142600e+00   3.1550200e+00   4.2716900e+00   5.4589800e+00   6.6603400e+00   7.9110100e+00   9.1306700e+00   1.0389600e+01   1.1626400e+01   1.2864300e+01   1.3921600e+01   1.4974100e+01   1.5917200e+01   1.6746200e+01   1.7501700e+01   1.8109600e+01   1.8696700e+01];
ad3=-694.998+[-6.0699400e-01  -6.1774100e-01  -6.8767100e-01  -8.0052900e-01  -9.5399000e-01  -1.1535700e+00  -1.4250500e+00  -1.7550400e+00  -2.1265200e+00  -2.5499100e+00  -2.9974000e+00  -3.5007600e+00  -4.0343700e+00  -4.6003600e+00  -5.1173000e+00  -5.6800200e+00  -6.2330200e+00  -6.7630200e+00  -7.2743400e+00  -7.7071300e+00  -8.1351200e+00];

ya1=aa1-ab1;
ya2=aa2-ab2;
ya3=aa3-ab3;
xa1=ad1-ac1;
xa2=ad2-ac2;
xa3=ad3-ac3;
x15=[xa1',xa2',xa3'];
y15=[ya1',ya2',ya3'];

for n=1:k
    mag15x(n)=sqrt(x15(n,1)^2+x15(n,2)^2+x15(n,3)^2);
end
for n=1:k
    mag15y(n)=sqrt(y15(n,1)^2+y15(n,2)^2+y15(n,3)^2);
end
for n=1:k
    width15(n)=mag15x(1,1)-mag15x(1,n);
end
for n=1:k
    height15(n)=mag15y(1,1)-mag15y(1,n);
end

%% model1_slideslide_tether/S2_4N
t1=[2 2.05126 2.11533 2.17471 2.20404 2.25121 2.30289 2.35286 2.41117 2.46025 2.51267 2.5564 2.60334 2.66048 2.70822 2.759 2.80923 2.85061 2.90524 2.95003 3];

% 4457
ae1=-9.37506+[-3.0640500e-01  -2.1349100e-01  -1.1215600e-01  -2.0607300e-02   2.3405600e-02   8.7273000e-02   1.4418900e-01   1.8868400e-01   2.2742200e-01   2.4788600e-01   2.5858800e-01   2.5860700e-01   2.5135200e-01   2.2912900e-01   1.9883700e-01   1.5683400e-01   1.0644600e-01   5.8858400e-02  -1.2843700e-02  -8.0566100e-02  -1.5979700e-01];
ae2=448.144+[2.1859200e+00   2.1718900e+00   2.3764100e+00   2.6754400e+00   2.8548600e+00   3.1886300e+00   3.6129100e+00   4.0888900e+00   4.7261600e+00   5.3273700e+00   6.0313200e+00   6.6644300e+00   7.3801500e+00   8.3017800e+00   9.1101800e+00   1.0005300e+01   1.0924000e+01   1.1705000e+01   1.2758000e+01   1.3637600e+01   1.4629800e+01];
ae3=-689.149+[-1.1481100e+00  -1.3694700e+00  -1.4795700e+00  -1.5835600e+00  -1.6396000e+00  -1.7348000e+00  -1.8466500e+00  -1.9714800e+00  -2.1411100e+00  -2.3081300e+00  -2.5161500e+00  -2.7124700e+00  -2.9427000e+00  -3.2424000e+00  -3.5184100e+00  -3.8397400e+00  -4.1845800e+00  -4.4922400e+00  -4.9363800e+00  -5.3311000e+00  -5.7967300e+00];

% 20101
af1=-11.8681+[-3.2046100e-01  -2.5470200e-01  -1.7626400e-01  -1.0464900e-01  -6.8127100e-02  -1.1213000e-02   4.3883200e-02   8.7169600e-02   1.2675300e-01   1.5227300e-01   1.7227200e-01   1.8264400e-01   1.8755600e-01   1.8295400e-01   1.7064000e-01   1.4970500e-01   1.2155100e-01   9.1217200e-02   4.2050300e-02  -5.0917700e-03  -6.1791300e-02];
af2=447.151+[1.5394400e+00   1.4276400e+00   1.4272000e+00   1.5054400e+00   1.5723600e+00   1.7263300e+00   1.9571600e+00   2.2471200e+00   2.6594100e+00   3.0571600e+00   3.5300700e+00   3.9690100e+00   4.4776500e+00   5.1376500e+00   5.7240600e+00   6.3866800e+00   7.0799000e+00   7.6766500e+00   8.4888500e+00   9.1737300e+00   9.9532300e+00];
af3=-698.575+[-8.3785300e-01  -1.0190300e+00  -1.0780200e+00  -1.1150200e+00  -1.1348400e+00  -1.1723900e+00  -1.2203500e+00  -1.2762300e+00  -1.3554300e+00  -1.4332500e+00  -1.5321100e+00  -1.6309100e+00  -1.7515700e+00  -1.9041000e+00  -2.0469600e+00  -2.2203100e+00  -2.4132100e+00  -2.5907100e+00  -2.8548400e+00  -3.0945400e+00  -3.3810400e+00];

% 9037
ag1=-7.50723+[-2.5743400e-01  -1.6116400e-01  -5.5731600e-02   3.9844100e-02   8.5696700e-02   1.5243100e-01   2.1339600e-01   2.6245500e-01   3.0619700e-01   3.3062200e-01   3.4529300e-01   3.4809700e-01   3.4329800e-01   3.2376900e-01   2.9564100e-01   2.5541300e-01   2.0606200e-01   1.5887700e-01   8.7080200e-02   1.9039300e-02  -6.0800200e-02];
ag2=444.719+[2.1685800e+00   2.1471800e+00   2.3309700e+00   2.6078300e+00   2.7759900e+00   3.0921500e+00   3.4990000e+00   3.9595600e+00   4.5793700e+00   5.1664000e+00   5.8559000e+00   6.4778600e+00   7.1830000e+00   8.0939300e+00   8.8958600e+00   9.7866000e+00   1.0703700e+01   1.1485500e+01   1.2542600e+01   1.3428600e+01   1.4430800e+01];
ag3=-690.512+[-1.0346900e+00  -1.2319700e+00  -1.2774000e+00  -1.3081900e+00  -1.3253500e+00  -1.3566100e+00  -1.3981500e+00  -1.4535800e+00  -1.5371000e+00  -1.6260000e+00  -1.7439400e+00  -1.8611800e+00  -2.0039700e+00  -2.1909100e+00  -2.3691100e+00  -2.5841300e+00  -2.8225700e+00  -3.0411700e+00  -3.3661400e+00  -3.6618700e+00  -4.0167000e+00];

% 21922
ah1=-12.9198+[-3.6086200e-01  -2.9069600e-01  -2.0986600e-01  -1.3856000e-01  -1.0245300e-01  -4.6233500e-02   6.7145600e-03   4.6323500e-02   8.1073100e-02   1.0246500e-01   1.1795600e-01   1.2429900e-01   1.2487100e-01   1.1511300e-01   9.8232300e-02   7.1969300e-02   3.8698000e-02   4.1962700e-03  -5.0217700e-02  -1.0164200e-01  -1.6291000e-01];
ah2=450.785+[1.7083600e+00   1.6079400e+00   1.6430800e+00   1.7587900e+00   1.8460300e+00   2.0342700e+00   2.3045200e+00   2.6364400e+00   3.1014200e+00   3.5455800e+00   4.0703400e+00   4.5549300e+00   5.1141300e+00   5.8384800e+00   6.4790100e+00   7.1992700e+00   7.9487100e+00   8.5911600e+00   9.4621300e+00   1.0193600e+01   1.1022500e+01];
ah3=-694.998+[-1.0313900e+00  -1.2246400e+00  -1.3242000e+00  -1.4057300e+00  -1.4502100e+00  -1.5300100e+00  -1.6279600e+00  -1.7388200e+00  -1.8892500e+00  -2.0319300e+00  -2.2057900e+00  -2.3730800e+00  -2.5724700e+00  -2.8299500e+00  -3.0657600e+00  -3.3435200e+00  -3.6440400e+00  -3.9138100e+00  -4.3038200e+00  -4.6501900e+00  -5.0577600e+00];

xb1=ah1-ag1;
xb2=ah2-ag2;
xb3=ah3-ag3;
yb1=ae1-af1;
yb2=ae2-af2;
yb3=ae3-af3;
y1=[yb1',yb2',yb3'];
x1=[xb1',xb2',xb3'];

for n=1:k
    mag1x(n)=sqrt(x1(n,1)^2+x1(n,2)^2+x1(n,3)^2);
end
for n=1:k
    mag1y(n)=sqrt(y1(n,1)^2+y1(n,2)^2+y1(n,3)^2);
end
for n=1:k
    height1(n)=mag1y(1,1)-mag1y(1,n);
end
for n=1:k
    width1(n)=mag1x(1,1)-mag1x(1,n);
end
%% model2_SlideSlide_NoTether/S2_4N
t2=[2 2.05126 2.1153 2.17471 2.20447 2.25221 2.30059 2.35788 2.41099 2.45099 2.50605 2.55427 2.60174 2.65492 2.70335 2.75569 2.80363 2.85302 2.90564 2.95047 3];

% 4457
ai1=-9.37506+[-1.7017400e-01  -8.4428600e-02   9.7364600e-03   9.4153300e-02   1.3452100e-01   1.9051000e-01   2.3484800e-01   2.7608300e-01   3.0190400e-01   3.1329900e-01   3.1908900e-01   3.1122500e-01   2.9231000e-01   2.5827100e-01   2.1654700e-01   1.6138200e-01   1.0044100e-01   2.9957100e-02  -5.3959100e-02  -1.3422600e-01  -2.2942100e-01];
ai2=448.144+[2.5984000e+00   2.5569300e+00   2.7361300e+00   3.0241300e+00   3.2029500e+00   3.5396200e+00   3.9388300e+00   4.4965900e+00   5.0938500e+00   5.5936200e+00   6.3588700e+00   7.1114200e+00   7.9105600e+00   8.8577600e+00   9.7623500e+00   1.0780200e+01   1.1740700e+01   1.2753400e+01   1.3844000e+01   1.4777400e+01   1.5812900e+01];
ai3=-689.149+[-1.3210800e+00  -1.4403500e+00  -1.5215100e+00  -1.6190700e+00  -1.6753000e+00  -1.7748200e+00  -1.8845800e+00  -2.0364300e+00  -2.2005900e+00  -2.3425200e+00  -2.5564800e+00  -2.7292300e+00  -2.9097000e+00  -3.1437700e+00  -3.3930600e+00  -3.7047500e+00  -4.0313500e+00  -4.4116000e+00  -4.8635200e+00  -5.2833500e+00  -5.7833100e+00];

% 20101
aj1=-11.8681+[-2.1616900e-01  -1.5334700e-01  -8.0213500e-02  -1.2751100e-02   2.1338300e-02   7.2727900e-02   1.1766100e-01   1.5989600e-01   1.8868600e-01   2.0618600e-01   2.2338800e-01   2.2686000e-01   2.2177900e-01   2.0742600e-01   1.8569600e-01   1.5396600e-01   1.1536600e-01   6.7407400e-02   5.6444500e-03  -5.3695500e-02  -1.2667500e-01];
aj2=447.151+[1.8236600e+00   1.7019600e+00   1.6908600e+00   1.7663000e+00   1.8338700e+00   1.9919300e+00   2.2092300e+00   2.5515400e+00   2.9405100e+00   3.2717200e+00   3.7789300e+00   4.2657800e+00   4.7841000e+00   5.4058300e+00   6.0071600e+00   6.6941800e+00   7.3544100e+00   8.0616300e+00   8.8424900e+00   9.5271800e+00   1.0300200e+01];
aj3=-698.575+[-9.6580700e-01  -1.0563200e+00  -1.0892900e+00  -1.1209400e+00  -1.1407200e+00  -1.1821600e+00  -1.2305800e+00  -1.3006200e+00  -1.3787100e+00  -1.4458700e+00  -1.5366900e+00  -1.5750300e+00  -1.6049200e+00  -1.6496400e+00  -1.7064800e+00  -1.7892900e+00  -1.8898600e+00  -2.0203600e+00  -2.1948000e+00  -2.3717300e+00  -2.5962500e+00];

% 9037
ak1=-7.50723+[-1.1656300e-01  -2.6586600e-02   7.2559800e-02   1.6131000e-01   2.0354700e-01   2.6259400e-01   3.1091000e-01   3.5720900e-01   3.8737000e-01   4.0183600e-01   4.1130300e-01   4.0624900e-01   3.9006900e-01   3.5867700e-01   3.1892800e-01   2.6513000e-01   2.0468100e-01   1.3395500e-01   4.8666900e-02  -3.3194500e-02  -1.3089100e-01];
ak2=444.719+[2.5710800e+00   2.5245400e+00   2.6855100e+00   2.9526400e+00   3.1205000e+00   3.4400000e+00   3.8231900e+00   4.3633300e+00   4.9447600e+00   5.4329000e+00   6.1819600e+00   6.9198700e+00   7.7067600e+00   8.6444500e+00   9.5451600e+00   1.0564500e+01   1.1532500e+01   1.2559100e+01   1.3671200e+01   1.4628200e+01   1.5695400e+01];
ak3=-690.512+[-1.1726200e+00  -1.2721900e+00  -1.2929900e+00  -1.3190900e+00  -1.3364500e+00  -1.3715700e+00  -1.4145100e+00  -1.4847300e+00  -1.5680600e+00  -1.6443500e+00  -1.7557300e+00  -1.8176800e+00  -1.8763400e+00  -1.9651400e+00  -2.0752700e+00  -2.2290400e+00  -2.4067000e+00  -2.6301800e+00  -2.9174200e+00  -3.1998800e+00  -3.5490200e+00];

% 21922
al1=-12.9198+[-2.5352100e-01  -1.8805800e-01  -1.1410000e-01  -4.7699800e-02  -1.4156300e-02   3.5998200e-02   7.8324600e-02   1.1584500e-01   1.3988900e-01   1.5374200e-01   1.6604500e-01   1.6488600e-01   1.5433500e-01   1.3370100e-01   1.0660600e-01   6.9073400e-02   2.5343400e-02  -2.7748800e-02  -9.3924400e-02  -1.5682300e-01  -2.3338200e-01];
al2=450.785+[2.0291800e+00   1.9131100e+00   1.9326800e+00   2.0434900e+00   2.1308900e+00   2.3230200e+00   2.5776300e+00   2.9691800e+00   3.4073300e+00   3.7774600e+00   4.3452700e+00   4.9000900e+00   5.4921200e+00   6.1982300e+00   6.8765300e+00   7.6466100e+00   8.3805500e+00   9.1596900e+00   1.0009200e+01   1.0745500e+01   1.1569600e+01];
al3=-694.998+[-1.2003100e+00  -1.2969300e+00  -1.3658700e+00  -1.4404700e+00  -1.4847200e+00  -1.5689600e+00  -1.6655000e+00  -1.8011600e+00  -1.9469700e+00  -2.0693400e+00  -2.2490900e+00  -2.3918800e+00  -2.5418800e+00  -2.7338700e+00  -2.9355800e+00  -3.1886000e+00  -3.4550400e+00  -3.7646900e+00  -4.1308700e+00  -4.4709200e+00  -4.8784400e+00];

xc1=al1-ak1;
xc2=al2-ak2;
xc3=al3-ak3;
yd1=ai1-aj1;
yd2=ai2-aj2;
yd3=ai3-aj3;
y2=[yd1',yd2',yd3'];
x2=[xc1',xc2',xc3'];

for n=1:k
    mag2x(n)=sqrt(x2(n,1)^2+x2(n,2)^2+x2(n,3)^2);
end
for n=1:k
    mag2y(n)=sqrt(y2(n,1)^2+y2(n,2)^2+y2(n,3)^2);
end
for n=1:k
    height2(n)=mag2y(1,1)-mag2y(1,n);
end
for n=1:k
    width2(n)=mag2x(1,1)-mag2x(1,n);
end

%% model3_APSlide_Tether/S2_4N
t3=[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3];
% 4457
am1=-9.37506+[3.5697400e-01   3.8306000e-01   4.0890500e-01   4.2832300e-01   4.4313000e-01   4.5921200e-01   4.6919800e-01   4.7390900e-01   4.7672500e-01   4.7603100e-01   4.7095300e-01   4.6035700e-01   4.4864400e-01   4.3284500e-01   4.0888500e-01   3.7486500e-01   3.3966800e-01   2.9847200e-01   2.4496900e-01   1.9297200e-01   1.5043400e-01];
am2=448.144+[1.9618200e+00   1.9627000e+00   2.1065300e+00   2.2994700e+00   2.4682900e+00   2.7176800e+00   3.0278800e+00   3.3442900e+00   3.7100100e+00   4.1708900e+00   4.6119300e+00   5.1620900e+00   5.6399200e+00   6.1706900e+00   6.7721400e+00   7.4526900e+00   8.0804500e+00   8.7468800e+00   9.5735800e+00   1.0320800e+01   1.0887100e+01];
am3=-689.149+[-1.2861900e+00  -1.2978100e+00  -1.3441500e+00  -1.4072700e+00  -1.4643000e+00  -1.5469300e+00  -1.6453800e+00  -1.7432100e+00  -1.8525600e+00  -1.9892500e+00  -2.1229100e+00  -2.2943900e+00  -2.4464900e+00  -2.6143200e+00  -2.8048900e+00  -3.0296300e+00  -3.2459100e+00  -3.4859500e+00  -3.7983400e+00  -4.0958000e+00  -4.3309500e+00];
% 20101
an1=-11.8681+[1.9195900e-01   2.1387000e-01   2.3896700e-01   2.5667700e-01   2.7033400e-01   2.8788000e-01   3.0544300e-01   3.1646400e-01   3.2583500e-01   3.3315300e-01   3.3777100e-01   3.4167000e-01   3.4221700e-01   3.3908000e-01   3.3019700e-01   3.1566900e-01   2.9797700e-01   2.7628800e-01   2.4427100e-01   2.1069100e-01   1.8241200e-01];
an2=447.151+[1.2337100e+00   1.1827400e+00   1.1854600e+00   1.2299600e+00   1.2773000e+00   1.3658600e+00   1.5022300e+00   1.6669700e+00   1.8756800e+00   2.1525100e+00   2.4223000e+00   2.7685000e+00   3.0831200e+00   3.4398500e+00   3.8492900e+00   4.3210700e+00   4.7657000e+00   5.2457400e+00   5.8500100e+00   6.4026300e+00   6.8251600e+00];
an3=-698.575+[-8.9701400e-01  -9.0371900e-01  -9.2576200e-01  -9.5113000e-01  -9.7274800e-01  -1.0064500e+00  -1.0512500e+00  -1.0961700e+00  -1.1465500e+00  -1.2088700e+00  -1.2673200e+00  -1.3428800e+00  -1.4139700e+00  -1.4914200e+00  -1.5781400e+00  -1.6832400e+00  -1.7890900e+00  -1.9124400e+00  -2.0786200e+00  -2.2404100e+00  -2.3707300e+00];
% 9037
ao1=-7.50723+[4.2968700e-01   4.5744700e-01   4.8532300e-01   5.0637100e-01   5.2244500e-01   5.4007500e-01   5.5223300e-01   5.5943400e-01   5.6475700e-01   5.6663100e-01   5.6373700e-01   5.5563000e-01   5.4564900e-01   5.3126300e-01   5.0860900e-01   4.7590500e-01   4.4158200e-01   4.0082400e-01   3.4707000e-01   2.9450300e-01   2.5153900e-01];
ao2=444.719+[1.9664300e+00   1.9610600e+00   2.0875800e+00   2.2629800e+00   2.4177400e+00   2.6490500e+00   2.9408100e+00   3.2423600e+00   3.5933400e+00   4.0381400e+00   4.4656500e+00   5.0010700e+00   5.4678200e+00   5.9876600e+00   6.5785900e+00   7.2496300e+00   7.8705700e+00   8.5316200e+00   9.3541000e+00   1.0100000e+01   1.0666800e+01];
ao3=-690.512+[-1.1964600e+00  -1.1900100e+00  -1.1867000e+00  -1.1975100e+00  -1.2108200e+00  -1.2345100e+00  -1.2679500e+00  -1.3084600e+00  -1.3570800e+00  -1.4222300e+00  -1.4899500e+00  -1.5815400e+00  -1.6669300e+00  -1.7617300e+00  -1.8706800e+00  -2.0048600e+00  -2.1391500e+00  -2.2934100e+00  -2.5010900e+00  -2.7047800e+00  -2.8693100e+00];
% 21922
ap1=-12.9198+[1.6308400e-01   1.8554600e-01   2.1050000e-01   2.2693700e-01   2.3930000e-01   2.5535600e-01   2.7063400e-01   2.7865300e-01   2.8452900e-01   2.8789200e-01   2.8922800e-01   2.8917900e-01   2.8630300e-01   2.7978400e-01   2.6741700e-01   2.4903100e-01   2.2766500e-01   2.0209400e-01   1.6570600e-01   1.2835500e-01   9.7203900e-02];
ap2=450.785+[1.3985100e+00   1.3505100e+00   1.3754500e+00   1.4443200e+00   1.5120900e+00   1.6294200e+00   1.7988900e+00   1.9955300e+00   2.2393900e+00   2.5575900e+00   2.8641400e+00   3.2544300e+00   3.6067200e+00   4.0053500e+00   4.4613700e+00   4.9842200e+00   5.4750000e+00   6.0028100e+00   6.6641200e+00   7.2663500e+00   7.7252400e+00];
ap3=-694.998+[-1.0828400e+00  -1.0929300e+00  -1.1405900e+00  -1.1946600e+00  -1.2407700e+00  -1.3094200e+00  -1.3952600e+00  -1.4807000e+00  -1.5766600e+00  -1.6938400e+00  -1.8022800e+00  -1.9394800e+00  -2.0648600e+00  -2.2043800e+00  -2.3623600e+00  -2.5486800e+00  -2.7310200e+00  -2.9368100e+00  -3.2061300e+00  -3.4623800e+00  -3.6651700e+00];

xe1=ap1-ao1;
xe2=ap2-ao2;
xe3=ap3-ao3;
yf1=am1-an1;
yf2=am2-an2;
yf3=am3-an3;
y3=[yf1',yf2',yf3'];
x3=[xe1',xe2',xe3'];

for n=1:k
    mag3x(n)=sqrt(x3(n,1)^2+x3(n,2)^2+x3(n,3)^2);
end
for n=1:k
    mag3y(n)=sqrt(y3(n,1)^2+y3(n,2)^2+y3(n,3)^2);
end
for n=1:k
    height3(n)=mag3y(1,1)-mag3y(1,n);
end
for n=1:k
    width3(n)=mag3x(1,1)-mag3x(1,n);
end


%% model4_APSlide_NoTether/S2_4N
t4=[2 2.0622 2.11523 2.15852 2.20492 2.25001 2.30364 2.35417 2.40231 2.45225 2.50547 2.55011 2.60474 2.65523 2.70472 2.7507 2.80007 2.85772 2.90074 2.95442 3];
% 4457
aq1=-9.37506+[-4.4029300e-01   7.2125200e-01   8.2077300e-01   8.1519300e-01   7.8668500e-01   7.4735300e-01   6.7842400e-01   6.0313300e-01   5.3849700e-01   4.5032300e-01   3.4124900e-01   2.5999800e-01   1.7857700e-01   1.0286800e-01   5.0521900e-03  -8.4852900e-02  -1.7118600e-01  -2.5394400e-01  -3.2388600e-01  -3.8456600e-01  -4.4271300e-01];
aq2=448.144+[2.2729300e+00   1.5145200e+00   2.7813100e+00   4.2174300e+00   5.9747700e+00   7.7602500e+00   9.8475000e+00   1.1725700e+01   1.3453300e+01   1.5210400e+01   1.6904400e+01   1.8216500e+01   1.9751600e+01   2.1104200e+01   2.2366000e+01   2.3482500e+01   2.4609500e+01   2.5814800e+01   2.6668000e+01   2.7668900e+01   2.8517400e+01];
aq3=689.149+[-1.2343600e-01  -1.2563100e+00  -1.4529800e+00  -1.7216300e+00  -2.0973100e+00  -2.5364600e+00  -3.1569200e+00  -3.8120600e+00  -4.4917300e+00  -5.1580100e+00  -5.8640500e+00  -6.4646800e+00  -7.2427500e+00  -7.9935100e+00  -8.7516300e+00  -9.4825900e+00  -1.0273600e+01  -1.1187600e+01  -1.1886300e+01  -1.2744900e+01  -1.3517600e+01];
% 20101
ar1=-11.8681+[-4.2105700e-01   4.8687400e-01   5.7116800e-01   5.7449200e-01   5.6480500e-01   5.5143300e-01   5.1355000e-01   4.7095800e-01   4.3926000e-01   3.8614500e-01   3.1489600e-01   2.6249100e-01   2.1646500e-01   1.7217900e-01   1.0561400e-01   4.4934300e-02  -1.3646300e-02  -6.5041500e-02  -1.1069200e-01  -1.5081400e-01  -1.8690600e-01];
ar2=447.151+[1.4900500e+00   6.9176300e-01   1.5700300e+00   2.6321400e+00   3.9636900e+00   5.3303800e+00   6.9498800e+00   8.4158600e+00   9.7619500e+00   1.1070200e+01   1.2317200e+01   1.3280200e+01   1.4404900e+01   1.5412900e+01   1.6370600e+01   1.7232400e+01   1.8114000e+01   1.9065800e+01   1.9737500e+01   2.0537600e+01   2.1214200e+01];
ar3=-698.575+[6.5302800e-02  -8.3124800e-01  -9.3006300e-01  -1.0885300e+00  -1.3227600e+00  -1.6048600e+00  -2.0170300e+00  -2.4581200e+00  -2.9105000e+00  -3.2760800e+00  -3.6424800e+00  -3.9445200e+00  -4.3293200e+00  -4.7081800e+00  -5.1017600e+00  -5.4953200e+00  -5.9256900e+00  -6.4224500e+00  -6.7889800e+00  -7.2320300e+00  -7.6070200e+00];
% 9037
as1=-7.50723+[-3.8446300e-01   8.0560100e-01   9.1774600e-01   9.1983000e-01   8.9948200e-01   8.6775300e-01   8.0485800e-01   7.3305600e-01   6.7184900e-01   5.8749500e-01   4.8171900e-01   4.0449800e-01   3.2865800e-01   2.5851300e-01   1.6428500e-01   7.7061300e-02  -6.7077600e-03  -8.4428400e-02  -1.5073700e-01  -2.0653500e-01  -2.6329800e-01];
as2=444.719+[2.2354400e+00   1.5221000e+00   2.7490000e+00   4.1459000e+00   5.8639200e+00   7.6174900e+00   9.6764300e+00   1.1537500e+01   1.3257600e+01   1.5016600e+01   1.6725500e+01   1.8060200e+01   1.9635500e+01   2.1035600e+01   2.2350900e+01   2.3522600e+01   2.4713700e+01   2.6000300e+01   2.6923000e+01   2.8015000e+01   2.8957000e+01];
as3=-690.512+[5.8991400e-02  -1.1585800e+00  -1.2219700e+00  -1.3498800e+00  -1.5580300e+00  -1.8264600e+00  -2.2468600e+00  -2.7188000e+00  -3.2257600e+00  -3.6813100e+00  -4.1666000e+00  -4.5895100e+00  -5.1507500e+00  -5.7099900e+00  -6.2891500e+00  -6.8629800e+00  -7.4954300e+00  -8.2369900e+00  -8.8043300e+00  -9.5087500e+00  -1.0136200e+01];
% 21922
at1=-12.9198+[-4.7550300e-01   4.6473500e-01   5.4123000e-01   5.3571300e-01   5.1501000e-01   4.9045500e-01   4.4022300e-01   3.8722900e-01   3.4538000e-01   2.8111000e-01   1.9848700e-01   1.3675100e-01   7.8860500e-02   2.3203900e-02  -5.3604000e-02  -1.2314000e-01  -1.8997900e-01  -2.5302800e-01  -3.0777600e-01  -3.5733400e-01  -4.0132200e-01];
at2=450.785+[1.6833300e+00   8.4775000e-01   1.8258200e+00   2.9884400e+00   4.4367300e+00   5.9168000e+00   7.6626800e+00   9.2354900e+00   1.0672700e+01   1.2085000e+01   1.3429900e+01   1.4462900e+01   1.5661700e+01   1.6724700e+01   1.7724000e+01   1.8614300e+01   1.9516800e+01   2.0480600e+01   2.1154100e+01   2.1947600e+01   2.2608300e+01];
at3=-694.998+[-1.5938200e-01  -1.0056100e+00  -1.2220600e+00  -1.5070500e+00  -1.8991000e+00  -2.3473700e+00  -2.9627900e+00  -3.5939300e+00  -4.2255600e+00  -4.8201800e+00  -5.4346500e+00  -5.9427700e+00  -6.5863000e+00  -7.2017600e+00  -7.8221700e+00  -8.4197900e+00  -9.0614600e+00  -9.7950300e+00  -1.0347800e+01  -1.1015700e+01  -1.1609500e+01];

xg1=at1-as1;
xg2=at2-as2;
xg3=at3-as3;
yh1=aq1-ar1;
yh2=aq2-ar2;
yh3=aq3-ar3;
y4=[yh1',yh2',yh3'];
x4=[xg1',xg2',xg3'];

for n=1:k
    mag4x(n)=sqrt(x4(n,1)^2+x4(n,2)^2+x4(n,3)^2);
end
for n=1:k
    mag4y(n)=sqrt(y4(n,1)^2+y4(n,2)^2+y4(n,3)^2);
end
for n=1:k
    height4(n)=mag4y(1,1)-mag4y(1,n);
end
for n=1:k
    width4(n)=mag4x(1,1)-mag4x(1,n);
end

%% model5_LatSlide_Tether/S2_4N
t5=[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3];
% 4457
au1=-9.37506+[3.3988300e-01   3.6483000e-01   3.8959500e-01   4.1199000e-01   4.2291700e-01   4.4057300e-01   4.5224300e-01   4.6085900e-01   4.6597900e-01   4.6736800e-01   4.6346000e-01   4.5441400e-01   4.4072700e-01   4.2668600e-01   4.0266300e-01   3.7097800e-01   3.3935600e-01   2.9731600e-01   2.5057400e-01   2.0349100e-01   1.5377500e-01];
au2=448.144+[1.9866000e+00   1.9881600e+00   2.1290100e+00   2.3402300e+00   2.4672600e+00   2.7440400e+00   3.0323900e+00   3.3378700e+00   3.6955400e+00   4.1045200e+00   4.5647100e+00   5.0661000e+00   5.6423800e+00   6.1193700e+00   6.7339000e+00   7.3829700e+00   7.9581400e+00   8.6522000e+00   9.3889200e+00   1.0087400e+01   1.0765400e+01];
au3=-689.149+[-1.2875100e+00  -1.2992700e+00  -1.3461100e+00  -1.4189800e+00  -1.4632700e+00  -1.5548700e+00  -1.6453700e+00  -1.7394300e+00  -1.8464200e+00  -1.9687500e+00  -2.1091400e+00  -2.2662200e+00  -2.4510900e+00  -2.6022100e+00  -2.7970600e+00  -3.0110700e+00  -3.2084700e+00  -3.4570500e+00  -3.7332600e+00  -4.0081100e+00  -4.2871500e+00];
% 20101
av1=-11.8681+[1.6997400e-01   1.9113600e-01   2.1603500e-01   2.3765200e-01   2.4893600e-01   2.7109100e-01   2.9239400e-01   3.0715700e-01   3.1800000e-01   3.2613000e-01   3.3178500e-01   3.3558500e-01   3.3639600e-01   3.3365700e-01   3.2502700e-01   3.1194700e-01   2.9633900e-01   2.7447600e-01   2.4704900e-01   2.1701700e-01   1.8434200e-01];
av2=447.151+[1.2432900e+00   1.1932400e+00   1.1948800e+00   1.2371700e+00   1.2732600e+00   1.3755700e+00   1.5049400e+00   1.6637300e+00   1.8665500e+00   2.1104300e+00   2.3900000e+00   2.7031700e+00   3.0802500e+00   3.3999500e+00   3.8170800e+00   4.2656400e+00   4.6716800e+00   5.1701700e+00   5.7069800e+00   6.2218000e+00   6.7261700e+00];
av3=-698.575+[-8.9375500e-01  -9.0074100e-01  -9.2419800e-01  -9.5432800e-01  -9.7193600e-01  -1.0105400e+00  -1.0523200e+00  -1.0950700e+00  -1.1436500e+00  -1.1996300e+00  -1.2608800e+00  -1.3298100e+00  -1.4157400e+00  -1.4850900e+00  -1.5732500e+00  -1.6725000e+00  -1.7682700e+00  -1.8949500e+00  -2.0407500e+00  -2.1891400e+00  -2.3426900e+00];
% 9037
aw1=-7.50723+[4.1513500e-01   4.4172600e-01   4.6821900e-01   4.9187100e-01   5.0332100e-01   5.2202700e-01   5.3544600e-01   5.4600900e-01   5.5325000e-01   5.5682100e-01   5.5515600e-01   5.4843800e-01   5.3698900e-01   5.2428100e-01   5.0166700e-01   4.7129800e-01   4.4054000e-01   3.9903400e-01   3.5217500e-01   3.0457500e-01   2.5435200e-01];
aw2=444.719+[1.9912800e+00   1.9865900e+00   2.1101600e+00   2.3010100e+00   2.4172100e+00   2.6738300e+00   2.9450000e+00   3.2357500e+00   3.5786800e+00   3.9730300e+00   4.4188300e+00   4.9065400e+00   5.4693200e+00   5.9364800e+00   6.5401700e+00   7.1800600e+00   7.7487900e+00   8.4370000e+00   9.1696300e+00   9.8663100e+00   1.0544500e+01];
aw3=-690.512+[-1.1941100e+00  -1.1877500e+00  -1.1853700e+00  -1.1982700e+00  -1.2094900e+00  -1.2363500e+00  -1.2665600e+00  -1.3047600e+00  -1.3518500e+00  -1.4098900e+00  -1.4808600e+00  -1.5646700e+00  -1.6685100e+00  -1.7537200e+00  -1.8647900e+00  -1.9920100e+00  -2.1139600e+00  -2.2728400e+00  -2.4553100e+00  -2.6421400e+00  -2.8363000e+00];
% 21922
ax1=-12.9198+[1.3890300e-01   1.6060200e-01   1.8582700e-01   2.0691300e-01   2.1759500e-01   2.3827300e-01   2.5702600e-01   2.6905700e-01   2.7682100e-01   2.8151400e-01   2.8378500e-01   2.8400600e-01   2.8062600e-01   2.7482200e-01   2.6258100e-01   2.4581000e-01   2.2683300e-01   2.0091700e-01   1.6954400e-01   1.3600800e-01   9.9900400e-02];
ax2=450.785+[1.4125100e+00   1.3654900e+00   1.3885900e+00   1.4568200e+00   1.5076600e+00   1.6410600e+00   1.8015000e+00   1.9916500e+00   2.2292800e+00   2.5104200e+00   2.8286900e+00   3.1821200e+00   3.6047300e+00   3.9622500e+00   4.4271500e+00   4.9246400e+00   5.3732000e+00   5.9217500e+00   6.5098300e+00   7.0715600e+00   7.6199200e+00];
ax3=-694.998+[-1.0848600e+00  -1.0953300e+00  -1.1436000e+00  -1.2044900e+00  -1.2398400e+00  -1.3162300e+00  -1.3965900e+00  -1.4790200e+00  -1.5725500e+00  -1.6778100e+00  -1.7914700e+00  -1.9164500e+00  -2.0678400e+00  -2.1931800e+00  -2.3543000e+00  -2.5311800e+00  -2.6970400e+00  -2.9096200e+00  -3.1474100e+00  -3.3839700e+00  -3.6242300e+00];

xi1=ax1-aw1;
xi2=ax2-aw2;
xi3=ax3-aw3;
yj1=au1-av1;
yj2=au2-av2;
yj3=au3-av3;
y5=[yj1',yj2',yj3'];
x5=[xi1',xi2',xi3'];

for n=1:k
    mag5x(n)=sqrt(x5(n,1)^2+x5(n,2)^2+x5(n,3)^2);
end
for n=1:k
    mag5y(n)=sqrt(y5(n,1)^2+y5(n,2)^2+y5(n,3)^2);
end
for n=1:k
    height5(n)=mag5y(1,1)-mag5y(1,n);
end
for n=1:k
    width5(n)=mag5x(1,1)-mag5x(1,n);
end


%% model6_LatSlide_NoTether/S2_4N
t6=[2 2.05467 2.1077 2.15244 2.20335 2.25035 2.30555 2.35774 2.40313 2.45015 2.50252 2.55284 2.60017 2.65712 2.70364 2.75106 2.80515 2.85128 2.90047 2.95082 3];
% 4457
ay1=-9.37506+[-4.4025400e-01  -4.0154900e-02   2.0236200e-01   3.5748300e-01   4.8415500e-01   5.4862200e-01   5.7391200e-01   5.6200700e-01   5.2841700e-01   4.8440700e-01   4.1416100e-01   3.2189800e-01   2.2018000e-01   8.4304000e-02  -3.3146600e-02  -1.5779600e-01  -3.0467300e-01  -4.3470900e-01  -5.6705200e-01  -6.8980600e-01  -7.9140000e-01];
ay2=448.144+[2.2728400e+00   1.9941600e+00   2.2824900e+00   2.7315000e+00   3.4284200e+00   4.2426200e+00   5.3871300e+00   6.6253600e+00   7.8162100e+00   9.1417300e+00   1.0743800e+01   1.2314100e+01   1.3780000e+01   1.5524400e+01   1.6918600e+01   1.8305000e+01   1.9836100e+01   2.1108800e+01   2.2425400e+01   2.3728600e+01   2.4968400e+01];
ay3=-689.149+[-1.2469200e-01  -1.4044600e+00  -1.4731100e+00  -1.5594000e+00  -1.6977000e+00  -1.8655900e+00  -2.1253100e+00  -2.4355200e+00  -2.7644000e+00  -3.1665200e+00  -3.6235900e+00  -4.1249400e+00  -4.6554800e+00  -5.3619800e+00  -5.9941100e+00  -6.6756100e+00  -7.4993100e+00  -8.2486000e+00  -9.0808000e+00  -9.9742400e+00  -1.0894000e+01];
% 20101
az1=-11.8681+[-4.2103300e-01  -1.2681100e-01   7.0959600e-02   1.9976800e-01   3.1016400e-01   3.7234900e-01   4.0484800e-01   4.0502900e-01   3.9028700e-01   3.6996600e-01   3.2934100e-01   2.7005100e-01   2.0234000e-01   1.0774600e-01   2.2647900e-02  -7.2009300e-02  -1.8842400e-01  -2.9203900e-01  -3.9962200e-01  -4.9638900e-01  -5.7641200e-01];
az2=447.151+[1.4902400e+00   1.1846300e+00   1.2606500e+00   1.5002000e+00   1.9336500e+00   2.4842900e+00   3.3009900e+00   4.2206000e+00   5.1192600e+00   6.1243400e+00   7.2947800e+00   8.4348200e+00   9.5073700e+00   1.0788000e+01   1.1825100e+01   1.2874200e+01   1.4058900e+01   1.5060000e+01   1.6111100e+01   1.7159600e+01   1.8157300e+01];
az3=-698.575+[6.4117900e-02  -1.0216600e+00  -1.0297900e+00  -1.0504300e+00  -1.1041200e+00  -1.1865900e+00  -1.3283100e+00  -1.5081900e+00  -1.7047700e+00  -1.9453100e+00  -2.1617500e+00  -2.3942700e+00  -2.6484900e+00  -2.9864000e+00  -3.2982800e+00  -3.6436600e+00  -4.0817000e+00  -4.4957100e+00  -4.9635800e+00  -5.4705500e+00  -5.9753000e+00];
% 9037
ba1=-7.50723+[-3.8442200e-01   2.1021300e-02   2.7194700e-01   4.3366700e-01   5.6850300e-01   6.4110800e-01   6.7512200e-01   6.6987100e-01   6.4070900e-01   6.0075200e-01   5.3406400e-01   4.4425200e-01   3.4324600e-01   2.0692900e-01   8.7971900e-02  -3.9356700e-02  -1.9038100e-01  -3.2422700e-01  -4.5975100e-01  -5.8493700e-01  -6.8791000e-01];
ba2=444.719+[2.2354000e+00   1.9724200e+00   2.2440400e+00   2.6743500e+00   3.3477700e+00   4.1395900e+00   5.2581800e+00   6.4735700e+00   7.6463000e+00   8.9560900e+00   1.0543800e+01   1.2109200e+01   1.3580000e+01   1.5343600e+01   1.6764400e+01   1.8186500e+01   1.9767200e+01   2.1090000e+01   2.2467700e+01   2.3843100e+01   2.5167200e+01];
ba3=-690.512+[5.7604800e-02  -1.2616400e+00  -1.2698900e+00  -1.2889300e+00  -1.3359700e+00  -1.4070400e+00  -1.5406200e+00  -1.7220800e+00  -1.9293200e+00  -2.1955100e+00  -2.4608600e+00  -2.7611500e+00  -3.1002000e+00  -3.5710000e+00  -4.0117600e+00  -4.5044500e+00  -5.1247400e+00  -5.7064000e+00  -6.3672400e+00  -7.0875900e+00  -7.8333600e+00];
% 21922
bb1=-12.9198+[-4.7547600e-01  -1.6057300e-01   4.0422300e-02   1.6887200e-01   2.7546100e-01   3.3179800e-01   3.5567300e-01   3.4690500e-01   3.2432300e-01   2.9571200e-01   2.4536600e-01   1.7611200e-01   1.0028000e-01  -2.8435900e-03  -9.4127100e-02  -1.9362200e-01  -3.1402000e-01  -4.2086600e-01  -5.3204400e-01  -6.3382100e-01  -7.1927600e-01];
bb2=450.785+[1.6834100e+00   1.3701700e+00   1.4821300e+00   1.7619800e+00   2.2526200e+00   2.8664000e+00   3.7663800e+00   4.7705800e+00   5.7458300e+00   6.8315800e+00   8.1138900e+00   9.3631100e+00   1.0530600e+01   1.1916000e+01   1.3028200e+01   1.4142000e+01   1.5385300e+01   1.6425600e+01   1.7507600e+01   1.8577200e+01   1.9585200e+01];
bb3=-694.998+[-1.6044100e-01  -1.2325500e+00  -1.2817100e+00  -1.3504600e+00  -1.4751400e+00  -1.6393200e+00  -1.8944200e+00  -2.1965300e+00  -2.5105400e+00  -2.8828400e+00  -3.2975600e+00  -3.7462200e+00  -4.2117400e+00  -4.8179400e+00  -5.3554900e+00  -5.9298100e+00  -6.6207000e+00  -7.2489800e+00  -7.9419300e+00  -8.6828100e+00  -9.4311200e+00];

xk1=bb1-ba1;
xk2=bb2-ba2;
xk3=bb3-ba3;
yl1=ay1-az1;
yl2=ay2-az2;
yl3=ay3-az3;
y6=[yl1',yl2',yl3'];
x6=[xk1',xk2',xk3'];

for n=1:k
    mag6x(n)=sqrt(x6(n,1)^2+x6(n,2)^2+x6(n,3)^2);
end
for n=1:k
    mag6y(n)=sqrt(y6(n,1)^2+y6(n,2)^2+y6(n,3)^2);
end
for n=1:k
    height6(n)=mag6y(1,1)-mag6y(1,n);
end
for n=1:k
    width6(n)=mag6x(1,1)-mag6x(1,n);
end


%% model13_Fixed_Tether_S2_4N
t13=[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3];
% 4457
bc1=-9.37506+[4.0951700e-01   4.4036800e-01   4.6692000e-01   4.8231400e-01   4.9869900e-01   5.0495400e-01   5.1589900e-01   5.1916400e-01   5.1898000e-01   5.1352000e-01   5.0284300e-01   4.8934200e-01   4.7278300e-01   4.4564700e-01   4.1708400e-01   3.8449500e-01   3.4481900e-01   3.0057300e-01   2.5055300e-01   1.9328300e-01   1.3290700e-01];
bc2=448.144+[2.2612600e+00   2.2595200e+00   2.4171400e+00   2.6265300e+00   2.9297300e+00   3.0864500e+00   3.5465300e+00   3.8246700e+00   4.2410500e+00   4.7575000e+00   5.3125600e+00   5.8583200e+00   6.4210400e+00   7.1576800e+00   7.7997700e+00   8.4674800e+00   9.2057500e+00   9.9716700e+00   1.0735000e+01   1.1527900e+01   1.2311500e+01];
bc3=-689.149+[-8.5921900e-01  -8.7668900e-01  -9.4281500e-01  -1.0245800e+00  -1.1443600e+00  -1.2031400e+00  -1.3624100e+00  -1.4536300e+00  -1.5837400e+00  -1.7397600e+00  -1.9086200e+00  -2.0786000e+00  -2.2614600e+00  -2.5038400e+00  -2.7189100e+00  -2.9501600e+00  -3.2164300e+00  -3.5062400e+00  -3.8123400e+00  -4.1478700e+00  -4.4946800e+00];
% 20101
bd1=-11.8681+[2.4412800e-01   2.7085700e-01   3.0000300e-01   3.1903800e-01   3.3878900e-01   3.4628700e-01   3.6244900e-01   3.6998000e-01   3.7695900e-01   3.7983800e-01   3.7950300e-01   3.7643000e-01   3.7239800e-01   3.6185600e-01   3.4739700e-01   3.2877300e-01   3.0539700e-01   2.7826000e-01   2.4729800e-01   2.1111100e-01   1.6986200e-01];
bd2=447.151+[1.4800000e+00   1.4224400e+00   1.4367600e+00   1.5016200e+00   1.6223200e+00   1.6957400e+00   1.9374200e+00   2.0959900e+00   2.3488100e+00   2.6812700e+00   3.0492300e+00   3.4181400e+00   3.8005400e+00   4.3059600e+00   4.7545900e+00   5.2287500e+00   5.7621800e+00   6.3234900e+00   6.8901700e+00   7.4851000e+00   8.0788400e+00];
bd3=-698.575+[-6.3160100e-01  -6.4066100e-01  -6.7850100e-01  -7.2067600e-01  -7.7619500e-01  -8.0279700e-01  -8.7420800e-01  -9.1552900e-01  -9.7769100e-01  -1.0560000e+00  -1.1406200e+00  -1.2265800e+00  -1.3170400e+00  -1.4309700e+00  -1.5328100e+00  -1.6461800e+00  -1.7822500e+00  -1.9354600e+00  -2.1039000e+00  -2.2943600e+00  -2.4963800e+00];
% 9037
be1=-7.50723+[4.8159700e-01   5.1405500e-01   5.4210600e-01   5.5840600e-01   5.7589600e-01   5.8268400e-01   5.9577000e-01   6.0060000e-01   6.0289900e-01   6.0039300e-01   5.9264100e-01   5.8175000e-01   5.6761500e-01   5.4317100e-01   5.1679600e-01   4.8620500e-01   4.4824100e-01   4.0523600e-01   3.5609500e-01   2.9940100e-01   2.3914500e-01];
be2=444.719+[2.2426500e+00   2.2348100e+00   2.3756700e+00   2.5687000e+00   2.8521600e+00   3.0001500e+00   3.4387700e+00   3.7059100e+00   4.1081000e+00   4.6097100e+00   5.1510800e+00   5.6852300e+00   6.2375200e+00   6.9625300e+00   7.5965400e+00   8.2577900e+00   8.9910200e+00   9.7539000e+00   1.0516500e+01   1.1310800e+01   1.2098000e+01];
be3=-690.512+[-7.0677700e-01  -7.0567700e-01  -7.2177900e-01  -7.5302200e-01  -8.0820100e-01  -8.3689600e-01  -9.1607300e-01  -9.6237200e-01  -1.0296700e+00  -1.1133300e+00  -1.2077900e+00  -1.3067600e+00  -1.4172900e+00  -1.5648400e+00  -1.6980200e+00  -1.8453000e+00  -2.0199500e+00  -2.2159400e+00  -2.4297500e+00  -2.6700800e+00  -2.9233400e+00];
% 21922
bf1=-12.9198+[2.1334200e-01   2.4073800e-01   2.7043900e-01   2.8916800e-01   3.0760400e-01   3.1417300e-01   3.2702900e-01   3.3228000e-01   3.3562300e-01   3.3404700e-01   3.2914600e-01   3.2170900e-01   3.1349600e-01   2.9795900e-01   2.7902700e-01   2.5582200e-01   2.2746200e-01   1.9553800e-01   1.5993200e-01   1.1904100e-01   7.3343800e-02];
bf2=450.785+[1.6817900e+00   1.6286900e+00   1.6673900e+00   1.7567400e+00   1.9103900e+00   2.0001900e+00   2.2870700e+00   2.4716700e+00   2.7618300e+00   3.1381900e+00   3.5507500e+00   3.9615000e+00   4.3851600e+00   4.9444000e+00   5.4392100e+00   5.9600700e+00   6.5433700e+00   7.1542300e+00   7.7682400e+00   8.4104400e+00   9.0489800e+00];
bf3=-694.998+[-8.5956700e-01  -8.7379600e-01  -9.4037600e-01  -1.0121200e+00  -1.1082900e+00  -1.1553800e+00  -1.2844300e+00  -1.3598000e+00  -1.4718600e+00  -1.6105000e+00  -1.7583900e+00  -1.9055900e+00  -2.0582800e+00  -2.2563700e+00  -2.4334900e+00  -2.6260700e+00  -2.8504800e+00  -3.0956300e+00  -3.3563000e+00  -3.6437200e+00  -3.9426800e+00];

xm1=bf1-be1;
xm2=bf2-be2;
xm3=bf3-be3;
yn1=bc1-bd1;
yn2=bc2-bd2;
yn3=bc3-bd3;
y13=[yn1',yn2',yn3'];
x13=[xm1',xm2',xm3'];

for n=1:k
    mag13x(n)=sqrt(x13(n,1)^2+x13(n,2)^2+x13(n,3)^2);
end
for n=1:k
    mag13y(n)=sqrt(y13(n,1)^2+y13(n,2)^2+y13(n,3)^2);
end
for n=1:k
    height13(n)=mag13y(1,1)-mag13y(1,n);
end
for n=1:k
    width13(n)=mag13x(1,1)-mag13x(1,n);
end


%% model14_Fixed_NoTether/S2_4N
t14=[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3];

% 4457
bg1=-9.37506+[-3.0019200e-01  -1.1257100e-01   5.8941300e-02   1.8784700e-01   2.3658200e-01   3.2114500e-01   3.7067100e-01   4.1122700e-01   4.3144100e-01   4.3420600e-01   4.2198100e-01   4.0085700e-01   3.5745500e-01   2.9547900e-01   2.2768700e-01   1.4156600e-01   4.8464300e-02  -6.6828800e-02  -1.6635500e-01  -2.8916600e-01  -4.0054800e-01];
bg2=448.144+[2.4402900e+00   2.4169000e+00   2.6690200e+00   3.0541900e+00   3.2708300e+00   3.8309200e+00   4.3639700e+00   5.1070400e+00   6.0672200e+00   6.6739700e+00   7.8424900e+00   8.6594700e+00   9.7788100e+00   1.0996700e+01   1.2138600e+01   1.3380600e+01   1.4584100e+01   1.5921300e+01   1.6988600e+01   1.8235600e+01   1.9369900e+01];
bg3=-689.149+[-6.9515600e-01  -9.8402200e-01  -1.0924300e+00  -1.2112500e+00  -1.2730700e+00  -1.4233400e+00  -1.5626200e+00  -1.7570600e+00  -2.0116900e+00  -2.1796300e+00  -2.4759100e+00  -2.6648300e+00  -2.9574600e+00  -3.3217400e+00  -3.7031200e+00  -4.1691000e+00  -4.6711300e+00  -5.2868400e+00  -5.8208000e+00  -6.4899700e+00  -7.1331400e+00];
% 20101
bh1=-11.8681+[-2.9902300e-01  -1.6600400e-01  -2.0850900e-02   8.8990000e-02   1.2993400e-01   2.0120200e-01   2.4540700e-01   2.8580000e-01   3.1088100e-01   3.2000800e-01   3.2105600e-01   3.1192400e-01   2.8928300e-01   2.5158200e-01   2.0747500e-01   1.4820600e-01   8.2054900e-02  -1.7339300e-03  -7.7185300e-02  -1.7344600e-01  -2.6783100e-01];
bh2=447.151+[1.7507100e+00   1.5936700e+00   1.6320700e+00   1.7972100e+00   1.9122100e+00   2.2428700e+00   2.5807300e+00   3.0790700e+00   3.7561500e+00   4.1937700e+00   5.0235100e+00   5.5826400e+00   6.3461100e+00   7.1892700e+00   7.9889400e+00   8.8688200e+00   9.7329300e+00   1.0714800e+01   1.1517800e+01   1.2471300e+01   1.3355900e+01];
bh3=-698.575+[-5.5128000e-01  -7.7965800e-01  -8.3068700e-01  -8.7544500e-01  -8.9875200e-01  -9.5853400e-01  -1.0180700e+00  -1.1103300e+00  -1.2432700e+00  -1.3338100e+00  -1.4639300e+00  -1.5174300e+00  -1.6041100e+00  -1.7274300e+00  -1.8683000e+00  -2.0554300e+00  -2.2685600e+00  -2.5484200e+00  -2.8078400e+00  -3.1474700e+00  -3.4821300e+00];
% 9037
bi1=-7.50723+[-2.4777100e-01  -5.7384100e-02   1.1818000e-01   2.5142600e-01   3.0247100e-01   3.9282500e-01   4.4780800e-01   4.9539800e-01   5.2346500e-01   5.3048900e-01   5.2485900e-01   5.0772300e-01   4.6866000e-01   4.1013400e-01   3.4442400e-01   2.5931000e-01   1.6567100e-01   4.8851800e-02  -5.2960200e-02  -1.8033500e-01  -2.9791400e-01];
bi2=444.719+[2.4035900e+00   2.3712400e+00   2.6036300e+00   2.9689900e+00   3.1768700e+00   3.7181100e+00   4.2363200e+00   4.9621100e+00   5.9043400e+00   6.5015000e+00   7.6533200e+00   8.4605900e+00   9.5710400e+00   1.0786000e+01   1.1932100e+01   1.3186300e+01   1.4409600e+01   1.5777900e+01   1.6875900e+01   1.8166000e+01   1.9345200e+01];
bi3=-690.512+[-5.2198300e-01  -7.8177800e-01  -8.2475400e-01  -8.7281500e-01  -9.0081500e-01  -9.7210200e-01  -1.0418000e+00  -1.1452600e+00  -1.2899900e+00  -1.3904600e+00  -1.5476000e+00  -1.6280900e+00  -1.7662600e+00  -1.9605700e+00  -2.1796400e+00  -2.4663800e+00  -2.7933600e+00  -3.2178800e+00  -3.6031800e+00  -4.0991600e+00  -4.5881800e+00];
% 21922
bk1=-12.9198+[-3.4854100e-01  -2.0396000e-01  -5.4018900e-02   5.6707300e-02   9.7094200e-02   1.6526000e-01   2.0557800e-01   2.3972600e-01   2.5665900e-01   2.6075900e-01   2.5292700e-01   2.3765400e-01   2.0681900e-01   1.6071100e-01   1.0906700e-01   4.2054600e-02  -3.0410700e-02  -1.2021700e-01  -1.9945500e-01  -2.9906200e-01  -3.9387500e-01];
bk2=450.785+[1.9490300e+00   1.8139600e+00   1.8905600e+00   2.0943300e+00   2.2293000e+00   2.6091500e+00   2.9910700e+00   3.5475500e+00   4.2950900e+00   4.7750100e+00   5.6918000e+00   6.3168900e+00   7.1694000e+00   8.1048800e+00   8.9869500e+00   9.9504100e+00   1.0888100e+01   1.1940900e+01   1.2792400e+01   1.3795000e+01   1.4716300e+01];
bk3=-694.998+[-7.8074900e-01  -1.0315200e+00  -1.1268500e+00  -1.2186100e+00  -1.2668700e+00  -1.3896600e+00  -1.5076300e+00  -1.6800400e+00  -1.9147800e+00  -2.0691200e+00  -2.3368700e+00  -2.5011500e+00  -2.7482200e+00  -3.0535600e+00  -3.3739000e+00  -3.7643800e+00  -4.1801500e+00  -4.6858600e+00  -5.1246400e+00  -5.6783200e+00  -6.2067000e+00];

xo1=bk1-bi1;
xo2=bk2-bi2;
xo3=bk3-bi3;
yp1=bg1-bh1;
yp2=bg2-bh2;
yp3=bg3-bh3;
x14=[xo1',xo2',xo3'];
y14=[yp1',yp2',yp3'];

for n=1:k
    mag14x(n)=sqrt(x14(n,1)^2+x14(n,2)^2+x14(n,3)^2);
end
for n=1:k
    mag14y(n)=sqrt(y14(n,1)^2+y14(n,2)^2+y14(n,3)^2);
end
for n=1:k
    height14(n)=mag14y(1,1)-mag14y(1,n);
end
for n=1:k
    width14(n)=mag14x(1,1)-mag14x(1,n);
end

%% Percent change
% bar plot
figure(1)
pc15x=(mag15x(21)/mag15x(1)*100)-100;
pc15y=(mag15y(21)/mag15y(1)*100)-100;
pc15=[pc15y,pc15x];

pc1x=(mag1x(21)/mag1x(1)*100)-100;
pc1y=(mag1y(21)/mag1y(1)*100)-100;
pc1=[pc1y,pc1x];

pc2x=(mag2x(21)/mag2x(1)*100)-100;
pc2y=(mag2y(21)/mag2y(1)*100)-100;
pc2=[pc2y,pc2x];

pc3x=(mag3x(21)/mag3x(1)*100)-100;
pc3y=(mag3y(21)/mag3y(1)*100)-100;
pc3=[pc3y,pc3x];

pc4x=(mag4x(21)/mag4x(1)*100)-100;
pc4y=(mag4y(21)/mag4y(1)*100)-100;
pc4=[pc4y,pc4x];

pc5x=(mag5x(21)/mag5x(1)*100)-100;
pc5y=(mag5y(21)/mag5y(1)*100)-100;
pc5=[pc5y,pc5x];

pc6x=(mag6x(21)/mag6x(1)*100)-100;
pc6y=(mag6y(21)/mag6y(1)*100)-100;
pc6=[pc6y,pc6x];

pc13x=(mag13x(21)/mag13x(1)*100)-100;
pc13y=(mag13y(21)/mag13y(1)*100)-100;
pc13=[pc13y,pc13x];


pc14x=(mag14x(21)/mag14x(1)*100)-100;
pc14y=(mag14y(21)/mag14y(1)*100)-100;
pc14=[pc14y,pc14x];

PC=[pc15;pc1;pc2;pc3;pc4;pc5;pc6;pc13;pc14];
bar(PC)
xticklabels({'Intact','Model 1','Model 2', 'Model 3','Model 4','Model 5','Model 6','Model 13','model 14'})
ylabel('Percent Change')
legend('Height','Width','location','northwest')
title('Absolute Foraminal Percent Change Under 2 N-m of extension (4n)')

%% figures
figure(2)

plot((t15-2)*(-2),-1*height15,'b')
hold on
plot((t15-2)*(-2),-1*width15,'-.b')
hold on

plot((t1-2)*(-2),-1*height1,'r')
hold on
plot((t1-2)*(-2),-1*width1,'-.r')
hold on

plot((t2-2)*(-2),-1*height2,'g')
hold on
plot((t2-2)*(-2),-1*width2,'-.g')
hold on

plot((t3-2)*(-2),-1*height3,'c')
hold on
plot((t3-2)*(-2),-1*width3,'-.c')
hold on

plot((t4-2)*(-2),-1*height4,'color',[.49 1 .63])
hold on
plot((t4-2)*(-2),-1*width4,'-.','color',[.49 1 .63])
hold on

plot((t5-2)*(-2),-1*height5,'color',[0.75, 0, 0.75])
hold on
plot((t5-2)*(-2),-1*width5,'-.','color',[0.75, 0, 0.75])
hold on

plot((t6-2)*(-2),-1*height6,'color',[0 0.5 1])
hold on
plot((t6-2)*(-2),-1*width6,'-.','color',[0 0.5 1])
hold on

plot((t13-2)*(-2),-1*height13,'color',[0.2 0 0])
hold on
plot((t13-2)*(-2),-1*width13,'-.','color',[0.2 0 0])
hold on

plot((t14-2)*(-2),-1*height14,'color',[1 .5 0])
hold on
plot((t14-2)*(-2),-1*width14,'-.','color',[1 .5 0])
hold on

xlabel('Moment (N-m)')
ylabel({'Narrowing/Widening (mm)';'(Positive is Widening, Negative is Narrowing)'})
title('C4-C5 Right Hand Foreman Narrowing/Widening Under 2 N-m of Extension (4N)')
legend('intact height','intact width','model 1 height', 'model 1 width','model 2 height','model 2 width','model 3 height', 'model 3 width','model 4 height','model 4 width','model 5 height','model 5 width','model 6 height','model 6 width','model 13 height','model 13 width','model 14 height','model 14 width','location','southwest')