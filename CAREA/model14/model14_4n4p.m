% Facet Contact Area (CAREA)
% model14_Fixed_NoTether/4n & 4p
clear all;
%% 4P
figure (25)

c4ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c4ulyp=[83.3725 83.5013 83.6638 83.6914 83.6778 83.7051 83.7584 83.74 83.7061 83.6959 83.6554 83.6568 83.6171 83.5463 83.493 83.4203 83.3537 83.2773 83.2061 82.6229 82.5768];

c4urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c4uryp=[77.8479 77.8077 77.7015 77.5809 77.5582 77.7706 77.7962 77.8851 77.9964 78.0046 78.1441 78.2479 78.2928 78.4283 78.5236 78.5058 78.4774 78.3834 78.2921 78.0587 77.9504];

c5ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c5ulyp=[86.5645 88.6271 87.7674 87.1248 86.0742 84.3549 82.3024 82.0065 79.3173 78.3834 76.7957 76.6036 76.2981 75.865 74.0006 73.6009 72.1547 70.3728 69.0277 66.5743 66.4289];

c5urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c5uryp=[83.0357 82.8704 81.6591 80.753 80.2478 79.8053 79.1088 78.7698 77.4533 77.3154 76.6458 74.9585 74.3425 73.4396 72.9411 71.5893 71.0357 70.5618 70.0777 69.4104 68.9603];

c6ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c6ulyp=[82.2128 84.6256 84.1074 83.1334 81.739 81.4763 80.9665 80.7168 80.0831 79.9897 79.6464 78.887 78.5304 78.1223 77.8146 77.4798 76.6578 76.2408 75.9388 75.5409 75.3988];

c6urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c6uryp=[87.8409 88.4138 86.8088 86.2896 85.4959 85.0485 84.3386 83.9992 82.8881 82.7733 82.2706 82.1702 81.8311 80.9675 79.6788 79.0662 78.5236 78.0543 76.6495 75.1954 74.9974];

c7ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c7ulyp=[92.1313 94.1755 94.4182 94.3977 93.8647 93.3629 92.5479 92.1474 91.6352 91.57 91.2427 90.8228 90.3964 89.9056 89.42 88.8872 88.4196 87.8456 87.3705 86.712 86.4881];

c7urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c7uryp=[89.5973 90.9568 90.008 89.1776 87.6791 87.4906 86.1755 85.8199 85.0997 85.001 84.4559 83.6595 83.1768 82.5449 82.1522 81.6865 80.7016 79.6481 78.6102 77.8071 77.3541];

%% 4N

c4ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c4ulyn=[83.3725 83.2662 83.0426 82.7331 82.5986 82.3299 82.1179 81.882 81.032 80.9221 80.6964 80.5329 79.0796 78.882 78.6848 78.4388 78.2119 78.0277 77.7936 77.4479 77.1511];

c4urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c4uryn=[77.8479 78.0733 78.6878 79.137 79.3239 79.7206 79.8866 80.1296 80.2046 80.1213 79.9518 79.647 79.0897 78.2236 77.5019 76.7061 75.9518 75.1012 74.4311 73.7453 73.1152];

c5ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c5ulyn=[86.5645 88.9321 88.9819 88.7328 88.4044 88.858 88.1799 87.2212 86.0654 84.6896 83.7999 81.7081 78.2222 75.1616 69.9243 63.7278 59.8042 56.7733 53.6708 51.0986 49.1072];

c5urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c5uryn=[83.0357 82.3969 81.8946 81.7433 81.8613 80.7344 79.624 78.7358 77.6336 76.8712 75.0297 73.0839 68.2861 64.225 58.3429 52.2579 48.3443 43.2836 40.9416 39.6537 38.4074];

c6ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c6ulyn=[82.2128 84.1805 85.1217 85.5001 85.5993 86.4967 86.9404 87.2528 87.5857 87.7998 88.3513 88.3393 88.3752 88.3116 88.2341 88.103 88.0746 87.8893 87.7843 87.6556 87.5587];

c6urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c6uryn=[87.8409 88.7212 88.8424 88.1853 88.2461 88.415 88.5694 88.7559 89.0818 89.2263 89.4147 89.3791 89.6089 89.458 89.4341 89.3979 89.1799 89.9177 89.4783 89.3275 88.6826 ];

c7ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c7ulyn=[92.1313 93.8225 93.5547 93.1828 93.1269 93.1032 93.1431 93.416 93.7434 94.0634 94.6159 94.8624 95.082 95.3528 95.5166 95.6323 96.3985 96.681 96.8626 96.9144 97.0553];

c7urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3 ]+2;
c7uryn=[89.5973 91.028 90.0975 89.4796 89.2454 88.94 88.6394 88.3804 88.4606 88.5641 88.792 88.9235 89.086 89.282 89.1449 89.3547 89.2853 89.572 89.0221 89.1717 89.2589 ];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'-.r');
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'-.g');
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'-.b');
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'-.c');

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Area (CAREA) for model 14 under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Area (mm^2)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','south')