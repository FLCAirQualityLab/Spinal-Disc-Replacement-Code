% Facet Contact Area (CAREA)
% model3_APSlide_Tether/4n & 4p
clear all;
%% 4P
figure (10)

c4ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c4ulyp=[83.1334 83.2148 83.3866 83.5271 83.7032 83.9853 84.1389 84.2653 84.016 83.9801 83.9547 83.9227 83.8254 83.7658 83.6922 83.5642 83.4589 83.3272 83.2014 83.0728 82.9773];

c4urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c4uryp=[78.9613 78.8268 78.5926 78.4084 78.1612 78.017 77.8786 77.6288 77.4828 77.5107 77.5475 77.5935 77.7226 77.7583 77.768 77.813 77.894 77.9109 77.9011 77.9123 77.9083];

c5ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c5ulyp=[88.9715 88.8946 88.7102 88.1675 87.3251 86.9389 85.5393 85.0698 83.2747 82.3833 82.0595 80.5926 79.4197 78.407 78.0336 76.6012 76.4644 75.0421 73.8244 71.2706 70.1236 ];

c5urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c5uryp=[82.6741 82.8648 82.7463 83.0877 81.6046 80.7391 80.5216 79.9719 79.3559 79.1893 78.8011 78.3457 77.7248 77.2402 76.8221 75.1081 74.4669 73.6816 73.114 72.4609 71.8421];

c6ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c6ulyp=[86.4373 86.5143 86.4556 86.3163 85.7755 85.064 83.5282 83.1868 82.5555 82.5025 82.3978 82.2906 82.2018 82.1354 82.009 81.3194 81.1321 80.8644 80.5272 80.1137 79.8591];

c6urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c6uryp=[89.2739 89.326 89.3251 89.2658 88.7279 88.0169 86.8809 86.6539 85.5964 84.669 83.7436 82.3034 81.3558 78.3891 78.0274 76.2464 76.0539 75.7627 74.9083 72.5071 70.7979];

c7ulxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c7ulyp=[95.8894 96.1464 96.251 96.2525 96.2947 96.5458 96.5124 96.3408 95.9986 95.8489 95.0838 94.2499 92.6168 91.7963 90.6807 89.2867 89.2468 89.9059 89.8332 90.0148 89.6604];

c7urxp=[2 2.05126 2.11533 2.16533 2.2247 2.26689 2.31689 2.36689 2.42627 2.45263 2.51196 2.57134 2.62143 2.65745 2.70443 2.7639 2.80111 2.85094 2.90531 2.96081 3]-2;
c7uryp=[91.1222 91.2483 91.4695 91.672 91.9262 92.3256 92.3575 92.2735 91.7453 91.5594 90.8503 90.1245 89.5087 88.9978 86.8892 85.8573 85.6374 84.0129 83.0507 81.8895 81.3851];

%% 4N

c4ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c4ulyn=[83.1334 83.0515 82.8809 82.6623 82.461 82.1854 81.7626 81.562 81.3842 80.3807 80.0939 79.7957 79.6186 78.0826 77.8659 77.5701 77.3436 77.1093 76.7766 76.537 76.3683];

c4urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c4uryn=[78.9613 79.1016 79.3202 79.63 79.7908 80.0691 80.1858 80.106 80.0063 79.6632 79.2136 78.3264 77.6495 76.9593 76.195 75.4339 74.7157 74.1325 73.4009 72.8233 72.3449];

c5ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c5ulyn=[88.9715 89.0323 89.0295 88.9178 88.6963 88.9509 88.9222 88.3882 87.7139 86.9776 86.2437 84.7224 84.0496 83.4018 82.6853 81.8423 81.0492 80.2467 78.5109 76.7959 74.8481];

c5urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c5uryn=[82.6741 82.6006 82.2274 81.9423 81.585 81.0727 80.9374 80.3441 79.2469 78.3502 77.6806 76.7199 75.8751 75.0347 74.0759 73.1361 72.1966 70.558 69.3025 68.2059 67.4096 ];

c6ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c6ulyn=[86.4373 86.5071 86.6446 86.773 86.8667 86.999 87.1219 87.207 87.3173 87.4414 87.8895 88.0838 88.2187 88.3643 88.4594 88.5446 88.2764 88.1399 88.0219 87.7918 87.6443];

c6urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c6uryn=[89.2739 89.1144 89.0339 89.0877 88.8752 88.9888 89.1272 88.507 88.6272 88.7814 88.9625 89.1493 89.5557 89.6713 89.5771 89.4348 89.9603 90.3575 90.0979 89.7781 89.4835];

c7ulxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c7ulyn=[95.8894 95.9764 95.6243 95.1316 94.8403 94.4703 94.1462 93.8572 93.5513 93.2048 93.1055 93.0074 92.9283 92.854 92.8024 92.773 92.7725 92.7967 92.7933 92.8937 93.0013 ];

c7urxn=-1*[2 2.05126 2.11533 2.16533 2.20361 2.25215 2.30482 2.35211 2.4011 2.4565 2.50468 2.55973 2.60432 2.65144 2.70196 2.75595 2.80367 2.85248 2.91084 2.96199 3]+2;
c7uryn=[91.1222 90.9962 90.5237 90.0421 89.6408 89.1454 88.7937 88.5805 88.364 88.1715 88.0268 87.7868 87.682 87.3167 87.2246 86.8426 86.6956 86.6769 86.6943 86.7544 86.821];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'-.r');
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'-.g');
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'-.b');
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'-.c');

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Area (CAREA) for model 3 under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Area (mm^2)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','south')