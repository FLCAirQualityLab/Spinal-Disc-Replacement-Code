% Facet Contact Area (CAREA)
% model15_intact/5n& 5p
clear all;
%% 5P
figure (2)

c4ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c4ulyp=[83.3586 83.4266 83.7627 83.7765 83.5081 83.0931 82.4157 81.7953 81.4442 80.8601 80.3019 79.7394 79.0431 78.7101 78.2956 77.499 76.8707 76.0195 75.2547 74.6416 74.0222 ];

c4urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c4uryp=[77.865 77.5707 77.6125 77.5661 77.2111 76.782 76.6462 76.5461 76.5793 75.645 75.4978 74.7857 74.0293 73.6219 73.2146 72.1666 71.0486 70.7354 70.4728 69.3131 68.7511 ];

c5ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c5ulyp=[85.6736 88.278 89.7936 89.9508 89.9991 90.872 92.888 93.1074 93.1875 93.2518 94.318 94.3928 95.964 95.8978 95.8198 95.8526 95.717 96.0532 95.7387 95.5356 95.2297];

c5urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c5uryp=[83.2378 83.3926 81.3424 81.1116 80.3259 78.0237 77.546 76.2937 75.3672 73.9821 72.8593 71.675 70.2544 68.9852 66.581 65.6019 65.4874 64.0799 61.9133 59.9963 59.9167];

c6ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c6ulyp=[84.9825 87.1142 88.8172 89.2055 89.4299 89.4983 89.6317 89.462 89.2244 88.8741 88.314 87.7532 86.8383 86.203 85.6929 85.1572 84.5584 83.7234 83.0722 82.4821 81.7984];

c6urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c6uryp=[86.7747 85.3704 83.4936 83.0529 82.3568 81.3579 80.4793 79.7758 79.0423 77.6109 76.5742 75.6063 72.9631 69.6211 65.5682 64.2984 60.1773 57.2145 53.8892 51.9298 49.4069 ];

c7ulxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c7ulyp=[94.2066 95.6007 97.962 99.3197 102.525 104.804 106.665 105.515 103.801 101.772 100.159 99.0484 98.1514 97.2705 96.4969 95.6767 94.831 93.8201 92.8117 91.9522 90.9648];

c7urxp=[2 2.0575 2.12605 2.15275 2.21233 2.25121 2.30204 2.36312 2.40096 2.45209 2.50097 2.55317 2.60321 2.65826 2.70492 2.75514 2.80039 2.85766 2.90816 2.95077 3 ]-2;
c7uryp=[87.3617 85.4185 82.4816 80.5086 77.5852 76.2978 73.7164 69.3105 68.0982 66.0393 63.7384 62.8121 61.7761 60.4915 59.4456 58.6362 57.914 56.5829 56.4904 56.0743 55.5616];

%% 5N

c4ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c4ulyn=[83.3586 82.9678 82.8554 82.7055 82.6687 82.5467 82.5805 82.0237 82.1385 80.7711 80.8908 79.8918 79.2288 78.9105 78.6305 77.6768 75.4298 74.8189 72.2181 71.2012 70.6178];

c4urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c4uryn=[77.865 78.6823 79.2943 79.8917 80.4145 80.3609 79.9128 78.8778 77.4231 76.3637 74.7967 73.7099 72.8135 72.049 71.0402 70.2272 69.3927 68.6724 67.7795 67.044 66.3875];

c5ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c5ulyn=[85.6736 84.6698 83.5536 83.4728 83.1502 82.4399 82.2387 81.2589 80.5709 80.3636 79.6874 78.1992 76.5221 75.1984 73.7907 72.0031 70.5664 68.2641 66.5184 62.9988 61.3031];

c5urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c5uryn=[83.2378 82.9323 83.8106 83.6621 84.2512 84.591 84.5385 85.0601 85.0562 84.9861 85.477 85.3858 85.2433 84.999 84.8519 84.5051 84.0737 83.6343 83.2823 82.883 82.583];

c6ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c6ulyn=[84.9825 82.4647 81.5904 80.6021 79.5033 78.3186 77.123 76.5781 74.7563 73.2797 72.2389 71.474 68.3219 68.1547 66.2658 65.4156 65.2188 63.6912 62.7994 62.6393 62.4966 ];

c6urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c6uryn=[86.7747 88.4371 89.5998 90.2816 90.7363 90.36 89.8872 89.1329 88.1926 87.1855 86.0166 85.0636 83.968 83.4024 82.5685 81.834 81.1557 80.51 79.7913 79.2347 78.7304 ];

c7ulxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c7ulyn=[94.2066 92.8348 91.5929 90.2287 89.5788 88.1589 86.9279 85.6545 84.4664 83.4959 82.2926 81.3295 79.3079 78.1652 76.308 72.4604 70.4046 69.8974 66.6076 65.4425 63.7628];

c7urxn=-1*[2 2.0575 2.10375 2.15062 2.20072 2.26757 2.30624 2.35024 2.40593 2.45239 2.51131 2.56239 2.61382 2.65198 2.70613 2.75565 2.80324 2.85205 2.90639 2.95374 3]+2;
c7uryn=[87.3617 89.343 90.2406 91.1771 93.9122 97.2934 98.4696 99.2144 100.026 100.648 100.814 100.922 100.881 100.677 100.277 99.8976 99.3808 98.6347 97.7523 96.9395 96.1436];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'-.r');
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'-.g');
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'-.b');
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'-.c');

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Area (CAREA) for intact model under lateral bending (5N/5P)')
xlabel('Moment (N-m)')
ylabel('Area (mm^2)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','south')