% Facet Contact Area (CAREA)
% model15_intact/4n & 4p Upper Left 
clear all;
%% 4P
figure (1)

c4ulxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c4ulyp=[83.3586 83.585 83.6323 83.6189 83.673 83.7203 83.7166 83.7081 83.6888 83.661 83.6316 83.6379 83.5877 83.5311 83.4669 83.4018 83.3254 83.2766 83.1859 82.6411 82.558];

c4urxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c4uryp=[77.865 77.7667 77.6868 77.5729 77.6656 77.8207 77.8387 77.9655 78.027 78.1073 78.2342 78.2991 78.3696 78.5023 78.5645 78.5347 78.4717 78.412 78.29 78.1409 77.9543];

c5ulxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c5ulyp=[85.6736 85.0876 84.8858 84.5548 84.0447 83.6115 83.5478 83.2773 82.9234 82.6445 82.4423 82.0174 81.7627 81.245 81.0003 79.0738 78.2584 76.5844 74.8407 74.1334 73.1189];

c5urxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c5uryp=[83.2378 83.3166 83.3572 83.4314 83.2499 82.6372 82.5962 82.3371 81.2953 81.0235 80.4525 80.113 79.8931 79.5899 78.7815 78.6119 78.2863 77.094 76.164 76.0245 75.6194];

c6ulxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c6ulyp=[84.9825 83.4916 82.4103 81.9369 81.2417 80.5425 80.4591 80.1201 79.7956 79.3322 78.9668 78.6819 77.9011 77.5828 77.2049 76.868 76.0514 75.8447 75.4348 75.1649 74.8866];

c6urxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c6uryp=[86.7747 85.8569 85.2499 84.7326 84.2875 83.644 83.5289 83.1169 82.6041 82.1931 81.8227 81.4587 81.1349 80.8058 80.1796 79.595 77.9344 77.671 77.0085 75.7105 75.3816];

c7ulxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c7ulyp=[94.2066 93.9002 93.6179 93.1001 92.3875 92.0146 91.9482 91.5263 90.8894 90.4156 89.9896 89.5841 89.1497 88.7171 88.165 87.7182 87.1718 86.8704 86.3036 85.9809 85.6144];

c7urxp=[2 2.0675 2.10046 2.15118 2.21847 2.28879 2.30129 2.3542 2.41761 2.47111 2.51624 2.55771 2.60433 2.65123 2.70673 2.75718 2.81828 2.8513 2.91654 2.95737 3 ]-2;
c7uryp=[87.3617 86.9002 86.4681 86.0505 85.8695 85.1867 85.1067 84.7669 84.1789 83.7344 83.0556 82.4439 82.0592 81.6834 81.2667 80.3665 79.3161 78.44 77.6819 77.3927 77.0286];

%% 4N
c4ulxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c4ulyn=[83.326 83.2056 83.0593 82.7976 82.5195 82.2434 81.9711 81.7718 80.923 80.6905 80.4747 78.9193 78.6702 78.404 78.2039 78.0122 77.6971 77.3744 77.0284 76.6401 76.3264];

c4urxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c4uryn=[77.9019 78.0735 78.6251 78.9549 79.3677 79.7468 79.9781 80.1648 80.1665 80.0185 79.6458 79.0221 78.1756 77.3087 76.527 75.7343 74.9254 74.1992 73.4496 72.8374 72.1467  ];

c5ulxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c5ulyn=[85.8014 86.152 86.5117 86.8802 87.189 87.4449 88.1646 88.2634 88.3482 88.3817 88.3423 88.2628 88.243 89.2265 89.1529 89.0156 88.9209 88.7212 88.4756 88.1452 87.841 ];

c5urxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c5uryn=[83.0901 83.3241 83.2661 83.0472 82.9531 82.7136 82.8129 82.5573 82.2315 81.9794 81.7462 81.5247 82.6961 82.5042 82.2482 81.9274 81.6358 81.3404 81.0304 80.6679 80.2742];

c6ulxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c6ulyn=[85.1879 86.2559 86.6502 86.9558 87.2706 87.9361 88.2704 88.59 88.4917 88.1814 87.7087 87.3781 87.2028 86.7952 86.2098 85.727 85.1017 84.2907 83.6071 82.9305 82.3662];

c6urxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c6uryn=[87.2611 87.2972 87.5143 87.8205 88.2 88.6699 89.1319 89.3539 89.3597 89.304 90.055 89.3728 88.8489 88.0217 86.9091 85.5563 84.5046 82.9194 81.6039 80.2348 78.8808];

c7ulxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c7ulyn=[94.5766 94.564 94.5542 95.3992 95.8996 96.3879 96.7134 97.5761 98.7938 99.3591 100.52 101.587 102.745 101.126 100.196 98.5701 96.4247 94.9274 93.8144 92.3117 91.7066 ];

c7urxn=-1*[2 2.05 2.1 2.15 2.2 2.25 2.30198 2.35365 2.40358 2.45421 2.50322 2.55384 2.60384 2.65565 2.70225 2.75206 2.80139 2.85108 2.90339 2.95085 3]+2;
c7uryn=[88.6922 88.2211 88.0755 88.5401 88.8716 89.006 89.5269 89.5911 89.1257 89.5694 88.4958 86.7218 85.627 81.7828 80.2254 78.0809 75.2318 74.3544 74.113 73.2009 73.6103 ];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'-.r');
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'-.g');
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'-.b');
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'-.c');

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Area (CAREA) for intact model under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Area (mm^2)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','south')