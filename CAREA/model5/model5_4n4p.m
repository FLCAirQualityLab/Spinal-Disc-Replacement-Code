% Facet Contact Area (CAREA)
% model5_LatSlide_Tether/4n & 4p
clear all;
%% 4P
figure (16)

c4ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c4ulyp=[83.1369 83.2181 83.3931 83.5305 83.6731 83.9603 84.1717 84.0624 84.0391 83.9587 83.9578 83.9085 83.8447 83.7815 83.6994 83.5893 83.4036 83.3289 83.1915 83.1023 82.9816];

c4urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c4uryp=[78.9534 78.8207 78.5841 78.4015 78.2004 78.0387 77.8187 77.5705 77.4899 77.541 77.5483 77.6228 77.7047 77.7464 77.7697 77.802 77.9067 77.9108 77.9033 77.9128 77.9059];

c5ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c5ulyp=[88.8267 88.7657 88.5515 88.2006 87.7384 87.2616 84.6649 84.1952 82.6627 82.1372 81.3217 80.4292 78.6389 78.4283 76.7662 76.3349 73.057 72.8656 70.2629 70.0295 67.6191];

c5urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c5uryp=[82.6801 82.7202 82.8268 82.3672 80.9323 80.8389 80.3144 79.855 79.6189 79.1887 79.0131 78.1981 78.0138 77.8059 75.9094 75.5246 74.2087 73.9651 73.0742 72.6961 71.586];

c6ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c6ulyp=[86.4053 86.4845 86.4102 86.2696 85.8937 85.2249 83.445 83.1407 82.6236 82.4579 82.4001 82.2703 82.2141 82.1484 82.0151 81.3663 81.0337 80.8716 80.5064 80.1894 79.8795];

c6urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c6uryp=[89.2598 89.3147 89.2995 89.23 88.8484 88.2212 86.8291 86.6256 86.5454 84.6012 83.7486 82.2835 82.2055 79.3819 78.0486 76.3018 75.9676 75.7954 73.8373 72.6041 70.9714];

c7ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c7ulyp=[95.8366 96.086 96.24 96.2317 96.2998 96.2609 96.4795 96.29 96.1025 95.6558 95.0954 93.6331 92.7152 91.902 91.2599 89.6892 89.2414 89.9095 89.8311 89.7595 89.6879];

c7urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3]-2;
c7uryp=[91.0847 91.1182 91.4326 91.851 91.8941 92.2939 92.3362 91.8676 91.7945 91.3595 90.8569 90.0941 89.5506 89.3911 87.3236 85.9498 85.5335 83.7428 83.0618 82.2227 81.4374];

%% 4N

c4ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c4ulyn=[83.1369 83.0562 82.882 82.6021 82.4388 82.1451 81.7589 81.5673 81.3903 80.4169 80.1173 79.8294 78.2363 78.0892 77.8664 77.5817 77.369 77.1257 76.8252 76.5872 76.3845];

c4urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c4uryn=[78.9534 79.094 79.3135 79.6729 79.788 80.0818 80.1846 80.1074 80.0089 79.7128 79.2523 78.4366 77.5954 76.9692 76.18 75.4454 74.7729 74.1491 73.4909 72.9384 72.3678 ];

c5ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c5ulyn=[88.8267 88.8794 88.9126 88.8354 88.7193 89.0504 89.0129 88.4627 87.7552 87.0821 86.3399 84.8457 84.0202 83.4378 82.7014 81.8917 81.1622 80.3135 78.6948 77.0047 74.9282];

c5urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c5uryn=[82.6801 82.6194 82.2518 81.9228 81.6594 81.9356 80.9761 79.9207 79.3331 78.5127 77.761 76.9011 75.8289 75.0653 74.0811 73.1783 72.3187 70.6266 69.5035 68.4608 67.4962];

c6ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c6ulyn=[86.4053 86.4715 86.633 86.8185 86.9162 87.0517 87.1377 87.2048 87.308 87.4118 87.5869 88.0477 88.2098 88.3421 88.4498 88.5428 88.2976 88.1869 88.1003 87.8785 87.6982];

c6urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c6uryn=[89.2598 89.105 89.0348 89.1062 88.889 89.0216 89.1522 89.0174 88.6299 88.7627 88.9443 89.1153 89.553 89.6671 89.5798 89.4583 89.9599 90.3904 90.1468 89.9314 89.5785];

c7ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c7ulyn=[95.8366 95.9326 95.609 95.0498 94.8268 94.4525 94.1572 93.8534 93.4489 93.1943 93.0843 92.9876 92.8772 92.8047 92.7437 92.7048 92.6943 92.708 92.6921 92.7702 92.8836];

c7urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c7uryn=[91.0847 90.951 90.4947 89.9311 89.6381 89.1188 88.81 88.6237 88.4082 88.2146 88.0541 87.8153 87.6728 87.3109 87.2127 86.9433 86.6825 86.6557 86.5904 86.6317 86.7774];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'-.r');
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'-.g');
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'-.b');
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'-.c');

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Area (CAREA) for model 5 under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Area (mm^2)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','south')