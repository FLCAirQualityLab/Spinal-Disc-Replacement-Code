%% Facet contact force magnitude (N)
%model5_LatSlide_Tether/4n &4p

clear all;
%% 4P
figure (16)

c4ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c4ulyp=[19.2335 17.9047 16.393 15.2964 14.3476 13.6028 12.5146 11.8393 11.4391 10.4994 10.0703 9.11244 8.68134 8.18316 7.5317 6.9128 6.15765 5.84049 5.25101 4.86811 4.42854];

c4urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c4uryp=[19.6155 18.5191 17.3003 16.4547 15.755 15.2576 14.4224 13.9166 13.5772 12.7774 12.418 11.5835 11.1925 10.7312 10.0718 9.37094 8.42606 8.00397 7.19653 6.63642 5.98997 ];

c5ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c5ulyp=[15.1248 13.6176 9.50322 5.76849 3.39586 2.43861 1.4665 0.962134 0.685888 0.320943 0.213753 0.00612509 0.00400791 0.00382318 0.00363199 0.00343183 0.00319134 0.00308659 0.00290176 0.00278545 0.00264316 ];

c5urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c5uryp=[8.56516 7.20876 3.84375 1.59383 0.526055 0.302847 0.0586155 0.00534518 0.00490914 0.00449382 0.0044327 0.00428292 0.0042197 0.00414973 0.00406006 0.00397992 0.00385959 0.00380311 0.00368806 0.00361006 0.00350822];

c6ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c6ulyp=[6.43052 6.10992 4.97124 3.78958 2.03057 0.720387 0.00520779 0.00483889 0.00464202 0.00434526 0.00424574 0.00404574 0.00395921 0.00385667 0.00369105 0.00353327 0.00339997 0.00335029 0.0032578 0.0031982 0.00312932 ];

c6urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c6uryp=[3.64472 3.26341 2.21249 1.40046 0.427966 0.00467567 0.00382282 0.00358852 0.00345826 0.00320115 0.00308595 0.00282741 0.00271307 0.00259275 0.00245059 0.00233723 0.00223808 0.00219483 0.00210469 0.00204641 0.00197547];

c7ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c7ulyp=[3.56497 3.59402 3.50694 3.39587 3.14637 2.78374 1.88183 0.861132 0.3971 0.00512347 0.00486676 0.00422218 0.00392398 0.0035746 0.00323247 0.00309253 0.00304632 0.00303593 0.00302483 0.00302664 0.00303901  ];

c7urxp=[2 2.05126 2.11533 2.16533 2.21533 2.25908 2.32939 2.37939 2.41064 2.48096 2.51221 2.58252 2.61377 2.65013 2.70227 2.75401 2.82172 2.85179 2.91104 2.95017 3 ]-2;
c7uryp=[10.2044 10.1096 9.54349 9.02611 8.18418 7.38732 5.83505 4.30693 3.46588 1.82822 1.32135 0.404723 0.0401962 0.00401572 0.00376997 0.00356782 0.0033876 0.00331272 0.00316862 0.00307424 0.00296025 ];

%% 4N

c4ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c4ulyn=[19.2335 20.7369 22.9018 26.3351 28.5054 32.538 35.9908 39.1706 42.5922 46.0754 49.5586 52.9838 56.9313 60.1069 64.0495 67.9269 71.3018 75.131 79.1597 82.9595 86.5461];

c4urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c4uryn=[19.6155 20.8787 22.5456 25.0669 26.7552 30.2114 33.6337 36.858 40.312 43.8499 47.3887 51.1407 55.3383 58.6149 62.4898 66.4052 69.7918 73.6924 77.542 80.9926 84.2999];

c5ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c5ulyn=[15.1248 16.9003 21.3516 26.4062 29.1323 33.9783 37.7984 41.206 44.712 48.1819 51.5237 54.853 58.4591 61.6334 65.6862 69.788 73.3803 77.6002 81.989 86.1607 90.2319];

c5urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c5uryn=[8.56516 9.9802 13.7689 18.2319 20.4824 24.3912 27.25 29.7062 32.069 34.4511 36.841 39.199 41.7935 44.1825 47.1599 50.1549 52.7636 55.8701 59.058 62.0043 64.8183];

c6ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c6ulyn=[6.43052 7.07762 8.48964 10.1603 11.0546 12.9008 14.6251 16.257 18.0448 19.9152 21.828 23.7542 25.9247 27.7112 29.994 32.393 34.5482 37.1937 40.1033 43.109 46.1443 ];

c6urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c6uryn=[3.64472 4.18117 5.44683 6.88887 7.65548 9.09423 10.4204 11.6758 13.0149 14.4264 15.8775 17.4045 19.2224 20.6652 22.4085 24.1982 25.7719 27.6649 29.8162 31.7733 33.6731 ];

c7ulxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c7ulyn=[3.56497 3.69082 3.86883 4.25382 4.48434 5.12067 5.97203 6.81533 7.76178 8.70904 9.64808 10.5845 11.601 12.4364 13.4522 14.4354 15.2628 16.2113 17.151 18.0848 19.0053 ];

c7urxn=-1*[2 2.05126 2.11533 2.17471 2.20404 2.25806 2.30703 2.35279 2.40109 2.45138 2.50274 2.55389 2.60894 2.65187 2.70418 2.75649 2.80083 2.85242 2.90526 2.95387 3]+2;
c7uryn=[10.2044 10.4895 11.1757 11.9833 12.4181 13.4676 14.6404 15.7335 16.8352 17.9362 18.9787 19.9482 20.9741 21.7304 22.5961 23.4269 24.0986 24.8378 25.5998 26.1847 26.676];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'color',[0.75, 0, 0.75]);
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'color',[0 0.5 1]);
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'color',[0.2 0 0]);
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'color',[1 .5 0]);

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Force Magntiude (CFNM) for model 5 under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Force (N)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','north')