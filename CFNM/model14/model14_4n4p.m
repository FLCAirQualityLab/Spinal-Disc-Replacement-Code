%% Facet contact force magnitude (N)
% model14_LatSlide_NoTether/4n & 4p
clear all;
%% 4P
figure (25)

c4ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c4ulyp=[19.7539 19.6852 18.0613 17.2871 16.2463 15.6029 14.4463 13.9244 12.5682 12.366 11.3754 10.6756 9.98205 9.14601 8.43257 7.68311 7.0309 6.27029 5.61545 4.768 4.47661 ];

c4urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c4uryp=[20.3207 20.0248 18.6322 17.9598 17.0866 16.5877 15.7441 15.3474 14.2991 14.1338 13.2743 12.6464 12.0449 11.2347 10.5326 9.66125 8.79979 7.71957 6.71653 5.42442 5.01483  ];

c5ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c5ulyp=[7.26002 9.28143 3.71797 2.84097 1.88272 1.42212 0.620113 0.418147 0.0689567 0.0177358 0.00379456 0.00363832 0.00348231 0.00329648 0.00314403 0.00298386 0.00283907 0.00266821 0.00251347 0.00232496 0.00226135 ];

c5urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c5uryp=[4.70891 4.56897 0.896984 0.551411 0.318706 0.219666 0.089293 0.036187 0.00485521 0.00468181 0.00433827 0.0042492 0.00416102 0.00404875 0.00395155 0.00384261 0.00374441 0.00362403 0.0035092 0.00336143 0.00331002 ];

c6ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c6ulyp=[1.25371 3.99343 1.72561 0.517792 0.0052832 0.00524451 0.00519925 0.00517131 0.00506137 0.00504263 0.00495525 0.00488119 0.00480653 0.00471168 0.004625 0.00453107 0.00444037 0.00432452 0.00421508 0.00407227 0.00402243 ];

c6urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c6uryp=[1.04329 2.33526 0.309665 0.00432541 0.00392703 0.00380572 0.00369784 0.00363269 0.00348028 0.00345719 0.00333528 0.00324688 0.00315385 0.00302906 0.00292246 0.00279883 0.00268202 0.00254066 0.00240835 0.00224421 0.0021872];

c7ulxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c7ulyp=[0.234852 2.01128 1.38815 0.823596 0.140931 0.00560417 0.00572182 0.00580373 0.00596605 0.0059854 0.00606197 0.00609778 0.00612432 0.00614834 0.006162 0.00616827 0.00616756 0.00626064 0.0063341 0.00640511 0.00644702];

c7urxp=[2 2.05026 2.12154 2.16006 2.21479 2.25242 2.32555 2.36019 2.44483 2.45733 2.51914 2.56141 2.60341 2.65657 2.70193 2.75284 2.80008 2.85729 2.91018 2.97712 3]-2;
c7uryp=[7.67754 9.54573 7.99443 7.173 5.95659 5.33522 5.27021 5.25586 5.07391 5.04453 5.01491 4.95954 4.88234 4.78872 4.68497 4.53694 4.36937 4.12993 3.89953 3.58155 3.46427 ];

%% 4N

c4ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c4ulyn=[19.7539 22.4097 24.9026 28.744 30.6617 34.7278 37.8857 41.7366 46.0759 48.5642 52.8592 55.5079 59.0105 62.8457 66.4437 70.3968 74.1704 78.3444 81.697 85.63 89.3084 ];

c4urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c4uryn=[20.3207 22.5472 24.4792 27.2933 28.6973 31.8416 34.6358 38.4022 42.7614 45.317 49.7261 52.4507 56.133 60.1816 63.8538 67.7905 71.6318 76.0601 79.664 83.8245 87.5346];

c5ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c5ulyn=[7.26002 14.6039 22.8155 29.7949 32.5499 37.3107 40.6591 44.5826 48.6296 50.857 54.9471 57.8047 61.8711 66.6676 71.345 76.5942 81.8392 87.8758 92.6026 98.0356 102.503 ];

c5urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c5uryn=[4.70891 9.71846 16.3526 21.8092 23.888 27.1832 29.382 31.796 34.6146 36.2041 39.6869 42.4259 46.2812 50.4482 54.4593 58.8979 63.2897 68.234 72.1486 76.6012 80.3757];

c6ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c6ulyn=[1.25371 5.17705 7.76956 10.4076 11.58 14.0204 16.0032 18.5619 21.5254 23.2482 26.3146 28.1855 30.8192 33.7908 36.5903 39.7817 43.0818 46.9827 50.389 54.5401 58.413 ];

c6urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c6uryn=[1.04329 3.80223 5.83889 7.45621 8.1865 9.77289 11.1543 13.1469 15.6211 17.1307 19.6406 21.1778 23.2598 25.5598 27.6722 30.0085 32.367 35.191 37.611 40.4932 43.28];

c7ulxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c7ulyn=[0.234852 1.9539 2.70203 3.40765 3.75151 4.58663 5.32468 6.31227 7.47601 8.17723 9.55419 10.3585 11.4139 12.5752 13.6453 14.7994 16.0735 17.6595 19.073 20.773 22.378];

c7urxn=-1*[2 2.05126 2.11533 2.17471 2.20107 2.25678 2.30078 2.35474 2.41562 2.45083 2.5117 2.55021 2.60026 2.65289 2.70081 2.75198 2.8011 2.85607 2.90043 2.95245 3]+2;
c7uryn=[7.67754 10.2633 11.3018 12.4368 12.9215 13.8956 14.6507 15.6015 16.6741 17.2863 18.2586 18.8212 19.523 20.2465 20.8568 21.5658 22.3204 23.2472 24.0581 25.049 26.1345];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'color',[0.75, 0, 0.75]);
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'color',[0 0.5 1]);
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'color',[0.2 0 0]);
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'color',[1 .5 0]);

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Force Magntiude (CFNM) for model 14 under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Force (N)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','north')