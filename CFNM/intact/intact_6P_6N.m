%% Facet contact force magnitude (N)
% Intact 6P/6N

clear all;
%% 6P
figure (3)

c4ulxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c4ulyp=[21.3341 19.1903 17.673 16.3607 15.2237 14.3743 13.5095 12.8032 12.2507 11.6966 11.0726 10.6034 10.1394 9.5794 8.8774 8.24339 7.68728 7.02635 6.4884 5.99162 5.46937 ];

c4urxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c4uryp=[21.2462 24.2257 26.8186 29.6385 32.5961 35.104 38.0648 40.8813 43.3522 45.8098 48.4966 50.9202 53.0617 55.3364 57.8679 60.0608 62.0079 64.2803 66.3894 68.1936 70.1396 ];

c5ulxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c5ulyp=[11.6099 10.856 10.7051 10.7933 10.8101 10.751 10.6115 10.3987 10.2005 10.0163 9.69336 9.30205 8.9088 8.41561 7.82751 7.36353 6.96618 6.51564 6.1006 5.71234 5.28788 ];

c5urxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c5uryp=[3.99436 5.81449 7.78729 9.96453 12.2007 13.9973 15.9406 17.6643 19.2025 20.7441 22.3857 23.9001 25.2952 26.8567 28.6037 30.1684 31.6285 33.3959 35.0886 36.5621 38.1722 ];

c6ulxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c6ulyp=[4.46774 2.43428 1.09259 0.00527453 0.00441979 0.00379339 0.0031794 0.00290765 0.00266958 0.00242272 0.00215804 0.00193295 0.00175061 0.00155229 0.00134942 0.00118712 0.00105381 0.00092098 0.000817264 0.000736629 0.000653781 ];

c6urxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c6uryp=[1.49563 4.69952 8.01164 11.5253 14.6776 17.133 19.7018 21.7836 23.4621 25.095 26.8718 28.5586 30.0206 31.54 33.1937 34.6439 35.9728 37.5582 39.0149 40.2523 41.5875 ];

c7ulxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c7ulyp=[2.08179 0.00626128 0.00495149 0.00419348 0.00352231 0.00300205 0.00260773 0.00229757 0.00205065 0.00180967 0.00156632 0.00137069 0.00121094 0.00105358 0.000886151 0.000748198 0.000636387 0.000513652 0.000417673 0.000349193 0.000288101 ];


c7urxp=[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]-2;
c7uryp=[9.88572 12.4899 14.6169 17.1115 19.8845 22.2708 25.0365 27.4821 29.5474 31.5374 33.6047 35.4439 37.0901 38.8295 40.7055 42.3327 43.8637 45.6792 47.3633 48.8313 50.3935 ];

%%6N
c4ulxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c4ulyn=[21.3341 23.7048 25.7999 27.9809 31.0861 32.3518 34.5226 36.3898 38.4476 40.8198 43.1217 44.9686 46.9406 49.0347 50.7051 52.6384 54.7538 57.4442 58.5433 59.9051 61.562 ];

c4urxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c4uryn=[21.2462 18.4768 16.3724 14.3423 11.6129 10.6251 9.09483 7.93702 6.73785 5.53313 4.54713 3.82784 3.17052 2.54574 2.04357 1.54846 1.11128 0.667543 0.491258 0.300596 0.172397 ];

c5ulxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c5ulyn=[11.6099 13.0152 14.4241 16.1037 18.4743 19.3805 20.9622 22.342 23.8451 25.6703 27.4973 29.0877 30.7705 32.5351 33.935 35.547 37.3562 39.6207 40.5447 41.6796 43.0575 ];

c5urxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c5uryn=[3.99436 2.77179 1.99008 1.42405 0.784123 0.661701 0.446895 0.247268 0.0192373 0.00474664 0.00454741 0.00438951 0.00420797 0.00400784 0.00383861 0.00362576 0.00338539 0.00307076 0.00293873 0.00277702 0.00258463 ];

c6ulxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c6ulyn=[4.46774 7.45443 9.94598 13.1611 17.3064 18.7973 21.3753 23.5446 25.8806 28.3973 30.7332 32.6836 34.6938 36.7707 38.3874 40.2595 42.3137 44.9171 45.9513 47.2069 48.693 ];

c6urxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c6uryn=[1.49563 0.00442299 0.00361249 0.00308575 0.00257293 0.00241189 0.00215049 0.00192899 0.00168839 0.00146011 0.00127654 0.00114517 0.00101332 0.000881374 0.000782758 0.00067992 0.000568232 0.000437298 0.000386905 0.000326606 0.000261745 ];

c7ulxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c7ulyn=[2.08179 5.33253 8.3095 11.6893 16.3158 17.9799 20.7786 23.0878 25.4863 27.983 30.252 32.0076 33.7793 35.6076 37.0416 38.7102 40.5642 42.9532 43.9266 45.1077 46.5268 ];

c7urxn=-1*[2 2.0575 2.1047 2.15542 2.20899 2.25434 2.30803 2.35883 2.40461 2.45206 2.5051 2.55493 2.60055 2.6508 2.70761 2.75783 2.80375 2.85877 2.90932 2.95288 3 ]+2;
c7uryn=[9.88572 7.50295 5.89382 4.47532 2.82515 2.27879 1.45917 0.893097 0.334267 0.00304547 0.00239133 0.00223725 0.00207898 0.00191212 0.00177559 0.00161757 0.00145036 0.0012512 0.00117612 0.00108799 0.000994451 ];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'color',[0.75, 0, 0.75]);
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'color',[0 0.5 1]);
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'color',[0.2 0 0]);
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'color',[1 .5 0]);

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Force Magntiude (CFNM) for intact under axial rotation (6N/6P)')
xlabel('Moment (N-m)')
ylabel('Force (N)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','north')