%% Facet contact force magnitude (N)
% model13_Fixed_Tether/4n & 4p
clear all;
%% 4P
figure (22)

c4ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c4ulyp=[21.0347 19.6313 17.9552 16.7059 15.5026 14.3736 13.3096 12.3785 11.4735 10.613 9.74873 8.87125 7.85323 7.12744 6.4553 5.69287 5.02524 4.34291 3.70826 3.09591 2.74818];

c4urxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c4uryp=[21.0659 19.7577 18.2502 17.1576 16.1051 15.2253 14.4105 13.5005 12.6492 11.8953 11.1256 10.3269 9.37086 8.67561 8.02731 7.15247 6.28131 5.30704 4.46484 3.56996 3.02786];

c5ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c5ulyp=[14.2344 13.1335 9.93202 6.92215 4.04276 2.62176 1.72753 1.33244 0.933578 0.504398 0.269345 0.0946579 0.00400744 0.00379158 0.00366496 0.00350411 0.0033484 0.0031639 0.00299547 0.00282177 0.0027203 ];

c5urxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c5uryp=[7.9013 6.96249 4.40733 2.38097 0.798807 0.338088 0.167341 0.00570458 0.00487745 0.00455773 0.00447032 0.00437641 0.00426389 0.00418971 0.00412044 0.00402973 0.00394762 0.00386658 0.00379155 0.0037081 0.00365756 ];

c6ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c6ulyp=[5.3594 5.21133 4.52583 3.79482 2.92182 1.44856 0.318827 0.00523469 0.00467975 0.00442151 0.00421115 0.00403556 0.00385031 0.00372587 0.00361151 0.00346402 0.00331299 0.00311751 0.00294376 0.00277003 0.00267566];

c6urxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c6uryp=[3.05586 2.85728 2.22019 1.61622 0.941467 0.128394 0.00408104 0.00367501 0.00331327 0.00310129 0.00291546 0.00272715 0.00250919 0.00236484 0.00224164 0.00208506 0.00195279 0.00182378 0.00171222 0.00159966 0.00153182];

c7ulxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c7ulyp=[2.66997 2.7083 2.74425 2.76075 2.76982 2.4437 2.06992 1.86274 1.46804 0.671796 0.160807 0.00498511 0.00459548 0.0042872 0.00399711 0.00360044 0.00322553 0.00293024 0.00270492 0.00252906 0.00244108];

c7urxp=[2 2.05126 2.11533 2.16533 2.21533 2.26533 2.31533 2.36533 2.41533 2.46533 2.51533 2.56533 2.62471 2.66689 2.70517 2.75527 2.80337 2.85848 2.91062 2.96632 3 ]-2;
c7uryp=[9.77236 9.73035 9.39958 9.15078 8.86756 8.23448 7.67876 6.74289 5.77397 4.5031 3.44092 2.5187 1.60573 1.10261 0.659948 0.0963823 0.0038093 0.00356802 0.00335556 0.00315417 0.00303854];

%% 4N
c4ulxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c4ulyn=[21.0347 22.5974 24.8065 27.454 31.574 33.4708 38.216 40.7621 44.1862 48.0348 51.7494 55.1177 58.3301 62.3676 65.8367 69.3783 73.2062 77.017 80.6249 84.1836 87.6868];

c4urxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c4uryn=[21.0659 22.5122 24.3591 26.3915 29.4928 30.9473 34.9388 37.328 40.7328 44.5844 48.386 51.8281 55.1441 59.3447 62.93 66.4729 70.2687 74.0527 77.7632 81.5753 85.356];

c5ulxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c5ulyn=[14.2344 16.318 21.4034 26.2778 32.1893 34.4595 39.5554 42.2091 45.7274 49.4712 53.0421 56.2106 59.2279 63.6352 67.4653 71.4086 75.6553 79.9412 84.1649 88.537 92.8746];

c5urxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c5uryn=[7.9013 9.5416 13.7861 17.9416 22.7446 24.5415 28.3262 30.17 32.5217 35.214 37.7958 40.0863 42.3011 45.5199 48.3319 51.1619 54.2587 57.2968 60.2461 63.2709 66.2612];

c6ulxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c6ulyn=[5.3594 6.04137 7.60184 9.19495 11.2224 12.1686 14.6387 16.0115 17.973 20.2151 22.4779 24.5918 26.6673 29.4605 31.9001 34.4616 37.3366 40.365 43.5046 46.8888 50.4281];

c6urxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c6uryn=[3.05586 3.57124 4.77099 5.92909 7.38771 8.06124 9.76154 10.7197 12.1355 13.907 15.7543 17.5288 19.2828 21.4853 23.3983 25.4436 27.7011 29.9953 32.2339 34.6602 37.0631];

c7ulxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c7ulyn=[2.66997 2.72972 2.86711 3.13978 3.57081 3.82447 4.77222 5.33982 6.16863 7.05338 7.89642 8.64612 9.3595 10.3824 11.2257 12.1052 13.1523 14.2274 15.3768 16.5862 17.8513];

c7urxn=-1*[2 2.05126 2.11533 2.16533 2.2247 2.25107 2.31707 2.35251 2.40079 2.4548 2.50774 2.55564 2.60228 2.65931 2.70659 2.75382 2.80395 2.85431 2.90296 2.95231 3]+2;
c7uryn=[9.77236 10.0973 10.9105 11.7112 12.7182 13.1872 14.3859 15.0332 15.9042 16.8797 17.7742 18.5435 19.2427 20.0407 20.701 21.3542 22.0721 22.7247 23.2482 23.7477 24.2493];
%% left

c4xl=2*[flip(c4ulxn(2:21)),c4ulxp];
c4yl=[flip(c4ulyn(2:21)),c4ulyp];
a=plot(c4xl,c4yl,'r');
hold on

c5xl=2*[flip(c5ulxn(2:21)),c5ulxp];
c5yl=[flip(c5ulyn(2:21)),c5ulyp];
b=plot(c5xl,c5yl,'g');
hold on

c6xl=2*[flip(c6ulxn(2:21)),c6ulxp];
c6yl=[flip(c6ulyn(2:21)),c6ulyp];
c=plot(c6xl,c6yl,'b');
hold on

c7xl=2*[flip(c7ulxn(2:21)),c7ulxp];
c7yl=[flip(c7ulyn(2:21)),c7ulyp];
d=plot(c7xl,c7yl,'c');
hold on
%% Right

c4xr=2*[flip(c4urxn(2:21)),c4urxp];
c4yr=[flip(c4uryn(2:21)),c4uryp];
e=plot(c4xr,c4yr,'color',[0.75, 0, 0.75]);
hold on

c5xr=2*[flip(c5urxn(2:21)),c5urxp];
c5yr=[flip(c5uryn(2:21)),c5uryp];
f=plot(c5xr,c5yr,'color',[0 0.5 1]);
hold on

c6xr=2*[flip(c6urxn(2:21)),c6urxp];
c6yr=[flip(c6uryn(2:21)),c6uryp];
g=plot(c6xr,c6yr,'color',[0.2 0 0]);
hold on

c7xr=2*[flip(c7urxn(2:21)),c7urxp];
c7yr=[flip(c7uryn(2:21)),c7uryp];
h=plot(c7xr,c7yr,'color',[1 .5 0]);

leg=[a,b,c,d,e,f,g,h];
title('Facet Contact Force Magntiude (CFNM) for model 13 under extension/flexion (4N/4P)')
xlabel('Moment (N-m)')
ylabel('Force (N)')
legend(leg,'C4UL','C5UL','C6UL','C7UL','C4UR','C5UR','C6UR','C7UR','location','north')